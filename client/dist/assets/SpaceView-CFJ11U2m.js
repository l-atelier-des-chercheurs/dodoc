import{n as o,_ as r}from"../build.js";import{P as i,S as c}from"./ProjectsListWithFilter-CxvZ_bHA.js";import{N as _}from"./NotFound-B1bi2Ju1.js";import"./ProjectPresentation-C7z1Y4vD.js";const p={props:{},components:{ProjectsListWithFilter:i,SpacePresentation:c,ProjectsTester:()=>r(()=>import("./ProjectsTester-B8hZn_2u.js"),[]),NotFound:_},data(){return{is_loading:!0,fetch_space_error_message:null,space:void 0,projects:void 0,show_create_modal:!1,show_import_modal:!1}},created(){},async mounted(){this.$api.updateSelfPath(this.space_path),await this.getSpace().catch(()=>{this.is_loading=!1}),this.$api.join({room:this.space_path}),this.$eventHub.$emit("received.space",this.space),await this.getProjects(),this.$api.join({room:this.projects_path}),this.$eventHub.$on("folder.removed",this.closeOnRemove),this.is_loading=!1},beforeDestroy(){this.$api.leave({room:this.space_path}),this.$api.leave({room:this.projects_path}),this.$eventHub.$off("folder.removed",this.closeOnRemove)},watch:{},computed:{space_path(){return this.createPath({space_slug:this.$route.params.space_slug})},projects_path(){return this.space_path+"/projects"},can_edit_space(){return this.canLoggedinEditFolder({folder:this.space})},can_contribute_to_space(){return this.canLoggedinContributeToFolder({folder:this.space})}},methods:{async getSpace(){this.space=await this.$api.getFolder({path:this.space_path}).catch(s=>{throw s.code==="folder_private"?this.fetch_space_error_message=this.$t("space_is_private"):this.fetch_space_error_message=s.code,s})},async getProjects(){this.projects=await this.$api.getFolders({path:this.projects_path}).catch(s=>{})},openNewProject(s){this.show_create_modal=!1;const t=this.createURLFromPath(this.projects_path+"/"+s);this.$router.push(t)},closeOnRemove({path:s}){s===this.space.$path&&(this.$alertify.closeLogOnClick(!0).delay(4e3).log(this.$t("space_was_removed")),this.$router.push("/"))}}};var n=function(){var t=this,e=t._self._c;return e("div",{staticClass:"_spaceView"},[t.is_loading?e("div",{key:"loader",staticClass:"u-divCentered"},[e("LoaderSpinner")],1):t.fetch_space_error_message?e("div",{key:"err"},[t.fetch_space_error_message==="not_found"?e("NotFound"):e("div",{staticClass:"u-instructions _errNotice"},[t._v(" "+t._s(t.fetch_space_error_message)+" ")])],1):t.space?e("div",[e("div",{staticClass:"_topSpace"},[e("SpacePresentation",{attrs:{space:t.space,context:"full",can_edit:t.can_edit_space}})],1),t._e(),e("div",{staticClass:"_projectsList"},[e("div",{staticClass:"u-sameRow u-spacingBottom"},[e("DLabel",{attrs:{str:t.$t("list_of_projects"),tag:"h2"}})],1),t.projects!==void 0?e("ProjectsListWithFilter",{attrs:{projects_pinned:t.space.projects_pinned,space_path:t.space.$path,projects:t.projects,can_edit:t.can_edit_space}},[t.can_contribute_to_space?e("button",{staticClass:"u-button u-button_red u-button_small",attrs:{type:"button"},on:{click:function(a){t.show_create_modal=!0}}},[e("b-icon",{attrs:{icon:"plus",label:t.$t("create")}}),t._v(" "+t._s(t.$t("create"))+" ")],1):t._e(),t.can_contribute_to_space?e("button",{staticClass:"u-button u-button_red u-button_small",attrs:{type:"button"},on:{click:function(a){t.show_import_modal=!0}}},[e("b-icon",{attrs:{icon:"upload",label:t.$t("import")}}),t._v(" "+t._s(t.$t("import_a_project"))+" ")],1):t._e()]):t._e(),t.show_create_modal?e("CreateFolder",{attrs:{modal_name:t.$t("create_a_project"),path:t.projects_path,private_status_explanations:t.$t("private_status_explanations_projects"),public_status_explanations:t.$t("public_status_explanations_projects"),default_folder_status:"draft"},on:{close:function(a){t.show_create_modal=!1},openNew:t.openNewProject}}):t._e(),t.show_import_modal?e("ImportFolder",{attrs:{modal_name:t.$t("import_a_project"),path:t.projects_path},on:{close:function(a){t.show_import_modal=!1},openNew:t.openNewProject}}):t._e()],1)],1):t._e()])},h=[],l=o(p,n,h,!1,null,"0f902302");const v=l.exports;export{v as default};
