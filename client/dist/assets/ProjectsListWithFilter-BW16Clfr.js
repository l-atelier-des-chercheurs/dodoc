import{n as l}from"../build.js";import{a as o,P as c}from"./ProjectPresentation-BDKDqB0P.js";const _={props:{space:Object,context:String,position_in_list:String,can_edit:Boolean},components:{},data(){return{}},created(){},mounted(){},beforeDestroy(){},watch:{},computed:{is_own_space(){return this.isOwnItem({folder:this.space})}},methods:{async removeSpace(){try{const a=await this.$api.deleteItem({path:this.space.$path})}catch{}}}};var d=function(){var t=this,e=t._self._c;return e("div",{staticClass:"_spacePresentation",class:{"is--own":t.is_own_space,"u-card2":t.context==="list"},attrs:{"data-context":t.context}},[e("div",{staticClass:"_spaceCover"},[e("CoverField",{attrs:{context:t.context,cover:t.space.$cover,path:t.space.$path,ratio:"square",can_edit:t.can_edit}}),e("transition",{attrs:{name:"toggleLock",mode:"out-in"}},[t.space.$status==="private"?e("StatusTag",{key:t.space.$status,staticClass:"_icon",attrs:{show_label:!1,status:t.space.$status,can_edit:!1,mode:"inactive"}}):t._e()],1)],1),e("div",{staticClass:"_textBloc"},[t.can_edit?e("div",{staticClass:"_statusOptions"},[e("StatusTag",{attrs:{status:t.space.$status||"public",status_options:["public","private"],path:t.space.$path,can_edit:t.can_edit}}),e("DropDown",{attrs:{show_label:!1,right:!0}},[e("DownloadFolder",{attrs:{modal_title:t.$t("download_space",{name:t.space.title}),path:t.space.$path}}),e("RemoveMenu",{attrs:{modal_title:t.$t("remove_space",{name:t.space.title})},on:{remove:t.removeSpace}})],1)],1):t._e(),e("div",{},[e("TitleField",{staticClass:"_title",attrs:{field_name:"title",label:t.context==="full"?t.$t("title"):"",tag:t.context==="full"?"h1":"h2",content:t.space.title,path:t.space.$path,required:!0,maxlength:280,can_edit:t.can_edit}}),t.can_edit||t.space.subtitle?e("TitleField",{staticClass:"_subtitle",attrs:{field_name:"subtitle",label:t.$t("subtitle"),show_label:t.context==="full"&&t.can_edit&&!t.space.subtitle,content:t.space.subtitle,path:t.space.$path,maxlength:280,can_edit:t.can_edit}}):t._e()],1),t.context==="full"&&(t.space.description||t.can_edit)?e("TitleField",{attrs:{label:t.$t("description"),show_label:t.context==="full",field_name:"description",input_type:"editor",custom_formats:["bold","italic","link"],content:t.space.description,path:t.space.$path,maxlength:1280,can_edit:t.can_edit}}):t._e(),t.context==="full"?[e("AdminsAndContributorsField",{attrs:{folder:t.space,can_edit:t.can_edit,admin_label:t.$t("referent"),admin_instructions:t.$t("space_admin_instructions"),contrib_instructions:t.$t("space_contrib_instructions")}})]:t._e()],2),t.context==="list"?e("router-link",{staticClass:"js--showCursor _openSpace",attrs:{to:{path:t.createURLFromPath(t.space.$path)},title:t.$t("open")+" "+t.space.title}}):t._e()],1)},u=[],p=l(_,d,u,!1,null,"c8946204");const w=p.exports,h={props:{projects:Array,projects_pinned:{type:Array,default:()=>[]},path:String,context:{default:"list",type:String},display_original_space:Boolean,can_edit:Boolean},components:{ProjectPresentation:o,PinnedNonpinnedFolder:c},data(){return{}},created(){},mounted(){},beforeDestroy(){},watch:{},computed:{},methods:{}};var f=function(){var t=this,e=t._self._c;return e("div",{staticClass:"_projectsList"},[t.projects.length===0?e("div",{key:"noprojects",staticClass:"u-instructions _noProjects"},[t._v(" "+t._s(t.$t("no_projects"))+" ")]):[e("PinnedNonpinnedFolder",{attrs:{field_name:"projects_pinned",label:t.$t("projects_pinned"),content:t.projects_pinned,path:t.path,folders:t.projects,can_edit:t.can_edit},scopedSlots:t._u([{key:"default",fn:function(s){return[e("ProjectPresentation",{attrs:{project:s.item,context:"list",display_original_space:t.display_original_space,can_edit:!1},on:{toggleFilter:function(r){return t.$emit("toggleFilter",r)}}})]}}])})]],2)},g=[],v=l(h,f,g,!1,null,"5f3f38fc");const m=v.exports,y={props:{projects:Array,projects_pinned:Array,space_path:String,display_original_space:Boolean,can_edit:Boolean},components:{ProjectsList:m},data(){return{show_sidebar:!1,search_project:"",order_key:"$date_created",order_options:[{key:"$date_created",text:this.$t("date_created")},{key:"$date_modified",text:this.$t("date_modified")},{key:"alphabetical",text:this.$t("alphabetical")}]}},created(){},mounted(){},beforeDestroy(){},watch:{},computed:{opened_event(){return this.$route.hash.substring(1)||!1},active_filters(){var t;let a=[];return(t=this.$route.query)!=null&&t.pfilters&&JSON.parse(this.$route.query.pfilters).map(s=>{a.push({filter_type:s.filter_type,value:decodeURI(s.value)})}),a},project_admins_and_contributors(){const a=this.extractArr(this.filtered_projects,"$admins"),t=this.extractArr(this.filtered_projects,"$contributors");return[...a,...t].reduce((e,s)=>{const r=this.getAuthor(s);return r&&!e.some(i=>i.$path===r.$path)&&e.push(r),e},[]).sort((e,s)=>e.name.localeCompare(s.name))},sorted_projects(){return this.projects?this.projects.slice().filter(a=>this.canLoggedinSeeFolder({folder:a})).sort((a,t)=>{if(a.$status!=="finished"&&t.$status==="finished")return 1;if(a.$status==="finished"&&t.$status!=="finished")return-1;if(this.order_key==="$date_created")return+new Date(t.$date_created)-+new Date(a.$date_created);if(this.order_key==="$date_modified")return+new Date(t.$date_modified)-+new Date(a.$date_modified);if(this.order_key==="alphabetical")return a.title.localeCompare(t.title)}):[]},filtered_projects(){return this.sorted_projects.filter(a=>{var t,e;for(const s of this.active_filters){const r=s.filter_type,i=s.value;if(r==="authors"){const n=this.getAuthor(i);if(!n||!((t=a.$contributors)!=null&&t.includes(n.$path))&&!((e=a.$admins)!=null&&e.includes(n.$path)))return!1}else if(!Object.prototype.hasOwnProperty.call(a,r))return!1;if(Array.isArray(a[r])&&!a[r].includes(i))return!1;if(typeof a[r]=="string"&&a[r]!==i)return!1}return!(this.search_project&&!this.searchInProject(a)||this.opened_event&&this.opened_event!==a.event_linked_slug)})}},methods:{extractAll(a){return this.extractArr(this.filtered_projects,a)},toggleFilter({filter_type:a,value:t}){let e={};this.$route.query&&(e=JSON.parse(JSON.stringify(this.$route.query)));let s=e.pfilters?JSON.parse(e.pfilters):[];t&&!s.some(i=>i.filter_type===a&&i.value===encodeURI(t))?s.push({filter_type:a,value:encodeURI(t)}):s=s.filter(i=>!(i.filter_type===a&&i.value===encodeURI(t)));const r=this.$route.hash||!1;s.length>0?e.pfilters=JSON.stringify(s):delete e.pfilters,this.$router.push({query:e,hash:r})},resetFilters(){var e;let a={};const t=this.$route.hash||!1;(e=this.$route.query)!=null&&e.pfilters&&(a=JSON.parse(JSON.stringify(this.$route.query)),delete a.pfilters),this.$router.push({query:a,hash:t})},getActiveTags(a){return this.active_filters.reduce((t,e)=>(e.filter_type===a&&t.push(e.value),t),[])},searchInProject(a){if(a.title&&this.twoStringsSearch(a.title,this.search_project)||a.description&&this.twoStringsSearch(a.description,this.search_project))return!0;for(const t of["keywords","machines","materials"])if(a[t]&&a[t].some(e=>this.twoStringsSearch(e,this.search_project)))return!0;return!1}}};var $=function(){var t=this,e=t._self._c;return e("section",{staticClass:"_projectsListWithFilter"},[e("div",{staticClass:"_filterSortBar"},[e("div",{staticClass:"_filterSortBar--leftSide"},[t._t("default"),t.sorted_projects.length>0?[e("div",{},[e("button",{staticClass:"u-button u-button_small u-button_bleumarine",class:{"is--active":t.show_sidebar},attrs:{type:"button",size:"small"},domProps:{textContent:t._s(t.show_sidebar?t.$t("hide"):t.$t("filter"))},on:{click:function(s){t.show_sidebar=!t.show_sidebar}}})]),e("div",{staticClass:"_searchField"},[e("SearchInput",{attrs:{search_placeholder:t.$t("search_in_title_desc_kw"),name:"search_project"},model:{value:t.search_project,callback:function(s){t.search_project=s},expression:"search_project"}})],1)]:t._e()],2),e("div",{},[t.sorted_projects.length>0?[e("select",{directives:[{name:"model",rawName:"v-model",value:t.order_key,expression:"order_key"}],staticClass:"_orderSelect",attrs:{size:"small",name:"order_projects",disabled:t.filtered_projects.length<=1},on:{change:function(s){var r=Array.prototype.filter.call(s.target.options,function(i){return i.selected}).map(function(i){var n="_value"in i?i._value:i.value;return n});t.order_key=s.target.multiple?r:r[0]}}},t._l(t.order_options,function(s){return e("option",{key:s.key,domProps:{value:s.key,textContent:t._s(s.text)}})}),0)]:t._e()],2)]),e("div",{staticClass:"_cont"},[t.show_sidebar?e("div",{staticClass:"_sidebar"},[e("div",[e("DLabel",{attrs:{str:t.$t("status")}}),e("div",{staticClass:"_statusList"},t._l(t.extractAll("$status"),function(s){return e("StatusTag",{key:s,attrs:{status:s,can_edit:!1,mode:t.getActiveTags("$status").includes(s)?"disable":"active"},on:{click:function(r){return t.toggleFilter({filter_type:"$status",value:s})}}})}),1)],1),e("div",[e("DLabel",{attrs:{str:t.$t("contributors")}}),e("TagsList",{attrs:{tags:t.project_admins_and_contributors,tag_type:"authors",tags_active:t.getActiveTags("authors")},on:{tagClick:function(s){return t.toggleFilter({filter_type:"authors",value:s})}}})],1),t._l(["target_audience","disciplines","level","keywords","machines","materials"],function(s){return[t.extractAll(s).length>0?e("div",{key:s},[s==="level"?[e("DLabel",{attrs:{str:t.$t("levels_and_competences")}}),e("TagsList",{attrs:{tags:t.extractAll("level"),tag_type:"level",tags_active:t.getActiveTags("level")},on:{tagClick:function(r){return t.toggleFilter({filter_type:"level",value:r})}}})]:s==="keywords"?[e("DLabel",{attrs:{str:t.$t("keywords")}}),e("TagsList",{attrs:{tags:t.extractAll("keywords"),tag_type:"keywords",tags_active:t.getActiveTags("keywords")},on:{tagClick:function(r){return t.toggleFilter({filter_type:"keywords",value:r})}}})]:s==="materials"?[e("DLabel",{attrs:{str:t.$t("materials")}}),e("TagsList",{attrs:{tags:t.extractAll("materials"),tag_type:"materials",tags_active:t.getActiveTags("materials")},on:{tagClick:function(r){return t.toggleFilter({filter_type:"materials",value:r})}}})]:s==="machines"?[e("DLabel",{attrs:{str:t.$t("machines")}}),e("TagsList",{attrs:{tags:t.extractAll("machines"),tag_type:"machines",tags_active:t.getActiveTags("machines")},on:{tagClick:function(r){return t.toggleFilter({filter_type:"machines",value:r})}}})]:s==="disciplines"?[e("DLabel",{attrs:{str:t.$t("disciplines")}}),e("TagsList",{attrs:{tags:t.extractAll("disciplines"),tag_type:"disciplines",tags_active:t.getActiveTags("disciplines")},on:{tagClick:function(r){return t.toggleFilter({filter_type:"disciplines",value:r})}}})]:s==="target_audience"?[e("DLabel",{attrs:{str:t.$t("target_audience")}}),e("TagsList",{attrs:{tags:t.extractAll("target_audience"),tag_type:"target_audience",tags_active:t.getActiveTags("target_audience")},on:{tagClick:function(r){return t.toggleFilter({filter_type:"target_audience",value:r})}}})]:t._e()],2):t._e()]})],2):t._e(),e("div",{staticClass:"_listOfProjects"},[e("transition",{attrs:{name:"scaleInFade",mode:"out-in"}},[t.active_filters.length>0?e("transition-group",{staticClass:"_tagList",attrs:{tag:"section",name:"listComplete",appear:""}},[t._l(t.active_filters,function(s){return[s.filter_type==="$status"?e("StatusTag",{key:s.value,attrs:{status:s.value,can_edit:!1,mode:"disable"},on:{click:function(r){return t.toggleFilter({filter_type:"$status",value:s.value})}}}):s.filter_type==="authors"?e("AuthorTag",{key:s.value,attrs:{path:s.value,mode:"disable"},on:{click:function(r){return t.toggleFilter({filter_type:"authors",value:s.value})}}}):e("SingleTag",{key:s.value,attrs:{tag_type:s.filter_type,tag_str:s.value,mode:"disable"},on:{tagClick:function(r){return t.toggleFilter({filter_type:s.filter_type,value:s.value})}}})]}),t.active_filters.length>1?e("button",{key:"reset_all",staticClass:"u-buttonLink",attrs:{type:"button"},on:{click:t.resetFilters}},[t._v(" "+t._s(t.$t("reset_all"))+" ")]):t._e()],2):t._e()],1),e("ProjectsList",{attrs:{projects:t.filtered_projects,projects_pinned:t.projects_pinned,path:t.space_path,display_original_space:t.display_original_space,can_edit:t.can_edit},on:{toggleFilter:function(s){return t.toggleFilter(s)}}})],1)])])},b=[],k=l(y,$,b,!1,null,"c749e29a");const C=k.exports;export{C as P,w as S};
