import{F as r}from"./FlickityCarousel-BRYWTejq.js";import{n}from"../build.js";const o={props:{},components:{FlickityCarousel:r},data(){return{events:void 0,path:"events",fetch_events_error:void 0,show_create_modal:!1,flickityOptions:{initialIndex:0,groupCells:!1,pageDots:!1,resize:!0,selectedAttraction:.2,percentPosition:!1,friction:.8,cellAlign:"left",contain:!0}}},created(){},async mounted(){this.events=await this.$api.getFolders({path:this.path}).catch(s=>{this.fetch_events_error=s.response}),this.$api.join({room:this.path})},beforeDestroy(){this.$api.leave({room:this.path})},watch:{},computed:{sorted_events(){return this.events?this.events.slice().filter(t=>this.canLoggedinSeeFolder({folder:t})).sort((t,e)=>+new Date(e.start_date)-+new Date(t.start_date)):[]},slider_key(){const s=this.sorted_events.map(t=>t.$path);return s?JSON.stringify(s):"none"}},methods:{openNewEvent(s){this.show_create_modal=!1;const t=this.createURLFromPath(this.path+"/"+s);this.$router.push(t)},sliderClick(s){const t=this.$refs.flickity&&this.$refs.flickity.flickity;if(t&&t.isPreventingClicks){s.preventDefault();return}this.$router.push(s.currentTarget.getAttribute("href"))}}};var c=function(){var t=this,e=t._self._c;return e("div",{staticClass:"_eventsList"},[e("div",{staticClass:"u-sameRow u-spacingBottom"},[e("DLabel",{attrs:{str:t.$t("events")}}),t.is_instance_admin||t.is_instance_contributor?e("button",{staticClass:"u-button u-button_orange u-button_small",attrs:{type:"button"},on:{click:function(a){t.show_create_modal=!0}}},[e("svg",{staticStyle:{"enable-background":"new 0 0 168 168"},attrs:{version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",x:"0px",y:"0px",viewBox:"0 0 168 168","xml:space":"preserve"}},[e("path",{staticStyle:{fill:"#ffbe32"},attrs:{d:`M24.6,24.4c-32.8,32.8-32.8,86.1,0,119c32.8,32.8,85.9,32.8,118.7,0c32.8-32.8,32.8-85.9,0-118.7
		C110.5-8.2,57.5-8.2,24.6,24.4z`}}),e("polygon",{staticStyle:{fill:"#ffffff"},attrs:{points:`132.3,73.4 132.3,94.4 94.6,94.4 94.6,132.1 73.6,132.1 73.6,94.4 35.9,94.4 35.9,73.4 
		73.6,73.4 73.6,35.7 94.6,35.7 94.6,73.4 		`}})]),t._v(" "+t._s(t.$t("create"))+" ")]):t._e(),t.show_create_modal?e("CreateFolder",{attrs:{modal_name:t.$t("create_an_event"),path:"events"},on:{close:function(a){t.show_create_modal=!1},openNew:t.openNewEvent}}):t._e()],1),t._m(0),t.sorted_events.length>0?e("FlickityCarousel",{key:t.slider_key,ref:"flickity",staticClass:"_eventsCarousel",attrs:{options:t.flickityOptions}},t._l(t.sorted_events,function(a){return e("div",{key:a.$path,staticClass:"carousel-cell"},[e("div",{staticClass:"_eventsDate"},[a.start_date?[t._v(" "+t._s(t.formatDateToPrecise(a.start_date))+" "),a.end_date?[e("b-icon",{attrs:{icon:"arrow-right-short"}}),t._v(" "+t._s(t.formatDateToPrecise(a.end_date))+" ")]:t._e()]:t._e()],2),e("div",{staticClass:"_eventsCoverTitle"},[e("CoverField",{staticClass:"_cover",attrs:{context:"preview",cover:a.$cover,ratio:"3 / 2",path:a.$path,can_edit:!1}}),e("div",{},[e("h3",[t._v(" "+t._s(a.title)+" ")]),e("div",{staticClass:"_openEvent"},[e("router-link",{staticClass:"u-buttonLink",attrs:{to:{path:t.createURLFromPath(a.$path)},event:""},nativeOn:{click:function(i){return i.preventDefault(),t.sliderClick.apply(null,arguments)}}},[e("div",{staticClass:"_clickZone"}),t._v(" "+t._s(t.$t("open"))+" ")])],1)])],1)])}),0):t._e()],1)},_=[function(){var s=this,t=s._self._c;return t("div",{staticClass:"_lineCont"},[t("div",{staticClass:"_line"})])}],l=n(o,c,_,!1,null,"89063c25");const d=l.exports,v={props:{event_slug:String},components:{},data(){return{event:void 0,is_loading:!0}},async created(){await this.getEvent().catch(s=>{var t;((t=s.response)==null?void 0:t.status)===404&&this.$alertify.delay(4e3).error("event_does_not_exit"),this.$router.replace("/")}),this.$api.join({room:this.event_path}),this.is_loading=!1},mounted(){},beforeDestroy(){this.$api.leave({room:this.event_path})},watch:{},computed:{event_path(){return this.createPath({event_slug:this.event_slug})},can_edit_event(){return this.canLoggedinEditFolder({folder:this.event})}},methods:{async getEvent(){this.event=await this.$api.getFolder({path:this.event_path})},async removeEvent(){await this.$api.deleteItem({path:this.event_path}),this.$router.push("/")}}};var p=function(){var t=this,e=t._self._c;return e("div",{staticClass:"_openedEvent"},[e("div",{staticClass:"_openedEvent--cont"},[t.is_loading?e("div",{key:"loader",staticClass:"_spinner"},[e("LoaderSpinner")],1):[t.event?t._e():e("div",[e("router-link",{staticClass:"u-buttonLink",attrs:{to:"/"}},[e("b-icon",{attrs:{icon:"arrow-left-short"}}),t._v(" "+t._s(t.$t("other_events"))+" ")],1)],1),e("CoverField",{staticClass:"_cover",attrs:{context:"full",cover:t.event.$cover,ratio:"3 / 2",path:t.event.$path,can_edit:t.can_edit_event}}),e("div",{staticClass:"_text"},[e("div",{staticClass:"_backBtn"},[e("router-link",{staticClass:"u-buttonLink",attrs:{to:"/"}},[e("b-icon",{attrs:{icon:"arrow-left-short"}}),t._v(" "+t._s(t.$t("other_events"))+" ")],1)],1),t.can_edit_event?e("div",{staticClass:"u-spacingBottom"}):t._e(),t.can_edit_event?e("StatusTag",{attrs:{status:t.event.$status||"public",status_options:["public","private"],path:t.event.$path,can_edit:t.can_edit_event}}):t._e(),t.can_edit_event?e("div",{staticClass:"u-spacingBottom"}):t._e(),e("div",{staticClass:"u-spacingBottom"},[e("TitleField",{staticClass:"_title",attrs:{field_name:"title",label:t.can_edit_event&&!t.event.title?t.$t("title"):"",content:t.event.title,path:t.event.$path,required:!0,maxlength:40,tag:"h1",can_edit:t.can_edit_event}})],1),e("div",{staticClass:"_eventsDates"},[e("div",{staticClass:"u-spacingBottom"},[e("DateField",{attrs:{field_name:"start_date",label:t.$t("start_date"),date:t.event.start_date,path:t.event.$path,input_type:"date",can_edit:t.can_edit_event}})],1),e("div",{staticClass:"u-spacingBottom"},[e("DateField",{attrs:{field_name:"end_date",label:t.$t("end_date"),date:t.event.end_date,path:t.event.$path,input_type:"date",can_edit:t.can_edit_event}})],1)]),e("div",{staticClass:"u-spacingBottom"},[e("CollaborativeEditor3",{attrs:{label:t.can_edit_event&&!t.event.description?t.$t("presentation"):"",field_to_edit:"presentation",content:t.event.presentation,path:t.event.$path,custom_formats:["bold","italic","link","emoji"],is_collaborative:!1,maxlength:1280,can_edit:t.can_edit_event}})],1),t.can_edit_event?e("div",{staticClass:"u-mediaOptions"},[e("RemoveMenu",{on:{remove:t.removeEvent}})],1):t._e()],1)]],2)])},h=[],u=n(v,p,h,!1,null,"e358c257");const f=u.exports,m={props:{},components:{EventsList:d,OpenedEvent:f},data(){return{}},created(){},mounted(){},beforeDestroy(){},watch:{opened_event:{handler(){this.opened_event&&this.$nextTick(()=>{this.$el.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"})})},immediate:!0}},computed:{opened_event(){return this.$route.hash.substring(1)||!1}},methods:{}};var $=function(){var t=this,e=t._self._c;return e("div",{staticClass:"_eventsSection"},[e("transition",{attrs:{name:"fade",mode:"out-in"}},[t.opened_event?e("OpenedEvent",{key:"event",attrs:{event_slug:t.opened_event}}):e("EventsList",{key:"list"})],1)],1)},C=[],g=n(m,$,C,!1,null,"057e74f8");const b=g.exports;export{b as default};
