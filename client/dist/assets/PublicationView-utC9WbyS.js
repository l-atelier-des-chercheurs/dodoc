import{n as r,_ as s,s as a}from"../build.js";import{P as n}from"./PublicationTopbar-Blju4-1f.js";const l={props:{},components:{PublicationTopbar:n,PageSlides:()=>s(()=>import("./PageSlides-Dwts4d2x.js"),[]),StoryTemplate:()=>s(()=>import("./StoryTemplate-BzD3Rp-G.js"),[]),SectionWithPrint:()=>s(()=>import("./SectionWithPrint-n2_3nN-m.js"),[]),MapForPrint:()=>s(()=>import("./MapForPrint-DSuZN299.js"),[]),EditionExport:()=>s(()=>import("./EditionExport-CZkG_2uH.js"),[])},data(){return{project:null,publication:null,fetch_publication_error:void 0,show_topbar:!1,is_fullscreen:!1,is_serversidepreview:!1}},created(){console.log("Loading PublicationView")},async mounted(){var t,i;((t=this.$route.query)==null?void 0:t.make_preview)==="true"&&(this.is_serversidepreview=!0);let e;(i=this.$route.query)!=null&&i.sat&&(e=this.$route.query.sat),window.app_infos.page_is_standalone_html?this.publication=window.folder_data:this.publication=await this.$api.getPublicFolder({path:this.publication_path,superadmintoken:e}).catch(o=>{this.fetch_publication_error=o.code}),this.$root.is_loading=!1},beforeDestroy(){},watch:{is_fullscreen(){}},computed:{project_path(){return this.createPath({space_slug:this.$route.params.space_slug,project_slug:this.$route.params.project_slug})},publication_path(){return`${this.project_path}/publications/${this.$route.params.publication_slug}`},set_print_margins(){let e=15;return this.publication&&this.publication.template==="page_by_page"&&(e=0),`
      @page {
        margin: ${e}mm;
      }
      `}},methods:{async openFs(){await a.request(this.$refs.fsContainer),this.is_fullscreen=!0,a.onchange(()=>{a.isFullscreen||(this.is_fullscreen=!1)})},async closeFs(){await a.exit(),this.is_fullscreen=!1},async toggleFs(){this.is_fullscreen?this.closeFs():this.openFs()}}};var p=function(){var t=this,i=t._self._c;return i("div",{staticClass:"_publicationView",class:{"is--serversidepreview":t.is_serversidepreview}},[i("style",{tag:"component"},[t._v(" "+t._s(t.set_print_margins)+" ")]),i("transition",{attrs:{name:"fade_fast",mode:"out-in"}},[t.$root.is_loading?i("div",{key:"loader",staticClass:"u-divCentered"},[i("LoaderSpinner")],1):t.fetch_publication_error?i("div",[t._v(" "+t._s(t.fetch_publication_error)+" ")]):t.publication?i("div",{key:"publication",ref:"fsContainer"},[!t.is_serversidepreview&&!t.is_fullscreen?[i("transition",{attrs:{name:"pagechange",mode:"out-in"}},[t.show_topbar?i("div",{staticClass:"_pubTopbar"},[i("PublicationTopbar",{attrs:{publication:t.publication,no_back_button:!0,can_edit:!1}})],1):t._e()]),i("div",{staticClass:"_toggleTopbar"},[i("button",{staticClass:"u-button u-button_small u-button_icon",attrs:{type:"button"},on:{click:function(o){t.show_topbar=!t.show_topbar}}},[i("b-icon",{attrs:{icon:"chevron-up",rotate:t.show_topbar?0:180}})],1)])]:t._e(),t.publication.template==="page_by_page"?[i("PageSlides",{attrs:{publication:t.publication,is_serversidepreview:t.is_serversidepreview},on:{toggleFs:t.toggleFs}})]:t.publication.template==="story"?i("div",[i("StoryTemplate",{staticClass:"_storyTemplate",attrs:{publication:t.publication,can_edit:!1}})],1):t.publication.template==="story_with_sections"?i("div",[i("SectionWithPrint",{attrs:{publication:t.publication}})],1):t.publication.template==="cartography"?i("div",[i("MapForPrint",{attrs:{publication:t.publication}})],1):t.publication.template==="edition"?i("div",[i("EditionExport",{attrs:{publication:t.publication}})],1):t._e()],2):t._e()])],1)},_=[],c=r(l,p,_,!1,null,"c7bde93b");const b=c.exports;export{b as default};
