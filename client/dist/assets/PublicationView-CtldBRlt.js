import{n as o,_ as s,s as a}from"../build.js";import{P as n}from"./PublicationTopbar-BZ6gaI7C.js";const l={props:{},components:{PublicationTopbar:n,PageSlides:()=>s(()=>import("./PageSlides-Bu4_wTBq.js"),[]),StoryTemplate:()=>s(()=>import("./StoryTemplate-DCjs3ZjO.js"),[]),SectionWithPrint:()=>s(()=>import("./SectionWithPrint-CKkI9yXx.js"),[]),MapForPrint:()=>s(()=>import("./MapForPrint-C2yzEmGO.js"),[])},data(){return{project:null,publication:null,fetch_publication_error:void 0,show_topbar:!0,is_fullscreen:!1,is_serversidepreview:!1}},created(){console.log("Loading PublicationView")},async mounted(){var t,e;((t=this.$route.query)==null?void 0:t.make_preview)==="true"&&(this.is_serversidepreview=!0);let i;(e=this.$route.query)!=null&&e.sat&&(i=this.$route.query.sat),window.app_infos.page_is_standalone_html?this.publication=window.folder_data:this.publication=await this.$api.getPublicFolder({path:this.publication_path,superadmintoken:i}).catch(r=>{this.fetch_publication_error=r.code}),this.$root.is_loading=!1},beforeDestroy(){},watch:{is_fullscreen(){}},computed:{project_path(){return this.createPath({space_slug:this.$route.params.space_slug,project_slug:this.$route.params.project_slug})},publication_path(){return`${this.project_path}/publications/${this.$route.params.publication_slug}`},set_print_margins(){let i=15;return this.publication&&this.publication.template==="page_by_page"&&(i=0),`
      @page {
        margin: ${i}mm;
      }
      `}},methods:{async openFs(){await a.request(this.$refs.fsContainer),this.is_fullscreen=!0,a.onchange(()=>{a.isFullscreen||(this.is_fullscreen=!1)})},async closeFs(){await a.exit(),this.is_fullscreen=!1},async toggleFs(){this.is_fullscreen?this.closeFs():this.openFs()}}};var _=function(){var t=this,e=t._self._c;return e("div",{staticClass:"_publicationView",class:{"is--serversidepreview":t.is_serversidepreview}},[e("style",{tag:"component"},[t._v(" "+t._s(t.set_print_margins)+" ")]),e("transition",{attrs:{name:"fade_fast",mode:"out-in"}},[t.$root.is_loading?e("div",{key:"loader",staticClass:"u-divCentered"},[e("LoaderSpinner")],1):t.fetch_publication_error?e("div",[t._v(" "+t._s(t.fetch_publication_error)+" ")]):t.publication?e("div",{key:"publication",ref:"fsContainer"},[!t.is_serversidepreview&&!t.is_fullscreen?[e("transition",{attrs:{name:"pagechange",mode:"out-in"}},[t.show_topbar?e("div",{staticClass:"_pubTopbar"},[e("PublicationTopbar",{attrs:{publication:t.publication,no_back_button:!0,can_edit:!1}})],1):t._e()]),e("div",{staticClass:"_toggleTopbar"},[e("button",{staticClass:"u-button u-button_small u-button_icon",attrs:{type:"button"},on:{click:function(r){t.show_topbar=!t.show_topbar}}},[e("b-icon",{attrs:{icon:"chevron-up",rotate:t.show_topbar?0:180}})],1)])]:t._e(),t.publication.template==="page_by_page"?[e("PageSlides",{attrs:{publication:t.publication,is_serversidepreview:t.is_serversidepreview},on:{toggleFs:t.toggleFs}})]:t.publication.template==="story"?e("div",[e("StoryTemplate",{staticClass:"_storyTemplate",attrs:{publication:t.publication,can_edit:!1}})],1):t.publication.template==="story_with_sections"?e("div",[e("SectionWithPrint",{attrs:{publication:t.publication}})],1):t.publication.template==="cartography"?e("div",[e("MapForPrint",{attrs:{publication:t.publication}})],1):t._e()],2):t._e()])],1)},p=[],c=o(l,_,p,!1,null,"4972440d");const b=c.exports;export{b as default};
