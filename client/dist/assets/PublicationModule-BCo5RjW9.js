import{M as V}from"./MediaPicker-BMUJ0Boq.js";import{C as _t}from"./CaptionCreditsPage-BlU_GZTS.js";import{n as D,S as Ct,a as St,H as kt,c as yt}from"../build.js";import{F as Et}from"./flickity-ByXwvD2H.js";const Mt={props:{medias_with_linked:Array,context:String,publimodule:Object,page_template:String,show_fs_button:Boolean,number_of_max_medias:[Boolean,Number],publication_path:String,edit_mode:Boolean,can_edit:Boolean},components:{MediaPicker:V,CaptionCreditsPage:_t},data(){return{show_media_picker:!1}},created(){},mounted(){},beforeDestroy(){},watch:{},computed:{is_multiple_medias(){return this.medias_with_linked.length>1},single_media_displayed_at_full_ratio(){var n,d,r,a,u;if(this.medias_with_linked.length>1)return!1;const c=(n=this.medias_with_linked[0]._linked_media.$infos)==null?void 0:n.ratio,t=(d=this.publimodule)!=null&&d.height&&((r=this.publimodule)!=null&&r.width)?((a=this.publimodule)==null?void 0:a.height)/((u=this.publimodule)==null?void 0:u.width):!1;if(!c||!t)return!1;const e=10;return Math.round(c*e)===Math.round(t*e)}},methods:{itemKey(c,t){return c!=null&&c.$path?c.$path+"_"+t:"no_media_"+t},itemStyle({media_with_linked:c}){let t={};return t["--object-fit"]=c.objectFit||"cover",t},mediaIsSquare(c){var t;return((t=c.$infos)==null?void 0:t.ratio)===1},removeMedia(c){this.$emit("removeMediaAtIndex",{index:c})},mediaDraggedSuccessfully(c){console.log("mediaDraggedSuccessfully"),this.$emit("removeMediaAtIndex",{index:c,remove_source:!1})},showAspectRatioOptions(c){return!(this.medias_with_linked.length===1&&this.page_template!=="page_by_page"||["stl","obj","text","table","other"].includes(c._linked_media.$type)||this.page_template!=="page_by_page"&&this.mediaIsSquare(c._linked_media))}}};var $t=function(){var t=this,e=t._self._c;return e("div",{staticClass:"_mediaGrid",class:{"is--multipleMedias":t.is_multiple_medias}},[t._l(t.medias_with_linked,function(n,d){return[e("div",{key:t.itemKey(n._linked_media,d),staticClass:"_mediaGrid--item",style:t.itemStyle({media_with_linked:n}),attrs:{"data-mediatype":n._linked_media.$type}},[n._linked_media?n._linked_media.$type==="text"?e("CollaborativeEditor2",{key:t.edit_mode,staticClass:"_mediaContent--collabEditor",attrs:{content:n._linked_media.$content,path:n._linked_media.$path,edit_on_mounted:t.edit_mode,can_edit:t.edit_mode}}):n._linked_media.$type==="table"?e("TableEditor",{staticClass:"_mediaContent--table",attrs:{content:n._linked_media.$content,path:n._linked_media.$path,can_edit:t.edit_mode}}):e("MediaContent",{attrs:{file:n._linked_media,resolution:t.context==="preview"?220:1600,context:t.context,show_fs_button:t.show_fs_button,can_edit:t.can_edit}}):e("div",{staticClass:"u-instructions _noSourceMedia",domProps:{textContent:t._s(t.$t("source_media_missing"))}}),e("CaptionCreditsPage",{attrs:{media:n._linked_media,publication_path:t.publication_path,can_edit:t.can_edit}}),e("div",{staticClass:"_btnRow"},[t.edit_mode?e("DragFile",{staticClass:"_df",attrs:{size:"small",file:n._linked_media},on:{dragfileSuccess:function(r){return t.mediaDraggedSuccessfully(d)}}}):t._e(),t.edit_mode?[t.showAspectRatioOptions(n)?[!n.objectFit||n.objectFit==="cover"?t._e():e("button",{staticClass:"u-button u-button_icon u-button_small",attrs:{type:"button"},on:{click:function(r){return r.stopPropagation(),t.$emit("updateMediaOpt",{index:d,opt:{objectFit:"cover"}})}}},[e("b-icon",{attrs:{icon:"aspect-ratio"}})],1),n.objectFit!=="contain"?e("button",{staticClass:"u-button u-button_icon u-button_small",attrs:{type:"button"},on:{click:function(r){return r.stopPropagation(),t.$emit("updateMediaOpt",{index:d,opt:{objectFit:"contain"}})}}},[e("b-icon",{attrs:{icon:"aspect-ratio-fill"}})],1):t._e()]:t._e(),t.is_multiple_medias?e("button",{staticClass:"u-button u-button_icon u-button_small",attrs:{type:"button"},on:{click:function(r){return t.removeMedia(d)}}},[e("b-icon",{attrs:{icon:"trash"}})],1):t._e()]:t._e()],2)],1)]}),t.can_edit&&(!t.number_of_max_medias||t.medias_with_linked.length<t.number_of_max_medias)?e("div",{staticClass:"_mediaPickerTile"},[t.edit_mode?e("EditBtn",{attrs:{btn_type:"add",is_unfolded:!1},on:{click:function(n){t.show_media_picker=!0}}}):t._e(),t.show_media_picker?e("MediaPicker",{attrs:{publication_path:t.publication_path},on:{addMedias:function(n){return t.$emit("addMedias",n)},close:function(n){t.show_media_picker=!1}}}):t._e(),!t.number_of_max_medias||t.medias_with_linked.length<t.number_of_max_medias?[e("DropZone",{staticClass:"_dzAfter",on:{mediaDropped:function(n){return t.$emit("addMedias",n)}}})]:t._e()],2):t._e()],2)},Dt=[],wt=D(Mt,$t,Dt,!1,null,"82eccccd");const Pt=wt.exports,It={props:{medias_with_linked:Array,publication_path:String,mode:String,edit_mode:Boolean},components:{SlickItem:Ct,SlickList:St,MediaPicker:V},directives:{handle:kt},data(){return{show_media_picker:!1,show_media_preview_for:null}},created(){},mounted(){},beforeDestroy(){},watch:{},computed:{slicklist_key(){let c=this.edit_mode+"_";return this.medias_with_linked.forEach(t=>{c+=t._linked_media.$path+"_"}),c}},methods:{}};var At=function(){var t=this,e=t._self._c;return e("div",{staticClass:"_filesList"},[e("DLabel",{attrs:{str:t.mode==="source"?t.$t("source_files"):void 0}}),e("SlickList",{key:t.slicklist_key,staticClass:"_listOfFiles",attrs:{axis:"y",value:t.medias_with_linked,useDragHandle:!0},on:{input:function(n){return t.$emit("reorderMedias",n)}}},t._l(t.medias_with_linked,function({_linked_media:n},d){return e("SlickItem",{key:n.$path,staticClass:"_reorderedFile",attrs:{index:d}},[t.edit_mode?e("button",{staticClass:"u-button u-button_icon _dragHandle",attrs:{type:"button"}},[e("b-icon",{directives:[{name:"handle",rawName:"v-handle"}],attrs:{icon:"grip-vertical",label:t.$t("move")}})],1):t._e(),n&&n.$path?e(t.mode==="source"?"DownloadFile":"span",{tag:"component",staticClass:"_link",attrs:{file:n}},[["image","video","audio","pdf","stl","url"].includes(n.$type)?e("button",{staticClass:"_link--previewBtn",attrs:{type:"button"},on:{click:function(r){r.preventDefault(),t.show_media_preview_for=n}}},[e("MediaContent",{staticClass:"_preview",attrs:{context:"preview",file:n,resolution:220}})],1):e("div",{staticClass:"_preview _preview--none"},[e("b-icon",{attrs:{icon:"file-earmark-arrow-down"}})],1),t.show_media_preview_for===n?e("BaseModal2",{on:{close:function(r){t.show_media_preview_for=null}}},[e("MediaContent",{attrs:{file:t.show_media_preview_for,context:"preview",resolution:1600}}),e("div",{staticClass:"u-spacingBottom"}),e("DownloadFile",{attrs:{file:t.show_media_preview_for}})],1):t._e(),e("span",{staticClass:"_link--filename",domProps:{textContent:t._s(n.$media_filename)}}),n.$infos.size&&t.mode==="source"?[e("span",{staticClass:"u-instructions _link--filesize",domProps:{textContent:t._s(t.formatBytes(n.$infos.size))}})]:t._e(),t.mode==="source"?e("b-icon",{staticClass:"_download",attrs:{icon:"file-earmark-arrow-down-fill"}}):t._e()],2):t._e(),t.edit_mode?e("div",{staticClass:"_removeItem"},[e("EditBtn",{attrs:{btn_type:"remove",label_position:"left",is_unfolded:!1},on:{click:function(r){return t.$emit("removeMediaAtIndex",{index:d})}}})],1):t._e()],1)}),1),t.edit_mode?e("div",{staticClass:"_addBtnSection"},[e("button",{staticClass:"u-button u-button_transparent u-addBtn",attrs:{type:"button"},on:{click:function(n){t.show_media_picker=!0}}},[e("b-icon",{attrs:{icon:"plus-circle"}}),t._v(" "+t._s(t.$t("add_files"))+" ")],1),t.show_media_picker?e("MediaPicker",{attrs:{publication_path:t.publication_path},on:{addMedias:function(n){return t.$emit("addMedias",n)},close:function(n){t.show_media_picker=!1}}}):t._e(),e("DropZone",{on:{mediaDropped:function(n){return t.$emit("addMedias",n)}}})],1):t._e()],1)},Lt=[],zt=D(It,At,Lt,!1,null,"92a8392b");const bt=zt.exports;var Bt={exports:{}},P={exports:{}},I={exports:{}},A={exports:{}},tt;function w(){return tt||(tt=1,function(c){(function(t,e){c.exports?c.exports=e():t.EvEmitter=e()})(typeof window<"u"?window:yt,function(){function t(){}var e=t.prototype;return e.on=function(n,d){if(!(!n||!d)){var r=this._events=this._events||{},a=r[n]=r[n]||[];return a.indexOf(d)==-1&&a.push(d),this}},e.once=function(n,d){if(!(!n||!d)){this.on(n,d);var r=this._onceEvents=this._onceEvents||{},a=r[n]=r[n]||{};return a[d]=!0,this}},e.off=function(n,d){var r=this._events&&this._events[n];if(!(!r||!r.length)){var a=r.indexOf(d);return a!=-1&&r.splice(a,1),this}},e.emitEvent=function(n,d){var r=this._events&&this._events[n];if(!(!r||!r.length)){r=r.slice(0),d=d||[];for(var a=this._onceEvents&&this._onceEvents[n],u=0;u<r.length;u++){var i=r[u],s=a&&a[i];s&&(this.off(n,i),delete a[i]),i.apply(this,d)}return this}},e.allOff=function(){delete this._events,delete this._onceEvents},t})}(A)),A.exports}var L={exports:{}};/*!
 * getSize v2.0.3
 * measure size of elements
 * MIT license
 */var et;function xt(){return et||(et=1,function(c){(function(t,e){c.exports?c.exports=e():t.getSize=e()})(window,function(){function e(h){var v=parseFloat(h),f=h.indexOf("%")==-1&&!isNaN(v);return f&&v}function n(){}var d=typeof console>"u"?n:function(h){console.error(h)},r=["paddingLeft","paddingRight","paddingTop","paddingBottom","marginLeft","marginRight","marginTop","marginBottom","borderLeftWidth","borderRightWidth","borderTopWidth","borderBottomWidth"],a=r.length;function u(){for(var h={width:0,height:0,innerWidth:0,innerHeight:0,outerWidth:0,outerHeight:0},v=0;v<a;v++){var f=r[v];h[f]=0}return h}function i(h){var v=getComputedStyle(h);return v||d("Style returned "+v+". Are you running this code in a hidden iframe on Firefox? See https://bit.ly/getsizebug1"),v}var s=!1,l;function p(){if(!s){s=!0;var h=document.createElement("div");h.style.width="200px",h.style.padding="1px 2px 3px 4px",h.style.borderStyle="solid",h.style.borderWidth="1px 2px 3px 4px",h.style.boxSizing="border-box";var v=document.body||document.documentElement;v.appendChild(h);var f=i(h);l=Math.round(e(f.width))==200,_.isBoxSizeOuter=l,v.removeChild(h)}}function _(h){if(p(),typeof h=="string"&&(h=document.querySelector(h)),!(!h||typeof h!="object"||!h.nodeType)){var v=i(h);if(v.display=="none")return u();var f={};f.width=h.offsetWidth,f.height=h.offsetHeight;for(var g=f.isBorderBox=v.boxSizing=="border-box",S=0;S<a;S++){var o=r[S],m=v[o],y=parseFloat(m);f[o]=isNaN(y)?0:y}var b=f.paddingLeft+f.paddingRight,x=f.paddingTop+f.paddingBottom,C=f.marginLeft+f.marginRight,k=f.marginTop+f.marginBottom,E=f.borderLeftWidth+f.borderRightWidth,Q=f.borderTopWidth+f.borderBottomWidth,J=g&&l,Z=e(v.width);Z!==!1&&(f.width=Z+(J?0:b+E));var K=e(v.height);return K!==!1&&(f.height=K+(J?0:x+Q)),f.innerWidth=f.width-(b+E),f.innerHeight=f.height-(x+Q),f.outerWidth=f.width+C,f.outerHeight=f.height+k,f}}return _})}(L)),L.exports}var z={exports:{}},B={exports:{}},it;function Ot(){return it||(it=1,function(c){(function(t,e){c.exports?c.exports=e():t.matchesSelector=e()})(window,function(){var e=function(){var n=window.Element.prototype;if(n.matches)return"matches";if(n.matchesSelector)return"matchesSelector";for(var d=["webkit","moz","ms","o"],r=0;r<d.length;r++){var a=d[r],u=a+"MatchesSelector";if(n[u])return u}}();return function(d,r){return d[e](r)}})}(B)),B.exports}var st;function M(){return st||(st=1,function(c){(function(t,e){c.exports?c.exports=e(t,Ot()):t.fizzyUIUtils=e(t,t.matchesSelector)})(window,function(e,n){var d={};d.extend=function(u,i){for(var s in i)u[s]=i[s];return u},d.modulo=function(u,i){return(u%i+i)%i};var r=Array.prototype.slice;d.makeArray=function(u){if(Array.isArray(u))return u;if(u==null)return[];var i=typeof u=="object"&&typeof u.length=="number";return i?r.call(u):[u]},d.removeFrom=function(u,i){var s=u.indexOf(i);s!=-1&&u.splice(s,1)},d.getParent=function(u,i){for(;u.parentNode&&u!=document.body;)if(u=u.parentNode,n(u,i))return u},d.getQueryElement=function(u){return typeof u=="string"?document.querySelector(u):u},d.handleEvent=function(u){var i="on"+u.type;this[i]&&this[i](u)},d.filterFindElements=function(u,i){u=d.makeArray(u);var s=[];return u.forEach(function(l){if(l instanceof HTMLElement){if(!i){s.push(l);return}n(l,i)&&s.push(l);for(var p=l.querySelectorAll(i),_=0;_<p.length;_++)s.push(p[_])}}),s},d.debounceMethod=function(u,i,s){s=s||100;var l=u.prototype[i],p=i+"Timeout";u.prototype[i]=function(){var _=this[p];clearTimeout(_);var h=arguments,v=this;this[p]=setTimeout(function(){l.apply(v,h),delete v[p]},s)}},d.docReady=function(u){var i=document.readyState;i=="complete"||i=="interactive"?setTimeout(u):document.addEventListener("DOMContentLoaded",u)},d.toDashed=function(u){return u.replace(/(.)([A-Z])/g,function(i,s,l){return s+"-"+l}).toLowerCase()};var a=e.console;return d.htmlInit=function(u,i){d.docReady(function(){var s=d.toDashed(i),l="data-"+s,p=document.querySelectorAll("["+l+"]"),_=document.querySelectorAll(".js-"+s),h=d.makeArray(p).concat(d.makeArray(_)),v=l+"-options",f=e.jQuery;h.forEach(function(g){var S=g.getAttribute(l)||g.getAttribute(v),o;try{o=S&&JSON.parse(S)}catch(y){a&&a.error("Error parsing "+l+" on "+g.className+": "+y);return}var m=new u(g,o);f&&f.data(g,i,m)})})},d})}(z)),z.exports}var O={exports:{}},nt;function Tt(){return nt||(nt=1,function(c){(function(t,e){c.exports?c.exports=e(t,xt()):(t.Flickity=t.Flickity||{},t.Flickity.Cell=e(t,t.getSize))})(window,function(e,n){function d(a,u){this.element=a,this.parent=u,this.create()}var r=d.prototype;return r.create=function(){this.element.style.position="absolute",this.element.setAttribute("aria-hidden","true"),this.x=0,this.shift=0,this.element.style[this.parent.originSide]=0},r.destroy=function(){this.unselect(),this.element.style.position="";var a=this.parent.originSide;this.element.style[a]="",this.element.style.transform="",this.element.removeAttribute("aria-hidden")},r.getSize=function(){this.size=n(this.element)},r.setPosition=function(a){this.x=a,this.updateTarget(),this.renderPosition(a)},r.updateTarget=r.setDefaultTarget=function(){var a=this.parent.originSide=="left"?"marginLeft":"marginRight";this.target=this.x+this.size[a]+this.size.width*this.parent.cellAlign},r.renderPosition=function(a){var u=this.parent.originSide==="left"?1:-1,i=this.parent.options.percentPosition?a*u*(this.parent.size.innerWidth/this.size.width):a*u;this.element.style.transform="translateX("+this.parent.getPositionValue(i)+")"},r.select=function(){this.element.classList.add("is-selected"),this.element.removeAttribute("aria-hidden")},r.unselect=function(){this.element.classList.remove("is-selected"),this.element.setAttribute("aria-hidden","true")},r.wrapShift=function(a){this.shift=a,this.renderPosition(this.x+this.parent.slideableWidth*a)},r.remove=function(){this.element.parentNode.removeChild(this.element)},d})}(O)),O.exports}var T={exports:{}},rt;function Ft(){return rt||(rt=1,function(c){(function(t,e){c.exports?c.exports=e():(t.Flickity=t.Flickity||{},t.Flickity.Slide=e())})(window,function(){function e(d){this.parent=d,this.isOriginLeft=d.originSide=="left",this.cells=[],this.outerWidth=0,this.height=0}var n=e.prototype;return n.addCell=function(d){if(this.cells.push(d),this.outerWidth+=d.size.outerWidth,this.height=Math.max(d.size.outerHeight,this.height),this.cells.length==1){this.x=d.x;var r=this.isOriginLeft?"marginLeft":"marginRight";this.firstMargin=d.size[r]}},n.updateTarget=function(){var d=this.isOriginLeft?"marginRight":"marginLeft",r=this.getLastCell(),a=r?r.size[d]:0,u=this.outerWidth-(this.firstMargin+a);this.target=this.x+this.firstMargin+u*this.parent.cellAlign},n.getLastCell=function(){return this.cells[this.cells.length-1]},n.select=function(){this.cells.forEach(function(d){d.select()})},n.unselect=function(){this.cells.forEach(function(d){d.unselect()})},n.getCellElements=function(){return this.cells.map(function(d){return d.element})},e})}(T)),T.exports}var F={exports:{}},ot;function Rt(){return ot||(ot=1,function(c){(function(t,e){c.exports?c.exports=e(t,M()):(t.Flickity=t.Flickity||{},t.Flickity.animatePrototype=e(t,t.fizzyUIUtils))})(window,function(e,n){var d={};return d.startAnimation=function(){this.isAnimating||(this.isAnimating=!0,this.restingFrames=0,this.animate())},d.animate=function(){this.applyDragForce(),this.applySelectedAttraction();var r=this.x;if(this.integratePhysics(),this.positionSlider(),this.settle(r),this.isAnimating){var a=this;requestAnimationFrame(function(){a.animate()})}},d.positionSlider=function(){var r=this.x;this.options.wrapAround&&this.cells.length>1&&(r=n.modulo(r,this.slideableWidth),r-=this.slideableWidth,this.shiftWrapCells(r)),this.setTranslateX(r,this.isAnimating),this.dispatchScrollEvent()},d.setTranslateX=function(r,a){r+=this.cursorPosition,r=this.options.rightToLeft?-r:r;var u=this.getPositionValue(r);this.slider.style.transform=a?"translate3d("+u+",0,0)":"translateX("+u+")"},d.dispatchScrollEvent=function(){var r=this.slides[0];if(r){var a=-this.x-r.target,u=a/this.slidesWidth;this.dispatchEvent("scroll",null,[u,a])}},d.positionSliderAtSelected=function(){this.cells.length&&(this.x=-this.selectedSlide.target,this.velocity=0,this.positionSlider())},d.getPositionValue=function(r){return this.options.percentPosition?Math.round(r/this.size.innerWidth*1e4)*.01+"%":Math.round(r)+"px"},d.settle=function(r){var a=!this.isPointerDown&&Math.round(this.x*100)==Math.round(r*100);a&&this.restingFrames++,this.restingFrames>2&&(this.isAnimating=!1,delete this.isFreeScrolling,this.positionSlider(),this.dispatchEvent("settle",null,[this.selectedIndex]))},d.shiftWrapCells=function(r){var a=this.cursorPosition+r;this._shiftCells(this.beforeShiftCells,a,-1);var u=this.size.innerWidth-(r+this.slideableWidth+this.cursorPosition);this._shiftCells(this.afterShiftCells,u,1)},d._shiftCells=function(r,a,u){for(var i=0;i<r.length;i++){var s=r[i],l=a>0?u:0;s.wrapShift(l),a-=s.size.outerWidth}},d._unshiftCells=function(r){if(!(!r||!r.length))for(var a=0;a<r.length;a++)r[a].wrapShift(0)},d.integratePhysics=function(){this.x+=this.velocity,this.velocity*=this.getFrictionFactor()},d.applyForce=function(r){this.velocity+=r},d.getFrictionFactor=function(){return 1-this.options[this.isFreeScrolling?"freeScrollFriction":"friction"]},d.getRestingPosition=function(){return this.x+this.velocity/(1-this.getFrictionFactor())},d.applyDragForce=function(){if(!(!this.isDraggable||!this.isPointerDown)){var r=this.dragX-this.x,a=r-this.velocity;this.applyForce(a)}},d.applySelectedAttraction=function(){var r=this.isDraggable&&this.isPointerDown;if(!(r||this.isFreeScrolling||!this.slides.length)){var a=this.selectedSlide.target*-1-this.x,u=a*this.options.selectedAttraction;this.applyForce(u)}},d})}(F)),F.exports}var at;function $(){return at||(at=1,function(c){(function(t,e){if(c.exports)c.exports=e(t,w(),xt(),M(),Tt(),Ft(),Rt());else{var n=t.Flickity;t.Flickity=e(t,t.EvEmitter,t.getSize,t.fizzyUIUtils,n.Cell,n.Slide,n.animatePrototype)}})(window,function(e,n,d,r,a,u,i){var s=e.jQuery,l=e.getComputedStyle,p=e.console;function _(o,m){for(o=r.makeArray(o);o.length;)m.appendChild(o.shift())}var h=0,v={};function f(o,m){var y=r.getQueryElement(o);if(!y){p&&p.error("Bad element for Flickity: "+(y||o));return}if(this.element=y,this.element.flickityGUID){var b=v[this.element.flickityGUID];return b&&b.option(m),b}s&&(this.$element=s(this.element)),this.options=r.extend({},this.constructor.defaults),this.option(m),this._create()}f.defaults={accessibility:!0,cellAlign:"center",freeScrollFriction:.075,friction:.28,namespaceJQueryEvents:!0,percentPosition:!0,resize:!0,selectedAttraction:.025,setGallerySize:!0},f.createMethods=[];var g=f.prototype;r.extend(g,n.prototype),g._create=function(){var o=this.guid=++h;this.element.flickityGUID=o,v[o]=this,this.selectedIndex=0,this.restingFrames=0,this.x=0,this.velocity=0,this.originSide=this.options.rightToLeft?"right":"left",this.viewport=document.createElement("div"),this.viewport.className="flickity-viewport",this._createSlider(),(this.options.resize||this.options.watchCSS)&&e.addEventListener("resize",this);for(var m in this.options.on){var y=this.options.on[m];this.on(m,y)}f.createMethods.forEach(function(b){this[b]()},this),this.options.watchCSS?this.watchCSS():this.activate()},g.option=function(o){r.extend(this.options,o)},g.activate=function(){if(!this.isActive){this.isActive=!0,this.element.classList.add("flickity-enabled"),this.options.rightToLeft&&this.element.classList.add("flickity-rtl"),this.getSize();var o=this._filterFindCellElements(this.element.children);_(o,this.slider),this.viewport.appendChild(this.slider),this.element.appendChild(this.viewport),this.reloadCells(),this.options.accessibility&&(this.element.tabIndex=0,this.element.addEventListener("keydown",this)),this.emitEvent("activate"),this.selectInitialIndex(),this.isInitActivated=!0,this.dispatchEvent("ready")}},g._createSlider=function(){var o=document.createElement("div");o.className="flickity-slider",o.style[this.originSide]=0,this.slider=o},g._filterFindCellElements=function(o){return r.filterFindElements(o,this.options.cellSelector)},g.reloadCells=function(){this.cells=this._makeCells(this.slider.children),this.positionCells(),this._getWrapShiftCells(),this.setGallerySize()},g._makeCells=function(o){var m=this._filterFindCellElements(o),y=m.map(function(b){return new a(b,this)},this);return y},g.getLastCell=function(){return this.cells[this.cells.length-1]},g.getLastSlide=function(){return this.slides[this.slides.length-1]},g.positionCells=function(){this._sizeCells(this.cells),this._positionCells(0)},g._positionCells=function(o){o=o||0,this.maxCellHeight=o&&this.maxCellHeight||0;var m=0;if(o>0){var y=this.cells[o-1];m=y.x+y.size.outerWidth}for(var b=this.cells.length,x=o;x<b;x++){var C=this.cells[x];C.setPosition(m),m+=C.size.outerWidth,this.maxCellHeight=Math.max(C.size.outerHeight,this.maxCellHeight)}this.slideableWidth=m,this.updateSlides(),this._containSlides(),this.slidesWidth=b?this.getLastSlide().target-this.slides[0].target:0},g._sizeCells=function(o){o.forEach(function(m){m.getSize()})},g.updateSlides=function(){if(this.slides=[],!!this.cells.length){var o=new u(this);this.slides.push(o);var m=this.originSide=="left",y=m?"marginRight":"marginLeft",b=this._getCanCellFit();this.cells.forEach(function(x,C){if(!o.cells.length){o.addCell(x);return}var k=o.outerWidth-o.firstMargin+(x.size.outerWidth-x.size[y]);b.call(this,C,k)||(o.updateTarget(),o=new u(this),this.slides.push(o)),o.addCell(x)},this),o.updateTarget(),this.updateSelectedSlide()}},g._getCanCellFit=function(){var o=this.options.groupCells;if(o){if(typeof o=="number"){var m=parseInt(o,10);return function(x){return x%m!==0}}}else return function(){return!1};var y=typeof o=="string"&&o.match(/^(\d+)%$/),b=y?parseInt(y[1],10)/100:1;return function(x,C){return C<=(this.size.innerWidth+1)*b}},g._init=g.reposition=function(){this.positionCells(),this.positionSliderAtSelected()},g.getSize=function(){this.size=d(this.element),this.setCellAlign(),this.cursorPosition=this.size.innerWidth*this.cellAlign};var S={center:{left:.5,right:.5},left:{left:0,right:1},right:{right:0,left:1}};return g.setCellAlign=function(){var o=S[this.options.cellAlign];this.cellAlign=o?o[this.originSide]:this.options.cellAlign},g.setGallerySize=function(){if(this.options.setGallerySize){var o=this.options.adaptiveHeight&&this.selectedSlide?this.selectedSlide.height:this.maxCellHeight;this.viewport.style.height=o+"px"}},g._getWrapShiftCells=function(){if(this.options.wrapAround){this._unshiftCells(this.beforeShiftCells),this._unshiftCells(this.afterShiftCells);var o=this.cursorPosition,m=this.cells.length-1;this.beforeShiftCells=this._getGapCells(o,m,-1),o=this.size.innerWidth-this.cursorPosition,this.afterShiftCells=this._getGapCells(o,0,1)}},g._getGapCells=function(o,m,y){for(var b=[];o>0;){var x=this.cells[m];if(!x)break;b.push(x),m+=y,o-=x.size.outerWidth}return b},g._containSlides=function(){if(!(!this.options.contain||this.options.wrapAround||!this.cells.length)){var o=this.options.rightToLeft,m=o?"marginRight":"marginLeft",y=o?"marginLeft":"marginRight",b=this.slideableWidth-this.getLastCell().size[y],x=b<this.size.innerWidth,C=this.cursorPosition+this.cells[0].size[m],k=b-this.size.innerWidth*(1-this.cellAlign);this.slides.forEach(function(E){x?E.target=b*this.cellAlign:(E.target=Math.max(E.target,C),E.target=Math.min(E.target,k))},this)}},g.dispatchEvent=function(o,m,y){var b=m?[m].concat(y):y;if(this.emitEvent(o,b),s&&this.$element){o+=this.options.namespaceJQueryEvents?".flickity":"";var x=o;if(m){var C=new s.Event(m);C.type=o,x=C}this.$element.trigger(x,y)}},g.select=function(o,m,y){if(this.isActive&&(o=parseInt(o,10),this._wrapSelect(o),(this.options.wrapAround||m)&&(o=r.modulo(o,this.slides.length)),!!this.slides[o])){var b=this.selectedIndex;this.selectedIndex=o,this.updateSelectedSlide(),y?this.positionSliderAtSelected():this.startAnimation(),this.options.adaptiveHeight&&this.setGallerySize(),this.dispatchEvent("select",null,[o]),o!=b&&this.dispatchEvent("change",null,[o]),this.dispatchEvent("cellSelect")}},g._wrapSelect=function(o){var m=this.slides.length,y=this.options.wrapAround&&m>1;if(!y)return o;var b=r.modulo(o,m),x=Math.abs(b-this.selectedIndex),C=Math.abs(b+m-this.selectedIndex),k=Math.abs(b-m-this.selectedIndex);!this.isDragSelect&&C<x?o+=m:!this.isDragSelect&&k<x&&(o-=m),o<0?this.x-=this.slideableWidth:o>=m&&(this.x+=this.slideableWidth)},g.previous=function(o,m){this.select(this.selectedIndex-1,o,m)},g.next=function(o,m){this.select(this.selectedIndex+1,o,m)},g.updateSelectedSlide=function(){var o=this.slides[this.selectedIndex];o&&(this.unselectSelectedSlide(),this.selectedSlide=o,o.select(),this.selectedCells=o.cells,this.selectedElements=o.getCellElements(),this.selectedCell=o.cells[0],this.selectedElement=this.selectedElements[0])},g.unselectSelectedSlide=function(){this.selectedSlide&&this.selectedSlide.unselect()},g.selectInitialIndex=function(){var o=this.options.initialIndex;if(this.isInitActivated){this.select(this.selectedIndex,!1,!0);return}if(o&&typeof o=="string"){var m=this.queryCell(o);if(m){this.selectCell(o,!1,!0);return}}var y=0;o&&this.slides[o]&&(y=o),this.select(y,!1,!0)},g.selectCell=function(o,m,y){var b=this.queryCell(o);if(b){var x=this.getCellSlideIndex(b);this.select(x,m,y)}},g.getCellSlideIndex=function(o){for(var m=0;m<this.slides.length;m++){var y=this.slides[m],b=y.cells.indexOf(o);if(b!=-1)return m}},g.getCell=function(o){for(var m=0;m<this.cells.length;m++){var y=this.cells[m];if(y.element==o)return y}},g.getCells=function(o){o=r.makeArray(o);var m=[];return o.forEach(function(y){var b=this.getCell(y);b&&m.push(b)},this),m},g.getCellElements=function(){return this.cells.map(function(o){return o.element})},g.getParentCell=function(o){var m=this.getCell(o);return m||(o=r.getParent(o,".flickity-slider > *"),this.getCell(o))},g.getAdjacentCellElements=function(o,m){if(!o)return this.selectedSlide.getCellElements();m=m===void 0?this.selectedIndex:m;var y=this.slides.length;if(1+o*2>=y)return this.getCellElements();for(var b=[],x=m-o;x<=m+o;x++){var C=this.options.wrapAround?r.modulo(x,y):x,k=this.slides[C];k&&(b=b.concat(k.getCellElements()))}return b},g.queryCell=function(o){if(typeof o=="number")return this.cells[o];if(typeof o=="string"){if(o.match(/^[#.]?[\d/]/))return;o=this.element.querySelector(o)}return this.getCell(o)},g.uiChange=function(){this.emitEvent("uiChange")},g.childUIPointerDown=function(o){o.type!="touchstart"&&o.preventDefault(),this.focus()},g.onresize=function(){this.watchCSS(),this.resize()},r.debounceMethod(f,"onresize",150),g.resize=function(){if(!(!this.isActive||this.isAnimating||this.isDragging)){this.getSize(),this.options.wrapAround&&(this.x=r.modulo(this.x,this.slideableWidth)),this.positionCells(),this._getWrapShiftCells(),this.setGallerySize(),this.emitEvent("resize");var o=this.selectedElements&&this.selectedElements[0];this.selectCell(o,!1,!0)}},g.watchCSS=function(){var o=this.options.watchCSS;if(o){var m=l(this.element,":after").content;m.indexOf("flickity")!=-1?this.activate():this.deactivate()}},g.onkeydown=function(o){var m=document.activeElement&&document.activeElement!=this.element;if(!(!this.options.accessibility||m)){var y=f.keyboardHandlers[o.keyCode];y&&y.call(this)}},f.keyboardHandlers={37:function(){var o=this.options.rightToLeft?"next":"previous";this.uiChange(),this[o]()},39:function(){var o=this.options.rightToLeft?"previous":"next";this.uiChange(),this[o]()}},g.focus=function(){var o=e.pageYOffset;this.element.focus({preventScroll:!0}),e.pageYOffset!=o&&e.scrollTo(e.pageXOffset,o)},g.deactivate=function(){this.isActive&&(this.element.classList.remove("flickity-enabled"),this.element.classList.remove("flickity-rtl"),this.unselectSelectedSlide(),this.cells.forEach(function(o){o.destroy()}),this.element.removeChild(this.viewport),_(this.slider.children,this.element),this.options.accessibility&&(this.element.removeAttribute("tabIndex"),this.element.removeEventListener("keydown",this)),this.isActive=!1,this.emitEvent("deactivate"))},g.destroy=function(){this.deactivate(),e.removeEventListener("resize",this),this.allOff(),this.emitEvent("destroy"),s&&this.$element&&s.removeData(this.element,"flickity"),delete this.element.flickityGUID,delete v[this.guid]},r.extend(g,i),f.data=function(o){o=r.getQueryElement(o);var m=o&&o.flickityGUID;return m&&v[m]},r.htmlInit(f,"flickity"),s&&s.bridget&&s.bridget("flickity",f),f.setJQuery=function(o){s=o},f.Cell=a,f.Slide=u,f})}(I)),I.exports}var R={exports:{}},W={exports:{}},q={exports:{}};/*!
 * Unipointer v2.4.0
 * base class for doing one thing with pointer event
 * MIT license
 */var lt;function Y(){return lt||(lt=1,function(c){(function(t,e){c.exports?c.exports=e(t,w()):t.Unipointer=e(t,t.EvEmitter)})(window,function(e,n){function d(){}function r(){}var a=r.prototype=Object.create(n.prototype);a.bindStartEvent=function(i){this._bindStartEvent(i,!0)},a.unbindStartEvent=function(i){this._bindStartEvent(i,!1)},a._bindStartEvent=function(i,s){s=s===void 0?!0:s;var l=s?"addEventListener":"removeEventListener",p="mousedown";"ontouchstart"in e?p="touchstart":e.PointerEvent&&(p="pointerdown"),i[l](p,this)},a.handleEvent=function(i){var s="on"+i.type;this[s]&&this[s](i)},a.getTouch=function(i){for(var s=0;s<i.length;s++){var l=i[s];if(l.identifier==this.pointerIdentifier)return l}},a.onmousedown=function(i){var s=i.button;s&&s!==0&&s!==1||this._pointerDown(i,i)},a.ontouchstart=function(i){this._pointerDown(i,i.changedTouches[0])},a.onpointerdown=function(i){this._pointerDown(i,i)},a._pointerDown=function(i,s){i.button||this.isPointerDown||(this.isPointerDown=!0,this.pointerIdentifier=s.pointerId!==void 0?s.pointerId:s.identifier,this.pointerDown(i,s))},a.pointerDown=function(i,s){this._bindPostStartEvents(i),this.emitEvent("pointerDown",[i,s])};var u={mousedown:["mousemove","mouseup"],touchstart:["touchmove","touchend","touchcancel"],pointerdown:["pointermove","pointerup","pointercancel"]};return a._bindPostStartEvents=function(i){if(i){var s=u[i.type];s.forEach(function(l){e.addEventListener(l,this)},this),this._boundPointerEvents=s}},a._unbindPostStartEvents=function(){this._boundPointerEvents&&(this._boundPointerEvents.forEach(function(i){e.removeEventListener(i,this)},this),delete this._boundPointerEvents)},a.onmousemove=function(i){this._pointerMove(i,i)},a.onpointermove=function(i){i.pointerId==this.pointerIdentifier&&this._pointerMove(i,i)},a.ontouchmove=function(i){var s=this.getTouch(i.changedTouches);s&&this._pointerMove(i,s)},a._pointerMove=function(i,s){this.pointerMove(i,s)},a.pointerMove=function(i,s){this.emitEvent("pointerMove",[i,s])},a.onmouseup=function(i){this._pointerUp(i,i)},a.onpointerup=function(i){i.pointerId==this.pointerIdentifier&&this._pointerUp(i,i)},a.ontouchend=function(i){var s=this.getTouch(i.changedTouches);s&&this._pointerUp(i,s)},a._pointerUp=function(i,s){this._pointerDone(),this.pointerUp(i,s)},a.pointerUp=function(i,s){this.emitEvent("pointerUp",[i,s])},a._pointerDone=function(){this._pointerReset(),this._unbindPostStartEvents(),this.pointerDone()},a._pointerReset=function(){this.isPointerDown=!1,delete this.pointerIdentifier},a.pointerDone=d,a.onpointercancel=function(i){i.pointerId==this.pointerIdentifier&&this._pointerCancel(i,i)},a.ontouchcancel=function(i){var s=this.getTouch(i.changedTouches);s&&this._pointerCancel(i,s)},a._pointerCancel=function(i,s){this._pointerDone(),this.pointerCancel(i,s)},a.pointerCancel=function(i,s){this.emitEvent("pointerCancel",[i,s])},r.getPointerPoint=function(i){return{x:i.pageX,y:i.pageY}},r})}(q)),q.exports}/*!
 * Unidragger v2.4.0
 * Draggable base class
 * MIT license
 */var ct;function Wt(){return ct||(ct=1,function(c){(function(t,e){c.exports?c.exports=e(t,Y()):t.Unidragger=e(t,t.Unipointer)})(window,function(e,n){function d(){}var r=d.prototype=Object.create(n.prototype);r.bindHandles=function(){this._bindHandles(!0)},r.unbindHandles=function(){this._bindHandles(!1)},r._bindHandles=function(i){i=i===void 0?!0:i;for(var s=i?"addEventListener":"removeEventListener",l=i?this._touchActionValue:"",p=0;p<this.handles.length;p++){var _=this.handles[p];this._bindStartEvent(_,i),_[s]("click",this),e.PointerEvent&&(_.style.touchAction=l)}},r._touchActionValue="none",r.pointerDown=function(i,s){var l=this.okayPointerDown(i);l&&(this.pointerDownPointer={pageX:s.pageX,pageY:s.pageY},i.preventDefault(),this.pointerDownBlur(),this._bindPostStartEvents(i),this.emitEvent("pointerDown",[i,s]))};var a={TEXTAREA:!0,INPUT:!0,SELECT:!0,OPTION:!0},u={radio:!0,checkbox:!0,button:!0,submit:!0,image:!0,file:!0};return r.okayPointerDown=function(i){var s=a[i.target.nodeName],l=u[i.target.type],p=!s||l;return p||this._pointerReset(),p},r.pointerDownBlur=function(){var i=document.activeElement,s=i&&i.blur&&i!=document.body;s&&i.blur()},r.pointerMove=function(i,s){var l=this._dragPointerMove(i,s);this.emitEvent("pointerMove",[i,s,l]),this._dragMove(i,s,l)},r._dragPointerMove=function(i,s){var l={x:s.pageX-this.pointerDownPointer.pageX,y:s.pageY-this.pointerDownPointer.pageY};return!this.isDragging&&this.hasDragStarted(l)&&this._dragStart(i,s),l},r.hasDragStarted=function(i){return Math.abs(i.x)>3||Math.abs(i.y)>3},r.pointerUp=function(i,s){this.emitEvent("pointerUp",[i,s]),this._dragPointerUp(i,s)},r._dragPointerUp=function(i,s){this.isDragging?this._dragEnd(i,s):this._staticClick(i,s)},r._dragStart=function(i,s){this.isDragging=!0,this.isPreventingClicks=!0,this.dragStart(i,s)},r.dragStart=function(i,s){this.emitEvent("dragStart",[i,s])},r._dragMove=function(i,s,l){this.isDragging&&this.dragMove(i,s,l)},r.dragMove=function(i,s,l){i.preventDefault(),this.emitEvent("dragMove",[i,s,l])},r._dragEnd=function(i,s){this.isDragging=!1,setTimeout((function(){delete this.isPreventingClicks}).bind(this)),this.dragEnd(i,s)},r.dragEnd=function(i,s){this.emitEvent("dragEnd",[i,s])},r.onclick=function(i){this.isPreventingClicks&&i.preventDefault()},r._staticClick=function(i,s){this.isIgnoringMouseUp&&i.type=="mouseup"||(this.staticClick(i,s),i.type!="mouseup"&&(this.isIgnoringMouseUp=!0,setTimeout((function(){delete this.isIgnoringMouseUp}).bind(this),400)))},r.staticClick=function(i,s){this.emitEvent("staticClick",[i,s])},d.getPointerPoint=n.getPointerPoint,d})}(W)),W.exports}var ut;function qt(){return ut||(ut=1,function(c){(function(t,e){c.exports?c.exports=e(t,$(),Wt(),M()):t.Flickity=e(t,t.Flickity,t.Unidragger,t.fizzyUIUtils)})(window,function(e,n,d,r){r.extend(n.defaults,{draggable:">1",dragThreshold:3}),n.createMethods.push("_createDrag");var a=n.prototype;r.extend(a,d.prototype),a._touchActionValue="pan-y",a._createDrag=function(){this.on("activate",this.onActivateDrag),this.on("uiChange",this._uiChangeDrag),this.on("deactivate",this.onDeactivateDrag),this.on("cellChange",this.updateDraggable)},a.onActivateDrag=function(){this.handles=[this.viewport],this.bindHandles(),this.updateDraggable()},a.onDeactivateDrag=function(){this.unbindHandles(),this.element.classList.remove("is-draggable")},a.updateDraggable=function(){this.options.draggable==">1"?this.isDraggable=this.slides.length>1:this.isDraggable=this.options.draggable,this.isDraggable?this.element.classList.add("is-draggable"):this.element.classList.remove("is-draggable")},a.bindDrag=function(){this.options.draggable=!0,this.updateDraggable()},a.unbindDrag=function(){this.options.draggable=!1,this.updateDraggable()},a._uiChangeDrag=function(){delete this.isFreeScrolling},a.pointerDown=function(s,l){if(!this.isDraggable){this._pointerDownDefault(s,l);return}var p=this.okayPointerDown(s);p&&(this._pointerDownPreventDefault(s),this.pointerDownFocus(s),document.activeElement!=this.element&&this.pointerDownBlur(),this.dragX=this.x,this.viewport.classList.add("is-pointer-down"),this.pointerDownScroll=i(),e.addEventListener("scroll",this),this._pointerDownDefault(s,l))},a._pointerDownDefault=function(s,l){this.pointerDownPointer={pageX:l.pageX,pageY:l.pageY},this._bindPostStartEvents(s),this.dispatchEvent("pointerDown",s,[l])};var u={INPUT:!0,TEXTAREA:!0,SELECT:!0};a.pointerDownFocus=function(s){var l=u[s.target.nodeName];l||this.focus()},a._pointerDownPreventDefault=function(s){var l=s.type=="touchstart",p=s.pointerType=="touch",_=u[s.target.nodeName];!l&&!p&&!_&&s.preventDefault()},a.hasDragStarted=function(s){return Math.abs(s.x)>this.options.dragThreshold},a.pointerUp=function(s,l){delete this.isTouchScrolling,this.viewport.classList.remove("is-pointer-down"),this.dispatchEvent("pointerUp",s,[l]),this._dragPointerUp(s,l)},a.pointerDone=function(){e.removeEventListener("scroll",this),delete this.pointerDownScroll},a.dragStart=function(s,l){this.isDraggable&&(this.dragStartPosition=this.x,this.startAnimation(),e.removeEventListener("scroll",this),this.dispatchEvent("dragStart",s,[l]))},a.pointerMove=function(s,l){var p=this._dragPointerMove(s,l);this.dispatchEvent("pointerMove",s,[l,p]),this._dragMove(s,l,p)},a.dragMove=function(s,l,p){if(this.isDraggable){s.preventDefault(),this.previousDragX=this.dragX;var _=this.options.rightToLeft?-1:1;this.options.wrapAround&&(p.x%=this.slideableWidth);var h=this.dragStartPosition+p.x*_;if(!this.options.wrapAround&&this.slides.length){var v=Math.max(-this.slides[0].target,this.dragStartPosition);h=h>v?(h+v)*.5:h;var f=Math.min(-this.getLastSlide().target,this.dragStartPosition);h=h<f?(h+f)*.5:h}this.dragX=h,this.dragMoveTime=new Date,this.dispatchEvent("dragMove",s,[l,p])}},a.dragEnd=function(s,l){if(this.isDraggable){this.options.freeScroll&&(this.isFreeScrolling=!0);var p=this.dragEndRestingSelect();if(this.options.freeScroll&&!this.options.wrapAround){var _=this.getRestingPosition();this.isFreeScrolling=-_>this.slides[0].target&&-_<this.getLastSlide().target}else!this.options.freeScroll&&p==this.selectedIndex&&(p+=this.dragEndBoostSelect());delete this.previousDragX,this.isDragSelect=this.options.wrapAround,this.select(p),delete this.isDragSelect,this.dispatchEvent("dragEnd",s,[l])}},a.dragEndRestingSelect=function(){var s=this.getRestingPosition(),l=Math.abs(this.getSlideDistance(-s,this.selectedIndex)),p=this._getClosestResting(s,l,1),_=this._getClosestResting(s,l,-1),h=p.distance<_.distance?p.index:_.index;return h},a._getClosestResting=function(s,l,p){for(var _=this.selectedIndex,h=1/0,v=this.options.contain&&!this.options.wrapAround?function(f,g){return f<=g}:function(f,g){return f<g};v(l,h)&&(_+=p,h=l,l=this.getSlideDistance(-s,_),l!==null);)l=Math.abs(l);return{distance:h,index:_-p}},a.getSlideDistance=function(s,l){var p=this.slides.length,_=this.options.wrapAround&&p>1,h=_?r.modulo(l,p):l,v=this.slides[h];if(!v)return null;var f=_?this.slideableWidth*Math.floor(l/p):0;return s-(v.target+f)},a.dragEndBoostSelect=function(){if(this.previousDragX===void 0||!this.dragMoveTime||new Date-this.dragMoveTime>100)return 0;var s=this.getSlideDistance(-this.dragX,this.selectedIndex),l=this.previousDragX-this.dragX;return s>0&&l>0?1:s<0&&l<0?-1:0},a.staticClick=function(s,l){var p=this.getParentCell(s.target),_=p&&p.element,h=p&&this.cells.indexOf(p);this.dispatchEvent("staticClick",s,[l,_,h])},a.onscroll=function(){var s=i(),l=this.pointerDownScroll.x-s.x,p=this.pointerDownScroll.y-s.y;(Math.abs(l)>3||Math.abs(p)>3)&&this._pointerDone()};function i(){return{x:e.pageXOffset,y:e.pageYOffset}}return n})}(R)),R.exports}var U={exports:{}},dt;function Ut(){return dt||(dt=1,function(c){(function(t,e){c.exports?c.exports=e(t,$(),Y(),M()):e(t,t.Flickity,t.Unipointer,t.fizzyUIUtils)})(window,function(e,n,d,r){var a="http://www.w3.org/2000/svg";function u(l,p){this.direction=l,this.parent=p,this._create()}u.prototype=Object.create(d.prototype),u.prototype._create=function(){this.isEnabled=!0,this.isPrevious=this.direction==-1;var l=this.parent.options.rightToLeft?1:-1;this.isLeft=this.direction==l;var p=this.element=document.createElement("button");p.className="flickity-button flickity-prev-next-button",p.className+=this.isPrevious?" previous":" next",p.setAttribute("type","button"),this.disable(),p.setAttribute("aria-label",this.isPrevious?"Previous":"Next");var _=this.createSVG();p.appendChild(_),this.parent.on("select",this.update.bind(this)),this.on("pointerDown",this.parent.childUIPointerDown.bind(this.parent))},u.prototype.activate=function(){this.bindStartEvent(this.element),this.element.addEventListener("click",this),this.parent.element.appendChild(this.element)},u.prototype.deactivate=function(){this.parent.element.removeChild(this.element),this.unbindStartEvent(this.element),this.element.removeEventListener("click",this)},u.prototype.createSVG=function(){var l=document.createElementNS(a,"svg");l.setAttribute("class","flickity-button-icon"),l.setAttribute("viewBox","0 0 100 100");var p=document.createElementNS(a,"path"),_=i(this.parent.options.arrowShape);return p.setAttribute("d",_),p.setAttribute("class","arrow"),this.isLeft||p.setAttribute("transform","translate(100, 100) rotate(180) "),l.appendChild(p),l};function i(l){return typeof l=="string"?l:"M "+l.x0+",50 L "+l.x1+","+(l.y1+50)+" L "+l.x2+","+(l.y2+50)+" L "+l.x3+",50  L "+l.x2+","+(50-l.y2)+" L "+l.x1+","+(50-l.y1)+" Z"}u.prototype.handleEvent=r.handleEvent,u.prototype.onclick=function(){if(this.isEnabled){this.parent.uiChange();var l=this.isPrevious?"previous":"next";this.parent[l]()}},u.prototype.enable=function(){this.isEnabled||(this.element.disabled=!1,this.isEnabled=!0)},u.prototype.disable=function(){this.isEnabled&&(this.element.disabled=!0,this.isEnabled=!1)},u.prototype.update=function(){var l=this.parent.slides;if(this.parent.options.wrapAround&&l.length>1){this.enable();return}var p=l.length?l.length-1:0,_=this.isPrevious?0:p,h=this.parent.selectedIndex==_?"disable":"enable";this[h]()},u.prototype.destroy=function(){this.deactivate(),this.allOff()},r.extend(n.defaults,{prevNextButtons:!0,arrowShape:{x0:10,x1:60,y1:50,x2:70,y2:40,x3:30}}),n.createMethods.push("_createPrevNextButtons");var s=n.prototype;return s._createPrevNextButtons=function(){this.options.prevNextButtons&&(this.prevButton=new u(-1,this),this.nextButton=new u(1,this),this.on("activate",this.activatePrevNextButtons))},s.activatePrevNextButtons=function(){this.prevButton.activate(),this.nextButton.activate(),this.on("deactivate",this.deactivatePrevNextButtons)},s.deactivatePrevNextButtons=function(){this.prevButton.deactivate(),this.nextButton.deactivate(),this.off("deactivate",this.deactivatePrevNextButtons)},n.PrevNextButton=u,n})}(U)),U.exports}var N={exports:{}},ht;function Nt(){return ht||(ht=1,function(c){(function(t,e){c.exports?c.exports=e(t,$(),Y(),M()):e(t,t.Flickity,t.Unipointer,t.fizzyUIUtils)})(window,function(e,n,d,r){function a(i){this.parent=i,this._create()}a.prototype=Object.create(d.prototype),a.prototype._create=function(){this.holder=document.createElement("ol"),this.holder.className="flickity-page-dots",this.dots=[],this.handleClick=this.onClick.bind(this),this.on("pointerDown",this.parent.childUIPointerDown.bind(this.parent))},a.prototype.activate=function(){this.setDots(),this.holder.addEventListener("click",this.handleClick),this.bindStartEvent(this.holder),this.parent.element.appendChild(this.holder)},a.prototype.deactivate=function(){this.holder.removeEventListener("click",this.handleClick),this.unbindStartEvent(this.holder),this.parent.element.removeChild(this.holder)},a.prototype.setDots=function(){var i=this.parent.slides.length-this.dots.length;i>0?this.addDots(i):i<0&&this.removeDots(-i)},a.prototype.addDots=function(i){for(var s=document.createDocumentFragment(),l=[],p=this.dots.length,_=p+i,h=p;h<_;h++){var v=document.createElement("li");v.className="dot",v.setAttribute("aria-label","Page dot "+(h+1)),s.appendChild(v),l.push(v)}this.holder.appendChild(s),this.dots=this.dots.concat(l)},a.prototype.removeDots=function(i){var s=this.dots.splice(this.dots.length-i,i);s.forEach(function(l){this.holder.removeChild(l)},this)},a.prototype.updateSelected=function(){this.selectedDot&&(this.selectedDot.className="dot",this.selectedDot.removeAttribute("aria-current")),this.dots.length&&(this.selectedDot=this.dots[this.parent.selectedIndex],this.selectedDot.className="dot is-selected",this.selectedDot.setAttribute("aria-current","step"))},a.prototype.onTap=a.prototype.onClick=function(i){var s=i.target;if(s.nodeName=="LI"){this.parent.uiChange();var l=this.dots.indexOf(s);this.parent.select(l)}},a.prototype.destroy=function(){this.deactivate(),this.allOff()},n.PageDots=a,r.extend(n.defaults,{pageDots:!0}),n.createMethods.push("_createPageDots");var u=n.prototype;return u._createPageDots=function(){this.options.pageDots&&(this.pageDots=new a(this),this.on("activate",this.activatePageDots),this.on("select",this.updateSelectedPageDots),this.on("cellChange",this.updatePageDots),this.on("resize",this.updatePageDots),this.on("deactivate",this.deactivatePageDots))},u.activatePageDots=function(){this.pageDots.activate()},u.updateSelectedPageDots=function(){this.pageDots.updateSelected()},u.updatePageDots=function(){this.pageDots.setDots()},u.deactivatePageDots=function(){this.pageDots.deactivate()},n.PageDots=a,n})}(N)),N.exports}var H={exports:{}},pt;function Ht(){return pt||(pt=1,function(c){(function(t,e){c.exports?c.exports=e(w(),M(),$()):e(t.EvEmitter,t.fizzyUIUtils,t.Flickity)})(window,function(e,n,d){function r(u){this.parent=u,this.state="stopped",this.onVisibilityChange=this.visibilityChange.bind(this),this.onVisibilityPlay=this.visibilityPlay.bind(this)}r.prototype=Object.create(e.prototype),r.prototype.play=function(){if(this.state!="playing"){var u=document.hidden;if(u){document.addEventListener("visibilitychange",this.onVisibilityPlay);return}this.state="playing",document.addEventListener("visibilitychange",this.onVisibilityChange),this.tick()}},r.prototype.tick=function(){if(this.state=="playing"){var u=this.parent.options.autoPlay;u=typeof u=="number"?u:3e3;var i=this;this.clear(),this.timeout=setTimeout(function(){i.parent.next(!0),i.tick()},u)}},r.prototype.stop=function(){this.state="stopped",this.clear(),document.removeEventListener("visibilitychange",this.onVisibilityChange)},r.prototype.clear=function(){clearTimeout(this.timeout)},r.prototype.pause=function(){this.state=="playing"&&(this.state="paused",this.clear())},r.prototype.unpause=function(){this.state=="paused"&&this.play()},r.prototype.visibilityChange=function(){var u=document.hidden;this[u?"pause":"unpause"]()},r.prototype.visibilityPlay=function(){this.play(),document.removeEventListener("visibilitychange",this.onVisibilityPlay)},n.extend(d.defaults,{pauseAutoPlayOnHover:!0}),d.createMethods.push("_createPlayer");var a=d.prototype;return a._createPlayer=function(){this.player=new r(this),this.on("activate",this.activatePlayer),this.on("uiChange",this.stopPlayer),this.on("pointerDown",this.stopPlayer),this.on("deactivate",this.deactivatePlayer)},a.activatePlayer=function(){this.options.autoPlay&&(this.player.play(),this.element.addEventListener("mouseenter",this))},a.playPlayer=function(){this.player.play()},a.stopPlayer=function(){this.player.stop()},a.pausePlayer=function(){this.player.pause()},a.unpausePlayer=function(){this.player.unpause()},a.deactivatePlayer=function(){this.player.stop(),this.element.removeEventListener("mouseenter",this)},a.onmouseenter=function(){this.options.pauseAutoPlayOnHover&&(this.player.pause(),this.element.addEventListener("mouseleave",this))},a.onmouseleave=function(){this.player.unpause(),this.element.removeEventListener("mouseleave",this)},d.Player=r,d})}(H)),H.exports}var j={exports:{}},ft;function jt(){return ft||(ft=1,function(c){(function(t,e){c.exports?c.exports=e(t,$(),M()):e(t,t.Flickity,t.fizzyUIUtils)})(window,function(e,n,d){function r(u){var i=document.createDocumentFragment();return u.forEach(function(s){i.appendChild(s.element)}),i}var a=n.prototype;return a.insert=function(u,i){var s=this._makeCells(u);if(!(!s||!s.length)){var l=this.cells.length;i=i===void 0?l:i;var p=r(s),_=i==l;if(_)this.slider.appendChild(p);else{var h=this.cells[i].element;this.slider.insertBefore(p,h)}if(i===0)this.cells=s.concat(this.cells);else if(_)this.cells=this.cells.concat(s);else{var v=this.cells.splice(i,l-i);this.cells=this.cells.concat(s).concat(v)}this._sizeCells(s),this.cellChange(i,!0)}},a.append=function(u){this.insert(u,this.cells.length)},a.prepend=function(u){this.insert(u,0)},a.remove=function(u){var i=this.getCells(u);if(!(!i||!i.length)){var s=this.cells.length-1;i.forEach(function(l){l.remove();var p=this.cells.indexOf(l);s=Math.min(p,s),d.removeFrom(this.cells,l)},this),this.cellChange(s,!0)}},a.cellSizeChange=function(u){var i=this.getCell(u);if(i){i.getSize();var s=this.cells.indexOf(i);this.cellChange(s)}},a.cellChange=function(u,i){var s=this.selectedElement;this._positionCells(u),this._getWrapShiftCells(),this.setGallerySize();var l=this.getCell(s);l&&(this.selectedIndex=this.getCellSlideIndex(l)),this.selectedIndex=Math.min(this.slides.length-1,this.selectedIndex),this.emitEvent("cellChange",[u]),this.select(this.selectedIndex),i&&this.positionSliderAtSelected()},n})}(j)),j.exports}var X={exports:{}},mt;function Xt(){return mt||(mt=1,function(c){(function(t,e){c.exports?c.exports=e(t,$(),M()):e(t,t.Flickity,t.fizzyUIUtils)})(window,function(e,n,d){n.createMethods.push("_createLazyload");var r=n.prototype;r._createLazyload=function(){this.on("select",this.lazyLoad)},r.lazyLoad=function(){var i=this.options.lazyLoad;if(i){var s=typeof i=="number"?i:0,l=this.getAdjacentCellElements(s),p=[];l.forEach(function(_){var h=a(_);p=p.concat(h)}),p.forEach(function(_){new u(_,this)},this)}};function a(i){if(i.nodeName=="IMG"){var s=i.getAttribute("data-flickity-lazyload"),l=i.getAttribute("data-flickity-lazyload-src"),p=i.getAttribute("data-flickity-lazyload-srcset");if(s||l||p)return[i]}var _="img[data-flickity-lazyload], img[data-flickity-lazyload-src], img[data-flickity-lazyload-srcset]",h=i.querySelectorAll(_);return d.makeArray(h)}function u(i,s){this.img=i,this.flickity=s,this.load()}return u.prototype.handleEvent=d.handleEvent,u.prototype.load=function(){this.img.addEventListener("load",this),this.img.addEventListener("error",this);var i=this.img.getAttribute("data-flickity-lazyload")||this.img.getAttribute("data-flickity-lazyload-src"),s=this.img.getAttribute("data-flickity-lazyload-srcset");this.img.src=i,s&&this.img.setAttribute("srcset",s),this.img.removeAttribute("data-flickity-lazyload"),this.img.removeAttribute("data-flickity-lazyload-src"),this.img.removeAttribute("data-flickity-lazyload-srcset")},u.prototype.onload=function(i){this.complete(i,"flickity-lazyloaded")},u.prototype.onerror=function(i){this.complete(i,"flickity-lazyerror")},u.prototype.complete=function(i,s){this.img.removeEventListener("load",this),this.img.removeEventListener("error",this);var l=this.flickity.getParentCell(this.img),p=l&&l.element;this.flickity.cellSizeChange(p),this.img.classList.add(s),this.flickity.dispatchEvent("lazyLoad",i,p)},n.LazyLoader=u,n})}(X)),X.exports}/*!
 * Flickity v2.3.0
 * Touch, responsive, flickable carousels
 *
 * Licensed GPLv3 for open source use
 * or Flickity Commercial License for commercial use
 *
 * https://flickity.metafizzy.co
 * Copyright 2015-2021 Metafizzy
 */var vt;function Gt(){return vt||(vt=1,function(c){(function(t,e){c.exports&&(c.exports=e($(),qt(),Ut(),Nt(),Ht(),jt(),Xt()))})(window,function(e){return e})}(P)),P.exports}var G={exports:{}};/*!
 * imagesLoaded v4.1.4
 * JavaScript is all like "You images are done yet or what?"
 * MIT License
 */var gt;function Vt(){return gt||(gt=1,function(c){(function(t,e){c.exports?c.exports=e(t,w()):t.imagesLoaded=e(t,t.EvEmitter)})(typeof window<"u"?window:yt,function(e,n){var d=e.jQuery,r=e.console;function a(h,v){for(var f in v)h[f]=v[f];return h}var u=Array.prototype.slice;function i(h){if(Array.isArray(h))return h;var v=typeof h=="object"&&typeof h.length=="number";return v?u.call(h):[h]}function s(h,v,f){if(!(this instanceof s))return new s(h,v,f);var g=h;if(typeof h=="string"&&(g=document.querySelectorAll(h)),!g){r.error("Bad element for imagesLoaded "+(g||h));return}this.elements=i(g),this.options=a({},this.options),typeof v=="function"?f=v:a(this.options,v),f&&this.on("always",f),this.getImages(),d&&(this.jqDeferred=new d.Deferred),setTimeout(this.check.bind(this))}s.prototype=Object.create(n.prototype),s.prototype.options={},s.prototype.getImages=function(){this.images=[],this.elements.forEach(this.addElementImages,this)},s.prototype.addElementImages=function(h){h.nodeName=="IMG"&&this.addImage(h),this.options.background===!0&&this.addElementBackgroundImages(h);var v=h.nodeType;if(!(!v||!l[v])){for(var f=h.querySelectorAll("img"),g=0;g<f.length;g++){var S=f[g];this.addImage(S)}if(typeof this.options.background=="string"){var o=h.querySelectorAll(this.options.background);for(g=0;g<o.length;g++){var m=o[g];this.addElementBackgroundImages(m)}}}};var l={1:!0,9:!0,11:!0};s.prototype.addElementBackgroundImages=function(h){var v=getComputedStyle(h);if(v)for(var f=/url\((['"])?(.*?)\1\)/gi,g=f.exec(v.backgroundImage);g!==null;){var S=g&&g[2];S&&this.addBackground(S,h),g=f.exec(v.backgroundImage)}},s.prototype.addImage=function(h){var v=new p(h);this.images.push(v)},s.prototype.addBackground=function(h,v){var f=new _(h,v);this.images.push(f)},s.prototype.check=function(){var h=this;if(this.progressedCount=0,this.hasAnyBroken=!1,!this.images.length){this.complete();return}function v(f,g,S){setTimeout(function(){h.progress(f,g,S)})}this.images.forEach(function(f){f.once("progress",v),f.check()})},s.prototype.progress=function(h,v,f){this.progressedCount++,this.hasAnyBroken=this.hasAnyBroken||!h.isLoaded,this.emitEvent("progress",[this,h,v]),this.jqDeferred&&this.jqDeferred.notify&&this.jqDeferred.notify(this,h),this.progressedCount==this.images.length&&this.complete(),this.options.debug&&r&&r.log("progress: "+f,h,v)},s.prototype.complete=function(){var h=this.hasAnyBroken?"fail":"done";if(this.isComplete=!0,this.emitEvent(h,[this]),this.emitEvent("always",[this]),this.jqDeferred){var v=this.hasAnyBroken?"reject":"resolve";this.jqDeferred[v](this)}};function p(h){this.img=h}p.prototype=Object.create(n.prototype),p.prototype.check=function(){var h=this.getIsImageComplete();if(h){this.confirm(this.img.naturalWidth!==0,"naturalWidth");return}this.proxyImage=new Image,this.proxyImage.addEventListener("load",this),this.proxyImage.addEventListener("error",this),this.img.addEventListener("load",this),this.img.addEventListener("error",this),this.proxyImage.src=this.img.src},p.prototype.getIsImageComplete=function(){return this.img.complete&&this.img.naturalWidth},p.prototype.confirm=function(h,v){this.isLoaded=h,this.emitEvent("progress",[this,this.img,v])},p.prototype.handleEvent=function(h){var v="on"+h.type;this[v]&&this[v](h)},p.prototype.onload=function(){this.confirm(!0,"onload"),this.unbindEvents()},p.prototype.onerror=function(){this.confirm(!1,"onerror"),this.unbindEvents()},p.prototype.unbindEvents=function(){this.proxyImage.removeEventListener("load",this),this.proxyImage.removeEventListener("error",this),this.img.removeEventListener("load",this),this.img.removeEventListener("error",this)};function _(h,v){this.url=h,this.element=v,this.img=new Image}return _.prototype=Object.create(p.prototype),_.prototype.check=function(){this.img.addEventListener("load",this),this.img.addEventListener("error",this),this.img.src=this.url;var h=this.getIsImageComplete();h&&(this.confirm(this.img.naturalWidth!==0,"naturalWidth"),this.unbindEvents())},_.prototype.unbindEvents=function(){this.img.removeEventListener("load",this),this.img.removeEventListener("error",this)},_.prototype.confirm=function(h,v){this.isLoaded=h,this.emitEvent("progress",[this,this.element,v])},s.makeJQueryPlugin=function(h){h=h||e.jQuery,h&&(d=h,d.fn.imagesLoaded=function(v,f){var g=new s(this,v,f);return g.jqDeferred.promise(d(this))})},s.makeJQueryPlugin(),s})}(G)),G.exports}/*!
 * Flickity imagesLoaded v2.0.0
 * enables imagesLoaded option for Flickity
 */(function(c){(function(t,e){c.exports?c.exports=e(t,Gt(),Vt()):t.Flickity=e(t,t.Flickity,t.imagesLoaded)})(window,function(e,n,d){n.createMethods.push("_createImagesLoaded");var r=n.prototype;return r._createImagesLoaded=function(){this.on("activate",this.imagesLoaded)},r.imagesLoaded=function(){if(!this.options.imagesLoaded)return;var a=this;function u(i,s){var l=a.getParentCell(s.img);a.cellSizeChange(l&&l.element),a.options.freeScroll||a.positionSliderAtSelected()}d(this.slider).on("progress",u)},n})})(Bt);const Yt={props:{medias_with_linked:Array,publication_path:String},components:{FilesList:bt},data(){return{}},created(){},mounted(){},beforeDestroy(){},watch:{},computed:{},methods:{}};var Qt=function(){var t=this,e=t._self._c;return e("BaseModal2",{attrs:{title:t.$t("change_order")},on:{close:function(n){return t.$emit("close")}},scopedSlots:t._u([{key:"footer",fn:function(){return[e("div"),e("button",{staticClass:"u-button",attrs:{type:"button"},on:{click:function(n){return t.$emit("closeModal")}}},[t._v(" "+t._s(t.$t("close"))+" ")])]},proxy:!0}])},[e("FilesList",{attrs:{mode:"carousel",medias_with_linked:t.medias_with_linked,publication_path:t.publication_path,edit_mode:!0},on:{addMedias:function(n){return t.$emit("addMedias",n)},reorderMedias:function(n){return t.$emit("reorderMedias",n)},removeMediaAtIndex:function(n){return t.$emit("removeMediaAtIndex",n)}}})],1)},Jt=[],Zt=D(Yt,Qt,Jt,!1,null,"9097a35f");const Kt=Zt.exports,te={props:{medias_with_linked:Array,context:String,page_template:String,show_fs_button:Boolean,number_of_max_medias:[Boolean,Number],publication_path:String,publi_width:Number,edit_mode:Boolean,can_edit:Boolean},components:{Flickity:Et,MediaPicker:V,CaptionCreditsPage:_t,ChangeOrderModal:Kt},data(){return{show_media_picker:!1,observer:null,show_change_order_modal:!1,flickityOptions:{initialIndex:0,groupCells:!1,imagesLoaded:!0,pageDots:!0,selectedAttraction:.2,percentPosition:!1,friction:.8,cellAlign:"left",contain:!0}}},created(){},mounted(){this.observer=new ResizeObserver(()=>{this.$refs.flickity&&this.$refs.flickity.resize()}),this.observer.observe(this.$el)},beforeDestroy(){this.observer.disconnect()},watch:{publi_width(){setTimeout(()=>{this.$refs.flickity&&this.$refs.flickity.resize()},250)}},computed:{slider_key(){const c=this.medias_with_linked.map((t,e)=>t.meta_filename_in_project+"-index-"+e);return c?JSON.stringify(c):"none"}},methods:{itemStyle({media_with_linked:c}){let t={};return t["--object-fit"]=c.objectFit||"cover",t},mediaIsSquare(c){var t;return((t=c.$infos)==null?void 0:t.ratio)===1},showObjectFitFor(c){return!(!c._linked_media||this.mediaIsSquare(c._linked_media)||!["image","video","stl","pdf"].includes(c._linked_media.$type))}}};var ee=function(){var t=this,e=t._self._c;return e("div",{staticClass:"_carousel",class:{}},[e("transition",{attrs:{name:"fade",mode:"out-in"}},[e("flickity",{key:t.slider_key,ref:"flickity",staticClass:"_mainCarousel",attrs:{options:t.flickityOptions}},t._l(t.medias_with_linked,function(n,d){return e("div",{key:n._linked_media&&n._linked_media.$path||"no_media_"+d,staticClass:"carousel-cell",style:t.itemStyle({media_with_linked:n}),attrs:{"data-mediatype":n._linked_media.$type}},[n._linked_media?e("MediaContent",{attrs:{file:n._linked_media,resolution:t.context==="preview"?220:1600,context:t.context,show_fs_button:t.show_fs_button,display_credits_caption:!0,can_edit_credits_caption:t.can_edit}}):e("span",{staticClass:"_noSourceMedia u-instructions",domProps:{textContent:t._s(t.$t("source_media_missing"))}}),e("CaptionCreditsPage",{attrs:{media:n._linked_media,publication_path:t.publication_path,can_edit:t.can_edit}}),t.edit_mode?e("div",{staticClass:"_btnRow"},[e("button",{staticClass:"u-button u-button_icon u-button_small",attrs:{type:"button"},on:{click:function(r){t.show_change_order_modal=!0}}},[e("b-icon",{attrs:{icon:"arrow-left-right"}})],1),t.showObjectFitFor(n)?[!n.objectFit||n.objectFit==="cover"?t._e():e("button",{staticClass:"u-button u-button_icon u-button_small",attrs:{type:"button"},on:{click:function(r){return t.$emit("updateMediaOpt",{index:d,opt:{objectFit:"cover"}})}}},[e("b-icon",{attrs:{icon:"aspect-ratio"}})],1),n.objectFit!=="contain"?e("button",{staticClass:"u-button u-button_icon u-button_small",attrs:{type:"button"},on:{click:function(r){return t.$emit("updateMediaOpt",{index:d,opt:{objectFit:"contain"}})}}},[e("b-icon",{attrs:{icon:"aspect-ratio-fill"}})],1):t._e()]:t._e(),e("button",{staticClass:"u-buttonLink",attrs:{type:"button"},on:{click:function(r){return t.$emit("removeMediaAtIndex",{index:d})}}},[e("b-icon",{attrs:{icon:"trash"}})],1)],2):t._e()],1)}),0)],1),t.show_change_order_modal?e("ChangeOrderModal",{attrs:{medias_with_linked:t.medias_with_linked,publication_path:t.publication_path},on:{addMedias:function(n){return t.$emit("addMedias",n)},reorderMedias:function(n){return t.$emit("reorderMedias",n)},removeMediaAtIndex:function(n){return t.$emit("removeMediaAtIndex",n)},close:function(n){t.show_change_order_modal=!1}}}):t._e(),t.can_edit?e("div",{staticClass:"_mediaPickerTile"},[e("EditBtn",{attrs:{btn_type:"add",is_unfolded:!1},on:{click:function(n){t.show_media_picker=!0}}}),t.show_media_picker?e("MediaPicker",{attrs:{publication_path:t.publication_path},on:{addMedias:function(n){return t.$emit("addMedias",n)},close:function(n){t.show_media_picker=!1}}}):t._e(),e("DropZone",{staticClass:"_dzAfter",on:{mediaDropped:function(n){return t.$emit("addMedias",n)}}})],1):t._e()],1)},ie=[],se=D(te,ee,ie,!1,null,"02aac783");const ne=se.exports,re={props:{publimodule:Object,context:{type:String,default:"full"},page_template:String,number_of_max_medias:[Boolean,Number],show_fs_button:Boolean,edit_mode:Boolean,can_edit:Boolean},components:{MosaicMediaGrid:Pt,FilesList:bt,MediaCarousel:ne},data(){return{}},created(){},mounted(){},beforeDestroy(){},watch:{},computed:{publication_path(){return this.getParent(this.publimodule.$path)},medias_with_linked(){return this.publimodule.source_medias?this.publimodule.source_medias.reduce((c,t)=>{const e=this.getSourceMedia({source_media:t,folder_path:this.publication_path});if(e){const n=Object.assign({},t,{_linked_media:e});c.push(n)}return c},[]):[]}},methods:{async addMedias({path_to_source_media_metas:c}){let t=this.publimodule.source_medias.slice()||[];for(const e of c){const n=this.$root.publication_include_mode,d=await this.prepareMediaForPublication({path_to_source_media_meta:e,publication_path:this.publication_path,import_mode:n});t.push(d)}this.$emit("updateMeta",{source_medias:t})},async removeMediaAtIndex({index:c,remove_source:t=!0}){const e=this.publimodule.source_medias.slice(),n=e[c];if(e.splice(c,1),e.length===0?this.$emit("remove",{with_content:!1}):this.$emit("updateMeta",{source_medias:e}),Object.prototype.hasOwnProperty.call(n,"meta_filename")&&t===!0){const d=this.getSourceMedia({source_media:{meta_filename:n.meta_filename},folder_path:this.publication_path});await this.$api.deleteItem({path:d.$path})}},reorderMedias(c){const t=c.map(e=>(delete e._linked_media,e));this.$emit("updateMeta",{source_medias:t})},updateMediaOpt({index:c,opt:t}){const e=this.publimodule.source_medias.slice();Object.assign(e[c],t),this.$emit("updateMeta",{source_medias:e})}}};var oe=function(){var t=this,e=t._self._c;return e("transition",{attrs:{name:"fade_fast",mode:"out-in"}},[e("div",{key:t.medias_with_linked.length>1?"multiple":"single",staticClass:"_mediasModule",style:`--number_of_medias: ${t.medias_with_linked.length}`},[e("transition",{attrs:{name:"pagechange",mode:"out-in"}},[t.publimodule.module_type==="mosaic"?e("MosaicMediaGrid",{key:"mosaic",attrs:{medias_with_linked:t.medias_with_linked,publimodule:t.publimodule,context:t.context,page_template:t.page_template,show_fs_button:t.show_fs_button,number_of_max_medias:t.number_of_max_medias,publication_path:t.publication_path,edit_mode:t.edit_mode,can_edit:t.can_edit},on:{addMedias:t.addMedias,removeMediaAtIndex:t.removeMediaAtIndex,updateMediaOpt:t.updateMediaOpt}}):t.publimodule.module_type==="files"?e("FilesList",{key:"filelist",attrs:{mode:"source",medias_with_linked:t.medias_with_linked,publication_path:t.publication_path,edit_mode:t.edit_mode,can_edit:t.can_edit},on:{addMedias:t.addMedias,reorderMedias:t.reorderMedias,removeMediaAtIndex:t.removeMediaAtIndex}}):t.publimodule.module_type==="carousel"?e("MediaCarousel",{attrs:{medias_with_linked:t.medias_with_linked,context:t.context,page_template:t.page_template,show_fs_button:t.show_fs_button,publication_path:t.publication_path,publi_width:t.publimodule.size,edit_mode:t.edit_mode,can_edit:t.can_edit},on:{addMedias:t.addMedias,reorderMedias:t.reorderMedias,removeMediaAtIndex:t.removeMediaAtIndex,updateMediaOpt:t.updateMediaOpt}}):t._e()],1)],1)])},ae=[],le=D(re,oe,ae,!1,null,"e4cd4c80");const ce=le.exports,ue={props:{publimodule:Object,module_position:String,module_being_edited:String,magnification:Number,border_radius:{type:Object,default:()=>({x:0,y:0})},context:String,page_template:String,number_of_max_medias:{type:[Boolean,Number],default:!1},can_edit:Boolean},components:{MediasModule:ce},inject:{$getMapOptions:{default:!1}},data(){return{is_repicking_location:!1,observer:void 0}},created(){},mounted(){this.$eventHub.$on(`module.enable_edit.${this.module_meta_filename}`,this.enableEdit),this.$eventHub.$on(`module.duplicate.${this.module_meta_filename}`,this.duplicateModule),this.$eventHub.$on(`module.remove.${this.module_meta_filename}`,this.removeModule),this.$eventHub.$on(`publication.story.scrollTo.${this.publimodule.$path}`,this.scrollToModule),this.$eventHub.$on("publication.map.click",this.setRepickLocation),this.startIntersectionObserver()},beforeDestroy(){this.$eventHub.$off(`module.enable_edit.${this.module_meta_filename}`,this.enableEdit),this.$eventHub.$off(`module.duplicate.${this.module_meta_filename}`,this.duplicateModule),this.$eventHub.$off(`module.remove.${this.module_meta_filename}`,this.removeModule),this.$eventHub.$off(`publication.story.scrollTo.${this.publimodule.$path}`,this.scrollToModule),this.$eventHub.$off("publication.map.click",this.setRepickLocation),this.endIntersectionObserver()},watch:{edit_mode(){this.$refs.textBloc&&(this.edit_mode?this.$nextTick(()=>this.$refs.textBloc.enableEditor()):this.$refs.textBloc.disableEditor()),this.edit_mode||(this.is_repicking_location=!1)}},computed:{is_associated_to_map(){return this.$getMapOptions},is_active_on_map(){return this.$getMapOptions?this.$getMapOptions().opened_pin_path===this.publimodule.$path:!1},zoom_level_options(){return new Array(20).fill(0).map((t,e)=>e===0?{key:"",text:this.$t("dont_zoom")}:e===1?{key:e,text:e+" ("+this.$t("very_far")+")"}:e===19?{key:e,text:e+" ("+this.$t("very_close")+")"}:{key:e})},available_module_types(){return this.publimodule.module_type==="text"?["text","mosaic","carousel","files"]:["mosaic","carousel","files"]},pin_options(){return this.$getMapOptions?this.$getMapOptions().pins_infos.find(({path:c})=>c===this.publimodule.$path):!1},has_coordinates(){var c,t;return((c=this.publimodule.location)==null?void 0:c.latitude)&&((t=this.publimodule.location)==null?void 0:t.longitude)},edit_mode(){return this.module_being_edited===this.publimodule.$path},module_meta_filename(){return this.publimodule.$path.split("/").at(-1)},show_caption(){var c;return!(this.module_type==="text"||this.module_type==="shape"||this.publimodule.source_medias.length===1&&((c=this.publimodule.source_medias[0].meta_filename)!=null&&c.startsWith("text-"))||!this.publimodule.caption&&!this.edit_mode)},module_type(){return this.getModuleType(this.publimodule.module_type)},show_fs_button(){return this.page_template==="page_by_page"?this.publimodule.show_fs_button===!0:!0},first_media(){return this.firstMedia(this.publimodule)},media_styles(){let c=0;return this.publimodule.align==="center"&&(this.publimodule.size===66.6?c=16.6:this.publimodule.size===50?c=25:this.publimodule.size===33.3&&(c=33.3)),this.publimodule.align==="right"&&(this.publimodule.size===66.6?c=33.3:this.publimodule.size===50?c=50:this.publimodule.size===33.3&&(c=66.6)),{"--module-width":this.publimodule.size||100,"--module-margin-left":c}}},methods:{async updateMeta(c){await this.$api.updateMeta({path:this.publimodule.$path,new_meta:c}).catch(t=>{throw this.$alertify.delay(4e3).error(t),t})},repickLocation(){this.is_repicking_location=!0,this.$eventHub.$emit("publication.map.disableTools")},showModuleOnMap(){this.$eventHub.$emit("publication.map.openPin",this.publimodule.$path)},pinButtonClick(){this.scrollToModule()},preventClickTraversing(c){this.edit_mode&&c.stopPropagation()},async setRepickLocation({longitude:c,latitude:t}){this.is_repicking_location&&(await this.updateMeta({location:{longitude:c,latitude:t}}).catch(e=>{throw this.$alertify.delay(4e3).error(e),e}),this.is_repicking_location=!1,await new Promise(e=>setTimeout(e,100)),this.showModuleOnMap())},async eraseCoords(){await this.updateMeta({location:{}}).catch(c=>{throw this.$alertify.delay(4e3).error(c),c})},enableEdit(){this.$emit("update:module_being_edited",this.publimodule.$path)},disableEdit(){this.$emit("update:module_being_edited",void 0)},scrollToModule(c="auto"){this.$el&&(console.log("scrollToModule "+this.publimodule.$path),this.$el.scrollIntoView({behavior:c,block:"start",inline:"nearest"}))},startIntersectionObserver(){let c=(e,n)=>{e.forEach(d=>{d.isIntersecting&&this.is_associated_to_map&&this.has_coordinates&&!this.is_active_on_map&&this.showModuleOnMap()})},t="-10%";try{t=window.getComputedStyle(this.$el).getPropertyValue("scroll-margin-top")}catch{}this.observer=new IntersectionObserver(c,{rootMargin:`${t} 0% -80% 0%`}),this.observer.observe(this.$refs.sentinel)},endIntersectionObserver(){this.observer.unobserve(this.$el)},changeModuleType(c){const t=c.target.value;this.updateMeta({module_type:t})},async duplicateModule(){let c={};this.page_template==="page_by_page"&&(c.x=(this.publimodule.x||0)+10,c.y=(this.publimodule.y||0)+10);const t=await this.duplicateModuleWithSourceMedias({og_module:this.publimodule,addtl_meta_to_module:c});this.$emit("duplicate",t),this.disableEdit()},async removeModule({with_content:c=!0}={}){if(c)try{for(let t of this.publimodule.source_medias)if(Object.prototype.hasOwnProperty.call(t,"meta_filename")){const e=this.getParent(this.publimodule.$path),n=this.getSourceMedia({source_media:t,folder_path:e});n&&await this.$api.deleteItem({path:n.$path})}}catch(t){this.$alertify.delay(4e3).error(t)}await this.$api.deleteItem({path:this.publimodule.$path}).catch(t=>{throw this.$alertify.delay(4e3).error(t),t}),this.$emit("remove")}}};var de=function(){var t=this,e=t._self._c;return e("div",{staticClass:"_publicationModule",attrs:{"data-type":t.module_type},on:{click:t.preventClickTraversing}},[e("transition",{attrs:{name:"showOptions",mode:"out-in",appear:""}},[t.edit_mode&&t.page_template!=="page_by_page"?e("div",{staticClass:"_sideOptions"},[e("div",{staticClass:"_sideOptions--content"},[e("div",{staticClass:"_arrows"},[t.$listeners.hasOwnProperty("moveUp")?e("button",{staticClass:"u-button _sideBtns _moveBefore",attrs:{disabled:t.module_position==="first"||t.module_position==="alone",type:"button"},on:{click:function(n){return t.$emit("moveUp")}}},[e("svg",{staticStyle:{transform:"rotate(90deg)"},attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 168 168"}},[e("path",{staticStyle:{fill:"currentColor"},attrs:{d:"M87.46,49.46,73.39,64.77a65.3,65.3,0,0,1-6.15,6.15A47.8,47.8,0,0,1,61,75.29H131.6V91.14H61A39.1,39.1,0,0,1,67,95.51q2.81,2.46,6.36,6.15L87.46,117,74.48,128,34.17,83.21,74.48,38.39Z"}})])]):t._e(),t.$listeners.hasOwnProperty("moveDown")?e("button",{staticClass:"u-button _sideBtns _moveAfter",attrs:{type:"button",disabled:t.module_position==="last"||t.module_position==="alone"},on:{click:function(n){return t.$emit("moveDown")}}},[e("svg",{staticStyle:{transform:"rotate(90deg)"},attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 168 168"}},[e("path",{staticStyle:{fill:"currentColor"},attrs:{d:"M78.31,117l14.07-15.31a65.3,65.3,0,0,1,6.15-6.15,47.52,47.52,0,0,1,6.29-4.37H34.17V75.29h70.65a39.1,39.1,0,0,1-6.08-4.37q-2.8-2.46-6.36-6.15L78.31,49.46l13-11.07L131.6,83.21,91.29,128Z"}})])]):t._e()]),e("div",{staticClass:"_options"},[e("div",{staticClass:"_advanced_menu"},[e("div",[e("select",{attrs:{disabled:t.available_module_types.length<=1},domProps:{value:t.publimodule.module_type},on:{change:t.changeModuleType}},t._l(t.available_module_types,function(n){return e("option",{key:n,domProps:{value:n}},[t._v(" "+t._s(t.$t(`module.label.${n}`))+" ")])}),0)]),e("div",{staticClass:"_buttonRow"},t._l([100,66.6,50,33.3],function(n){return e("button",{key:n,staticClass:"u-button u-button_small u-button_transparent _sizes",class:{"is--active":!t.publimodule.size&&n===100||t.publimodule.size===n},attrs:{type:"button"},on:{click:function(d){return t.updateMeta({size:n})}}},[t._v(" "+t._s(n)+"% ")])}),0),t.publimodule.size&&t.publimodule.size!==100?e("div",{staticClass:"_buttonRow"},t._l(["left","center","right"],function(n){return e("button",{key:n,staticClass:"u-button u-button_small u-button_transparent",class:{"is--active":!t.publimodule.align&&n==="left"||t.publimodule.align===n},attrs:{type:"button"},on:{click:function(d){return t.updateMeta({align:n})}}},[n==="left"?e("b-icon",{attrs:{icon:"align-start"}}):t._e(),n==="center"?e("b-icon",{attrs:{icon:"align-center"}}):t._e(),n==="right"?e("b-icon",{attrs:{icon:"align-end"}}):t._e()],1)}),0):t._e()]),t.is_associated_to_map?e("div",{staticClass:"_carto"},[t._e(),e("div",{},[e("button",{staticClass:"u-button u-button_red u-button_small",attrs:{type:"button"},on:{click:function(n){return n.stopPropagation(),t.repickLocation.apply(null,arguments)}}},[t.has_coordinates?[e("b-icon",{attrs:{icon:"pin-map-fill"}}),t._v(" "+t._s(t.$t("change_location"))+" ")]:[e("b-icon",{attrs:{icon:"pin-map"}}),t._v(" "+t._s(t.$t("place_on_map"))+" ")]],2)]),t.has_coordinates?e("div",{},[e("SelectField2",{attrs:{value:t.publimodule.zoom_level,options:t.zoom_level_options,can_edit:t.can_edit,hide_validation:!0,size:"small"},on:{change:function(n){return t.updateMeta({zoom_level:n})}}})],1):t._e(),t.has_coordinates?e("div",{},[e("button",{staticClass:"u-buttonLink",attrs:{type:"button"},on:{click:t.eraseCoords}},[e("b-icon",{attrs:{icon:"x-circle"}}),t._v(" "+t._s(t.$t("erase"))+" ")],1)]):t._e()]):t._e(),e("DropDown",{attrs:{right:!0}},[e("button",{staticClass:"u-buttonLink",attrs:{type:"button"},on:{click:t.duplicateModule}},[e("b-icon",{attrs:{icon:"file-plus"}}),t._v(" "+t._s(t.$t("duplicate"))+" ")],1),e("button",{staticClass:"u-buttonLink",attrs:{type:"button"},on:{click:function(n){return t.$emit("changeSectionForModule")}}},[e("b-icon",{attrs:{icon:"arrow-left-right"}}),t._v(" "+t._s(t.$t("change_section"))+" ")],1),t.can_edit?e("RemoveMenu",{attrs:{show_button_text:!0},on:{remove:t.removeModule}}):t._e()],1)],1),e("div",{staticClass:"_saveBtn"},[e("EditBtn",{attrs:{btn_type:"check",label_position:"left"},on:{click:t.disableEdit}})],1),t.is_repicking_location?e("div",{staticClass:"_repickNotice"},[e("div",{staticClass:"_repickNotice--content"},[e("div",[t._v(" "+t._s(t.$t("click_on_map_to_repick_location"))+" ")]),e("button",{staticClass:"u-buttonLink",attrs:{type:"button"},on:{click:function(n){t.is_repicking_location=!1}}},[t._v(" "+t._s(t.$t("cancel"))+" ")])])]):t._e()])]):t._e()]),e("div",{staticClass:"_content",style:t.media_styles},[e("div",{ref:"sentinel"}),t.is_associated_to_map&&t.has_coordinates?e("button",{ref:"pinButton",staticClass:"u-button _pinButton",class:{"is--active":t.is_active_on_map},style:`--pin-color: ${t.pin_options?t.pin_options.color:""}`,attrs:{type:"button"},on:{click:function(n){return n.stopPropagation(),t.pinButtonClick.apply(null,arguments)}}},[e("img",{attrs:{src:t.pin_options.pin_preview_src}})]):t._e(),t.can_edit&&(t.page_template!=="page_by_page"||t.publimodule.module_type==="text")?e("div",{staticClass:"_floatingEditBtn"},[e("span",{on:{click:function(n){return n.stopPropagation(),t.enableEdit.apply(null,arguments)},touchstart:function(n){return n.stopPropagation(),t.enableEdit.apply(null,arguments)}}},[t.edit_mode?t._e():e("EditBtn",{attrs:{label_position:"left"}})],1)]):t._e(),["mosaic","carousel","files"].includes(t.publimodule.module_type)?e("MediasModule",{attrs:{publimodule:t.publimodule,edit_mode:t.edit_mode,can_edit:t.can_edit,context:t.context,page_template:t.page_template,number_of_max_medias:t.number_of_max_medias,show_fs_button:t.show_fs_button},on:{updateMeta:t.updateMeta,remove:t.removeModule}}):t.publimodule.module_type==="text"&&t.first_media?e("CollaborativeEditor2",{ref:"textBloc",attrs:{path:t.first_media.$path,content:t.first_media.$content,scrollingContainer:t.$el,line_selected:!1,can_edit:t.can_edit},on:{lineClicked:function(n){return t.$emit("lineClicked",n)},contentIsEdited:function(n){return t.$emit("contentIsEdited",n)},contentIsNotEdited:function(n){return t.$emit("contentIsNotEdited",n)}}}):t.module_type==="shape"?[e("svg",{attrs:{viewBox:"0 0 100 100",preserveAspectRatio:"none",xmlns:"http://www.w3.org/2000/svg"}},[t.publimodule.module_type==="ellipsis"?e("circle",{attrs:{cx:"50",cy:"50",r:50-t.publimodule.outline_width*t.magnification/8,"vector-effect":"non-scaling-stroke"}}):t.publimodule.module_type==="rectangle"?e("rect",{attrs:{x:t.publimodule.outline_width*t.magnification/4,y:t.publimodule.outline_width*t.magnification/4,width:100-t.publimodule.outline_width*t.magnification/2,height:100-t.publimodule.outline_width*t.magnification/2,"vector-effect":"non-scaling-stroke",rx:t.border_radius.x,ry:t.border_radius.y}}):t.publimodule.module_type==="line"?e("g",[e("rect",{attrs:{width:"100",height:"100","vector-effect":"non-scaling-stroke",stroke:"none",rx:t.border_radius.x,ry:t.border_radius.y}}),e("line",{attrs:{x1:t.publimodule.outline_width*t.magnification/4||0,y1:"50",x2:100-(t.publimodule.outline_width*t.magnification/4||0),y2:"50","vector-effect":"non-scaling-stroke"}})]):t.publimodule.module_type==="arrow"?e("g",[e("rect",{attrs:{width:"100",height:"100","vector-effect":"non-scaling-stroke",stroke:"none",rx:t.border_radius.x,ry:t.border_radius.y}}),e("line",{attrs:{x1:t.publimodule.outline_width*t.magnification/4||0,y1:"50",x2:100-(t.publimodule.outline_width*t.magnification/4||0),y2:"50","vector-effect":"non-scaling-stroke"}}),e("g",{attrs:{transform:`
              translate(${100-(t.publimodule.outline_width*t.magnification/4||0)}, 50)`,preserveAspectRatio:""}},[e("line",{attrs:{x1:"0",y1:"0",x2:"-10",y2:"-10","vector-effect":"non-scaling-stroke"}}),e("line",{attrs:{x1:"0",y1:"0",x2:"-10",y2:"10","vector-effect":"non-scaling-stroke"}})])]):t._e()])]:e("small",[t._v(t._s(t.$t("nothing_to_show")))]),t.show_caption?e("div",{staticClass:"_captionField"},[e("CollaborativeEditor2",{staticClass:"_caption",attrs:{label:t.edit_mode&&!t.publimodule.caption&&t.page_template!=="page_by_page"?t.$t("add_caption"):void 0,field_to_edit:"caption",content:t.publimodule.caption,path:t.publimodule.$path,custom_formats:["bold","italic","link"],is_collaborative:!1,can_edit:t.page_template!=="page_by_page"?t.can_edit:!1}}),t.edit_mode&&t.first_media&&t.first_media.caption&&!t.publimodule.caption&&t.page_template!=="page_by_page"?e("div",{},[e("div",{staticClass:"u-instructions"},[t._v(" "+t._s(t.$t("copy_first_media_caption"))+" ")]),e("button",{attrs:{type:"button"},on:{click:function(n){return t.updateMeta({caption:t.first_media.caption})}}},[t._v(" "+t._s(t.first_media.caption)+" ")])]):t._e()],1):t._e()],2),t.edit_mode&&t.page_template!=="page_by_page"?e("div",{staticClass:"_selectorIndicator"}):t._e()],1)},he=[],pe=D(ue,de,he,!1,null,"cbf9d75b");const _e=pe.exports;export{_e as P};
