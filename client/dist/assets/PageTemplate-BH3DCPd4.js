import{P as ie}from"./PublicationSettings-DIeHMtor.js";import{n as D}from"../build.js";import{S as At}from"./SinglePage-BVSGgL1O.js";import{M as ne}from"./ModuleCreator-4ZunUVS2.js";import"./PublicationModule-8FTebee0.js";import"./MediaPicker-CZryquB9.js";import"./CaptionCreditsPage-B7Fq5xCj.js";import"./flickity-ByXwvD2H.js";const ae={props:{publication:Object},components:{},data(){return{edit_mode:!1,is_saving:!1,can_edit:!0,new_layout_mode:void 0,new_page_width:void 0,new_page_height:void 0}},created(){},mounted(){this.initValues()},beforeDestroy(){},watch:{new_layout_mode(){const{width:a,height:t}=this.format_options[0];this.new_page_width||(this.new_page_width=a),this.new_page_height||(this.new_page_height=t)}},computed:{format_options(){return this.new_layout_mode==="print"?[{key:"A4_portrait",text:this.$t("A4_portrait"),width:210,height:297},{key:"A4_landscape",text:this.$t("A4_landscape"),width:297,height:210},{key:"A5_portrait",text:this.$t("A5_portrait"),width:148,height:210},{key:"A5_landscape",text:this.$t("A5_landscape"),width:210,height:148},{key:"custom",text:this.$t("custom")}]:[{key:"recommended",text:this.$t("recommended"),width:960,height:700},{key:"desktop1080",text:this.$t("desktop_1080"),width:1920,height:1080},{key:"desktop720",text:this.$t("desktop_720"),width:1280,height:720},{key:"custom",text:this.$t("custom")}]},predefined_format_from_width(){const a=this.format_options.find(t=>t.width===this.new_page_width&&t.height===this.new_page_height);return a?a.key:"custom"},unit(){return this.new_layout_mode==="screen"?"px":"mm"}},methods:{initValues(){this.new_layout_mode=this.publication.layout_mode||"print",this.new_page_width=this.publication.page_width||210,this.new_page_height=this.publication.page_height||297},enableEditMode(){this.edit_mode=!0},setSizeFromFormat(a){const t=a.target.value;if(t==="custom")return;const e=this.format_options.find(i=>i.key===t);this.new_page_width=e.width,this.new_page_height=e.height},cancel(){this.edit_mode=!1,this.is_saving=!1,this.initValues()},async updateSize(){this.is_saving=!0;try{const a={layout_mode:this.new_layout_mode,page_width:this.new_page_width,page_height:this.new_page_height};await this.$api.updateMeta({path:this.publication.$path,new_meta:a}),this.edit_mode=!1,this.is_saving=!1}catch(a){this.is_saving=!1,this.edit_mode=!1,this.$alertify.closeLogOnClick(!0).delay(4e3).error(this.$t("couldntbesaved")),this.$alertify.closeLogOnClick(!0).error(a.response.data)}}}};var oe=function(){var t=this,e=t._self._c;return e("div",{staticClass:"_widthHeightField"},[e("fieldset",[e("legend",{staticClass:"u-label"},[t._v(t._s(t.$t("format")))]),e("DLabel",{staticClass:"_label",attrs:{str:t.$t("document_type"),tag:"h3"}}),e("br"),t._l([{key:"print",label:t.$t("print"),instructions:t.$t("print_instr")},{key:"screen",label:t.$t("screen"),instructions:t.$t("screen_instr")}],function(i){return e("div",{key:i.key},[e("div",[e("input",{directives:[{name:"model",rawName:"v-model",value:t.new_layout_mode,expression:"new_layout_mode"}],attrs:{type:"radio",name:i.key,id:"radioi-lmode-"+i.key,disabled:!t.edit_mode},domProps:{value:i.key,checked:t._q(t.new_layout_mode,i.key)},on:{change:function(n){t.new_layout_mode=i.key}}}),e("label",{attrs:{for:"radioi-lmode-"+i.key}},[t._v(" "+t._s(i.label)),e("br"),e("small",{domProps:{innerHTML:t._s(i.instructions)}})])]),e("br")])}),e("transition",{attrs:{name:"fade",mode:"out-in"}},[e("div",{key:t.new_layout_mode},[e("DLabel",{staticClass:"_label",attrs:{str:t.$t("format"),tag:"h3",instructions:t.$t("format_instructions")}}),e("br"),[e("select",{attrs:{disabled:!t.edit_mode},domProps:{value:t.predefined_format_from_width},on:{change:t.setSizeFromFormat}},t._l(t.format_options,function(i){return e("option",{key:i.key,domProps:{value:i.key,textContent:t._s(i.text)}})}),0),e("br")],e("div",{staticClass:"u-sameRow"},[e("div",{},[e("DLabel",{attrs:{str:t.$t("width")}}),e("div",{staticClass:"u-inputGroup"},[e("input",{directives:[{name:"model",rawName:"v-model.number",value:t.new_page_width,expression:"new_page_width",modifiers:{number:!0}}],attrs:{type:"number",disabled:!t.edit_mode},domProps:{value:t.new_page_width},on:{input:function(i){i.target.composing||(t.new_page_width=t._n(i.target.value))},blur:function(i){return t.$forceUpdate()}}}),e("span",{staticClass:"u-suffix",domProps:{textContent:t._s(t.unit)}})])],1),e("div",{},[e("DLabel",{attrs:{str:t.$t("height")}}),e("div",{staticClass:"u-inputGroup"},[e("input",{directives:[{name:"model",rawName:"v-model.number",value:t.new_page_height,expression:"new_page_height",modifiers:{number:!0}}],attrs:{type:"number",disabled:!t.edit_mode},domProps:{value:t.new_page_height},on:{input:function(i){i.target.composing||(t.new_page_height=t._n(i.target.value))},blur:function(i){return t.$forceUpdate()}}}),e("span",{staticClass:"u-suffix",domProps:{textContent:t._s(t.unit)}})])],1)])],2)]),e("br"),t.can_edit&&!t.edit_mode?e("EditBtn",{on:{click:t.enableEditMode}}):t._e(),t.edit_mode?e("div",{staticClass:"_footer"},[e("SaveCancelButtons",{staticClass:"_scb",attrs:{is_saving:t.is_saving},on:{save:t.updateSize,cancel:t.cancel}})],1):t._e()],2)])},re=[],se=D(ae,oe,re,!1,null,"358d5718");const le=se.exports,ce={props:{publication:Object,is_spread:Boolean},components:{},data(){return{edit_mode:!1,is_saving:!1,can_edit:!0,top:this.publication.page_margin_top||0,bottom:this.publication.page_margin_bottom||0,left:this.publication.page_margin_left||0,right:this.publication.page_margin_right||0}},created(){},mounted(){},beforeDestroy(){},watch:{},computed:{unit(){return this.publication.layout_mode==="screen"?"px":"mm"}},methods:{enableEditMode(){this.edit_mode=!0},cancel(){this.edit_mode=!1,this.is_saving=!1},async updateMargins(){this.is_saving=!0;try{const a={page_margin_top:this.top,page_margin_bottom:this.bottom,page_margin_left:this.left,page_margin_right:this.right};await this.$api.updateMeta({path:this.publication.$path,new_meta:a}),this.edit_mode=!1,this.is_saving=!1}catch(a){this.is_saving=!1,this.edit_mode=!1,this.$alertify.closeLogOnClick(!0).delay(4e3).error(this.$t("couldntbesaved")),this.$alertify.closeLogOnClick(!0).error(a.response.data)}}}};var ue=function(){var t=this,e=t._self._c;return e("div",[e("fieldset",[e("legend",{staticClass:"u-label"},[t._v(t._s(t.$t("margins")))]),e("div",{staticClass:"u-instructions"},[e("small",[t._v(t._s(t.$t("margins_instructions")))])]),e("br"),e("div",{staticClass:"u-sameRow"},[e("div",{},[e("DLabel",{attrs:{str:t.$t("top")}}),e("div",{staticClass:"u-inputGroup"},[e("input",{directives:[{name:"model",rawName:"v-model.number",value:t.top,expression:"top",modifiers:{number:!0}}],attrs:{type:"number",disabled:!t.edit_mode},domProps:{value:t.top},on:{input:function(i){i.target.composing||(t.top=t._n(i.target.value))},blur:function(i){return t.$forceUpdate()}}}),e("span",{staticClass:"u-suffix",domProps:{textContent:t._s(t.unit)}})])],1),e("div",{},[e("DLabel",{attrs:{str:t.$t("bottom")}}),e("div",{staticClass:"u-inputGroup"},[e("input",{directives:[{name:"model",rawName:"v-model.number",value:t.bottom,expression:"bottom",modifiers:{number:!0}}],attrs:{type:"number",disabled:!t.edit_mode},domProps:{value:t.bottom},on:{input:function(i){i.target.composing||(t.bottom=t._n(i.target.value))},blur:function(i){return t.$forceUpdate()}}}),e("span",{staticClass:"u-suffix",domProps:{textContent:t._s(t.unit)}})])],1)]),e("br"),e("div",{staticClass:"u-sameRow"},[e("div",{},[e("DLabel",{attrs:{str:t.is_spread?t.$t("margins_inside"):t.$t("left")}}),e("div",{staticClass:"u-inputGroup"},[e("input",{directives:[{name:"model",rawName:"v-model.number",value:t.left,expression:"left",modifiers:{number:!0}}],attrs:{type:"number",disabled:!t.edit_mode},domProps:{value:t.left},on:{input:function(i){i.target.composing||(t.left=t._n(i.target.value))},blur:function(i){return t.$forceUpdate()}}}),e("span",{staticClass:"u-suffix",domProps:{textContent:t._s(t.unit)}})])],1),e("br"),e("div",{},[e("DLabel",{attrs:{str:t.is_spread?t.$t("margins_outside"):t.$t("right")}}),e("div",{staticClass:"u-inputGroup"},[e("input",{directives:[{name:"model",rawName:"v-model.number",value:t.right,expression:"right",modifiers:{number:!0}}],attrs:{type:"number",disabled:!t.edit_mode},domProps:{value:t.right},on:{input:function(i){i.target.composing||(t.right=t._n(i.target.value))},blur:function(i){return t.$forceUpdate()}}}),e("span",{staticClass:"u-suffix",domProps:{textContent:t._s(t.unit)}})])],1)]),e("br"),t.can_edit&&!t.edit_mode?e("EditBtn",{on:{click:t.enableEditMode}}):t._e(),t.edit_mode?e("div",{staticClass:"_footer"},[e("SaveCancelButtons",{staticClass:"_scb",attrs:{is_saving:t.is_saving},on:{save:t.updateMargins,cancel:t.cancel}})],1):t._e()],1)])},de=[],_e=D(ce,ue,de,!1,null,"46ecccdd");const pe=_e.exports,he={props:{publication:Object,is_spread:Boolean},components:{},data(){return{edit_mode:!1,is_saving:!1,can_edit:!0,enable_pagination:this.publication.enable_pagination||!1,pagn_starts_on_page:this.publication.pagn_starts_on_page||1,right:this.publication.pagn_right||2,bottom:this.publication.pagn_bottom||2}},created(){},mounted(){},beforeDestroy(){},watch:{},computed:{unit(){return this.publication.layout_mode==="screen"?"px":"mm"}},methods:{enableEditMode(){this.edit_mode=!0},cancel(){this.edit_mode=!1,this.is_saving=!1,this.enable_pagination=this.publication.enable_pagination,this.pagn_starts_on_page=this.publication.pagn_starts_on_page,this.right=this.publication.pagn_right||2,this.bottom=this.publication.pagn_bottom||2},async updatePagination(){this.is_saving=!0;try{const a={enable_pagination:this.enable_pagination,pagn_starts_on_page:this.pagn_starts_on_page,pagn_right:this.right,pagn_bottom:this.bottom};await this.$api.updateMeta({path:this.publication.$path,new_meta:a}),this.edit_mode=!1,this.is_saving=!1}catch(a){this.is_saving=!1,this.edit_mode=!1,this.$alertify.closeLogOnClick(!0).delay(4e3).error(this.$t("couldntbesaved")),this.$alertify.closeLogOnClick(!0).error(a.response.data)}}}};var ge=function(){var t=this,e=t._self._c;return e("div",[e("fieldset",[e("legend",{staticClass:"u-label"},[t._v(t._s(t.$t("pagination")))]),e("div",{staticClass:"u-instructions"},[e("small",[t._v(t._s(t.$t("pagination_instructions")))]),t.is_spread?e("small",[t._v(" "+t._s(t.$t("pagination_instructions_spread")))]):t._e()]),e("div",{staticClass:"u-sameRow"},[e("ToggleInput",{attrs:{content:t.enable_pagination,label:t.$t("enable"),disabled:!t.edit_mode},on:{"update:content":function(i){t.enable_pagination=i}}})],1),e("br"),e("div",{},[e("DLabel",{attrs:{str:t.$t("pagn_starts_on_page")}}),e("input",{directives:[{name:"model",rawName:"v-model.number",value:t.pagn_starts_on_page,expression:"pagn_starts_on_page",modifiers:{number:!0}}],attrs:{type:"number",disabled:!t.edit_mode},domProps:{value:t.pagn_starts_on_page},on:{input:function(i){i.target.composing||(t.pagn_starts_on_page=t._n(i.target.value))},blur:function(i){return t.$forceUpdate()}}})],1),e("br"),e("div",{staticClass:"u-sameRow"},[e("div",{},[e("DLabel",{attrs:{str:t.is_spread?t.$t("distance_to_outside"):t.$t("distance_to_right")}}),e("div",{staticClass:"u-inputGroup"},[e("input",{directives:[{name:"model",rawName:"v-model.number",value:t.right,expression:"right",modifiers:{number:!0}}],attrs:{type:"number",disabled:!t.edit_mode},domProps:{value:t.right},on:{input:function(i){i.target.composing||(t.right=t._n(i.target.value))},blur:function(i){return t.$forceUpdate()}}}),e("span",{staticClass:"u-suffix",domProps:{textContent:t._s(t.unit)}})])],1),e("div",{},[e("DLabel",{attrs:{str:t.$t("distance_to_bottom")}}),e("div",{staticClass:"u-inputGroup"},[e("input",{directives:[{name:"model",rawName:"v-model.number",value:t.bottom,expression:"bottom",modifiers:{number:!0}}],attrs:{type:"number",disabled:!t.edit_mode},domProps:{value:t.bottom},on:{input:function(i){i.target.composing||(t.bottom=t._n(i.target.value))},blur:function(i){return t.$forceUpdate()}}}),e("span",{staticClass:"u-suffix",domProps:{textContent:t._s(t.unit)}})])],1)]),e("br"),t.can_edit&&!t.edit_mode?e("EditBtn",{on:{click:t.enableEditMode}}):t._e(),t.edit_mode?e("div",{staticClass:"_footer"},[e("SaveCancelButtons",{staticClass:"_scb",attrs:{is_saving:t.is_saving},on:{save:t.updatePagination,cancel:t.cancel}})],1):t._e()],1)])},fe=[],ve=D(he,ge,fe,!1,null,"e789b930");const me=ve.exports,be={props:{publication:Object},components:{WidthHeightField:le,SetMargins:pe,PaginationOption:me},data(){return{}},created(){},mounted(){},beforeDestroy(){},watch:{},computed:{},methods:{}};var we=function(){var t=this,e=t._self._c;return e("div",{staticClass:"_pageSettings"},[e("WidthHeightField",{attrs:{publication:t.publication}}),e("br"),e("ToggleField",{attrs:{label:t.$t("page_spreads"),field_name:"page_spreads",content:t.publication.page_spreads,path:t.publication.$path,can_edit:!0}}),e("br"),e("SetMargins",{attrs:{publication:t.publication,is_spread:t.publication.page_spreads===!0}}),e("br"),e("PaginationOption",{attrs:{publication:t.publication,is_spread:t.publication.page_spreads===!0}})],1)},ye=[],Se=D(be,we,ye,!1,null,"91c5113e");const $e=Se.exports,Ce={props:{label:String,value:Number,page_modules:Array},components:{},data(){return{}},created(){},mounted(){},beforeDestroy(){},watch:{},computed:{list_all_z_index(){return this.page_modules.map(a=>a.z_index||0)},max_z_index(){return Math.max(...this.list_all_z_index)},min_z_index(){return Math.min(...this.list_all_z_index)}},methods:{moveToBack(){this.$emit("save",this.min_z_index-1)},moveToFront(){this.$emit("save",this.max_z_index+1)}}};var ze=function(){var t=this,e=t._self._c;return e("div",{staticClass:"_depthInput"},[t.label?e("DLabel",{attrs:{str:t.label,for:t.label}}):t._e(),e("div",{staticClass:"u-sameRow"},[e("button",{staticClass:"u-button u-button_black",attrs:{type:"button",disabled:t.value===t.max_z_index},on:{click:t.moveToFront}},[e("b-icon",{attrs:{icon:"front"}}),t._v(" "+t._s(t.$t("move_to_front"))+" ")],1),e("button",{staticClass:"u-button u-button_black",attrs:{type:"button",disabled:t.value===t.min_z_index},on:{click:t.moveToBack}},[e("b-icon",{attrs:{icon:"back"}}),t._v(" "+t._s(t.$t("move_to_back"))+" ")],1)])],1)},xe=[],Pe=D(Ce,ze,xe,!1,null,"6343db9a");const Ee=Pe.exports,Me={props:{pages:Array,current_page_id:String},components:{},data(){return{page_id_to_move_to:void 0}},created(){},mounted(){},beforeDestroy(){},watch:{},computed:{all_pages_in_select(){return this.pages.map((a,t)=>({key:a.id,text:t+1}))}},methods:{setNewPage(a){this.page_id_to_move_to=a},submit(){this.$emit("submit",this.page_id_to_move_to),this.$emit("close")}}};var ke=function(){var t=this,e=t._self._c;return e("BaseModal2",{attrs:{title:t.$t("move_to_page")},on:{close:function(i){return t.$emit("close")}}},[e("div",{},[e("SelectField2",{attrs:{value:t.current_page_id,options:t.all_pages_in_select,can_edit:!0,hide_validation:!0},on:{change:t.setNewPage}})],1),e("template",{slot:"footer"},[e("button",{staticClass:"u-button",attrs:{type:"button"},on:{click:function(i){return t.$emit("close")}}},[e("b-icon",{attrs:{icon:"x-circle"}}),t._v(" "+t._s(t.$t("cancel"))+" ")],1),e("button",{staticClass:"u-button u-button_bleuvert",attrs:{type:"button",autofocus:"",disabled:!t.page_id_to_move_to||t.page_id_to_move_to===t.current_page_id},on:{click:t.submit}},[t._v(" "+t._s(t.$t("move"))+" ")])])],2)},Te=[],De=D(Me,ke,Te,!1,null,"897dc9dc");const Ot=De.exports,Ae={props:{on_click:Object,pages:Array,current_page_id:String,path:String},components:{SelectPage:Ot},data(){var a,t,e;return{type_of_link:((a=this.on_click)==null?void 0:a.type)||"",content_url:((t=this.on_click)==null?void 0:t.url)||"",content_page_id:((e=this.on_click)==null?void 0:e.page_id)||"",show_page_select:!1,options:[{key:"",label:this.$t("do_nothing")},{key:"url",label:this.$t("open_webpage")},{key:"page",label:this.$t("navigate_to_page")}]}},created(){},mounted(){},beforeDestroy(){},watch:{type_of_link:{handler(a,t){a==="page"&&t!=="page"&&!this.content_page_id&&(this.show_page_select=!0)}}},computed:{selected_page_id(){return this.pages.findIndex(a=>a.id===this.content_page_id)+1},active_page_number(){return this.pages.findIndex(a=>a.id===this.current_page_id)+1},allow_save(){return this.type_of_link==="page"?this.content_page_id.length>0:this.type_of_link==="url"?this.content_url.length>0:this.type_of_link===""}},methods:{linkToPage(a){this.content_page_id=a,this.show_page_select=!1},save(){let a;this.type_of_link==="url"?a={type:this.type_of_link,url:this.content_url}:this.type_of_link==="page"?a={type:this.type_of_link,page_id:this.content_page_id}:a={},this.$emit("save",{on_click:a}),this.$emit("close")}}};var Oe=function(){var t=this,e=t._self._c;return e("BaseModal2",{attrs:{title:t.$t("on_click")},on:{close:function(i){return t.$emit("close")}}},[e("div",{staticClass:"u-spacingBottom"},[e("RadioCheckboxInput",{attrs:{value:t.type_of_link,options:t.options,can_edit:!0},on:{"update:value":function(i){t.type_of_link=i}}})],1),t.type_of_link==="url"?e("div",{staticClass:"_options"},[e("TextInput",{attrs:{content:t.content_url,input_type:"url",placeholder:t.$t("url_to_open")},on:{"update:content":function(i){t.content_url=i}}})],1):t.type_of_link==="page"?e("div",{staticClass:"_options"},[t._v(" "+t._s(t.$t("page_number"))+" = "),e("b",[t.selected_page_id?[t._v(" "+t._s(t.selected_page_id)+" ")]:[t._v(" "+t._s(t.$t("no_page_selected"))+" ")]],2),e("EditBtn",{attrs:{label_position:"right"},on:{click:function(i){t.show_page_select=!0}}}),t.show_page_select?e("SelectPage",{attrs:{pages:t.pages,current_page_id:t.current_page_id,allow_save:t.allow_save},on:{submit:t.linkToPage,close:function(i){t.show_page_select=!1}}}):t._e()],1):t._e(),e("SaveCancelButtons",{attrs:{slot:"footer"},on:{save:t.save,cancel:function(i){return t.$emit("close")}},slot:"footer"})],1)},Ye=[],Re=D(Ae,Oe,Ye,!1,null,"4cb80713");const Xe=Re.exports,Be={props:{can_edit:Boolean,pages:Array,active_page_number:Number,active_spread_index:[Boolean,Number],page_width:Number,page_height:Number,scale:Number,show_grid:Boolean,snap_to_grid:Boolean,grid_z_index:String,gridstep_in_mm:Number,layout_mode:{type:String,default:"print"},page_color:String,pagination:[Boolean,Object],publication_path:String,page_modules:Array,page_opened_id:String,active_module:[Boolean,Object],display_as_public:Boolean},components:{DepthInput:Ee,ModuleCreator:ne,SelectPage:Ot,LinkToPageOrURL:Xe},data(){return{show_page_options:!1,show_confirm_move:!1,show_edit_link_modal:!1,show_all_medias:!1,has_editor_toolbar:!1}},created(){},mounted(){this.$eventHub.$on("module.text_editing_enabled",this.displayToolbarAndToolTip),this.$eventHub.$on("module.text_editing_disabled",this.removeToolbar),this.$eventHub.$on("module.open_remove_modal",this.openRemoveModal)},beforeDestroy(){this.$eventHub.$off("module.text_editing_enabled",this.displayToolbarAndToolTip),this.$eventHub.$off("module.text_editing_disabled",this.removeToolbar),this.$eventHub.$off("module.open_remove_modal",this.openRemoveModal)},watch:{},computed:{module_meta_filename(){return this.active_module?this.active_module.$path.substring(this.active_module.$path.lastIndexOf("/")+1):""},active_module_first_media(){return this.firstMedia(this.active_module)},first_media_ratio(){var a,t;return(t=(a=this.active_module_first_media)==null?void 0:a.$infos)==null?void 0:t.ratio},is_shape(){return this.getModuleType(this.active_module.module_type)==="shape"},unit(){return this.layout_mode==="screen"?"px":"mm"},magnification(){return this.layout_mode==="screen"?1:this.$root.page_magnification},show_caption(){return!(this.active_module.module_type==="text"||this.is_shape)},has_pagination(){return this.active_page_number-this.pagination.pagination_start_on_page>=0},active_page(){return this.pages[this.active_page_number]},hide_pagination(){return this.pages[this.active_page_number].hide_pagination===!0},new_module_meta(){const a=Math.max(...this.page_modules.map(r=>r.z_index||0))+1;let t=this.$root.default_new_module_left,e=this.$root.default_new_module_top;this.$root.set_new_module_offset_left&&(t=(this.$root.set_new_module_offset_left+this.$root.zoom_offset)/this.magnification),this.$root.set_new_module_offset_top&&(e=(this.$root.set_new_module_offset_top+this.$root.zoom_offset)/this.magnification);const i=Math.max(this.$root.default_new_module_width,this.$root.default_new_module_width/this.scale)/this.magnification,n=Math.max(this.$root.default_new_module_height,this.$root.default_new_module_height/this.scale)/this.magnification;return this.gridstep_in_mm,{page_id:this.page_opened_id,x:t,y:e,width:i,height:n,rotation:0,margins:0,opacity:1,outline_width:0,z_index:a}}},methods:{displayToolbarAndToolTip({$toolbar:a,$tooltip:t}){this.has_editor_toolbar=!0,this.$nextTick(()=>{this.$refs.editor_toolbar&&this.$refs.editor_toolbar.append(a),this.$refs.editor_tooltip&&this.$refs.editor_tooltip.append(t)})},removeToolbar(){this.has_editor_toolbar=!1},openRemoveModal(){this.$refs.removeMenu.show_confirm_delete=!0},getPageNumberFromId(a){return this.pages.findIndex(t=>t.id===a)+1},enableModuleEdit({meta_filenames:a}){const t=a.at(-1);setTimeout(()=>{this.$eventHub.$emit(`module.enable_edit.${t}`),this.$eventHub.$emit(`module.panTo.${t}`)},150)},async setRealSize(){const a=this.active_module.width*this.first_media_ratio;await this.updateMediaPubliMeta({height:a})},async setSize(a){a==="full"?await this.updateMediaPubliMeta({width:this.page_width,height:this.page_height,x:0,y:0}):a==="half_left"?await this.updateMediaPubliMeta({width:this.page_width/2,height:this.page_height,x:0,y:0}):a==="half_right"?await this.updateMediaPubliMeta({width:this.page_width/2,height:this.page_height,x:this.page_width/2,y:0}):a==="half_top"?await this.updateMediaPubliMeta({width:this.page_width,height:this.page_height/2,x:0,y:0}):a==="half_bottom"&&await this.updateMediaPubliMeta({width:this.page_width,height:this.page_height/2,x:0,y:this.page_height/2})},changeModulePage(){this.$eventHub.$emit(`module.move.${this.module_meta_filename}`)},duplicateModule(){this.$eventHub.$emit(`module.duplicate.${this.module_meta_filename}`)},removeModule(){this.$eventHub.$emit(`module.remove.${this.module_meta_filename}`),this.$eventHub.$emit("module.setActive",!1)},setActive(a){this.$eventHub.$emit("module.setActive",a),a&&this.$nextTick(()=>{const t=this.getFilename(a);this.$eventHub.$emit(`module.panTo.${t}`)})},async updateMediaPubliMeta(a){this.active_module&&await this.$api.updateMeta({path:this.active_module.$path,new_meta:a}).catch(t=>{throw this.$alertify.delay(4e3).error(t),t})}}};var Le=function(){var t=this,e=t._self._c;return e("div",{staticClass:"_pageMenu"},[e("div",{staticClass:"_pageMenu--pane"},[e("button",{staticClass:"u-buttonLink",attrs:{type:"button"},on:{click:function(i){return t.$emit("close")}}},[e("b-icon",{attrs:{icon:"grid-fill"}}),t.active_spread_index?[t._v(t._s(t.$t("list_of_spreads")))]:[t._v(t._s(t.$t("list_of_pages")))]],2),e("div",{staticClass:"_titleRow"},[e("button",{staticClass:"u-button u-button_transparent u-button_icon",attrs:{type:"button",disabled:t.active_page_number<=0},on:{click:function(i){return t.$emit("prevPage")}}},[e("b-icon",{attrs:{icon:"arrow-left-square"}})],1),e("div",[e("transition",{attrs:{name:"slideupFade",mode:"out-in"}},[e("div",[e("b",{key:t.active_page_number},[t._v(t._s(t.$t("page"))+" "+t._s(t.active_page_number+1))])])]),t.active_spread_index!==!1?e("transition",{attrs:{name:"slideupFade",mode:"out-in"}},[e("span",{key:t.active_spread_index},[t.active_page_number===0?[t._v(" ("+t._s(t.$t("cover"))+") ")]:[t._v(" ("+t._s(t.$t("spread").toLowerCase())+" "+t._s(t.active_spread_index)+") ")]],2)]):t._e()],1),e("button",{staticClass:"u-button u-button_transparent u-button_icon",attrs:{type:"button",disabled:t.active_page_number>=t.pages.length-1},on:{click:function(i){return t.$emit("nextPage")}}},[e("b-icon",{attrs:{icon:"arrow-right-square"}})],1)]),e("div",{staticClass:"_scale"},[e("RangeValueInput",{staticClass:"u-spacingBottom",attrs:{can_toggle:!1,label:t.$t("scale"),value:Math.round(t.scale*100),min:10,max:200,step:1,ticks:[10,25,50,100,200],default_value:100,suffix:"%"},on:{save:function(i){return t.$emit("update:scale",i/100)}}})],1),t.can_edit?e("div",{},[e("ToggleInput",{attrs:{content:t.display_as_public,label:t.$t("preview")},on:{"update:content":function(i){return t.$emit("update:display_as_public",i)}}})],1):t._e()]),t.can_edit&&!t.display_as_public?[!t.has_editor_toolbar&&!t.active_module?[e("div",{staticClass:"_pageMenu--pane"},[e("div",{staticClass:"u-spacingBottom"},[e("DLabel",{attrs:{str:t.$t("add_on_page")}}),e("ModuleCreator",{attrs:{publication_path:t.publication_path,pre_addtl_meta:t.new_module_meta,context:"page_by_page",start_collapsed:!1},on:{addModules:t.enableModuleEdit}})],1),t.can_edit?e("div",{},[t.can_edit?e("ToggledSection",{staticClass:"u-spacingBottom",attrs:{label:t.$t("show_grid"),show_toggle:t.show_grid},on:{"update:show_toggle":function(i){return t.$emit("update:show_grid",i)}}},[e("RadioCheckboxInput",{attrs:{value:t.grid_z_index,options:[{label:t.$t("over"),key:"over"},{label:t.$t("under"),key:"under"}],can_edit:!0},on:{"update:value":function(i){return t.$emit("update:grid_z_index",i)}}}),e("div",{staticClass:"u-spacingBottom"}),e("RangeValueInput",{attrs:{label:t.$t("gridstep"),can_toggle:!1,value:t.gridstep_in_mm,min:1,max:20,step:1,ticks:[5,10,20,50],default_value:10,suffix:t.unit},on:{save:function(i){return t.$emit("update:gridstep_in_mm",i)}}}),e("div",{staticClass:"u-spacingBottom"}),e("ToggleInput",{staticClass:"u-spacingBottom",attrs:{content:t.snap_to_grid,label:t.$t("snap_to_grid")},on:{"update:content":function(i){return t.$emit("update:snap_to_grid",i)}}})],1):t._e()],1):t._e(),t.can_edit?e("div",{},[e("ColorInput",{staticClass:"u-spacingBottom",attrs:{label:t.$t("page_color"),value:t.page_color},on:{save:function(i){return t.$emit("updatePageOptions",{page_number:t.active_page_number,value:{page_color:i}})}}}),e("DLabel",{attrs:{str:t.$t("format,margins,pagination")}}),e("div",{},[e("button",{staticClass:"u-button",attrs:{type:"button"},on:{click:function(i){return t.$eventHub.$emit("publication.settings.toggle")}}},[e("b-icon",{attrs:{slot:"prefix",icon:"gear","aria-label":t.$t("settings")},slot:"prefix"}),t._v(" "+t._s(t.$t("settings"))+" ")],1)]),t.has_pagination?[e("div",{staticClass:"u-spacingBottom"}),e("ToggleInput",{attrs:{content:t.hide_pagination,label:t.$t("hide_pagination")},on:{"update:content":function(i){return t.$emit("updatePageOptions",{page_number:t.active_page_number,value:{hide_pagination:i}})}}})]:t._e()],2):t._e()]),e("div",{staticClass:"_pageMenu--pane"},[e("DetailsPane",{attrs:{header:t.$t("on_this_page"),icon:"images",has_items:t.page_modules.length,is_open_initially:!1,can_be_toggled:!0}},[e("div",{staticClass:"_mediaList"},t._l(t.page_modules,function(i){return e("div",{key:i.$path,staticClass:"u-sameRow",on:{click:function(n){return t.setActive(i.$path)}}},[t.getModuleType(i.module_type)==="shape"?[t._v(" "+t._s(t.$t(i.module_type))+" ")]:t.firstMedia(i)?e("MediaContent",{staticClass:"_preview",attrs:{file:t.firstMedia(i),resolution:50,context:"preview"}}):[t._v(" – ")]],2)}),0)])],1)]:!t.has_editor_toolbar&&t.active_module?e("div",{key:"media-"+t.active_module.$path,staticClass:"_pageMenu--pane"},[e("DLabel",{attrs:{str:t.$t("media"),instructions:t.$t("active_media_instr")}}),t.active_module.module_type==="mosaic"&&t.active_module_first_media?e("MediaContent",{staticClass:"_activeModulePreview",attrs:{file:t.active_module_first_media,resolution:50,context:"preview"}}):t.active_module.module_type==="text"&&t.active_module_first_media?e("span",{staticClass:"u-textEllipsis u-textEllipsis_3 _textExtract"},[e("CollaborativeEditor2",{ref:"textBloc",attrs:{path:t.active_module_first_media.$path,content:t.active_module_first_media.$content,can_edit:!1}})],1):e("span",[t._v(" "+t._s(t.$t(t.active_module.module_type))+" ")]),e("div",{staticClass:"u-spacingBottom"}),e("div",{staticClass:"u-mediaOptions"},[e("div",[e("button",{staticClass:"u-buttonLink",attrs:{type:"button"},on:{click:function(i){t.show_confirm_move=!0}}},[e("b-icon",{attrs:{icon:"arrow-left-right"}}),t._v(" "+t._s(t.$t("move_to_page"))+" ")],1)]),t.show_confirm_move?e("SelectPage",{attrs:{pages:t.pages,current_page_id:t.active_page.id},on:{submit:function(i){t.updateMediaPubliMeta({page_id:i}),t.setActive(!1)}}}):t._e(),e("div",{},[e("button",{staticClass:"u-buttonLink",attrs:{type:"button"},on:{click:t.duplicateModule}},[e("b-icon",{attrs:{icon:"file-plus"}}),t._v(" "+t._s(t.$t("duplicate"))+" ")],1)]),e("div",{},[t.active_module.locked===!0?e("button",{staticClass:"u-buttonLink",attrs:{type:"button"},on:{click:function(i){return t.updateMediaPubliMeta({locked:!1})}}},[e("b-icon",{attrs:{icon:"unlock"}}),t._v(" "+t._s(t.$t("unlock"))+" ")],1):e("button",{staticClass:"u-buttonLink",attrs:{type:"button"},on:{click:function(i){return t.updateMediaPubliMeta({locked:!0})}}},[e("b-icon",{attrs:{icon:"lock"}}),t._v(" "+t._s(t.$t("lock"))+" ")],1)]),e("div",{},[e("button",{staticClass:"u-buttonLink",attrs:{type:"button"},on:{click:function(i){return t.setActive(!1)}}},[e("b-icon",{attrs:{icon:"dash-square-dotted"}}),t._v(" "+t._s(t.$t("unselect"))+" ")],1)]),e("RemoveMenu",{ref:"removeMenu",attrs:{modal_title:t.$t("withdraw_from_page")},on:{remove:t.removeModule}})],1),e("div",{staticClass:"u-spacingBottom"}),t.show_caption?[e("TitleField",{attrs:{label:t.active_module.caption?t.$t("caption"):t.$t("add_caption"),field_name:"caption",input_type:"editor",custom_formats:["bold","italic","link"],content:t.active_module.caption,path:t.active_module.$path,maxlength:640,can_edit:t.can_edit}}),e("div",{staticClass:"u-spacingBottom"}),t.active_module_first_media&&t.active_module_first_media.caption&&!t.active_module.caption?e("div",{},[e("div",{staticClass:"u-instructions"},[t._v(" "+t._s(t.$t("copy_first_media_caption"))+" ")]),e("button",{staticClass:"u-buttonLink _firstMediaCaption",attrs:{type:"button"},on:{click:function(i){return t.updateMediaPubliMeta({caption:t.active_module_first_media.caption})}}},[t._v(" "+t._s(t.active_module_first_media.caption)+" ")])]):t._e(),e("div",{staticClass:"u-spacingBottom"})]:t._e(),e("div",[e("DLabel",{attrs:{str:t.$t("on_click")}}),e("div",[t.active_module.on_click&&t.active_module.on_click.type==="url"&&t.active_module.on_click.url?[t._v(" "+t._s(t.$t("open_webpage"))+" "),e("br"),e("b",[t._v(t._s(t.active_module.on_click.url))])]:t.active_module.on_click&&t.active_module.on_click.type==="page"&&t.active_module.on_click.page_id?[t._v(" "+t._s(t.$t("navigate_to_page"))+" "),e("br"),e("b",[t._v(t._s(t.getPageNumberFromId(t.active_module.on_click.page_id)))])]:[t._v(" "+t._s(t.$t("do_nothing"))+" ")],e("EditBtn",{attrs:{label_position:"left"},on:{click:function(i){t.show_edit_link_modal=!0}}})],2),t.show_edit_link_modal?e("LinkToPageOrURL",{attrs:{path:t.active_module.$path,on_click:t.active_module.on_click,pages:t.pages,current_page_id:t.active_page.id},on:{save:t.updateMediaPubliMeta,close:function(i){t.show_edit_link_modal=!1}}}):t._e()],1),e("div",{staticClass:"u-spacingBottom"}),e("div",{staticClass:"u-sameRow"},[e("NumberInput",{attrs:{label:t.$t("position")+" →",value:t.active_module.x,suffix:t.unit},on:{save:function(i){return t.updateMediaPubliMeta({x:i})}}}),e("NumberInput",{attrs:{label:t.$t("position")+" ↓",value:t.active_module.y,suffix:t.unit},on:{save:function(i){return t.updateMediaPubliMeta({y:i})}}})],1),e("div",{staticClass:"u-sameRow"},[e("NumberInput",{attrs:{label:t.$t("width")+" ↔",value:t.active_module.width,min:0,suffix:t.unit},on:{save:function(i){return t.updateMediaPubliMeta({width:i})}}}),e("NumberInput",{attrs:{label:t.$t("height")+" ↕",value:t.active_module.height,min:0,suffix:t.unit},on:{save:function(i){return t.updateMediaPubliMeta({height:i})}}})],1),e("div",{staticClass:"_setSizeBtn"},[t.first_media_ratio?e("button",{staticClass:"u-button_icon",attrs:{type:"button",title:t.$t("real_size")},on:{click:t.setRealSize}},[e("b-icon",{attrs:{icon:"slash-square-fill",rotate:"90","aria-label":t.$t("real_size")}})],1):t._e(),e("button",{staticClass:"u-button_icon",attrs:{type:"button"},on:{click:function(i){return t.setSize("full")}}},[e("b-icon",{attrs:{icon:"square-fill","aria-label":t.$t("full_page")}})],1),e("button",{staticClass:"u-button_icon",attrs:{type:"button"},on:{click:function(i){return t.setSize("half_left")}}},[e("b-icon",{attrs:{icon:"square-half"}})],1),e("button",{staticClass:"u-button_icon",attrs:{type:"button"},on:{click:function(i){return t.setSize("half_right")}}},[e("b-icon",{attrs:{icon:"square-half",rotate:"180"}})],1),e("button",{staticClass:"u-button_icon",attrs:{type:"button"},on:{click:function(i){return t.setSize("half_top")}}},[e("b-icon",{attrs:{icon:"square-half",rotate:"90"}})],1),e("button",{staticClass:"u-button_icon",attrs:{type:"button"},on:{click:function(i){return t.setSize("half_bottom")}}},[e("b-icon",{attrs:{icon:"square-half",rotate:"270"}})],1)]),e("div",{staticClass:"u-spacingBottom"}),e("RangeValueInput",{staticClass:"u-spacingBottom",attrs:{label:t.$t("angle"),value:t.active_module.rotation,min:0,max:360,step:1,ticks:[0,90,180,270,360],default_value:0,suffix:"°"},on:{save:function(i){return t.updateMediaPubliMeta({rotation:i})}}}),e("RangeValueInput",{staticClass:"u-spacingBottom",attrs:{label:t.$t("margins"),value:t.active_module.margins,min:0,max:50,step:1,default_value:0,suffix:t.unit},on:{save:function(i){return t.updateMediaPubliMeta({margins:i})}}}),t.active_module.module_type!=="ellipsis"?e("RangeValueInput",{staticClass:"u-spacingBottom",attrs:{label:t.$t("border_radius"),value:t.active_module.border_radius,min:0,max:50,step:1,default_value:0,suffix:t.unit},on:{save:function(i){return t.updateMediaPubliMeta({border_radius:i})}}}):t._e(),e("RangeValueInput",{staticClass:"u-spacingBottom",attrs:{label:t.$t("drop_shadow"),value:t.active_module.drop_shadow?t.active_module.drop_shadow*100:void 0,min:0,max:100,step:1,ticks:[0,25,50,75,100],default_value:0,suffix:"%"},on:{save:function(i){return t.updateMediaPubliMeta({drop_shadow:i/100})}}}),e("RangeValueInput",{staticClass:"u-spacingBottom",attrs:{label:t.$t("opacity"),value:Math.round(t.active_module.opacity*100),min:1,max:100,step:1,ticks:[1,100],default_value:100,suffix:"%"},on:{save:function(i){return t.updateMediaPubliMeta({opacity:i/100})}}}),e("ColorInput",{staticClass:"u-spacingBottom",attrs:{label:t.$t("background_color"),value:t.active_module.background_color,allow_transparent:!0,default_value:t.is_shape?"transparent":""},on:{save:function(i){return t.updateMediaPubliMeta({background_color:i})}}}),e("RangeValueInput",{staticClass:"u-spacingBottom",attrs:{label:t.$t("outline_width"),value:t.active_module.outline_width,min:0,max:20,step:1,ticks:[0,10,20],default_value:0,suffix:t.unit},on:{save:function(i){return t.updateMediaPubliMeta({outline_width:i})}}}),t.active_module.outline_width>0?e("ColorInput",{staticClass:"u-spacingBottom",attrs:{label:t.$t("outline_color"),value:t.active_module.outline_color,allow_transparent:!0,default_value:"#000000"},on:{save:function(i){return t.updateMediaPubliMeta({outline_color:i})}}}):t._e(),t.active_module_first_media&&t.active_module_first_media.$type==="image"?e("ToggleInput",{staticClass:"u-spacingBottom",attrs:{content:t.active_module.show_fs_button,label:t.$t("show_fs_button")},on:{"update:content":function(i){return t.updateMediaPubliMeta({show_fs_button:i})}}}):t._e(),e("DepthInput",{attrs:{label:t.$t("z_index"),value:t.active_module.z_index,page_modules:t.page_modules},on:{save:function(i){return t.updateMediaPubliMeta({z_index:i})}}})],2):t._e(),e("div",{directives:[{name:"show",rawName:"v-show",value:t.has_editor_toolbar,expression:"has_editor_toolbar"}],key:"text-toolbar-"+t.active_page_number,staticClass:"_pageMenu--pane"},[e("div",{ref:"editor_toolbar",staticClass:"_editorToolbar"}),e("div",{ref:"editor_tooltip",staticClass:"_editorToolbar"})])]:t._e()],2)},Ie=[],Fe=D(Be,Le,Ie,!1,null,"fb2f461b");const He=Fe.exports;var We="function",Ve="object",Ne="string",Yt="undefined",je=typeof document!==Yt&&document,Ze=[{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"},{open:'\\"',close:'\\"'},{open:"\\'",close:"\\'"}],U={cm:function(a){return a*96/2.54},mm:function(a){return a*96/254},in:function(a){return a*96},pt:function(a){return a*96/72},pc:function(a){return a*96/6},"%":function(a,t){return a*t/100},vw:function(a,t){return t===void 0&&(t=window.innerWidth),a/100*t},vh:function(a,t){return t===void 0&&(t=window.innerHeight),a/100*t},vmax:function(a,t){return t===void 0&&(t=Math.max(window.innerWidth,window.innerHeight)),a/100*t},vmin:function(a,t){return t===void 0&&(t=Math.min(window.innerWidth,window.innerHeight)),a/100*t}};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function qe(){for(var a=0,t=0,e=arguments.length;t<e;t++)a+=arguments[t].length;for(var i=Array(a),n=0,t=0;t<e;t++)for(var r=arguments[t],o=0,s=r.length;o<s;o++,n++)i[n]=r[o];return i}function mt(a){return typeof a===Yt}function W(a){return a&&typeof a===Ve}function V(a){return Array.isArray(a)}function Rt(a){return typeof a===Ne}function Ue(a){return typeof a===We}function Ge(a,t){var e=a===""||a==" ",i=t===""||t==" ";return i&&e||a===t}function Xt(a,t,e,i,n){var r=ut(a,t,e);return r?e:Ke(a,t,e+1,i,n)}function ut(a,t,e){if(!a.ignore)return null;var i=t.slice(Math.max(e-3,0),e+3).join("");return new RegExp(a.ignore).exec(i)}function Ke(a,t,e,i,n){for(var r=function(c){var d=t[c].trim();if(d===a.close&&!ut(a,t,c))return{value:c};var _=c,l=at(n,function(h){var f=h.open;return f===d});if(l&&(_=Xt(l,t,c,i,n)),_===-1)return o=c,"break";c=_,o=c},o,s=e;s<i;++s){var u=r(s);if(s=o,typeof u=="object")return u.value;if(u==="break")break}return-1}function Bt(a,t){var e=Rt(t)?{separator:t}:t,i=e.separator,n=i===void 0?",":i,r=e.isSeparateFirst,o=e.isSeparateOnlyOpenClose,s=e.isSeparateOpenClose,u=s===void 0?o:s,c=e.openCloseCharacters,d=c===void 0?Ze:c,_=d.map(function(y){var x=y.open,P=y.close;return x===P?x:x+"|"+P}).join("|"),l="(\\s*"+n+"\\s*|"+_+"|\\s+)",h=new RegExp(l,"g"),f=a.split(h).filter(function(y){return y&&y!=="undefined"}),v=f.length,p=[],m=[];function g(){return m.length?(p.push(m.join("")),m=[],!0):!1}for(var b=function(y){var x=f[y].trim(),P=y,O=at(d,function(M){var R=M.open;return R===x}),Y=at(d,function(M){var R=M.close;return R===x});if(O){if(P=Xt(O,f,y,v,d),P!==-1&&u)return g()&&r||(p.push(f.slice(y,P+1).join("")),y=P,r)?(w=y,"break"):(w=y,"continue")}else if(Y&&!ut(Y,f,y)){var k=qe(d);return k.splice(d.indexOf(Y),1),{value:Bt(a,{separator:n,isSeparateFirst:r,isSeparateOnlyOpenClose:o,isSeparateOpenClose:u,openCloseCharacters:k})}}else if(Ge(x,n)&&!o)return g(),r?(w=y,"break"):(w=y,"continue");P===-1&&(P=v-1),m.push(f.slice(y,P+1).join("")),y=P,w=y},w,$=0;$<v;++$){var z=b($);if($=w,typeof z=="object")return z.value;if(z==="break")break}return m.length&&p.push(m.join("")),p}function Je(a){return Bt(a,",")}function Qe(a){var t=/^([^\d|e|\-|\+]*)((?:\d|\.|-|e-|e\+)+)(\S*)$/g.exec(a);if(!t)return{prefix:"",unit:"",value:NaN};var e=t[1],i=t[2],n=t[3];return{prefix:e,unit:n,value:parseFloat(i)}}function ti(a){return a.replace(/[\s-_]+([^\s-_])/g,function(t,e){return e.toUpperCase()})}function bt(){return Date.now?Date.now():new Date().getTime()}function Lt(a,t,e){e===void 0&&(e=-1);for(var i=a.length,n=0;n<i;++n)if(t(a[n],n,a))return n;return e}function at(a,t,e){var i=Lt(a,t);return i>-1?a[i]:e}function B(a,t){var e=Qe(a),i=e.value,n=e.unit;if(W(t)){var r=t[n];if(r){if(Ue(r))return r(i);if(U[n])return U[n](i,r)}}else if(n==="%")return i*t/100;return U[n]?U[n](i):i}function L(a,t,e){return Math.max(t,Math.min(a,e))}function ei(a,t){var e=1/t;return Math.round(a/t)/e}function F(a,t){a.classList?a.classList.add(t):a.className+=" "+t}function C(a,t,e,i){a.addEventListener(t,e,i)}function S(a,t,e,i){a.removeEventListener(t,e,i)}function dt(a){return(a==null?void 0:a.ownerDocument)||je}function H(a){var t;return((t=a==null?void 0:a.ownerDocument)===null||t===void 0?void 0:t.defaultView)||window}function ii(a){return a&&"postMessage"in a&&"blur"in a&&"self"in a}function wt(a){return W(a)&&a.nodeName&&a.nodeType&&"ownerDocument"in a}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var ot=function(){return ot=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++){e=arguments[i];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t},ot.apply(this,arguments)};function ni(){for(var a=0,t=0,e=arguments.length;t<e;t++)a+=arguments[t].length;for(var i=Array(a),n=0,t=0;t<e;t++)for(var r=arguments[t],o=0,s=r.length;o<s;o++,n++)i[n]=r[o];return i}var _t=function(){function a(){this._events={}}var t=a.prototype;return t.on=function(e,i){if(W(e))for(var n in e)this.on(n,e[n]);else this._addEvent(e,i,{});return this},t.off=function(e,i){if(!e)this._events={};else if(W(e))for(var n in e)this.off(n);else if(!i)this._events[e]=[];else{var r=this._events[e];if(r){var o=Lt(r,function(s){return s.listener===i});o>-1&&r.splice(o,1)}}return this},t.once=function(e,i){var n=this;return i&&this._addEvent(e,i,{once:!0}),new Promise(function(r){n._addEvent(e,r,{once:!0})})},t.emit=function(e,i){var n=this;i===void 0&&(i={});var r=this._events[e];if(!e||!r)return!0;var o=!1;return i.eventType=e,i.stop=function(){o=!0},i.currentTarget=this,ni(r).forEach(function(s){s.listener(i),s.once&&n.off(e,s.listener)}),!o},t.trigger=function(e,i){return i===void 0&&(i={}),this.emit(e,i)},t._addEvent=function(e,i,n){var r=this._events;r[e]=r[e]||[];var o=r[e];o.push(ot({listener:i},n))},a}();/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var rt=function(a,t){return rt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,i){e.__proto__=i}||function(e,i){for(var n in i)i.hasOwnProperty(n)&&(e[n]=i[n])},rt(a,t)};function ai(a,t){rt(a,t);function e(){this.constructor=a}a.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var E=function(){return E=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++){e=arguments[i];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t},E.apply(this,arguments)};function oi(a,t){var e=t[0]-a[0],i=t[1]-a[1],n=Math.atan2(i,e);return n>=0?n:n+Math.PI*2}function et(a){return oi([a[0].clientX,a[0].clientY],[a[1].clientX,a[1].clientY])/Math.PI*180}function ri(a){return a.touches&&a.touches.length>=2}function G(a){return a?a.touches?li(a.touches):[It(a)]:[]}function si(a){return a&&(a.type.indexOf("mouse")>-1||"button"in a)}function yt(a,t,e){var i=e.length,n=j(a,i),r=n.clientX,o=n.clientY,s=n.originalClientX,u=n.originalClientY,c=j(t,i),d=c.clientX,_=c.clientY,l=j(e,i),h=l.clientX,f=l.clientY,v=r-d,p=o-_,m=r-h,g=o-f;return{clientX:s,clientY:u,deltaX:v,deltaY:p,distX:m,distY:g}}function it(a){return Math.sqrt(Math.pow(a[0].clientX-a[1].clientX,2)+Math.pow(a[0].clientY-a[1].clientY,2))}function li(a){for(var t=Math.min(a.length,2),e=[],i=0;i<t;++i)e.push(It(a[i]));return e}function It(a){return{clientX:a.clientX,clientY:a.clientY}}function j(a,t){t===void 0&&(t=a.length);for(var e={clientX:0,clientY:0,originalClientX:0,originalClientY:0},i=Math.min(a.length,t),n=0;n<i;++n){var r=a[n];e.originalClientX+="originalClientX"in r?r.originalClientX:r.clientX,e.originalClientY+="originalClientY"in r?r.originalClientY:r.clientY,e.clientX+=r.clientX,e.clientY+=r.clientY}return t?{clientX:e.clientX/t,clientY:e.clientY/t,originalClientX:e.originalClientX/t,originalClientY:e.originalClientY/t}:e}var nt=function(){function a(t){this.prevClients=[],this.startClients=[],this.movement=0,this.length=0,this.startClients=t,this.prevClients=t,this.length=t.length}return a.prototype.getAngle=function(t){return t===void 0&&(t=this.prevClients),et(t)},a.prototype.getRotation=function(t){return t===void 0&&(t=this.prevClients),et(t)-et(this.startClients)},a.prototype.getPosition=function(t,e){t===void 0&&(t=this.prevClients);var i=yt(t||this.prevClients,this.prevClients,this.startClients),n=i.deltaX,r=i.deltaY;return this.movement+=Math.sqrt(n*n+r*r),this.prevClients=t,i},a.prototype.getPositions=function(t){t===void 0&&(t=this.prevClients);for(var e=this.prevClients,i=this.startClients,n=Math.min(this.length,e.length),r=[],o=0;o<n;++o)r[o]=yt([t[o]],[e[o]],[i[o]]);return r},a.prototype.getMovement=function(t){var e=this.movement;if(!t)return e;var i=j(t,this.length),n=j(this.prevClients,this.length),r=i.clientX-n.clientX,o=i.clientY-n.clientY;return Math.sqrt(r*r+o*o)+e},a.prototype.getDistance=function(t){return t===void 0&&(t=this.prevClients),it(t)},a.prototype.getScale=function(t){return t===void 0&&(t=this.prevClients),it(t)/it(this.startClients)},a.prototype.move=function(t,e){this.startClients.forEach(function(i){i.clientX-=t,i.clientY-=e}),this.prevClients.forEach(function(i){i.clientX-=t,i.clientY-=e})},a}(),St=["textarea","input"],Ft=function(a){ai(t,a);function t(e,i){i===void 0&&(i={});var n=a.call(this)||this;n.options={},n.flag=!1,n.pinchFlag=!1,n.data={},n.isDrag=!1,n.isPinch=!1,n.clientStores=[],n.targets=[],n.prevTime=0,n.doubleFlag=!1,n._useMouse=!1,n._useTouch=!1,n._useDrag=!1,n._dragFlag=!1,n._isTrusted=!1,n._isMouseEvent=!1,n._isSecondaryButton=!1,n._preventMouseEvent=!1,n._prevInputEvent=null,n._isDragAPI=!1,n._isIdle=!0,n._preventMouseEventId=0,n._window=window,n.onDragStart=function(l,h){if(h===void 0&&(h=!0),!(!n.flag&&l.cancelable===!1)){var f=l.type.indexOf("drag")>=-1;if(!(n.flag&&f)){n._isDragAPI=!0;var v=n.options,p=v.container,m=v.pinchOutside,g=v.preventWheelClick,b=v.preventRightClick,w=v.preventDefault,$=v.checkInput,z=v.dragFocusedInput,y=v.preventClickEventOnDragStart,x=v.preventClickEventOnDrag,P=v.preventClickEventByCondition,O=n._useTouch,Y=!n.flag;if(n._isSecondaryButton=l.which===3||l.button===2,g&&(l.which===2||l.button===1)||b&&(l.which===3||l.button===2))return n.stop(),!1;if(Y){var k=n._window.document.activeElement,M=l.target;if(M){var R=M.tagName.toLowerCase(),J=St.indexOf(R)>-1,q=M.isContentEditable;if(J||q){if($||!z&&k===M)return!1;if(k&&(k===M||q&&k.isContentEditable&&k.contains(M)))if(z)M.blur();else return!1}else if((w||l.type==="touchstart")&&k){var Q=k.tagName.toLowerCase();(k.isContentEditable||St.indexOf(Q)>-1)&&k.blur()}(y||x||P)&&C(n._window,"click",n._onClick,!0)}n.clientStores=[new nt(G(l))],n._isIdle=!1,n.flag=!0,n.isDrag=!1,n._isTrusted=h,n._dragFlag=!0,n._prevInputEvent=l,n.data={},n.doubleFlag=bt()-n.prevTime<200,n._isMouseEvent=si(l),!n._isMouseEvent&&n._preventMouseEvent&&n._allowMouseEvent();var tt=n._preventMouseEvent||n.emit("dragStart",E(E({data:n.data,datas:n.data,inputEvent:l,isMouseEvent:n._isMouseEvent,isSecondaryButton:n._isSecondaryButton,isTrusted:h,isDouble:n.doubleFlag},n.getCurrentStore().getPosition()),{preventDefault:function(){l.preventDefault()},preventDrag:function(){n._dragFlag=!1}}));tt===!1&&n.stop(),n._isMouseEvent&&n.flag&&w&&l.preventDefault()}if(!n.flag)return!1;var vt=0;if(Y?(n._attchDragEvent(),O&&m&&(vt=setTimeout(function(){C(p,"touchstart",n.onDragStart,{passive:!1})}))):O&&m&&S(p,"touchstart",n.onDragStart),n.flag&&ri(l)){if(clearTimeout(vt),Y&&l.touches.length!==l.changedTouches.length)return;n.pinchFlag||n.onPinchStart(l)}}}},n.onDrag=function(l,h){if(n.flag){var f=n.options.preventDefault;!n._isMouseEvent&&f&&l.preventDefault(),n._prevInputEvent=l;var v=G(l),p=n.moveClients(v,l,!1);if(n._dragFlag){if(n.pinchFlag||p.deltaX||p.deltaY){var m=n._preventMouseEvent||n.emit("drag",E(E({},p),{isScroll:!!h,inputEvent:l}));if(m===!1){n.stop();return}}n.pinchFlag&&n.onPinch(l,v)}n.getCurrentStore().getPosition(v,!0)}},n.onDragEnd=function(l){if(n.flag){var h=n.options,f=h.pinchOutside,v=h.container,p=h.preventClickEventOnDrag,m=h.preventClickEventOnDragStart,g=h.preventClickEventByCondition,b=n.isDrag;(p||m||g)&&requestAnimationFrame(function(){n._allowClickEvent()}),!g&&!m&&p&&!b&&n._allowClickEvent(),n._useTouch&&f&&S(v,"touchstart",n.onDragStart),n.pinchFlag&&n.onPinchEnd(l);var w=l!=null&&l.touches?G(l):[],$=w.length;$===0||!n.options.keepDragging?n.flag=!1:n._addStore(new nt(w));var z=n._getPosition(),y=bt(),x=!b&&n.doubleFlag;n._prevInputEvent=null,n.prevTime=b||x?0:y,n.flag||(n._dettachDragEvent(),n._preventMouseEvent||n.emit("dragEnd",E({data:n.data,datas:n.data,isDouble:x,isDrag:b,isClick:!b,isMouseEvent:n._isMouseEvent,isSecondaryButton:n._isSecondaryButton,inputEvent:l,isTrusted:n._isTrusted},z)),n.clientStores=[],n._isMouseEvent||(n._preventMouseEvent=!0,clearTimeout(n._preventMouseEventId),n._preventMouseEventId=setTimeout(function(){n._preventMouseEvent=!1},200)),n._isIdle=!0)}},n.onBlur=function(){n.onDragEnd()},n._allowClickEvent=function(){S(n._window,"click",n._onClick,!0)},n._onClick=function(l){n._allowClickEvent(),n._allowMouseEvent();var h=n.options.preventClickEventByCondition;h!=null&&h(l)||(l.stopPropagation(),l.preventDefault())},n._onContextMenu=function(l){var h=n.options;h.preventRightClick?n.onDragEnd(l):l.preventDefault()},n._passCallback=function(){};var r=[].concat(e),o=r[0];n._window=ii(o)?o:H(o),n.options=E({checkInput:!1,container:o&&!("document"in o)?H(o):o,preventRightClick:!0,preventWheelClick:!0,preventClickEventOnDragStart:!1,preventClickEventOnDrag:!1,preventClickEventByCondition:null,preventDefault:!0,checkWindowBlur:!1,keepDragging:!1,pinchThreshold:0,events:["touch","mouse"]},i);var s=n.options,u=s.container,c=s.events,d=s.checkWindowBlur;if(n._useDrag=c.indexOf("drag")>-1,n._useTouch=c.indexOf("touch")>-1,n._useMouse=c.indexOf("mouse")>-1,n.targets=r,n._useDrag&&r.forEach(function(l){C(l,"dragstart",n.onDragStart)}),n._useMouse&&(r.forEach(function(l){C(l,"mousedown",n.onDragStart),C(l,"mousemove",n._passCallback)}),C(u,"contextmenu",n._onContextMenu)),d&&C(H(),"blur",n.onBlur),n._useTouch){var _={passive:!1};r.forEach(function(l){C(l,"touchstart",n.onDragStart,_),C(l,"touchmove",n._passCallback,_)})}return n}return t.prototype.stop=function(){this.isDrag=!1,this.data={},this.clientStores=[],this.pinchFlag=!1,this.doubleFlag=!1,this.prevTime=0,this.flag=!1,this._isIdle=!0,this._allowClickEvent(),this._dettachDragEvent(),this._isDragAPI=!1},t.prototype.getMovement=function(e){return this.getCurrentStore().getMovement(e)+this.clientStores.slice(1).reduce(function(i,n){return i+n.movement},0)},t.prototype.isDragging=function(){return this.isDrag},t.prototype.isIdle=function(){return this._isIdle},t.prototype.isFlag=function(){return this.flag},t.prototype.isPinchFlag=function(){return this.pinchFlag},t.prototype.isDoubleFlag=function(){return this.doubleFlag},t.prototype.isPinching=function(){return this.isPinch},t.prototype.scrollBy=function(e,i,n,r){r===void 0&&(r=!0),this.flag&&(this.clientStores[0].move(e,i),r&&this.onDrag(n,!0))},t.prototype.move=function(e,i){var n=e[0],r=e[1],o=this.getCurrentStore(),s=o.prevClients;return this.moveClients(s.map(function(u){var c=u.clientX,d=u.clientY;return{clientX:c+n,clientY:d+r,originalClientX:c,originalClientY:d}}),i,!0)},t.prototype.triggerDragStart=function(e){this.onDragStart(e,!1)},t.prototype.setEventData=function(e){var i=this.data;for(var n in e)i[n]=e[n];return this},t.prototype.setEventDatas=function(e){return this.setEventData(e)},t.prototype.getCurrentEvent=function(e){return e===void 0&&(e=this._prevInputEvent),E(E({data:this.data,datas:this.data},this._getPosition()),{movement:this.getMovement(),isDrag:this.isDrag,isPinch:this.isPinch,isScroll:!1,inputEvent:e})},t.prototype.getEventData=function(){return this.data},t.prototype.getEventDatas=function(){return this.data},t.prototype.unset=function(){var e=this,i=this.targets,n=this.options.container;this.off(),S(this._window,"blur",this.onBlur),this._useDrag&&i.forEach(function(r){S(r,"dragstart",e.onDragStart)}),this._useMouse&&(i.forEach(function(r){S(r,"mousedown",e.onDragStart)}),S(n,"contextmenu",this._onContextMenu)),this._useTouch&&(i.forEach(function(r){S(r,"touchstart",e.onDragStart)}),S(n,"touchstart",this.onDragStart)),this._prevInputEvent=null,this._allowClickEvent(),this._dettachDragEvent()},t.prototype.onPinchStart=function(e){var i=this,n=this.options.pinchThreshold;if(!(this.isDrag&&this.getMovement()>n)){var r=new nt(G(e));this.pinchFlag=!0,this._addStore(r);var o=this.emit("pinchStart",E(E({data:this.data,datas:this.data,angle:r.getAngle(),touches:this.getCurrentStore().getPositions()},r.getPosition()),{inputEvent:e,isTrusted:this._isTrusted,preventDefault:function(){e.preventDefault()},preventDrag:function(){i._dragFlag=!1}}));o===!1&&(this.pinchFlag=!1)}},t.prototype.onPinch=function(e,i){if(!(!this.flag||!this.pinchFlag||i.length<2)){var n=this.getCurrentStore();this.isPinch=!0,this.emit("pinch",E(E({data:this.data,datas:this.data,movement:this.getMovement(i),angle:n.getAngle(i),rotation:n.getRotation(i),touches:n.getPositions(i),scale:n.getScale(i),distance:n.getDistance(i)},n.getPosition(i)),{inputEvent:e,isTrusted:this._isTrusted}))}},t.prototype.onPinchEnd=function(e){if(this.pinchFlag){var i=this.isPinch;this.isPinch=!1,this.pinchFlag=!1;var n=this.getCurrentStore();this.emit("pinchEnd",E(E({data:this.data,datas:this.data,isPinch:i,touches:n.getPositions()},n.getPosition()),{inputEvent:e}))}},t.prototype.getCurrentStore=function(){return this.clientStores[0]},t.prototype.moveClients=function(e,i,n){var r=this._getPosition(e,n),o=this.isDrag;(r.deltaX||r.deltaY)&&(this.isDrag=!0);var s=!1;return!o&&this.isDrag&&(s=!0),E(E({data:this.data,datas:this.data},r),{movement:this.getMovement(e),isDrag:this.isDrag,isPinch:this.isPinch,isScroll:!1,isMouseEvent:this._isMouseEvent,isSecondaryButton:this._isSecondaryButton,inputEvent:i,isTrusted:this._isTrusted,isFirstDrag:s})},t.prototype._addStore=function(e){this.clientStores.splice(0,0,e)},t.prototype._getPosition=function(e,i){var n=this.getCurrentStore(),r=n.getPosition(e,i),o=this.clientStores.slice(1).reduce(function(c,d){var _=d.getPosition();return c.distX+=_.distX,c.distY+=_.distY,c},r),s=o.distX,u=o.distY;return E(E({},r),{distX:s,distY:u})},t.prototype._attchDragEvent=function(){var e=this._window,i=this.options.container,n={passive:!1};this._isDragAPI&&(C(i,"dragover",this.onDrag,n),C(e,"dragend",this.onDragEnd)),this._useMouse&&(C(i,"mousemove",this.onDrag),C(e,"mouseup",this.onDragEnd)),this._useTouch&&(C(i,"touchmove",this.onDrag,n),C(e,"touchend",this.onDragEnd,n),C(e,"touchcancel",this.onDragEnd,n))},t.prototype._dettachDragEvent=function(){var e=this._window,i=this.options.container;this._isDragAPI&&(S(i,"dragover",this.onDrag),S(e,"dragend",this.onDragEnd)),this._useMouse&&(S(i,"mousemove",this.onDrag),S(e,"mouseup",this.onDragEnd)),this._useTouch&&(S(i,"touchstart",this.onDragStart),S(i,"touchmove",this.onDrag),S(e,"touchend",this.onDragEnd),S(e,"touchcancel",this.onDragEnd))},t.prototype._allowMouseEvent=function(){this._preventMouseEvent=!1,clearTimeout(this._preventMouseEventId)},t}(_t);function ci(a,t){return t.replace(/([^}{]*){/gm,function(e,i){return i.replace(/\.([^{,\s\d.]+)/g,"."+a+"$1")+"{"})}function ui(a,t){return function(e){var i=e.prototype;a.forEach(function(n){t(i,n)})}}function di(a){for(var t=5381,e=a.length;e;)t=t*33^a.charCodeAt(--e);return t>>>0}var _i=di;function pi(a){return _i(a).toString(36)}function hi(a){if(a&&a.getRootNode){var t=a.getRootNode();if(t.nodeType===11)return t}}function gi(a,t,e){return e.original?t:t.replace(/([^};{\s}][^};{]*|^\s*){/mg,function(i,n){var r=n.trim();return(r?Je(r):[""]).map(function(o){var s=o.trim();return s.indexOf("@")===0?s:s.indexOf(":global")>-1?s.replace(/\:global/g,""):s.indexOf(":host")>-1?"".concat(s.replace(/\:host/g,".".concat(a))):s?".".concat(a," ").concat(s):".".concat(a)}).join(", ")+" {"})}function fi(a,t,e,i,n){var r=dt(i),o=r.createElement("style");return o.setAttribute("type","text/css"),o.setAttribute("data-styled-id",a),o.setAttribute("data-styled-count","1"),e.nonce&&o.setAttribute("nonce",e.nonce),o.innerHTML=gi(a,t,e),(n||r.head||r.body).appendChild(o),o}function vi(a){var t="rCS"+pi(a);return{className:t,inject:function(e,i){i===void 0&&(i={});var n=hi(e),r=(n||e.ownerDocument||document).querySelector('style[data-styled-id="'.concat(t,'"]'));if(!r)r=fi(t,a,i,e,n);else{var o=parseFloat(r.getAttribute("data-styled-count"))||0;r.setAttribute("data-styled-count","".concat(o+1))}return{destroy:function(){var s,u=parseFloat(r.getAttribute("data-styled-count"))||0;u<=1?(r.remove?r.remove():(s=r.parentNode)===null||s===void 0||s.removeChild(r),r=null):r.setAttribute("data-styled-count","".concat(u-1))}}}}}function pt(a,t){for(var e=a.length,i=0;i<e;++i)if(t(a[i],i))return!0;return!1}function Ht(a,t){for(var e=a.length,i=0;i<e;++i)if(t(a[i],i))return a[i];return null}function Wt(a){var t=a;if(typeof t>"u"){if(typeof navigator>"u"||!navigator)return"";t=navigator.userAgent||""}return t.toLowerCase()}function ht(a,t){try{return new RegExp(a,"g").exec(t)}catch{return null}}function mi(){if(typeof navigator>"u"||!navigator||!navigator.userAgentData)return!1;var a=navigator.userAgentData,t=a.brands||a.uaList;return!!(t&&t.length)}function bi(a,t){var e=ht("("+a+")((?:\\/|\\s|:)([0-9|\\.|_]+))",t);return e?e[3]:""}function st(a){return a.replace(/_/g,".")}function N(a,t){var e=null,i="-1";return pt(a,function(n){var r=ht("("+n.test+")((?:\\/|\\s|:)([0-9|\\.|_]+))?",t);return!r||n.brand?!1:(e=n,i=r[3]||"-1",n.versionAlias?i=n.versionAlias:n.versionTest&&(i=bi(n.versionTest.toLowerCase(),t)||i),i=st(i),!0)}),{preset:e,version:i}}function K(a,t){var e={brand:"",version:"-1"};return pt(a,function(i){var n=Vt(t,i);return n?(e.brand=i.id,e.version=i.versionAlias||n.version,e.version!=="-1"):!1}),e}function Vt(a,t){return Ht(a,function(e){var i=e.brand;return ht(""+t.test,i.toLowerCase())})}var Nt=[{test:"phantomjs",id:"phantomjs"},{test:"whale",id:"whale"},{test:"edgios|edge|edg",id:"edge"},{test:"msie|trident|windows phone",id:"ie",versionTest:"iemobile|msie|rv"},{test:"miuibrowser",id:"miui browser"},{test:"samsungbrowser",id:"samsung internet"},{test:"samsung",id:"samsung internet",versionTest:"version"},{test:"chrome|crios",id:"chrome"},{test:"firefox|fxios",id:"firefox"},{test:"android",id:"android browser",versionTest:"version"},{test:"safari|iphone|ipad|ipod",id:"safari",versionTest:"version"}],jt=[{test:"(?=.*applewebkit/(53[0-7]|5[0-2]|[0-4]))(?=.*\\schrome)",id:"chrome",versionTest:"chrome"},{test:"chromium",id:"chrome"},{test:"whale",id:"chrome",versionAlias:"-1",brand:!0}],lt=[{test:"applewebkit",id:"webkit",versionTest:"applewebkit|safari"}],Zt=[{test:"(?=(iphone|ipad))(?!(.*version))",id:"webview"},{test:"(?=(android|iphone|ipad))(?=.*(naver|daum|; wv))",id:"webview"},{test:"webview",id:"webview"}],qt=[{test:"windows phone",id:"windows phone"},{test:"windows 2000",id:"window",versionAlias:"5.0"},{test:"windows nt",id:"window"},{test:"win32|windows",id:"window"},{test:"iphone|ipad|ipod",id:"ios",versionTest:"iphone os|cpu os"},{test:"macos|macintel|mac os x",id:"mac"},{test:"android|linux armv81",id:"android"},{test:"tizen",id:"tizen"},{test:"webos|web0s",id:"webos"}];function Ut(a){return!!N(Zt,a).preset}function wi(a){var t=Wt(a),e=!!/mobi/g.exec(t),i={name:"unknown",version:"-1",majorVersion:-1,webview:Ut(t),chromium:!1,chromiumVersion:"-1",webkit:!1,webkitVersion:"-1"},n={name:"unknown",version:"-1",majorVersion:-1},r=N(Nt,t),o=r.preset,s=r.version,u=N(qt,t),c=u.preset,d=u.version,_=N(jt,t);if(i.chromium=!!_.preset,i.chromiumVersion=_.version,!i.chromium){var l=N(lt,t);i.webkit=!!l.preset,i.webkitVersion=l.version}return c&&(n.name=c.id,n.version=d,n.majorVersion=parseInt(d,10)),o&&(i.name=o.id,i.version=s,i.webview&&n.name==="ios"&&i.name!=="safari"&&(i.webview=!1)),i.majorVersion=parseInt(i.version,10),{browser:i,os:n,isMobile:e,isHints:!1}}function yi(a){var t=navigator.userAgentData,e=(t.uaList||t.brands).slice(),i=t.mobile||!1,n=e[0],r=(t.platform||navigator.platform).toLowerCase(),o={name:n.brand,version:n.version,majorVersion:-1,webkit:!1,webkitVersion:"-1",chromium:!1,chromiumVersion:"-1",webview:!!K(Zt,e).brand||Ut(Wt())},s={name:"unknown",version:"-1",majorVersion:-1};o.webkit=!o.chromium&&pt(lt,function(l){return Vt(e,l)});var u=K(jt,e);if(o.chromium=!!u.brand,o.chromiumVersion=u.version||"-1",!o.chromium){var c=K(lt,e);o.webkit=!!c.brand,o.webkitVersion=c.version||"-1"}var d=Ht(qt,function(l){return new RegExp(""+l.test,"g").exec(r)});s.name=d?d.id:"";{var _=K(Nt,e);o.name=_.brand||o.name,o.version=_.brand&&a?a.uaFullVersion:_.version}return o.webkit&&(s.name=i?"ios":"mac"),s.name==="ios"&&o.webview&&(o.version="-1"),s.version=st(s.version),o.version=st(o.version),s.majorVersion=parseInt(s.version,10),o.majorVersion=parseInt(o.version,10),{browser:o,os:s,isMobile:i,isHints:!0}}function Si(a){return mi()?yi():wi(a)}var ct=function(a,t){return ct=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,i){e.__proto__=i}||function(e,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])},ct(a,t)};function gt(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");ct(a,t);function e(){this.constructor=a}a.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var A=function(){return A=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++){e=arguments[i];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t},A.apply(this,arguments)};function $i(a,t,e,i){var n=arguments.length,r=n<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(a,t,e,i);else for(var s=a.length-1;s>=0;s--)(o=a[s])&&(r=(n<3?o(r):n>3?o(t,e,r):o(t,e))||r);return n>3&&r&&Object.defineProperty(t,e,r),r}function $t(a,t,e){if(e||arguments.length===2)for(var i=0,n=t.length,r;i<n;i++)(r||!(i in t))&&(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return a.concat(r||Array.prototype.slice.call(t))}var Ci=Si(),zi=Ci.browser.name==="safari",I="infinite-viewer-",Ct="".concat(I,"wrapper"),zt="".concat(I,"scroll-area"),xi="".concat(I,"scroll-bar"),Gt="".concat(I,"horizontal-scroll-bar"),Kt="".concat(I,"vertical-scroll-bar"),xt="".concat(I,"scroll-thumb"),Jt=vi(ci(I,`
{
    position: relative;
    overscroll-behavior: none;
}
.wrapper {
    position: absolute;
    width: 100%;
    height: 100%;
    overflow: auto;
    scrollbar-width: none;
    top: 0;
    left: 0;
    will-change: scroll-position;
}
.restrict-wrapper {
    position: absolute;
    width: 100%;
    height: 100%;
    top: 0;
    left: 0;
}
.wrapper::-webkit-scrollbar {
    display: none;
}
.scroll-area {
    position:absolute;
    top:0;
    left:0;
    transform-origin: 0 0;
}
.scroll-bar {
    position:absolute;
    width: 10px;
    height: 10px;
    box-sizing: border-box;
    right: 0;
    bottom: 0;
    overflow: hidden;
}
.horizontal-scroll-bar {
    width: calc(100% - 20px);
    right: 10px;
    height: 14px;
}
.vertical-scroll-bar {
    height: calc(100% - 20px);
    bottom: 10px;
    width: 14px;
}
.scroll-thumb {
    position:relative;
    opacity: 0.7;
    background: #333;
    border-radius: 3px;
    left: 0px;
    top: 0px;
    z-index: 10;
    width: 6px;
    height: 6px;
    transition: all ease 0.2s;
    opacity: 0;
}
.scroll-bar:hover .scroll-thumb {
    border-radius: 5px;
    opacity: 1;
}
.horizontal-scroll-bar .scroll-thumb {
    margin: 4px 0px;
    transition-property: opacity, margin, height, border-radius;
}
.vertical-scroll-bar .scroll-thumb {
    margin: 0px 4px;
    transition-property: opacity, margin, width, border-radius;
}
.horizontal-scroll-bar:hover .scroll-thumb {
    height: 10px;
    margin: 2px 0px;
}
.vertical-scroll-bar:hover .scroll-thumb {
    width: 10px;
    margin: 0px 2px;
}
`)),T={margin:500,threshold:100,zoom:1,zoomX:1,zoomY:1,rangeX:[-1/0,1/0],rangeY:[-1/0,1/0],rangeOffsetX:[0,0],rangeOffsetY:[0,0],wrapperElement:null,scrollAreaElement:null,horizontalScrollElement:null,verticalScrollElement:null,usePinch:!1,useAutoZoom:!1,useMouseDrag:!1,pinchThreshold:30,cspNonce:"",maxPinchWheel:1/0,wheelScale:.01,displayHorizontalScroll:!0,displayVerticalScroll:!0,useTransform:!0,useWheelPinch:!0,zoomRange:[.001,1/0],wheelPinchKey:"ctrl",useWheelScroll:zi,zoomOffsetX:"50%",zoomOffsetY:"50%",translateZ:0,useGesture:!0,useResizeObserver:!1,pinchDirection:"all",preventWheelClick:!0,useBounceScrollBar:!1,useOverflowScroll:!1},Pt=function(a){return 1-Math.pow(1-a,3)},Et={horizontal:{pos:"Left",coord:"X",size:"Width"},vertical:{pos:"Top",coord:"Y",size:"Height"}},Pi=Jt.className,ft=["margin","threshold","zoomOffsetX","zoomOffsetY","zoom","zoomX","zoomY","rangeX","rangeY","rangeOffsetX","rangeOffsetY","usePinch","useMouseDrag","pinchThreshold","maxPinchWheel","wheelScale","displayVerticalScroll","displayHorizontalScroll","translateZ","useAutoZoom","wheelPinchKey","zoomRange","zoomRangeX","zoomRangeY","pinchDirection","useOverflowScroll"],Mt=$t($t([],ft,!0),["preventWheelClick","useWheelPinch","useWheelScroll","useGesture","cspNonce","wrapperElement","scrollAreaElement","verticalScrollElement","horizontalScrollElement","useResizeObserver","wheelContainer","useBounceScrollBar"],!1),Ei=["scroll","abortPinch","dragStart","dragEnd","pinchStart","pinch"],Mi=["getScrollLeft","getScrollTop","getScrollWidth","getScrollHeight","getContainerWidth","getContainerHeight","getViewportWidth","getViewportHeight","getViewportScrollWidth","getViewportScrollHeight","scrollTo","scrollBy","zoomBy","scrollCenter","getContainer","getViewport","getWrapper","setZoom","getRangeX","getRangeY","resize","getZoom","getZoomX","getZoomY","getWheelContainer","setTo","setBy"],ki=1e-6;function Ti(a){var t=a.deltaX,e=a.deltaY,i=a.datas,n=Date.now(),r=i.speed;if(!r){i.speed=[0,0],i.time=n;return}var o=n-i.time;i.speed=[r[0]/2+t/o,r[1]/2+e/o]}function Qt(a,t){var e=Math.sqrt(a[0]*a[0]+a[1]*a[1]);return Math.abs(e/t)}function Di(a,t){var e=Qt(a,t);return[-a[0]/2*e,-a[1]/2*e]}function X(a){return Math.abs(a)}function Ai(a,t,e,i,n){var r=n||isFinite(e[0])?e[0]:Math.min(-1,Math.floor(a/t))*t-i,o=n||isFinite(e[1])?e[1]:Math.max(1,Math.ceil(a/t))*t+i;return[r,o]}function kt(a,t){return a??t}function Tt(a,t,e){var i=e.duration,n=e.easing||function(u){return 1-Math.pow(1-u,3)},r=Date.now(),o=r,s=function(){var u=Date.now(),c=u-r;i<c&&(c=i);var d=n(c/i),_=n((o-r)/i);o=u,a(d-_),!(c>=i)&&t(s)};t(s)}var Dt=function(a){gt(t,a);function t(i,n,r){var o=a.call(this)||this;o.type=n,o.isAppend=!1,o.size=0,o.scrollSize=0,o.isHorizontal=!1,o._onDragStart=function(_){var l=o.isHorizontal,h=_.inputEvent.target,f=_.datas,v=o.thumbElement===h;v||setTimeout(function(){requestAnimationFrame(function(){var p=o.thumbElement.getBoundingClientRect(),m=p[l?"left":"top"],g=p[l?"width":"height"],b=m+g,w=_[l?"clientX":"clientY"];if(!(m<=w&&w<=b)){var $=o.size,z=$*$/o.scrollSize;o.scrollBy(m<w?z:-z)}})},100),f.isThumb=v,_.inputEvent.stopPropagation(),_.inputEvent.preventDefault()},o._onDrag=function(_){_.datas.isThumb&&o.scrollBy(o.isHorizontal?_.deltaX:_.deltaY)},o._onWheel=function(_){var l=o.isHorizontal?_.deltaX:_.deltaY;l&&_.preventDefault(),o.trigger("scroll",{delta:l})};var s=n==="horizontal",u=dt(i),c,d=r;return r?c=r.querySelector(".".concat(xt)):(d=u.createElement("div"),c=u.createElement("div"),d.insertBefore(c,null),o.isAppend=!0),F(d,s?Gt:Kt),F(d,xi),F(c,xt),o.thumbElement=c,o.barElement=d,o.isHorizontal=s,o.gesto=new Ft(d,{container:H(u)}).on("dragStart",function(_){return o._onDragStart(_)}).on("drag",function(_){return o._onDrag(_)}),C(o.barElement,"wheel",o._onWheel,{passive:!1}),o}var e=t.prototype;return e.scrollBy=function(i,n){var r=i/this.size;this.trigger("scroll",{delta:n?i:this.scrollSize*r})},e.render=function(i,n,r,o){this.size=r,this.scrollSize=o;var s=i&&ei(o-r,.001)>0?1:0,u=this.isHorizontal?["X","width"]:["Y","height"],c=u[0],d=u[1],_=r/o*100,l=Math.max(0,n)/o*100;this.thumbElement.style.cssText+="".concat(d,": ").concat(_,"%;opacity: ").concat(s,";")+"transform: translate".concat(c,"(").concat(100/_*l,"%)")},e.destroy=function(){S(this.barElement,"wheel",this._onWheel),this.gesto.off(),this.off()},t}(_t),Oi=function(a){gt(t,a);function t(i,n,r){n===void 0&&(n={}),r===void 0&&(r={});var o=a.call(this)||this;return o._containerElement=i,o.offsetX=0,o.offsetY=0,o.containerWidth=0,o.containerHeight=0,o.viewportWidth=0,o.viewportHeight=0,o.viewportScrollWidth=0,o.viewportScrollHeight=0,o.scrollLeft=0,o.scrollTop=0,o._scrollTimer=0,o._zoomTimer=0,o._viewportElement=null,o._wheelContainerElement=null,o.dragFlag=!1,o.isLoop=!1,o._tempScale=[1,1],o._tempRect=null,o._tempRectTimer=null,o._onDestroys=[],o._asLeft=0,o._asTop=0,o.resize=function(){var s=o._containerElement,u=s.offsetWidth,c=s.offsetHeight,d=o._viewportElement,_=d.offsetWidth,l=d.offsetHeight,h=d.scrollWidth,f=d.scrollHeight;o.containerWidth=u,o.containerHeight=c,o.viewportWidth=_,o.viewportHeight=l,o.viewportScrollWidth=Math.max(_,h),o.viewportScrollHeight=Math.max(l,f),o.render(),o._scrollBy(0,0)},o._onScroll=function(){var s=o.wrapperElement,u=s.scrollLeft,c=s.scrollTop,d=o.zoom,_=d===void 0?T.zoom:d,l=u-o.scrollLeft,h=c-o.scrollTop,f=o.getScrollLeft(),v=o.getScrollTop();o.isLoop&&(o.isLoop=!1),o.scrollLeft=u,o.scrollTop=c,o.scrollTo(f+l/_,v+h/_)},o.onWheel=function(s){var u=o.options,c=u.pinchDirection,d=u.maxPinchWheel||1/0,_=s["".concat(o.wheelPinchKey,"Key")]||s.ctrlKey;if(u.useWheelPinch&&_){var l=s.deltaY,h=l>=0?1:-1,f=Math.min(d,Math.abs(l));l=h*f;var v=-l,p=Math.max(1+v*(u.wheelScale||.01),ki);clearTimeout(o._tempRectTimer),o._tempRectTimer=window.setTimeout(function(){o._tempRect=null},100),o._triggerPinch({distance:f,scale:p,rotation:0,zoom:o.zoom*p,zoomX:o.zoomX*(c==="vertical"?1:p),zoomY:o.zoomY*(c==="horizontal"?1:p),inputEvent:s,isWheel:!0,clientX:s.clientX,clientY:s.clientY,ratioX:0,ratioY:0})}else if(u.useWheelScroll){var m=s.deltaX,l=s.deltaY;s.shiftKey&&!m&&(m=l,l=0),o.scrollBy(m/o.zoomX,l/o.zoomY)}else return;s.preventDefault()},o.onGestureStart=function(s){o._tempScale=[o.zoomX,o.zoomY],o._setClientRect(),s.preventDefault()},o.onGestureChange=function(s){if(s.preventDefault(),o.gesto.isFlag()||!o._tempScale){o._tempScale=[1,1];return}var u=s.scale,c=o._tempScale[0],d=o._tempScale[1],_=o.options.pinchDirection;o._triggerPinch({distance:0,scale:u,rotation:s.rotation,inputEvent:s,isWheel:!0,zoom:(c+d)*u/2,zoomX:c*(_==="vertical"?1:u),zoomY:d*(_==="horizontal"?1:u),clientX:s.clientX,clientY:s.clientY,ratioX:0,ratioY:0})},o.onGestureEnd=function(){},wt(n)?(o._viewportElement=n,o.options=A(A({},T),r)):(o._viewportElement=i.children[0],o.options=A(A({},T),n)),o.init(),o}var e=t.prototype;return e.getContainer=function(){return this._containerElement},e.getWheelContainer=function(){return this._wheelContainerElement},e.getViewport=function(){return this._viewportElement},e.getWrapper=function(){return this.wrapperElement},e.geScrollArea=function(){return this.scrollAreaElement},e.destroy=function(){this.off(),this.gesto.unset(),this.verticalScrollbar.destroy(),this.horizontalScrollbar.destroy(),this.injectResult.destroy();var i=this._containerElement;this._onDestroys.forEach(function(n){n()}),S(this.wrapperElement,"scroll",this._onScroll),S(this._wheelContainerElement,"wheel",this.onWheel),S(i,"gesturestart",this.onGestureStart),S(i,"gesturechange",this.onGestureChange),S(i,"gesturesend",this.onGestureEnd),this.gesto=null,this.injectResult=null,this._containerElement=null,this._viewportElement=null,this.options=null},e.getScrollTop=function(i){i===void 0&&(i={});var n=!1,r=!1;W(i)?(n=i.range,r=i.absolute):n=i;var o=this.zoomY,s=this.scrollTop/o+this.offsetY+(n?X(this.getRangeY()[0]):0);return r?s*o:s},e.getScrollLeft=function(i){i===void 0&&(i={});var n=!1,r=!1;W(i)?(n=i.range,r=i.absolute):n=i;var o=this.zoomX,s=this.scrollLeft/o+this.offsetX+(n?X(this.getRangeX()[0]):0);return r?s*o:s},e.getScrollWidth=function(i){var n=this._getScrollRangeX(),r=this.zoomX,o=this.containerWidth/r+X(n[0])+n[1];return i?o:o*r},e.getScrollHeight=function(i){var n=this._getScrollRangeY(),r=this.zoomY,o=this.containerHeight/r+X(n[0])+n[1];return i?o:o*r},e.scrollCenter=function(i){i===void 0&&(i={}),this.resize();var n=this.zoomX,r=this.zoomY,o=-(this.containerWidth/n-this.viewportWidth)/2,s=-(this.containerHeight/r-this.viewportHeight)/2;return i.absolute&&(o*=n,s*=r),i.horizontal===!1&&(o=this.getScrollLeft()),i.vertical===!1&&(s=this.getScrollTop()),this.scrollTo(o,s,i)},e.setTo=function(i){var n=i.x,r=n===void 0?this.getScrollLeft():n,o=i.y,s=o===void 0?this.getScrollTop():o,u=i.zoom,c=u===void 0?[this.getZoomX(),this.getZoomY()]:u,d=i.duration,_=this,l=_.zoomX,h=_.zoomY,f=_.zoomRange,v=this,p=v.zoomOffsetX,m=p===void 0?T.zoomOffsetX:p,g=v.zoomOffsetY,b=g===void 0?T.zoomOffsetY:g;"zoomOffsetX"in i&&(m=i.zoomOffsetX),"zoomOffsetY"in i&&(b=i.zoomOffsetY);var w=V(c)?c:[c,c],$=w[0],z=w[1],y=this.zoomRangeX||f,x=this.zoomRangeY||f,P=L($,y[0],y[1]),O=L(z,x[0],x[1]),Y=B("".concat(m),this.viewportWidth)*(1/l-1/P),k=B("".concat(b),this.viewportHeight)*(1/h-1/O);this.scrollTo(r-Y,s-k,{duration:d}),this.setZoom(c,{zoomOffsetX:m,zoomOffsetY:b,duration:d,zoomBase:"fixed"})},e.setBy=function(i){var n=i.x,r=n===void 0?0:n,o=i.y,s=o===void 0?0:o,u=i.zoom,c=u===void 0?[0,0]:u,d=V(c)?c:[c,c],_=d[0],l=d[1];this.setTo(A(A({},i),{x:this.getScrollLeft()+r,y:this.getScrollTop()+s,zoom:[this.zoomX+_,this.zoomY+l]}))},e.scrollBy=function(i,n,r){if(this._pauseScrollAnimation(),!r||!r.duration){var o=this.getScrollLeft(),s=this.getScrollTop();return r!=null&&r.absolute&&(o*=this.zoomX,s*=this.zoomY),this._scrollTo(o+i,s+n,r)}else return this._startScrollAnimation([i,n],r),!0},e.scrollTo=function(i,n,r){if(this._pauseScrollAnimation(),!r||!r.duration)return this._scrollTo(i,n,r);var o=this.getScrollLeft(),s=this.getScrollTop();return r!=null&&r.absolute&&(o*=this.zoomX,s*=this.zoomY),this.scrollBy(i-o,n-s,r)},e.zoomBy=function(i,n){this._pauseZoomAnimation();var r=V(i)?i:[i,i],o=r[0],s=r[1];!n||!n.duration?this._setZoom([this.zoomX+o,this.zoomY+s],n):this._startZoomAnimation([o,s],n)},e.setZoom=function(i,n){if(this._pauseZoomAnimation(),!n||!n.duration)this._setZoom(i,n);else{var r=V(i)?i:[i,i],o=r[0],s=r[1];this._startZoomAnimation([o-this.zoomX,s-this.zoomY],n)}},e.getViewportWidth=function(){return this.viewportWidth},e.getViewportHeight=function(){return this.viewportWidth},e.getViewportScrollWidth=function(){return this.viewportScrollWidth},e.getViewportScrollHeight=function(){return this.viewportScrollHeight},e.getContainerWidth=function(){return this.containerWidth},e.getContainerHeight=function(){return this.containerHeight},e.getZoom=function(){return(this.zoomX+this.zoomY)/2},e.getZoomX=function(){return this.zoomX},e.getZoomY=function(){return this.zoomY},e.getRangeX=function(i,n){return this._getRangeCoord("horizontal",i,n)},e.getRangeY=function(i,n){return this._getRangeCoord("vertical",i,n)},e.init=function(){var i=this,n,r=this._containerElement,o=this.options,s=dt(r),u=H(r),c=o.wrapperElement||r.querySelector(".".concat(Ct)),d=o.scrollAreaElement||r.querySelector(".".concat(zt)),_=o.horizontalScrollElement||r.querySelector(".".concat(Gt)),l=o.verticalScrollElement||r.querySelector(".".concat(Kt));c||(c=s.createElement("div"),c.insertBefore(this._viewportElement,null),r.insertBefore(c,null)),this.wrapperElement=c,d||(d=s.createElement("div"),c.insertBefore(d,c.firstChild)),this.scrollAreaElement=d,F(r,Pi),F(c,Ct),F(d,zt);var h=new Dt(r,"horizontal",_),f=new Dt(r,"vertical",l);this.horizontalScrollbar=h,this.verticalScrollbar=f,h.on("scroll",function(g){i.scrollBy(g.delta/i.zoomX,0)}),f.on("scroll",function(g){i.scrollBy(0,g.delta/i.zoomY)}),h.isAppend&&r.insertBefore(h.barElement,null),f.isAppend&&r.insertBefore(f.barElement,null),this.injectResult=Jt.inject(r,{nonce:this.options.cspNonce});var v=o.wheelContainer,p=null;if(v&&(Rt(v)?p=s.querySelector(v):wt(v)?p=v:("value"in v||"current"in v)&&(p=v.current||v.value)),p||(p=r),this._wheelContainerElement=p,this.gesto=new Ft(r,{container:H(r),events:["touch","mouse"],preventWheelClick:(n=this.options.preventWheelClick)!==null&&n!==void 0?n:!0}).on("dragStart",function(g){var b=g.inputEvent,w=g.stop,$=g.datas;if(!i.useMouseDrag&&g.isMouseEvent){w();return}i._pauseScrollAnimation(),i.dragFlag=!1;var z=i.trigger("dragStart",g);if(z===!1){w();return}b.preventDefault(),$.startEvent=b}).on("drag",function(g){!i.options.usePinch||g.isPinch||i.useMouseDrag&&g.isMouseEvent?(i.trigger("drag",A(A({},g),{inputEvent:g.inputEvent})),Ti(g),i.scrollBy(-g.deltaX/i.zoomX,-g.deltaY/i.zoomY)):!i.dragFlag&&g.movement>o.pinchThreshold&&(i.dragFlag=!0,i.trigger("abortPinch",{inputEvent:g.datas.startEvent||g.inputEvent}))}).on("dragEnd",function(g){i.trigger("dragEnd",{isDrag:g.isDrag,isDouble:g.isDouble,inputEvent:g.inputEvent}),i._startScrollAnimationBySpeed(g.datas.speed)}).on("pinchStart",function(g){var b=g.inputEvent,w=g.datas,$=g.stop;b.preventDefault(),i._pauseScrollAnimation(),w.startZoom=[i.zoomX,i.zoomY];var z=i.trigger("pinchStart",{inputEvent:b});z===!1&&$(),i._setClientRect()}).on("pinch",function(g){var b=g.scale,w=i.options.pinchDirection;i._triggerPinch({rotation:g.rotation,distance:g.distance,scale:g.scale,inputEvent:g.inputEvent,isWheel:!1,zoom:g.datas.startZoom*b,zoomX:i.zoomX*(w==="vertical"?1:b),zoomY:i.zoomY*(w==="horizontal"?1:b),clientX:g.clientX,clientY:g.clientY,ratioX:0,ratioY:0})}).on("pinchEnd",function(){i._tempRect=null}),C(c,"scroll",this._onScroll),o.useResizeObserver){var m=new u.ResizeObserver(function(){i.resize()});m.observe(this._viewportElement),m.observe(this._containerElement),this._onDestroys.push(function(){m.disconnect()})}else C(u,"resize",this.resize),this._onDestroys.push(function(){S(u,"resize",i.resize)});(o.useWheelPinch||o.useWheelScroll)&&C(p,"wheel",this.onWheel,{passive:!1}),o.useGesture&&(C(r,"gesturestart",this.onGestureStart,{passive:!1}),C(r,"gesturechange",this.onGestureChange,{passive:!1})),this.resize()},e.render=function(){var i=this,n=i.offsetX,r=i.offsetY,o=i.zoomX,s=o===void 0?T.zoomX:o,u=i.zoomY,c=u===void 0?T.zoomY:u,d=i.translateZ,_=d===void 0?0:d;i.rangeX,i.rangeY,i.containerWidth,i.containerHeight;var l=this.options.useTransform,h=l===void 0?T.useTransform:l,f=-n*s,v=-r*c;this.scrollAreaElement.style.cssText="width:calc(100% + ".concat(this.getScrollAreaWidth(),"px);")+"height:calc(100% + ".concat(this.getScrollAreaHeight(),"px);");var p=this._viewportElement.style;h===!1?p.cssText+="position: relative; left: ".concat(f,"px; top: ").concat(v,"px; "):p.cssText+="transform-origin: 0 0;"+"transform:translate3d(".concat(f,"px, ").concat(v,"px, ").concat(_,"px) scale(").concat(s,", ").concat(c,");"),this.renderScroll()},e.renderScroll=function(){var i=this,n=i.zoomX,r=i.zoomY,o=i.containerWidth,s=i.containerHeight,u=this.horizontalScrollbar,c=this.verticalScrollbar;if(this.options.useBounceScrollBar){var d=this.getScrollLeft(!0)*n,_=this.getRangeX(!0),l=o+X(_[0])+X(_[1]),h=this.getScrollTop(!0)*r,f=this.getRangeY(!0),v=s+X(f[0])+X(f[1]);u.render(this.displayHorizontalScroll,d,o,l),c.render(this.displayVerticalScroll,h,s,v)}else{var p=this._getScrollRangeX(),m=this._getScrollRangeY(),d=this.getScrollLeft(),h=this.getScrollTop(),l=this.containerWidth+X(p[0])+p[1],v=this.containerHeight+X(m[0])+m[1];u.render(this.displayHorizontalScroll,d-p[0],o,l),c.render(this.displayVerticalScroll,h-m[0],s,v)}},e.move=function(i,n){var r=this.wrapperElement;r.scrollLeft=i,r.scrollTop=n},e.setDisplayVerticalScroll=function(i){this.options.displayVerticalScroll=i,this.renderScroll()},e.setDisplayHorizontalScroll=function(i){this.options.displayHorizontalScroll=i,this.renderScroll()},e._startZoomAnimation=function(i,n){var r=this;if(i){var o=n.duration,s=n.easing||Pt;Tt(function(u){return r._setZoom([r.zoomX+i[0]*u,r.zoomY+i[1]*u],n)},function(u){r._zoomTimer=requestAnimationFrame(u)},{easing:s,duration:o})}},e._startScrollAnimation=function(i,n){var r=this;if(!(!i[0]&&!i[1])){var o=n.duration,s=n.easing||Pt;Tt(function(u){return r._scrollBy(i[0]*u,i[1]*u,n)},function(u){r._scrollTimer=requestAnimationFrame(u)},{easing:s,duration:o})}},e._startScrollAnimationBySpeed=function(i){if(!(!i||!i[0]&&!i[1])){var n=-6e-4,r=Qt(i,n),o=Di(i,n);return this._startScrollAnimation(o,{duration:r})}},e._pauseScrollAnimation=function(){cancelAnimationFrame(this._scrollTimer),this._scrollTimer=0},e._pauseZoomAnimation=function(){cancelAnimationFrame(this._zoomTimer),this._zoomTimer=0},e.getScrollAreaWidth=function(){var i=this.getRangeX(!0),n=i[0],r=i[1];return n||r?this.margin*2:0},e.getScrollAreaHeight=function(){var i=this.getRangeY(!0),n=i[0],r=i[1];return n||r?this.margin*2:0},e._triggerPinch=function(i){var n=i.clientX,r=i.clientY,o=i.zoomX,s=i.zoomY;this.useAutoZoom&&this._zoomByClient([o,s],n,r),this._tempRect||this._setClientRect();var u=this.zoomRange,c=this.zoomRangeX||u,d=this.zoomRangeY||u,_=this._tempRect,l=_.left,h=_.top,f=_.width,v=_.height,p=(n-l)/f*100,m=(r-h)/v*100;this.trigger("pinch",A(A({},i),{zoom:L((o+s)/2,u[0],u[1]),zoomX:L(o,c[0],c[1]),zoomY:L(s,d[0],d[1]),ratioX:p,ratioY:m}))},e._setClientRect=function(){var i=this.getContainer().getBoundingClientRect();this._tempRect={left:i.left,top:i.top,width:i.width,height:i.height}},e._zoomByClient=function(i,n,r){this._tempRect||this._setClientRect();var o=this._tempRect,s=o.left,u=o.top,c=o.width,d=o.height,_=this.options,l=_.zoomOffsetX,h=_.zoomOffsetY;_.zoomOffsetX="".concat((n-s)/c*100,"%"),_.zoomOffsetY="".concat((r-u)/d*100,"%"),this._setZoom(i,{zoomBase:"screen"}),_.zoomOffsetX=l,_.zoomOffsetY=h},e._setZoom=function(i,n){n===void 0&&(n={});var r=n.zoomBase,o=this,s=o.containerWidth,u=o.containerHeight,c=o.zoomX,d=o.zoomY,_=o.zoomRange,l=this,h=l.zoomOffsetX,f=h===void 0?T.zoomOffsetX:h,v=l.zoomOffsetY,p=v===void 0?T.zoomOffsetY:v;"zoomOffsetX"in n&&(f=n.zoomOffsetX),"zoomOffsetY"in n&&(p=n.zoomOffsetY);var m=this.getScrollLeft(),g=this.getScrollTop(),b=V(i)?i:[i,i],w=b[0],$=b[1],z=this.zoomRangeX||_,y=this.zoomRangeY||_,x=L(w,z[0],z[1]),P=L($,y[0],y[1]),O=this.options;O.zoomX=x,O.zoomY=P,O.zoom=(x+P)/2;var Y=this.getScrollLeft(),k=this.getScrollTop(),M=0,R=0;r==="fixed"?(M=B("".concat(f),this.viewportWidth),R=B("".concat(p),this.viewportHeight)):r==="viewport"?(M=(-m+B("".concat(f),this.viewportWidth))*c,R=(-g+B("".concat(p),this.viewportHeight))*d):(M=B("".concat(f),s),R=B("".concat(p),u));var J=m+M/c,q=g+R/d,Q=Y+M/x,tt=k+R/P;this._scrollBy(J-Q,q-tt,{zoom:!!(x-c||P-d)}),this.render()},e._scrollBy=function(i,n,r){var o=this.getScrollLeft(),s=this.getScrollTop();return r!=null&&r.absolute&&(o*=this.zoomX,s*=this.zoomY),this._scrollTo(o+i,s+n,r)},e._scrollTo=function(i,n,r){var o=this,s=this,u=s.scrollLeft,c=s.scrollTop,d=r==null?void 0:r.absolute;this._scrollToType("horizontal",i,d),this._scrollToType("vertical",n,d);var _=this.scrollLeft,l=this.scrollTop;this.render();var h=this.getScrollLeft(),f=this.getScrollTop();return this._emitScrollEvent(h,f,r==null?void 0:r.zoom),Math.round(u)!==_||Math.round(c)!==l?(this.isLoop=!0,this.move(_,l),requestAnimationFrame(function(){if(o.isLoop){o.isLoop=!1;var v=o.wrapperElement,p=v.scrollLeft,m=v.scrollTop;o.scrollLeft=p,o.scrollTop=m,(_!==Math.round(p)||l!==Math.round(m))&&o._scrollTo(h,f)}}),!1):!0},e._scrollToType=function(i,n,r){var o=Et[i],s=this,u=s.margin,c=u===void 0?T.margin:u,d=s.threshold,_=d===void 0?T.threshold:d,l=this["scroll".concat(o.pos)],h=this["getRange".concat(o.coord)](!0,!0),f=h[0],v=h[1],p=Math.round(l),m=this["getScrollArea".concat(o.size)](),g=this["zoom".concat(o.coord)];r&&(n=n/g);var b=n*g;if(f===v)p=f,n=f/g;else if(b-_<=f){var w=Math.max(0,b-f);p=w,n=(f+w)/g}else if(b+_>=v){var $=Math.max(0,v-b);p=m-$,n=(v-$)/g}else p<_?p+=c:p>m-_&&(p-=c);p=Math.round(p),this["scroll".concat(o.pos)]=p,this["offset".concat(o.coord)]=n-p/g},e._getRangeCoord=function(i,n,r){var o=this,s=o.margin,u=s===void 0?T.margin:s,c=o.threshold,d=Et[i],_=kt(this["range".concat(d.coord)],T["range".concat(d.coord)]),l=kt(this["rangeOffset".concat(d.coord)],T["rangeOffset".concat(d.coord)]),h=this["zoom".concat(d.coord)],f=Ai(this["getScroll".concat(d.pos)](),u,_,c,r);return n?[f[0]*h+l[0],this.options.useOverflowScroll?Math.max(this["viewport".concat(d.size)]*h-this["container".concat(d.size)],f[1]*h+l[1]):f[1]*h+l[1]]:[f[0]+l[0],f[1]+l[1]]},e._emitScrollEvent=function(i,n,r){var o=this._asLeft,s=this._asTop;!r&&o===i&&s===n||(this._asLeft=i,this._asTop=n,this.trigger("scroll",{scrollLeft:i,scrollTop:n,zoomX:this.zoomX,zoomY:this.zoomY}))},e._getScrollRangeX=function(){var i=this.getScrollLeft(),n=this.rangeX,r=n[0],o=n[1];this.useOverflowScroll&&isFinite(o)&&(o=Math.max(o,this.viewportWidth-this.containerWidth/this.zoomX));var s=Math.min(0,isFinite(r)?Math.min(r,i):i),u=Math.max(0,isFinite(o)?Math.max(o,i):i),c=this.viewportScrollWidth,d=Math.max(this.containerWidth/this.zoomX,c)-c,_=Math.min(0,d+s);return[_,u]},e._getScrollRangeY=function(){var i=this.getScrollTop(),n=this.rangeY,r=n[0],o=n[1];this.useOverflowScroll&&isFinite(o)&&(o=Math.max(o,this.viewportHeight-this.containerHeight/this.zoomY));var s=Math.min(0,isFinite(r)?Math.min(r,i):i),u=Math.max(0,isFinite(o)?Math.max(o,i):i),c=this.viewportScrollHeight,d=Math.max(this.containerHeight/this.zoomY,c)-c,_=Math.min(0,d+s);return[_,u]},t=$i([ui(ft,function(i,n){var r={enumerable:!0,configurable:!0,get:function(){return this.options[n]}},o=ti("set ".concat(n));i[o]?r.set=function(s){this[o](s)}:r.set=function(s){this.options[n]=s},Object.defineProperty(i,n,r)})],t),t}(_t),Yi=function(a){gt(t,a);function t(){return a!==null&&a.apply(this,arguments)||this}return t}(Oi),Z=function(){return Z=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++){e=arguments[i];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t},Z.apply(this,arguments)},te={};Mi.forEach(function(a){te[a]=function(){for(var t,e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];return(t=this.infiniteViewer)[a].apply(t,e)}});var Ri={name:"infinite-viewer",methods:te,props:Mt,mounted:function(){var a=this,t={},e=this.$props;Mt.forEach(function(r){var o=e[r];mt(o)||(t[r]=e[r])});var i=this.$refs;this.infiniteViewer=new Yi(i.containerElement,i.scrollAreaElement.nextElementSibling,Z(Z({},t),{wrapperElement:i.wrapperElement,scrollAreaElement:i.scrollAreaElement,horizontalScrollElement:i.horizontalScrollElement,verticalScrollElement:i.verticalScrollElement}));var n=this.infiniteViewer;Ei.forEach(function(r){n.on(r,function(o){a.$emit(r,Z({},o))})})},updated:function(){var a=this.$props,t=this.infiniteViewer;ft.forEach(function(e){var i=a[e];t[e]!==i&&!mt(i)&&(t[e]=a[e])})},beforeDestroy:function(){this.infiniteViewer.destroy()}};function Xi(a,t,e,i,n,r,o,s,u,c){const d=typeof e=="function"?e.options:e;return a&&a.render&&(d.render=a.render,d.staticRenderFns=a.staticRenderFns,d._compiled=!0),e}const Bi=Ri;var ee=function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",{ref:"containerElement"},[e("div",{ref:"wrapperElement"},[e("div",{ref:"scrollAreaElement"}),a._v(" "),a._t("default")],2),a._v(" "),e("div",{ref:"horizontalScrollElement"},[e("div",{staticClass:"infinite-viewer-scroll-thumb"})]),a._v(" "),e("div",{ref:"verticalScrollElement"},[e("div",{staticClass:"infinite-viewer-scroll-thumb"})])])},Li=[];ee._withStripped=!0;const Ii=void 0,Fi=Xi({render:ee,staticRenderFns:Li},Ii,Bi),Hi={props:{scale:Number},components:{VueInfiniteViewer:Fi},data(){return{viewerOptions:{},scroll_left:void 0,scroll_top:void 0,debounce_zoom:void 0,debounce_scroll:void 0}},created(){this.viewerOptions={useMouseDrag:!0,useWheelScroll:!0,useAutoZoom:!0,zoomRange:[.4,10],maxPinchWheel:10,displayVerticalScroll:!0,displayHorizontalScroll:!0}},mounted(){this.$nextTick(()=>{this.scrollToCorner({animate:!1})}),this.$eventHub.$on("panzoom.panTo",this.panTo)},beforeDestroy(){this.$eventHub.$off("panzoom.panTo",this.panTo),this.$root.set_new_module_offset_left=0,this.$root.set_new_module_offset_top=0},watch:{scale(){this.updateScale(this.scale)}},computed:{panzoom_rangex(){const a=this.$root.window.innerWidth-100;return[-a,a]},panzoom_rangey(){const a=this.$root.window.innerHeight-100;return[-a,a]}},methods:{onScroll(){this.debounce_scroll&&clearTimeout(this.debounce_scroll),this.debounce_scroll=setTimeout(async()=>{this.$root.set_new_module_offset_left=Math.max(0,this.$refs.viewer.getScrollLeft()),this.$root.set_new_module_offset_top=Math.max(0,this.$refs.viewer.getScrollTop())},500)},dragStart(a){console.log("dragStart"),a.inputEvent.target.classList.contains("panzoom-exclude")&&a.stop()},dragEnd(a){console.log("dragEnd"),a.isDrag||this.disableActiveModule()},pinchStart(){console.log("pinchStart")},abortPinch(){console.log("abortPinch")},pinch(){this.debounce_zoom&&clearTimeout(this.debounce_zoom),this.debounce_zoom=setTimeout(async()=>{const a=this.$refs.viewer.getZoom();a!==this.scale&&this.$emit("update:scale",a)},500)},panTo({x:a,y:t}){this.scrollToCorner({x:a,y:t,animate:!0})},scrollToCorner({x:a,y:t,animate:e}){const i=e?{duration:200}:void 0,n=80;let r=(a||0)+-(0+n)/this.scale,o=(t||0)+-n/this.scale;this.$refs.viewer.scrollTo(r,o,i)},updateScale(a){a!==this.$refs.viewer.getZoom()&&this.$refs.viewer.setZoom(a,{duration:200,zoomBase:"viewport",zoomOffsetX:this.$root.zoom_offset,zoomOffsetY:this.$root.zoom_offset})},disableActiveModule(){this.$eventHub.$emit("module.setActive",!1)}}};var Wi=function(){var t=this,e=t._self._c;return e("vue-infinite-viewer",t._b({ref:"viewer",staticClass:"viewer",on:{scroll:t.onScroll,dragStart:t.dragStart,dragEnd:t.dragEnd,pinchStart:t.pinchStart,abortPinch:t.abortPinch,pinch:t.pinch}},"vue-infinite-viewer",t.viewerOptions,!1),[e("div",{staticClass:"_pzViewport"},[t._t("default")],2)])},Vi=[],Ni=D(Hi,Wi,Vi,!1,null,"a986f5ca");const ji=Ni.exports,Zi={props:{page_opened_id:String,publication_path:String,publication_title:String,pages:Array,spreads:[Boolean,Array],modules:Array,is_spread:Boolean,page_width:Number,page_height:Number,layout_mode:String,margins:Object,pagination:[Boolean,Object],can_edit:Boolean},components:{PageMenu:He,SinglePage:At,PanZoom2:ji},data(){return{scale:1,page_settings:{show_grid:!1,snap_to_grid:!1,grid_z_index:"under",gridstep_in_mm:10},display_as_public:!1,active_module_path:!1}},created(){this.$eventHub.$on("module.setActive",this.setActiveModule),document.addEventListener("keydown",this.keyPressed),this.loadSettings()},mounted(){},beforeDestroy(){this.$eventHub.$off("module.setActive",this.setActiveModule),document.removeEventListener("keydown",this.keyPressed)},watch:{page_opened_id(){this.$nextTick(()=>{})},page_settings:{handler(){this.saveSettings()},deep:!0}},computed:{active_module(){return this.active_module_path?this.modules.find(a=>a.$path===this.active_module_path):!1},active_module_first_media(){return this.firstMedia(this.active_module)},active_module_meta_filename(){return this.active_module.$path.substring(this.active_module.$path.lastIndexOf("/")+1)},active_page_number(){return this.pages.findIndex(a=>a.id===this.page_opened_id)},current_page(){return this.pages.find(a=>a.id===this.page_opened_id)},previous_page(){return this.pages[this.active_page_number-1]},next_page(){return this.pages[this.active_page_number+1]},active_spread(){return this.spreads[this.active_spread_index]},active_spread_index(){return this.is_spread&&this.spreads.findIndex(a=>a.find(t=>t&&t.id===this.page_opened_id))}},methods:{loadSettings(){const a=localStorage.getItem(`publication.page_settings.${this.publication_path}`);a&&(this.page_settings=JSON.parse(a))},saveSettings(){localStorage.setItem(`publication.page_settings.${this.publication_path}`,JSON.stringify(this.page_settings))},keyPressed(a){if(this.$root.modal_is_opened||a.target.tagName.toLowerCase()==="input"||a.target.tagName.toLowerCase()==="textarea"||a.target.className.includes("ql-editor")||a.target.hasAttribute("contenteditable"))return;let t="";(a.key==="Backspace"||a.key==="Delete")&&(t="remove",this.$eventHub.$emit("module.open_remove_modal")),t&&a.preventDefault()},setActiveModule(a){this.active_module_path=a},prevPage(){const a=this.active_page_number-1;this.setPageActive(this.pages[a].id)},nextPage(){const a=this.active_page_number+1;this.setPageActive(this.pages[a].id)},setPageActive(a){this.setActiveModule(!1),this.$emit("togglePage",a)},prevSpread(){const t=this.spreads[this.active_spread_index-1][1].id;this.setPageActive(t)},nextSpread(){const t=this.spreads[this.active_spread_index+1][0].id;this.setPageActive(t)}}};var qi=function(){var t=this,e=t._self._c;return e("div",{staticClass:"_openedPage",class:{"is--editable":t.can_edit&&!t.display_as_public}},[e("div",{staticClass:"_spreadNavigator"},[e("div",{staticClass:"_spreadNavigator--content",on:{click:function(i){return i.target!==i.currentTarget?null:t.setActiveModule(!1)}}},[e("div",{staticClass:"_sideCont"},[e("div",{staticClass:"_content"},[e("PageMenu",{attrs:{can_edit:t.can_edit,pages:t.pages,active_page_number:t.active_page_number,active_spread_index:t.active_spread_index,page_width:t.page_width,page_height:t.page_height,scale:t.scale,show_grid:t.page_settings.show_grid,snap_to_grid:t.page_settings.snap_to_grid,grid_z_index:t.page_settings.grid_z_index,gridstep_in_mm:t.page_settings.gridstep_in_mm,layout_mode:t.layout_mode,page_color:t.current_page.page_color,pagination:t.pagination,publication_path:t.publication_path,page_opened_id:t.page_opened_id,page_modules:t.getModulesForPage({modules:t.modules,page_id:t.page_opened_id}),active_module:t.active_module,display_as_public:t.display_as_public},on:{"update:show_grid":function(i){return t.$set(t.page_settings,"show_grid",i)},"update:snap_to_grid":function(i){return t.$set(t.page_settings,"snap_to_grid",i)},"update:grid_z_index":function(i){return t.$set(t.page_settings,"grid_z_index",i)},"update:gridstep_in_mm":function(i){return t.$set(t.page_settings,"gridstep_in_mm",i)},"update:display_as_public":function(i){t.display_as_public=i},updatePageOptions:function(i){return t.$emit("updatePageOptions",i)},"update:scale":function(i){t.scale=i},prevPage:function(i){return t.prevPage()},nextPage:function(i){return t.nextPage()},close:function(i){return t.setPageActive(!1)}}})],1)]),e("div",{staticClass:"_pagePan"},[e("PanZoom2",{attrs:{scale:t.scale},on:{"update:scale":function(i){t.scale=i}}},[e("transition",{attrs:{name:"pagechange",mode:"out-in"}},[e("div",{key:t.is_spread?"spread-"+JSON.stringify(t.active_spread.map(i=>i.id)):"page-"+t.page_opened_id,staticClass:"_pageCont",on:{click:function(i){return i.target!==i.currentTarget?null:t.setActiveModule(!1)}}},[t.is_spread?t._l(t.active_spread,function(i,n){return e("div",{key:i.id?i.id:n,staticClass:"_spreadNavigator--page",class:{"is--active":i.id===t.page_opened_id}},[i?[e("SinglePage",{attrs:{context:"full",page_modules:t.getModulesForPage({modules:t.modules,page_id:i.id}),page_width:t.page_width,page_height:t.page_height,layout_mode:t.layout_mode,page_color:i.page_color,scale:t.scale,show_grid:t.page_settings.show_grid,snap_to_grid:t.page_settings.snap_to_grid,grid_z_index:t.page_settings.grid_z_index,gridstep_in_mm:t.page_settings.gridstep_in_mm,margins:t.margins,page_number:t.active_spread_index*2+n,pagination:t.pagination,hide_pagination:t.current_page.hide_pagination===!0,active_module:t.active_module,page_is_left:n===0,can_edit:t.can_edit&&i.id===t.page_opened_id&&!t.display_as_public},on:{close:function(r){return t.setPageActive(!1)}}}),i.id!==t.page_opened_id?[e("button",{staticClass:"_openAdjacentPageBtn",attrs:{type:"button"},on:{mousedown:function(r){return r.target!==r.currentTarget?null:t.setPageActive(i.id)}}})]:t._e()]:e("div",{staticClass:"_noPage"})],2)}):e("SinglePage",{staticClass:"_spreadNavigator--page is--active",attrs:{context:"full",page_modules:t.getModulesForPage({modules:t.modules,page_id:t.page_opened_id}),page_width:t.page_width,page_height:t.page_height,layout_mode:t.layout_mode,page_color:t.current_page.page_color,scale:t.scale,show_grid:t.page_settings.show_grid,snap_to_grid:t.page_settings.snap_to_grid,grid_z_index:t.page_settings.grid_z_index,gridstep_in_mm:t.page_settings.gridstep_in_mm,margins:t.margins,page_number:t.active_page_number,pagination:t.pagination,hide_pagination:t.current_page.hide_pagination===!0,active_module:t.active_module,can_edit:t.can_edit&&!t.display_as_public},on:{close:function(i){return t.setPageActive(!1)}}})],2)])],1)],1)])])])},Ui=[],Gi=D(Zi,qi,Ui,!1,null,"f4876e4e");const Ki=Gi.exports,Ji={props:{index:Number,number_of_pages:Number,can_edit:Boolean},components:{},data(){return{edit_mode:!1}},created(){},mounted(){},beforeDestroy(){},watch:{},computed:{},methods:{}};var Qi=function(){var t=this,e=t._self._c;return e("div",{staticClass:"_label"},[e("div",{staticClass:"u-sameRow u-label"},[t._v(" "+t._s(t.$t("page"))+" "),t.edit_mode?[e("select",{domProps:{value:t.index},on:{change:function(i){t.$emit("movePage",{old_position:t.index,new_position:+i.target.value}),t.edit_mode=!1}}},t._l(t.number_of_pages,function(i){return e("option",{key:i-1,domProps:{value:i-1,textContent:t._s(i)}})}),0)]:[t._v(" "+t._s(t.index+1)+" ")],t.can_edit?e("EditBtn",{on:{click:function(i){t.edit_mode=!t.edit_mode}}}):t._e()],2),t.edit_mode?e("div",{staticClass:"u-sameRow"},[e("div",{},[e("EditBtn",{attrs:{btn_type:"duplicate"},on:{click:function(i){t.$emit("duplicatePage"),t.edit_mode=!1}}})],1),t.can_edit?e("RemoveMenu",{attrs:{modal_title:t.$t("remove_page_and_content")},on:{remove:function(i){return t.$emit("removePage")}}},[e("template",{slot:"trigger"},[e("EditBtn",{attrs:{btn_type:"remove"}})],1)],2):t._e()],1):t._e()])},tn=[],en=D(Ji,Qi,tn,!1,null,"04815a5b");const nn=en.exports,an={props:{publication:Object,page_opened_id:String,can_edit:Boolean},components:{SinglePage:At,OpenedPageOrSpread:Ki,PageLabel:nn},provide(){return{$getMetaFilenamesAlreadyPresent:()=>this.meta_filenames_already_present}},data(){return{is_creating_page:!1,previews_size:200}},created(){this.$eventHub.$on("publication.togglePage",this.togglePage)},mounted(){},beforeDestroy(){this.$eventHub.$off("publication.togglePage",this.togglePage)},watch:{},computed:{pages(){return this.publication.pages},modules(){return this.publication.$files||[]},is_spread(){return this.publication.page_spreads===!0},page_preview_zoom(){return this.calculateZoomToFit({width:this.publication.page_width,height:this.publication.page_height,desired_largest_dimension:this.previews_size,magnification:this.publication.layout_mode==="screen"?1:this.$root.page_magnification})},spreads(){return this.is_spread?this.makeSpread({pages:this.pages}):!1},margins(){return{left:this.publication.page_margin_left||0,right:this.publication.page_margin_right||0,top:this.publication.page_margin_top||0,bottom:this.publication.page_margin_bottom||0}},pagination(){return this.setPaginationFromPublication(this.publication)},meta_filenames_already_present(){const a=[],t=[];return this.pages.map(e=>{const i=e.id,n=i===this.page_opened_id;this.getModulesForPage({modules:this.modules,page_id:i}).map(o=>{o!=null&&o.source_medias&&Array.isArray(o.source_medias)&&o.source_medias.map(s=>{s.meta_filename_in_project&&(n?a.push(s.meta_filename_in_project):t.push(s.meta_filename_in_project))})})}),[{label:this.$t("on_this_page"),medias:a,color:"var(--c-orange)"},{label:this.$t("on_other_pages"),medias:t,color:"var(--c-bleuvert)"}]}},methods:{async createPage(a){this.is_creating_page=!0;const t=this.generatePageID();let e=this.publication.pages?this.publication.pages.slice():[];const i={id:t,page_color:"white"};typeof a!="number"?e.push(i):e.splice(a,0,i),await this.updatePubliMeta({pages:e}),await new Promise(n=>setTimeout(n,500)),this.is_creating_page=!1},removePage(a){let t=this.publication.pages.slice();t=t.filter(e=>e.id!==a),this.updatePubliMeta({pages:t})},async duplicatePage(a){let t=this.generatePageID();const e=this.publication.pages.reduce((r,o)=>{if(r.push(o),o.id===a){const s=JSON.parse(JSON.stringify(o));s.id=t,r.push(s)}return r},[]);await this.updatePubliMeta({pages:e});const i=this.getModulesForPage({modules:this.modules,page_id:a});if(i.length===0)return;const n={page_id:t};for(const r of i)await this.duplicateModuleWithSourceMedias({og_module:r,addtl_meta_to_module:n})},movePage({old_position:a,new_position:t}){let e=this.publication.pages.slice();function i(n,r,o){if(o>=n.length)for(var s=o-n.length+1;s--;)n.push(void 0);return n.splice(o,0,n.splice(r,1)[0]),n}i(e,a,t),this.updatePubliMeta({pages:e})},generatePageID(){return(Math.random().toString(36)+"00000000000000000").slice(2,8)},togglePage(a){this.$emit("togglePage",a)},async updatePageOptions({page_number:a,value:t}){let e=this.publication.pages.slice();Object.assign(e[a],t),this.updatePubliMeta({pages:e})},async updatePubliMeta(a){return await this.$api.updateMeta({path:this.publication.$path,new_meta:a})}}};var on=function(){var t=this,e=t._self._c;return e("transition",{attrs:{name:"slideup"}},[t.page_opened_id?e("OpenedPageOrSpread",{key:"openedpage",attrs:{page_opened_id:t.page_opened_id,publication_title:t.publication.title,publication_path:t.publication.$path,pages:t.pages,spreads:t.spreads,modules:t.modules,is_spread:t.is_spread,page_width:t.publication.page_width,page_height:t.publication.page_height,layout_mode:t.publication.layout_mode,margins:t.margins,pagination:t.pagination,can_edit:t.can_edit},on:{togglePage:function(i){return t.$emit("togglePage",i)},updatePageOptions:t.updatePageOptions}}):e("div",[e("div",{staticClass:"_setPreviewSize"},[e("h2",[t.is_spread?[t._v(t._s(t.$t("list_of_spreads")))]:[t._v(t._s(t.$t("list_of_pages")))]],2),e("div",{staticClass:"u-spacingBottom"}),e("RangeValueInput",{attrs:{label:t.$t("previews_size"),value:t.previews_size,can_toggle:!1,min:20,max:600,step:1,ticks:[20,50,100,200,400,600],default_value:200},on:{save:function(i){t.previews_size=i}}})],1),e("transition-group",{key:"allpages",staticClass:"_allPages",attrs:{tag:"div",name:"listComplete"}},[t.is_spread?[t._l(t.spreads,function(i,n){return[t._l(i,function(r,o){return[t.can_edit&&o===0?e("EditBtn",{key:"createPage-"+Math.max(0,n*2+o-1),staticClass:"_createPage",style:t.is_creating_page?"opacity: 0 !important;":"opacity: 1 !important;",attrs:{btn_type:"create_page"},on:{click:function(s){t.createPage(Math.max(0,n*2+o-1))}}}):t._e(),e("div",{key:r?r.id:o,attrs:{"data-pageposition":o===0?"left":"right"}},[r&&r.id?[e("div",{staticClass:"_preview"},[e("SinglePage",{attrs:{context:"preview",zoom:t.page_preview_zoom,page_modules:t.getModulesForPage({modules:t.modules,page_id:r.id}),page_width:t.publication.page_width,page_height:t.publication.page_height,layout_mode:t.publication.layout_mode,page_color:r.page_color,page_number:n*2+o,pagination:t.pagination,hide_pagination:r.hide_pagination===!0,page_is_left:o===0,can_edit:!1}}),e("button",{staticClass:"u-button _openPage",attrs:{type:"button"},domProps:{innerHTML:t._s(t.$t("open"))},on:{click:function(s){return t.$emit("togglePage",r.id)}}})],1),e("PageLabel",{attrs:{index:n*2+o-1,number_of_pages:t.pages.length,can_edit:t.can_edit},on:{movePage:function(s){return t.movePage({old_position:s.old_position,new_position:s.new_position})},duplicatePage:function(s){return t.duplicatePage(r.id)},removePage:function(s){return t.removePage(r.id)}}})]:t._e()],2)]})]})]:t._l(t.pages,function(i,n){return e("div",{key:"page-"+i.id,staticClass:"u-sameRow _singlePage"},[e("div",{staticClass:"_createPageBtn"},[t.can_edit?e("EditBtn",{key:"createPage"+n,style:t.is_creating_page?"opacity: 0 !important;":"opacity: 1 !important;",attrs:{btn_type:"create_page"},on:{click:function(r){return t.createPage(n)}}}):t._e()],1),e("div",{staticClass:"_page"},[e("div",{staticClass:"_preview"},[e("SinglePage",{attrs:{context:"preview",zoom:t.page_preview_zoom,page_modules:t.getModulesForPage({modules:t.modules,page_id:i.id}),page_width:t.publication.page_width,page_height:t.publication.page_height,layout_mode:t.publication.layout_mode,page_color:i.page_color,page_number:n,pagination:t.pagination,hide_pagination:i.hide_pagination===!0,can_edit:!1}}),e("button",{staticClass:"u-button _openPage",attrs:{type:"button"},domProps:{innerHTML:t._s(t.$t("open"))},on:{click:function(r){return t.$emit("togglePage",i.id)}}})],1),e("PageLabel",{staticClass:"_pageLabel",attrs:{index:n,number_of_pages:t.pages.length,can_edit:t.can_edit},on:{movePage:function(r){return t.movePage({old_position:r.old_position,new_position:r.new_position})},duplicatePage:function(r){return t.duplicatePage(i.id)},removePage:function(r){return t.removePage(i.id)}}})],1)])}),t.can_edit?e("span",{key:"createPage",style:t.is_creating_page?"opacity: 0 !important;":"opacity: 1 !important;"},[e("EditBtn",{attrs:{btn_type:"create_page",is_unfolded:!0},on:{click:t.createPage}})],1):t._e()],2)],1)],1)},rn=[],sn=D(an,on,rn,!1,null,"c7dfb16e");const ln=sn.exports,cn={props:{publication:Object,page_opened_id:String,can_edit:Boolean},components:{PublicationSettings:ie,PageSettings:$e,PagesList:ln},data(){return{}},created(){},mounted(){},beforeDestroy(){},watch:{},computed:{},methods:{}};var un=function(){var t=this,e=t._self._c;return e("div",{staticClass:"_pageTemplate"},[e("PagesList",{attrs:{publication:t.publication,page_opened_id:t.page_opened_id,can_edit:t.can_edit},on:{togglePage:function(i){return t.$emit("togglePage",i)}}}),t.can_edit?e("PublicationSettings",[e("PageSettings",{attrs:{publication:t.publication}})],1):t._e()],1)},dn=[],_n=D(cn,un,dn,!1,null,"b438b873");const yn=_n.exports;export{yn as default};
