import{n as ee,_ as Qe,R as Ze,e as Ee,d as W}from"../build.js";const et={props:{available_modes:Array,selected_mode:String,disable_change_mode:Boolean},components:{},data(){return{id:(Math.random().toString(36)+"00000000000000000").slice(2,8),available_mode_picto:{photo:this.$root.publicPath+"images/i_icone-dodoc_image.svg",video:this.$root.publicPath+"images/i_icone-dodoc_video.svg",stopmotion:this.$root.publicPath+"images/i_icone-dodoc_anim.svg",audio:this.$root.publicPath+"images/i_icone-dodoc_audio.svg",vecto:this.$root.publicPath+"images/i_icone-dodoc_vecto.svg",lines:this.$root.publicPath+"images/i_icone-dodoc_lines.svg"}}},created(){},mounted(){this.$eventHub.$on("capture.navigate.previous",this.previousMode),this.$eventHub.$on("capture.navigate.next",this.nextMode)},beforeDestroy(){this.$eventHub.$off("capture.navigate.previous",this.previousMode),this.$eventHub.$off("capture.navigate.next",this.nextMode)},watch:{},computed:{},methods:{previousMode(){if(this.disable_change_mode)return;let o=this.available_modes.indexOf(this.selected_mode);o>0?this.$emit("changeMode",this.available_modes[o-1]):this.$emit("changeMode",this.available_modes[this.available_modes.length-1])},nextMode(){if(this.disable_change_mode)return;let o=this.available_modes.indexOf(this.selected_mode);o<this.available_modes.length-1?this.$emit("changeMode",this.available_modes[o+1]):this.$emit("changeMode",this.available_modes[0])}}};var tt=function(){var e=this,t=e._self._c;return t("div",{staticClass:"_modeSelector"},[e.available_modes.length>1?t("div",{staticClass:"_arrows"},[t("button",{staticClass:"u-button u-button_transparent",attrs:{type:"button"},on:{click:function(i){return i.stopPropagation(),i.preventDefault(),e.previousMode.apply(null,arguments)}}},[t("svg",{staticStyle:{"enable-background":"new 0 0 169 169"},attrs:{version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",x:"0px",y:"0px",width:"169px",height:"169px",viewBox:"0 0 169 169","xml:space":"preserve"}},[t("path",{attrs:{fill:"currentColor",stroke:"currentColor","stroke-width":"10","stroke-linejoin":"round",d:"M60.2,84.5l48.6-24.3l0,48.6L60.2,84.5z"}})])])]):e._e(),e._l(e.available_modes,function(i){return t("div",{key:i},[t("input",{attrs:{type:"radio",id:e.id+"_"+i},domProps:{value:i,checked:e.selected_mode===i},on:{click:function(r){return e.$emit("changeMode",i)}}}),t("label",{attrs:{for:e.id+"_"+i}},[t("div",{staticClass:"_picto",attrs:{content:e.$t(i)}},[t("img",{attrs:{src:e.available_mode_picto[i]}})]),e.selected_mode===i?t("span",[e._v(e._s(e.$t(i)))]):e._e()])])}),e.available_modes.length>1?t("div",{staticClass:"_arrows"},[t("button",{staticClass:"u-button u-button_transparent",attrs:{type:"button"},on:{click:function(i){return i.stopPropagation(),i.preventDefault(),e.nextMode.apply(null,arguments)}}},[t("svg",{staticStyle:{"enable-background":"new 0 0 169 169"},attrs:{version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",x:"0px",y:"0px",width:"169px",height:"169px",viewBox:"0 0 169 169","xml:space":"preserve"}},[t("path",{attrs:{fill:"currentColor",stroke:"currentColor","stroke-width":"10","stroke-linejoin":"round",d:"M108.8,84.5l-48.6,24.3V60.2L108.8,84.5z"}})])])]):e._e()],2)},it=[],at=ee(et,tt,it,!1,null,"3905612f");const ot=at.exports,nt={props:{media_to_validate:Object,audio_output_deviceId:String},components:{},data(){return{}},created(){},mounted(){this.setSinkId()},beforeDestroy(){},watch:{audio_output_deviceId:{handler(){this.setSinkId()}}},computed:{},methods:{setSinkId(){this.audio_output_deviceId&&(this.media_to_validate.type==="video"||this.media_to_validate.type==="audio")&&this.$refs.videoElement.setSinkId(this.audio_output_deviceId)}}};var rt=function(){var e=this,t=e._self._c;return e.media_to_validate?t("div",{staticClass:"m_previewValidation"},[e.media_to_validate.type==="image"?t("img",{attrs:{src:e.media_to_validate.objectURL}}):e.media_to_validate.type==="video"||e.media_to_validate.type==="audio"?t("vue-plyr",{staticClass:"m_previewValidation--video"},[t("video",{ref:"videoElement",attrs:{src:e.media_to_validate.objectURL,poster:e.media_to_validate.preview,preload:"auto"}})]):e.media_to_validate.type==="svg"?t("div",{staticClass:"m_previewValidation--svg",domProps:{innerHTML:e._s(e.media_to_validate.preview)}}):e._e()],1):e._e()},st=[],lt=ee(nt,rt,st,!1,null,"5db7b05e");const dt=lt.exports,ct={props:{media_is_being_sent:Boolean,media_being_sent_percent:Number,can_add_to_fav:Boolean,cancelButtonIsBackButton:{type:Boolean,default:!1}},components:{},data(){return{selected_button:1}},created(){},mounted(){document.addEventListener("keyup",this.captureKeyListener)},beforeDestroy(){document.removeEventListener("keyup",this.captureKeyListener)},watch:{},computed:{},methods:{captureKeyListener(o){switch(console.log("METHODS ‚Ä¢ MediaValidationButtons: captureKeyListener"),o.key){case"w":case"z":case"ArrowLeft":this.selectedMoveLeft();break;case"s":case"ArrowRight":this.selectedMoveRight();break;case"a":case"q":case" ":this.validateButton(this.selected_button);break}return o.preventDefault(),!1},selectedMoveLeft(){console.log("METHODS ‚Ä¢ MediaValidationButtons: captureKeyListener / goleft"),this.selected_button+=this.selected_button>0?-1:0},selectedMoveRight(){console.log("METHODS ‚Ä¢ MediaValidationButtons: captureKeyListener / goright"),this.selected_button+=this.selected_button<2?1:0},validateButton(o){o===0?this.$emit("cancel"):o===1?this.$emit("save"):o===2&&this.$emit("save_and_fav")}}};var ut=function(){var e=this,t=e._self._c;return t("div",{staticClass:"m_mediaValidationButtons"},[t("button",{staticClass:"u-button u-button_transparent _arrows",attrs:{type:"button"},on:{click:e.selectedMoveLeft}},[t("svg",{staticStyle:{"enable-background":"new 0 0 169 169"},attrs:{version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",x:"0px",y:"0px",width:"169px",height:"169px",viewBox:"0 0 169 169","xml:space":"preserve"}},[t("path",{attrs:{fill:"currentColor",d:"M60.2,84.5l48.6-24.3l0,48.6L60.2,84.5z"}})])]),t("button",{staticClass:"u-button u-button_black",class:{"is--active":e.selected_button===0},attrs:{type:"button"},on:{mousedown:function(i){return i.stopPropagation(),i.preventDefault(),e.validateButton(0)},touchstart:function(i){return i.stopPropagation(),i.preventDefault(),e.validateButton(0)},mouseover:function(i){e.selected_button=0}}},[e.cancelButtonIsBackButton?[t("span",{},[e._v("‚Äπ "+e._s(e.$t("back")))])]:[t("svg",{staticStyle:{"enable-background":"new 0 0 168 168"},attrs:{version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",x:"0px",y:"0px",viewBox:"0 0 168 168","xml:space":"preserve"}},[t("polygon",{attrs:{fill:"currentColor",points:`42.6,57.2 57.5,42.4 84.1,69 110.8,42.4 125.6,57.2 99,83.9 125.6,110.5 110.8,125.4 
      84.1,98.7 57.5,125.4 42.6,110.5 69.3,83.9`}})]),e._v(" "+e._s(e.$t("cancel"))+" ")]],2),t("div",{staticClass:"_valStarBtns"},[t("button",{staticClass:"u-button u-button_red _checkBtn",class:{"is--active":e.selected_button===1},attrs:{type:"button",title:e.$t("save")},on:{click:function(i){return e.validateButton(1)},mouseover:function(i){e.selected_button=1}}},[t("svg",{staticStyle:{"enable-background":"new 0 0 168 168"},attrs:{version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",x:"0px",y:"0px",viewBox:"0 0 168 168","xml:space":"preserve"}},[t("rect",{attrs:{x:"51.4",y:"73.1",transform:"matrix(0.7071 -0.7071 0.7071 0.7071 -53.857 72.9892)",width:"19.5",height:"56.8",fill:"currentColor"}}),t("rect",{attrs:{x:"53.2",y:"77.3",transform:"matrix(0.7071 -0.7071 0.7071 0.7071 -31.6875 97.6563)",width:"97.6",height:"19.5",fill:"currentColor"}})]),t("span",[e._v(e._s(e.$t("save")))])]),e.can_add_to_fav?t("button",{staticClass:"u-button u-button_red _favBtn",class:{"is--active":e.selected_button===2},attrs:{type:"button",title:e.$t("add_to_fav")},on:{click:function(i){return e.validateButton(2)},mouseover:function(i){e.selected_button=2}}},[t("b-icon",{attrs:{icon:e.selected_button===2?"star-fill":"star"}})],1):e._e()]),t("button",{staticClass:"u-button u-button_transparent u-colorOrange _arrows",attrs:{type:"button"},on:{click:e.selectedMoveRight}},[t("svg",{staticStyle:{"enable-background":"new 0 0 169 169"},attrs:{version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",x:"0px",y:"0px",width:"169px",height:"169px",viewBox:"0 0 169 169","xml:space":"preserve"}},[t("path",{attrs:{fill:"currentColor",d:"M108.8,84.5l-48.6,24.3V60.2L108.8,84.5z"}})])]),e.media_is_being_sent?t("div",{staticClass:"m_mediaValidationButtons--overlay"},[t("transition",{attrs:{name:"fade_fast",duration:150}},[t("LoaderSpinner")],1),t("span",{staticClass:"m_mediaValidationButtons--overlay--percent",domProps:{textContent:e._s(e.media_being_sent_percent+"%")}})],1):e._e()])},mt=[],_t=ee(ct,ut,mt,!1,null,"1e3a27ee");const Ve=_t.exports,ft={props:{medias:Array,frame_rate:Number,output_format:String,created_stopmotion:[Boolean,Object]},components:{},data(){return{current_media_index:0,is_playing:!1,new_frame_rate:this.frame_rate,new_output_format:this.output_format,next_image_timeout:null}},created(){},mounted(){},beforeDestroy(){},watch:{new_frame_rate(){this.$emit("update:frame_rate",this.new_frame_rate)},new_output_format(){this.$emit("update:output_format",this.new_output_format)}},computed:{current_media(){return this.medias[this.current_media_index]}},methods:{playPausePreview(){this.is_playing?this.stopPreview():this.playPreview()},stopPreview(){this.is_playing=!1,window.clearTimeout(this.next_image_timeout)},playPreview(){this.is_playing=!0;const o=()=>{const e=this.current_media.duration,t=1e3/this.frame_rate,i=e*t;this.next_image_timeout=window.setTimeout(()=>{if(this.current_media_index<this.medias.length-1)this.current_media_index++,o();else{this.is_playing=!1;return}},i)};this.current_media_index=0,o(this.current_media_index)}}};var ht=function(){var e=this,t=e._self._c;return t("div",[t("div",{staticClass:"_player"},[e.created_stopmotion?[t("MediaContent",{key:e.created_stopmotion.$path,attrs:{context:"full",file:e.created_stopmotion,resolution:1600}})]:[e.current_media?t("MediaContent",{attrs:{file:e.current_media.media,resolution:1600}}):e._e(),e.is_playing?e._e():t("div",{staticClass:"_miniListPreview"},e._l(e.medias,function({media:i}){return t("MediaContent",{key:"previews-"+i.$path,attrs:{file:i,resolution:1600}})}),1),t("div",{staticClass:"_imgCount"},[e._v(" "+e._s(e.current_media_index+1)+"/"+e._s(e.medias.length)+" ")]),t("button",{staticClass:"_playPauseBtn",attrs:{type:"button"},on:{click:e.playPausePreview}},[e.is_playing?e._e():t("img",{attrs:{src:`${e.$root.publicPath}images/i_play.svg`,width:"48",height:"48",draggable:"false"}})]),t("transition",{attrs:{name:"fade"}},[e.is_playing?e._e():t("div",{staticClass:"_fps"},[t("div",{staticClass:"u-sameRow"},[t("div",[t("label",{staticClass:"u-label",attrs:{for:"fps_select"}},[e._v(e._s(e.$t("img_per_second")))]),t("select",{directives:[{name:"model",rawName:"v-model.number",value:e.new_frame_rate,expression:"new_frame_rate",modifiers:{number:!0}}],attrs:{size:"small",name:"fps_select",id:"fps_select"},on:{change:function(i){var r=Array.prototype.filter.call(i.target.options,function(s){return s.selected}).map(function(s){var n="_value"in s?s._value:s.value;return e._n(n)});e.new_frame_rate=i.target.multiple?r:r[0]}}},[t("option",[e._v("2")]),t("option",[e._v("4")]),t("option",[e._v("8")]),t("option",[e._v("15")]),t("option",[e._v("24")]),t("option",[e._v("30")])])]),t("div",[t("label",{staticClass:"u-label",attrs:{for:"output_format"}},[e._v(e._s(e.$t("format")))]),t("select",{directives:[{name:"model",rawName:"v-model",value:e.new_output_format,expression:"new_output_format"}],attrs:{size:"small",name:"output_format",id:e.output_format},on:{change:function(i){var r=Array.prototype.filter.call(i.target.options,function(s){return s.selected}).map(function(s){var n="_value"in s?s._value:s.value;return n});e.new_output_format=i.target.multiple?r:r[0]}}},[t("option",{domProps:{value:"gif"}},[e._v(e._s(e.$t("gif")))]),t("option",{domProps:{value:"mp4"}},[e._v(e._s(e.$t("video")))])])])])])])]],2)])},pt=[],vt=ee(ft,ht,pt,!1,null,"7a1f6f4c");const gt=vt.exports,yt={props:{value:Number,frame_rate:Number},components:{},data(){return{local_value:this.value}},created(){},mounted(){},beforeDestroy(){},watch:{},computed:{seconds_equivalent(){return parseFloat((this.local_value/this.frame_rate).toFixed(2)).toLocaleString(this.$i18n.locale)}},methods:{}};var bt=function(){var e=this,t=e._self._c;return t("BaseModal2",{attrs:{title:e.$t("duration")},on:{close:function(i){return e.$emit("close")}}},[t("div",{staticClass:"u-inputGroup u-spacingBottom"},[t("input",{directives:[{name:"model",rawName:"v-model.number",value:e.local_value,expression:"local_value",modifiers:{number:!0}}],staticClass:"_input",attrs:{type:"number",name:e.$t("duration"),id:"_input_"+e.$t("duration"),size:"medium",min:1,max:3600,step:1},domProps:{value:e.local_value},on:{keyup:function(i){return!i.type.indexOf("key")&&e._k(i.keyCode,"enter",13,i.key,"Enter")?null:e.$emit("save",e.local_value)},input:function(i){i.target.composing||(e.local_value=e._n(i.target.value))},blur:function(i){return e.$forceUpdate()}}}),t("span",{staticClass:"u-suffix"},[e._v(" "+e._s((e.local_value>1?e.$t("images"):e.$t("image")).toLowerCase())+" ")])]),t("p",{staticClass:"u-instructions"},[e._v(" "+e._s(e.$t("duration_explanation",{seconds_equivalent:e.seconds_equivalent,frame_rate:e.frame_rate}))+" ")]),t("div",{staticClass:"u-spacingBottom"}),t("template",{slot:"footer"},[t("SaveCancelButtons",{staticClass:"_scb",attrs:{allow_save:!0},on:{save:function(i){return e.$emit("save",e.local_value)},cancel:function(i){return e.$emit("close")}}})],1)],2)},wt=[],xt=ee(yt,bt,wt,!1,null,"1365fca4");const Ct=xt.exports,kt={props:{current_stopmotion_path:String,stream:MediaStream,show_live_feed:Boolean,is_validating_stopmotion_video:Boolean,onion_skin_opacity:Number,stopmotion_frame_rate:Number},components:{MediaValidationButtons:Ve,PreviewStopmotion:gt,ImageDurationPicker:Ct},data(){return{stopmotion:null,fetch_stopmotion_error:void 0,show_options_menu:!1,frame_rate:this.stopmotion_frame_rate,output_format:"mp4",validating_video_preview:!1,previous_photo_to_show:!1,media_is_being_sent:!1,show_advanced_menu:!1,compilation_in_progress:!1,created_stopmotion:!1,preview_playing_event:void 0,show_duration_menu:!1,status_saving_to_project:!1}},created(){},async mounted(){this.$eventHub.$on("stopmotion.addImage",this.appendToStopMotion),this.$eventHub.$on("stopmotion.test",this.testStopmotion),this.$eventHub.$on("capture.navigate.next",this.nextImage),this.$eventHub.$on("capture.navigate.previous",this.prevImage),this.$eventHub.$on("capture.remove",this.openRemoveImageMenu);const o=await this.$api.getFolder({path:this.current_stopmotion_path}).catch(e=>{this.fetch_stopmotion_error=e.response});this.stopmotion=o,this.$api.join({room:this.current_stopmotion_path})},beforeDestroy(){this.$api.leave({room:this.current_stopmotion_path}),this.$eventHub.$off("stopmotion.addImage",this.appendToStopMotion),this.$eventHub.$off("capture.navigate.next",this.nextImage),this.$eventHub.$off("capture.navigate.previous",this.prevImage),this.$eventHub.$off("capture.remove",this.openRemoveImageMenu)},watch:{frame_rate(){this.$emit("update:stopmotion_frame_rate",this.frame_rate)},stopmotion_frame_rate(){this.frame_rate=this.stopmotion_frame_rate},medias(){this.medias.length>0&&this.show_live_feed&&(this.previous_photo_to_show=this.medias[this.medias.length-1].media,this.$nextTick(()=>{this.$nextTick(()=>{this.$refs.mediaPreviews.$el.scrollLeft=1e6})}))},stream:{handler(){},immediate:!0},previous_photo_to_show(){this.$emit("showPreviousImage",this.previous_photo_to_show),this.$nextTick(()=>{const o=document.querySelector(".m_stopmotionpanel--medias--list--items.is--current_single");o&&o.scrollIntoView({behavior:"smooth",inline:"nearest"})})},validating_video_preview(){this.$emit("update:is_validating_stopmotion_video",this.validating_video_preview)}},computed:{medias(){var o,e,t;return(o=this.stopmotion)!=null&&o.images_list&&((t=(e=this.stopmotion)==null?void 0:e.$files)==null?void 0:t.length)>0?this.stopmotion.images_list.reduce((r,s)=>{const n=s.m||s,d=s.d?Number(s.d):1,c=this.stopmotion.$files.find(f=>f.$path.endsWith(n));return c&&r.push({media:c,duration:d}),r},[]):[]},images_list(){return this.medias.map(o=>({m:this.getFilename(o.media.$path),d:o.duration}))},image_index_currently_shown(){return this.previous_photo_to_show?this.medias.findIndex(o=>o.media.$path===this.previous_photo_to_show.$path):!1},current_photo_duration(){var o;return(o=this.medias.find(e=>e.media.$path===this.previous_photo_to_show.$path))==null?void 0:o.duration}},methods:{openRemoveImageMenu(){var o;(o=this.$refs.removeMediaMenu)!=null&&o[0]&&(this.$refs.removeMediaMenu[0].show_confirm_delete=!0)},async appendToStopMotion({imageData:o}){const e={};e.$origin="capture";const{meta_filename:t}=await this.$api.uploadFile({path:this.current_stopmotion_path,filename:+new Date+".jpeg",file:o,additional_meta:e}).catch(r=>{throw this.$alertify.delay(4e3).error(r),r});let i=this.images_list.slice();i.push({m:t,d:1}),await this.$api.updateMeta({path:this.current_stopmotion_path,new_meta:{images_list:i}})},previewPlay({loop:o=!1}={}){(this.show_live_feed||this.image_index_currently_shown===this.medias.length-1)&&this.firstImage();const e=t=>{if(t>this.medias.length-1)return o?e(0):this.pausePreview();this.previous_photo_to_show=this.medias[t].media;const i=this.medias[t].duration;this.preview_playing_event=window.setTimeout(()=>e(t+1),1e3/this.frame_rate*i)};e(this.image_index_currently_shown)},pausePreview(){window.clearTimeout(this.preview_playing_event),this.preview_playing_event=void 0},testStopmotion(){this.validating_video_preview=!0,this.$nextTick(()=>{this.$nextTick(()=>{})})},photoIsActive(o){var e;return((e=this.previous_photo_to_show)==null?void 0:e.$path)===o&&!this.show_live_feed},showVideoFeed(){this.previous_photo_to_show=this.medias[this.medias.length-1].media,this.$emit("update:show_live_feed",!0)},firstImage(){this.previous_photo_to_show=this.medias[0].media,this.$emit("update:show_live_feed",!1)},prevImage(){if(this.show_live_feed){this.previous_photo_to_show=this.medias.at(-1).media,this.$emit("update:show_live_feed",!1);return}this.previous_photo_to_show=this.medias[this.image_index_currently_shown-1].media},nextImage(){if(this.image_index_currently_shown===this.medias.length-1)return this.showVideoFeed();this.previous_photo_to_show=this.medias[this.image_index_currently_shown+1].media},lastImage(){this.showVideoFeed()},async updateMediaDurationForCurrentPreviousPhoto(o){const e=this.images_list.slice();e[this.image_index_currently_shown].d=o,await this.$api.updateMeta({path:this.current_stopmotion_path,new_meta:{images_list:e}}),this.show_duration_menu=!1},backToStopmotion(){console.log("METHODS ‚Ä¢ StopmotionPanel: backToStopmotion"),this.validating_video_preview=!1,this.created_stopmotion=!1,this.$emit("update:show_live_feed",!0)},async exportStopmotion({fav:o=!1}={}){var r;this.compilation_in_progress=!0;const e={fav:o,$origin:"capture"};(r=this.connected_as)!=null&&r.$path&&(e.$authors=[this.connected_as.$path]);const t=await this.$api.exportFolder({path:this.current_stopmotion_path,instructions:{recipe:"stopmotion",field:"images_list",frame_rate:this.frame_rate,output_format:this.output_format,additional_meta:e}});this.$alertify.delay(4e3).log(this.$t("compilation_started")),this.backToStopmotion();const i=({task_id:s,event:n,message:d})=>{var c;if(s===t)if(this.$eventHub.$off("task.ended",i),this.compilation_in_progress=!1,n==="completed"){const f=this.getFilename((c=d.file)==null?void 0:c.$path);f&&this.$emit("insertMedia",f),this.$emit("close")}else this.$alertify.delay(4e3).error(d)};this.$eventHub.$on("task.ended",i)},async saveToProject(o){let{space_slug:e,project_slug:t}=this.decomposePath(o);const i=this.createPath({space_slug:e,project_slug:t});this.status_saving_to_project="saving",await this.$api.copyFile({path:o,path_to_destination_folder:i,new_meta:{$origin:"capture"}}).catch(r=>{this.$alertify.delay(4e3).error(r)}),this.status_saving_to_project="saved",setTimeout(()=>{this.status_saving_to_project=!1},3e3)},async removeMedia(o){let e=this.images_list.slice();e=e.filter(t=>!o.endsWith(t.m)),this.nextImage(),await this.$api.updateMeta({path:this.current_stopmotion_path,new_meta:{images_list:e}}),await this.$api.deleteItem({path:o})}}};var St=function(){var e=this,t=e._self._c;return t("div",{staticClass:"m_stopmotionpanel",class:{"is--showing_video_validation":e.validating_video_preview}},[e.stopmotion?e.fetch_stopmotion_error?t("div",[e._v(" "+e._s(e.fetch_stopmotion_error)+" ")]):[e.validating_video_preview?t("div",{ref:"videoPreview",staticClass:"m_stopmotionpanel--videopreview"},[t("PreviewStopmotion",{attrs:{medias:e.medias,frame_rate:e.frame_rate,output_format:e.output_format,created_stopmotion:e.created_stopmotion},on:{"update:frame_rate":function(i){e.frame_rate=i},"update:output_format":function(i){e.output_format=i}}}),t("transition",{attrs:{name:"fade_fast",duration:150,mode:"out-in"}},[e.compilation_in_progress?t("LoaderSpinner"):e._e()],1)],1):[t("div",{staticClass:"m_stopmotionpanel--toprowbuttons"},[t("button",{staticClass:"u-button u-button_black",attrs:{type:"button",disabled:e.image_index_currently_shown===0&&!e.show_live_feed},on:{click:e.firstImage}},[t("b-icon",{attrs:{icon:"chevron-double-left","aria-label":e.$t("first_image")}})],1),t("button",{staticClass:"u-button u-button_black",attrs:{type:"button",disabled:e.image_index_currently_shown===0&&!e.show_live_feed},on:{click:e.prevImage}},[t("b-icon",{attrs:{icon:"chevron-left","aria-label":e.$t("previous_image")}})],1),t("div",{},[e.preview_playing_event?t("button",{staticClass:"u-button u-button_black",attrs:{type:"button",disabled:e.show_live_feed},on:{click:e.pausePreview}},[t("b-icon",{attrs:{icon:"pause-fill"}}),e._v(" ¬† "+e._s(e.$t("pause"))+" ")],1):[t("button",{staticClass:"u-button u-button_black",attrs:{type:"button",disabled:e.medias.length<=1},on:{click:e.previewPlay}},[t("b-icon",{attrs:{icon:"play-fill"}}),e._v(" ¬† "+e._s(e.$t("play"))+" ")],1),t("button",{staticClass:"u-button u-button_black",attrs:{type:"button",disabled:e.medias.length<=1},on:{click:function(i){return e.previewPlay({loop:!0})}}},[t("b-icon",{attrs:{icon:"play-circle-fill"}}),e._v(" ¬† "+e._s(e.$t("loop"))+" ")],1)]],2),t("button",{staticClass:"u-button u-button_black",attrs:{type:"button",disabled:e.show_live_feed},on:{click:e.nextImage}},[t("b-icon",{attrs:{icon:"chevron-right","aria-label":e.$t("next_image")}})],1),t("button",{staticClass:"u-button u-button_black",attrs:{type:"button",disabled:e.show_live_feed},on:{click:e.lastImage}},[t("b-icon",{attrs:{icon:"chevron-double-right","aria-label":e.$t("last_image")}})],1)]),t("div",{staticClass:"m_stopmotionpanel--medias"},[t("transition-group",{ref:"mediaPreviews",staticClass:"m_stopmotionpanel--medias--list",attrs:{name:"listComplete"}},[e._l(e.medias,function({media:i,duration:r},s){var n;return t("div",{key:i.$path,staticClass:"m_stopmotionpanel--medias--list--items",class:{"is--current_single":e.previous_photo_to_show&&e.previous_photo_to_show.$path===i.$path&&!e.show_live_feed},on:{click:function(d){e.previous_photo_to_show=i,e.$emit("update:show_live_feed",!1)}}},[t("MediaContent",{attrs:{file:i,resolution:240}}),t("div",{staticClass:"_optionBtns"},[r>1||e.photoIsActive(i.$path)?t("button",{staticClass:"u-button u-button_small u-button_bleumarine",attrs:{type:"button",title:e.$t("duration")},on:{click:function(d){e.show_duration_menu=!e.show_duration_menu}}},[t("b-icon",{attrs:{icon:"clock"}}),e._v(e._s(r)+" ")],1):e._e(),e.show_duration_menu&&e.photoIsActive(i.$path)?t("ImageDurationPicker",{attrs:{value:e.current_photo_duration,frame_rate:e.stopmotion_frame_rate},on:{close:function(d){e.show_duration_menu=!1},save:function(d){return e.updateMediaDurationForCurrentPreviousPhoto(d,s)}}}):e._e(),e.photoIsActive(i.$path)?[t("RemoveMenu",{ref:"removeMediaMenu",refInFor:!0,attrs:{modal_title:e.$t("remove_this_image")},on:{remove:function(d){return e.removeMedia(i.$path)}}},[t("button",{staticClass:"u-button u-button_small u-button_red",attrs:{slot:"trigger",type:"button",title:e.$t("remove_this_image")},slot:"trigger"},[t("b-icon",{attrs:{icon:"trash"}})],1)]),t("button",{staticClass:"u-button u-button_small",attrs:{type:"button"},on:{click:function(d){e.show_options_menu=!e.show_options_menu}}},[t("b-icon",{attrs:{icon:"three-dots"}})],1),e.show_options_menu?t("BaseModal2",{attrs:{title:e.$t("photo")+" "+(s+1)},on:{close:function(d){e.show_options_menu=!1}}},[t("MediaContent",{staticClass:"_previewImage",attrs:{file:i,resolution:1600}}),t("div",{staticClass:"u-spacingBottom"}),t("div",{staticClass:"u-sameRow _options"},[t("DownloadFile",{attrs:{file:i}},[t("b-icon",{attrs:{icon:"file-earmark-arrow-down"}}),e._v(" "+e._s(e.$t("download"))+" "),(n=i.$infos)!=null&&n.size?[e._v(" ("+e._s(e.formatBytes(i.$infos.size))+") ")]:e._e()],2)],1),t("div"),t("template",{slot:"footer"},[t("button",{staticClass:"u-button",attrs:{type:"button"},on:{click:function(d){e.show_options_menu=!1}}},[t("b-icon",{attrs:{icon:"x-circle"}}),e._v(" "+e._s(e.$t("cancel"))+" ")],1),t("button",{staticClass:"u-button u-button_orange",attrs:{type:"button"},on:{click:function(d){return e.saveToProject(i.$path)}}},[t("span",{staticClass:"u-icon",domProps:{innerHTML:e._s(e.dodoc_icon_collect)}}),e._v(" "+e._s(e.$t("save_to_project"))+" ")]),e.status_saving_to_project?t("div",{staticClass:"_saveNotice"},[e.status_saving_to_project==="saving"?t("div",[t("LoaderSpinner"),e._v(" "+e._s(e.$t("saving"))+" ")],1):e.status_saving_to_project==="saved"?t("div",[e._v(" "+e._s(e.$t("media_was_saved_to_project"))+" ")]):e._e()]):e._e()])],2):e._e()]:e._e()],2)],1)}),t("div",{key:"live_feed",staticClass:"m_stopmotionpanel--medias--list--items",class:{"is--current_single":e.show_live_feed},attrs:{"data-content":e.$t("live")},on:{click:e.showVideoFeed}},[t("video",{ref:"videoElement",attrs:{autoplay:"",playsinline:"",muted:""},domProps:{muted:!0,srcObject:e.stream}}),e.show_live_feed?t("div",{key:"_onion_skin",staticClass:"_onion_skin"},[t("label",{},[t("span",[e._v(e._s(e.$t("onion_skin").toLowerCase()))]),t("input",{staticClass:"_onion_skin_range",attrs:{type:"range",min:"0",max:".9",step:"0.01","data-use":"onionskin"},domProps:{value:e.onion_skin_opacity},on:{input:function(i){return e.$emit("update:onion_skin_opacity",+i.target.value)}}})])]):e._e()])],2)],1)],e.validating_video_preview?t("MediaValidationButtons",{attrs:{media_is_being_sent:e.media_is_being_sent,can_add_to_fav:!0,cancelButtonIsBackButton:!0},on:{cancel:e.backToStopmotion,save:function(i){return e.exportStopmotion()},save_and_fav:function(i){return e.exportStopmotion({fav:!0})}}}):e._e(),e.media_is_being_sent?t("div",{staticClass:"_loader"},[t("LoaderSpinner")],1):e._e()]:t("LoaderSpinner")],2)},$t=[],Rt=ee(kt,St,$t,!1,null,"f52c9b44");const Tt=Rt.exports,Mt={props:{location_to_add_to_medias:Object},components:{},data(){return{}},created(){},mounted(){},beforeDestroy(){},watch:{},computed:{},methods:{newPosition(o){this.$emit("update:location_to_add_to_medias",o),setTimeout(()=>{this.$emit("close")},1e3)}}};var Dt=function(){var e=this,t=e._self._c;return t("BaseModal2",{attrs:{title:e.$t("location")},on:{close:function(i){return e.$emit("close")}}},[t("div",{staticClass:"u-instructions u-spacingBottom"},[e._v(" "+e._s(e.$t("location_stored_in_localstorage"))+" ")]),t("PositionPicker",{attrs:{field_name:"$location",content:e.location_to_add_to_medias,can_edit:!0},on:{newPosition:e.newPosition}})],1)},Lt=[],Ut=ee(Mt,Dt,Lt,!1,null,"923bb630");const It=Ut.exports,Et={props:{label:String,pane_type:String},components:{},data(){return{}},created(){},mounted(){},beforeDestroy(){},watch:{},computed:{},methods:{}};var Bt=function(){var e=this,t=e._self._c;return t("div",{staticClass:"_capturePane",attrs:{"data-type":e.pane_type}},[t("div",{staticClass:"_topbar"},[t("div",{staticClass:"_topbar--title"},[t("h3",{},[e._v(" "+e._s(e.label)+" ")]),t("button",{staticClass:"u-button u-button_icon _close_button",attrs:{type:"button"},on:{click:function(i){return e.$emit("close")}}},[t("b-icon",{attrs:{icon:"x-lg",label:e.$t("close")}})],1)])]),e._t("default")],2)},At=[],Pt=ee(Et,Bt,At,!1,null,"409b3941");const Ft=Pt.exports,Ot={props:{audio_output_deviceId:String},components:{},data(){return{is_loading_available_devices:!1,is_loading_feed:!1,status:void 0,local_stream:void 0,stream_current_settings:void 0,desired_camera_resolution:void 0,last_working_resolution:void 0,selected_devices:{video_input_device:void 0,audio_input_device:void 0,audio_output_device:void 0},connected_devices:[],predefined_resolutions:[{label:this.$t("very_high"),label_detail:"4K(UHD)",width:3840,height:2160,ratio:"16:9"},{label:this.$t("high"),label_detail:"1080p(FHD)",width:1920,height:1080,ratio:"16:9"},{label:this.$t("medium"),label_detail:"720p(HD)",width:1280,height:720,ratio:"16:9"},{label:this.$t("low"),label_detail:"VGA",width:640,height:480,ratio:"4:3"}],unavailable_camera_resolutions:[],custom_camera_resolution:{label:this.$t("custom_f"),type:"custom",width:1280,height:720},advanced_capture_options:{echoCancellation:{supported:void 0,enabled:!1},noiseSuppression:{supported:void 0,enabled:!1},cursor:{supported:void 0,enabled:!1}}}},created(){},async mounted(){try{await this.initializeCaptureSettings()}catch(o){console.error("Failed to initialize capture settings:",o),this.handleInitializationError(o),this.is_loading_feed=!1,this.is_loading_available_devices=!1,this.$emit("hasFinishedLoading")}},async beforeDestroy(){try{await this.cleanupStream()}catch(o){console.warn("Error during component cleanup:",o)}},watch:{"selected_devices.video_input_device":function(){this.unavailable_camera_resolutions=[],this.last_working_resolution=!1},selected_devices:{async handler(){try{localStorage.setItem("selected_devices",JSON.stringify(this.selected_devices)),await this.setCameraStreamFromDefaults()}catch(o){console.error("Error in selected_devices watcher:",o)}},deep:!0},desired_camera_resolution:{async handler(){try{await this.setCameraStreamFromDefaults()}catch(o){console.error("Error in desired_camera_resolution watcher:",o)}},deep:!0},last_working_resolution:{handler(){},deep:!0}},computed:{all_video_input_devices(){return this.connected_devices.filter(o=>o.kind==="videoinput")},all_audio_input_devices(){return this.connected_devices.filter(o=>o.kind==="audioinput")},all_audio_output_devices(){return this.connected_devices.filter(o=>o.kind==="audiooutput")},current_settings(){let o="";return this.selected_devices.video_input_device&&(o+=this.selected_devices.video_input_device.deviceId+"-",this.selected_devices.video_input_device.deviceId==="screen_capture"&&(o+=this.advanced_capture_options.cursor.enabled+"-")),this.desired_camera_resolution&&this.desired_camera_resolution.width&&this.desired_camera_resolution.height&&(o+=this.desired_camera_resolution.width+"x"+this.desired_camera_resolution.height+"-"),this.selected_devices.audio_input_device&&(o+=this.selected_devices.audio_input_device.deviceId+"-",o+=this.advanced_capture_options.noiseSuppression.enabled+"-",o+=this.advanced_capture_options.echoCancellation.enabled+"-"),this.selected_devices.audio_output_device&&(o+=this.selected_devices.audio_output_device.deviceId+"-"),o}},methods:{async initializeCaptureSettings(){if(console.log("Starting capture settings initialization..."),!this.checkBrowserCompatibility()){console.log("Browser compatibility check failed");return}this.is_loading_feed=!0,this.is_loading_available_devices=!0;try{console.log("Requesting initial permissions..."),await this.requestInitialPermissions(),console.log("Refreshing available devices..."),await this.refreshAvailableDevices(),console.log("Setting default inputs and outputs..."),this.setDefaultInputsAndOutputs(),console.log("Setting up camera stream..."),await this.setCameraStreamFromDefaults(),console.log("Initialization completed successfully"),this.is_loading_feed=!1,this.$emit("hasFinishedLoading")}catch(o){throw console.error("Initialization failed:",o),this.is_loading_feed=!1,this.$emit("hasFinishedLoading"),o}},async manualRefreshDevices(){try{console.log("Manual device refresh requested"),await this.refreshAvailableDevices(),this.setDefaultInputsAndOutputs(),await this.setCameraStreamFromDefaults()}catch(o){console.error("Manual refresh failed:",o),this.$alertify.closeLogOnClick(!0).delay(4e3).error("Failed to refresh devices. Please check your permissions and try again.")}},checkBrowserCompatibility(){return!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia?(this.$alertify.closeLogOnClick(!0).delay(4e3).error(this.$t("browser_not_supported")||"Your browser doesn't support media capture"),!1):!0},async requestInitialPermissions(){try{console.log("Requesting getUserMedia permissions...");const o=await navigator.mediaDevices.getUserMedia({audio:!0,video:!0});console.log("Permissions granted, stream created:",o),this.local_stream=o}catch(o){throw console.error("Permission request failed:",o),this.handlePermissionError(o),o}},handlePermissionError(o){let e=this.$t("couldnt_load_getusermedia")||"Could not access media devices";switch(o.name){case"NotAllowedError":e+="<br>"+(this.$t("permission_denied")||"Permission denied"),this.status="not_allowed";break;case"NotFoundError":e+="<br>"+(this.$t("no_media_devices")||"No media devices found");break;case"NotReadableError":e+="<br>"+(this.$t("device_in_use")||"Device is already in use");break;default:e+="<br>"+o.name+": "+o.message}this.$alertify.closeLogOnClick(!0).delay(4e3).error(e)},handleInitializationError(o){console.error("Initialization error:",o),this.$alertify.closeLogOnClick(!0).delay(4e3).error((this.$t("failed_to_initialize_capture")||"Failed to initialize capture settings")+"<br>"+o.message),this.$emit("show")},async listDevices(){this.$root.debug_mode===!0&&console.log("CaptureSettings ‚Ä¢ METHODS : listDevices");try{const o=await navigator.mediaDevices.enumerateDevices();if(!Array.isArray(o))throw new Error("Invalid devices response from browser");try{const e=await this.getDesktopCapturer();if(Array.isArray(e))return o.concat(e)}catch(e){console.warn("Failed to get desktop sources:",e)}return o}catch(o){throw console.error("Failed to enumerate devices:",o),new Error(`Device enumeration failed: ${o.message}`)}},resInstructions(o){if(o.type!=="custom")return`${o.label_detail} ‚Ä¢ ${o.ratio} ‚Ä¢ ${o.width}√ó${o.height} ${this.$t("pixels")}`},setSupportedConstraints(){this.$root.debug_mode===!0&&console.log("CaptureSettings ‚Ä¢ METHODS : setSupportedConstraints");try{const o=navigator.mediaDevices.getSupportedConstraints();if(!o){console.warn("getSupportedConstraints not available");return}Object.keys(this.advanced_capture_options).forEach(e=>{const t=o[e]===!0;this.advanced_capture_options[e].supported=t,t&&(this.advanced_capture_options[e].enabled=!0)})}catch(o){console.error("Failed to set supported constraints:",o)}},setDefaultInputsAndOutputs(){this.$root.debug_mode===!0&&console.log("CaptureSettings ‚Ä¢ METHODS : setDefaultInputsAndOutputs"),this.connected_devices.length!==0&&(this.all_video_input_devices.length>0&&(this.selected_devices.video_input_device=this.getDefaultDevice({key:"video_input_device",option_preference:{key:"facingMode",value:"environment"},devices_list:this.all_video_input_devices})),this.all_audio_input_devices.length>0&&(this.selected_devices.audio_input_device=this.getDefaultDevice({key:"audio_input_device",devices_list:this.all_audio_input_devices})),this.all_audio_output_devices.length>0&&(this.selected_devices.audio_output_device=this.getDefaultDevice({key:"audio_output_device",devices_list:this.all_audio_output_devices})),this.desired_camera_resolution=this.predefined_resolutions.find(o=>o.height===720))},getDefaultDevice({key:o,option_preference:e,devices_list:t}){var r;if(this.$root.debug_mode===!0&&console.log(`CaptureSettings ‚Ä¢ METHODS : getDefaultDevice ${o} ${e} ${t}`),!o||!Array.isArray(t)||t.length===0)return console.warn("Invalid parameters for getDefaultDevice"),t[0]||null;let i=null;try{const s=localStorage.getItem("selected_devices");if(s&&(i=JSON.parse(s),(r=i==null?void 0:i[o])!=null&&r.deviceId)){const n=t.find(d=>d.deviceId===i[o].deviceId);if(n)return n}}catch(s){console.warn("Failed to parse stored devices:",s),localStorage.removeItem("selected_devices")}if(e!=null&&e.key&&(e!=null&&e.value)){const s=t.find(n=>n[e.key]===e.value);if(s)return s}return this.$root.debug_mode===!0&&console.log(`CaptureSettings ‚Ä¢ METHODS : getDefaultDevice ‚Äî setting first available device for ${o}`),t[0]},async startMediaDeviceFeed(o){if(this.$root.debug_mode===!0&&console.log("CaptureSettings ‚Ä¢ METHODS : startMediaDeviceFeed"),!o||typeof o!="object")throw new Error("Invalid constraints provided");try{const e=await Promise.allSettled([this.startVideoFeed(o),this.startAudioFeed(o)]),t=[],i=[];if(e[0].status==="fulfilled"&&e[0].value){const r=e[0].value;r.stream&&t.push(...r.stream.getTracks())}else e[0].status==="rejected"&&i.push(`Video: ${e[0].reason.message}`);if(e[1].status==="fulfilled"&&e[1].value){const r=e[1].value;r.stream&&t.push(...r.stream.getAudioTracks())}else e[1].status==="rejected"&&i.push(`Audio: ${e[1].reason.message}`);if(t.length===0)throw new Error(`No media tracks available. ${i.join("; ")}`);return new MediaStream(t)}catch(e){throw console.error("Failed to start media device feed:",e),e}},async startVideoFeed(o){if(!o.video)return null;try{let e;return o._is_webrtc_screen_capture===!0?e=await navigator.mediaDevices.getDisplayMedia({video:o.video,audio:!1}):e=await navigator.mediaDevices.getUserMedia({video:o.video,audio:!1}),{type:"videoStream",stream:e}}catch(e){throw console.error("Failed to start video feed:",e),e}},async startAudioFeed(o){if(!o.audio)return null;try{return{type:"audioStream",stream:await navigator.mediaDevices.getUserMedia({video:!1,audio:o.audio})}}catch(e){throw console.error("Failed to start audio feed:",e),e}},async getDesktopCapturer(){if(!window.electronAPI||!window.electronAPI.desktopCapturer)return this.$root.debug_mode===!0&&console.log("Desktop capture not available (not in Electron or API missing)"),[];this.$root.debug_mode===!0&&console.log("CaptureSettings ‚Ä¢ METHODS : getDesktopCapturer");try{const o=await window.electronAPI.desktopCapturer({types:["window","screen"]});if(!o||!Array.isArray(o))return console.log("No desktop sources available"),[];const e=o.map(t=>({chromeMediaSource:"desktop",deviceId:t.id,kind:"videoinput",label:"üñ•Ô∏è "+t.name,thumbnail:t.thumbnail}));return console.log(`Found ${e.length} desktop sources`),e}catch(o){return console.error("Desktop capture error:",o),[]}},async refreshAvailableDevices(){console.log("Refreshing available devices..."),this.connected_devices=[],this.is_loading_available_devices=!0;try{console.log("Setting supported constraints..."),this.setSupportedConstraints(),console.log("Enumerating devices...");const o=await this.listDevices();console.log("Found devices:",o.length),this.connected_devices=o.map(e=>{var d,c;const{label:t,kind:i,deviceId:r,chromeMediaSource:s=!1}=e;let n={};try{const f=(d=e.getCapabilities)==null?void 0:d.call(e);n=((c=f==null?void 0:f.facingMode)==null?void 0:c[0])||{}}catch(f){console.warn("Could not get device capabilities:",f)}return{label:t||`Unknown ${i}`,kind:i,deviceId:r,facingMode:n,chromeMediaSource:s}}),this.connected_devices.push({deviceId:"screen_capture",kind:"videoinput",label:"üñ•Ô∏è "+this.$t("screen_capture")}),console.log("Processed devices:",this.connected_devices.length),this.is_loading_available_devices=!1}catch(o){throw console.error("Failed to refresh available devices:",o),this.is_loading_available_devices=!1,this.$alertify.closeLogOnClick(!0).delay(4e3).error((this.$t("failed_listing_devices")||"Failed to list devices")+"<br>"+o.message),o}},async setCameraStreamFromDefaults(){var o;this.$root.debug_mode===!0&&console.log("CaptureSettings ‚Ä¢ METHODS : setCameraStreamFromDefaults"),this.is_loading_feed=!0;try{this.selected_devices.audio_output_device&&this.$emit("update:audio_output_deviceId",this.selected_devices.audio_output_device.deviceId),await this.startLocalStream(),this.stream_current_settings=this.current_settings,this.last_working_resolution=this.desired_camera_resolution,this.is_loading_feed=!1}catch(e){if(this.is_loading_feed=!1,console.error("Failed to set camera stream:",e),this.$alertify.closeLogOnClick(!0).delay(4e3).error((this.$t("failed_to_start_streams_change_source_or_res")||"Failed to start streams. Try changing source or resolution")+"<br>"+e.name),((o=this.desired_camera_resolution)==null?void 0:o.type)!=="custom"&&this.last_working_resolution)this.unavailable_camera_resolutions.push(this.desired_camera_resolution.label),this.desired_camera_resolution=this.last_working_resolution,this.last_working_resolution=!1,setTimeout(async()=>{try{await this.setCameraStreamFromDefaults()}catch(t){console.error("Retry failed:",t)}},500);else throw e}},async startLocalStream(){this.$root.debug_mode===!0&&console.log("CaptureSettings ‚Ä¢ METHODS : startLocalStream");try{await this.cleanupStream();const o=this.createConstraintsFromSelected();this.validateConstraints(o);const e=await this.startMediaDeviceFeed(o);return this.local_stream=e,this.$emit("setStream",e),e}catch(o){throw console.error("getUserMedia error:",o),this.$emit("show"),o.name==="NotAllowedError"&&(this.status="not_allowed"),o}},async cleanupStream(){if(this.local_stream)try{this.local_stream.getTracks().forEach(o=>o.stop()),this.local_stream=void 0,await new Promise(o=>setTimeout(o,200))}catch(o){console.warn("Error during stream cleanup:",o)}},validateConstraints(o){if(!o||typeof o!="object")throw new Error("Invalid constraints object");if(o.video&&typeof o.video=="object"&&o.video.width&&o.video.height&&(o.video.width<1||o.video.height<1))throw new Error("Invalid video dimensions");o.audio&&typeof o.audio=="object"&&o.audio.deviceId&&!o.audio.deviceId.exact&&console.warn("Audio deviceId should use exact constraint")},createConstraintsFromSelected(){var e,t;this.$root.debug_mode===!0&&console.log("CaptureSettings ‚Ä¢ METHODS : createConstraintsFromSelected");const o={audio:!1,video:!1};if(this.selected_devices.audio_input_device&&(o.audio={deviceId:this.selected_devices.audio_input_device.deviceId?{exact:this.selected_devices.audio_input_device.deviceId}:void 0,echoCancellation:this.advanced_capture_options.echoCancellation.enabled,noiseSuppression:this.advanced_capture_options.noiseSuppression.enabled}),this.selected_devices.video_input_device){const i=this.selected_devices.video_input_device;i.chromeMediaSource?(o._is_electron_screen_capture=!0,o.video={mandatory:{chromeMediaSource:i.chromeMediaSource,chromeMediaSourceId:i.deviceId}}):i.deviceId==="screen_capture"?(o._is_webrtc_screen_capture=!0,o.video={cursor:this.advanced_capture_options.cursor.enabled}):(o.video={deviceId:i.deviceId?{exact:i.deviceId}:void 0},(e=this.desired_camera_resolution)!=null&&e.width&&((t=this.desired_camera_resolution)!=null&&t.height)&&(o.video.width={exact:this.desired_camera_resolution.width},o.video.height={exact:this.desired_camera_resolution.height}))}return this.$root.debug_mode===!0&&console.log("Constraints = "+JSON.stringify(o,null,4)),o}}};var Vt=function(){var e=this,t=e._self._c;return t("div",{staticClass:"m_captureSettings"},[t("transition",{attrs:{name:"fade_fast",duration:400}},[e.is_loading_available_devices||e.is_loading_feed?t("LoaderSpinner",{staticClass:"_loader"}):e._e()],1),t("div",{staticClass:"m_captureSettings--settings"},[t("div",{},[e.status==="not_allowed"?t("div",[t("div",{staticClass:"padding-top-verysmall"},[e._v(" "+e._s(e.$t("camera_access_refused"))+" ")])]):e._e(),t("label",{staticClass:"u-label _sourcesTitle"},[e._v(" "+e._s(e.$t("sources"))+" "),t("button",{staticClass:"u-buttonLink margin-none margin-left padding-bottom-none",attrs:{type:"button"},on:{click:e.manualRefreshDevices}},[e._v(" "+e._s(e.$t("reload"))+" ")])]),t("div",{},[t("div",{},[t("label",{staticClass:"u-label"},[e._v(e._s(e.$t("camera")))]),t("div",[e.all_video_input_devices.length===0?t("small",[e._v(" "+e._s(e.$t("no_video_input_available"))+" ")]):t("select",{directives:[{name:"model",rawName:"v-model",value:e.selected_devices.video_input_device,expression:"selected_devices.video_input_device"}],attrs:{id:"devices",name:"Video devices",title:"devices"},on:{change:function(i){var r=Array.prototype.filter.call(i.target.options,function(s){return s.selected}).map(function(s){var n="_value"in s?s._value:s.value;return n});e.$set(e.selected_devices,"video_input_device",i.target.multiple?r:r[0])}}},e._l(e.all_video_input_devices,function(i){return t("option",{key:i.deviceId,domProps:{value:i}},[e._v(" "+e._s(i.label)+" ")])}),0)]),e.selected_devices.video_input_device&&e.selected_devices.video_input_device.deviceId==="screen_capture"?t("div",{staticClass:"margin-top-veryverysmall"},[t("span",{staticClass:"u-switch u-switch-xs"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.advanced_capture_options.cursor.enabled,expression:"advanced_capture_options.cursor.enabled"}],attrs:{id:"show_cursor",type:"checkbox",disabled:!e.advanced_capture_options.cursor.supported,"true-value":"always","false-value":"never"},domProps:{checked:Array.isArray(e.advanced_capture_options.cursor.enabled)?e._i(e.advanced_capture_options.cursor.enabled,null)>-1:e._q(e.advanced_capture_options.cursor.enabled,"always")},on:{change:function(i){var r=e.advanced_capture_options.cursor.enabled,s=i.target,n=s.checked?"always":"never";if(Array.isArray(r)){var d=null,c=e._i(r,d);s.checked?c<0&&e.$set(e.advanced_capture_options.cursor,"enabled",r.concat([d])):c>-1&&e.$set(e.advanced_capture_options.cursor,"enabled",r.slice(0,c).concat(r.slice(c+1)))}else e.$set(e.advanced_capture_options.cursor,"enabled",n)}}}),t("label",{staticClass:"u-label",attrs:{for:"show_cursor"}},[e._v(e._s(e.$t("show_cursor")))]),e.advanced_capture_options.cursor.supported?e._e():t("small",[e._v(" "+e._s(e.$t("not_supported_on_this_device"))+" ")])])]):e._e()]),t("div",[t("label",{staticClass:"u-label"},[e._v(e._s(e.$t("audioinput")))]),t("div",[e.all_audio_input_devices.length===0?t("small",[e._v(" "+e._s(e.$t("no_audio_input_available"))+" ")]):t("select",{directives:[{name:"model",rawName:"v-model",value:e.selected_devices.audio_input_device,expression:"selected_devices.audio_input_device"}],attrs:{id:"devices",name:"Video devices",title:"devices"},on:{change:function(i){var r=Array.prototype.filter.call(i.target.options,function(s){return s.selected}).map(function(s){var n="_value"in s?s._value:s.value;return n});e.$set(e.selected_devices,"audio_input_device",i.target.multiple?r:r[0])}}},e._l(e.all_audio_input_devices,function(i){return t("option",{key:i.deviceId,domProps:{value:i}},[e._v(" "+e._s(i.label)+" ")])}),0)]),e.selected_devices.audio_input_device?t("div",{staticClass:"margin-top-veryverysmall"},[t("span",{staticClass:"u-switch u-switch-xs"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.advanced_capture_options.echoCancellation.enabled,expression:"advanced_capture_options.echoCancellation.enabled"}],attrs:{id:"echoCancellation",type:"checkbox",disabled:!e.advanced_capture_options.echoCancellation.supported},domProps:{checked:Array.isArray(e.advanced_capture_options.echoCancellation.enabled)?e._i(e.advanced_capture_options.echoCancellation.enabled,null)>-1:e.advanced_capture_options.echoCancellation.enabled},on:{change:function(i){var r=e.advanced_capture_options.echoCancellation.enabled,s=i.target,n=!!s.checked;if(Array.isArray(r)){var d=null,c=e._i(r,d);s.checked?c<0&&e.$set(e.advanced_capture_options.echoCancellation,"enabled",r.concat([d])):c>-1&&e.$set(e.advanced_capture_options.echoCancellation,"enabled",r.slice(0,c).concat(r.slice(c+1)))}else e.$set(e.advanced_capture_options.echoCancellation,"enabled",n)}}}),t("label",{staticClass:"u-label",attrs:{for:"echoCancellation"}},[e._v(e._s(e.$t("echoCancellation")))]),e.advanced_capture_options.echoCancellation.supported?e._e():t("small",[e._v(" "+e._s(e.$t("not_supported_on_this_device"))+" ")])])]):e._e(),e.selected_devices.audio_input_device?t("div",{staticClass:"margin-top-veryverysmall"},[t("span",{staticClass:"u-switch u-switch-xs"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.advanced_capture_options.noiseSuppression.enabled,expression:"advanced_capture_options.noiseSuppression.enabled"}],attrs:{id:"noiseSuppression",type:"checkbox",disabled:!e.advanced_capture_options.noiseSuppression.supported},domProps:{checked:Array.isArray(e.advanced_capture_options.noiseSuppression.enabled)?e._i(e.advanced_capture_options.noiseSuppression.enabled,null)>-1:e.advanced_capture_options.noiseSuppression.enabled},on:{change:function(i){var r=e.advanced_capture_options.noiseSuppression.enabled,s=i.target,n=!!s.checked;if(Array.isArray(r)){var d=null,c=e._i(r,d);s.checked?c<0&&e.$set(e.advanced_capture_options.noiseSuppression,"enabled",r.concat([d])):c>-1&&e.$set(e.advanced_capture_options.noiseSuppression,"enabled",r.slice(0,c).concat(r.slice(c+1)))}else e.$set(e.advanced_capture_options.noiseSuppression,"enabled",n)}}}),t("label",{staticClass:"u-label",attrs:{for:"noiseSuppression"}},[e._v(e._s(e.$t("noiseSuppression")))]),e.advanced_capture_options.noiseSuppression.supported?e._e():t("small",[e._v(" "+e._s(e.$t("not_supported_on_this_device"))+" ")])])]):e._e()]),t("div",[t("label",{staticClass:"u-label"},[e._v(e._s(e.$t("audiooutput")))]),t("div",[e.all_audio_output_devices.length===0?t("small",[e._v(" "+e._s(e.$t("no_audio_output_available"))+" ")]):t("select",{directives:[{name:"model",rawName:"v-model",value:e.selected_devices.audio_output_device,expression:"selected_devices.audio_output_device"}],attrs:{id:"devices",name:"Video devices",title:"devices"},on:{change:function(i){var r=Array.prototype.filter.call(i.target.options,function(s){return s.selected}).map(function(s){var n="_value"in s?s._value:s.value;return n});e.$set(e.selected_devices,"audio_output_device",i.target.multiple?r:r[0])}}},e._l(e.all_audio_output_devices,function(i){return t("option",{key:i.deviceId,domProps:{value:i}},[e._v(" "+e._s(i.label)+" ")])}),0)])])]),t("div",{staticClass:"u-spacingBottom"}),t("label",{staticClass:"u-label"},[e._v(e._s(e.$t("resolutions")))]),t("div",[!e.selected_devices.video_input_device||!e.selected_devices.video_input_device.deviceId?t("div",[t("small",[e._v(" "+e._s(e.$t("pick_a_camera"))+" ")])]):e._e(),e.selected_devices.video_input_device&&(e.selected_devices.video_input_device.deviceId==="screen_capture"||e.selected_devices.video_input_device.chromeMediaSource)?t("div",[t("small",[e._v(" "+e._s(e.$t("cant_pick_resolution_when_screen_capture"))+" ")])]):t("div",{staticClass:"m_captureSettings--settings--resolutions"},[e._l(e.predefined_resolutions.concat(e.custom_camera_resolution),function(i){return t("div",{key:i.name},[t("label",{attrs:{for:i.label}},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.desired_camera_resolution,expression:"desired_camera_resolution"}],attrs:{type:"radio",id:i.label,disabled:e.unavailable_camera_resolutions.includes(i.label)},domProps:{value:i,checked:e._q(e.desired_camera_resolution,i)},on:{change:function(r){e.desired_camera_resolution=i}}}),t("span",{staticClass:"_resolutionLabel"},[t("DLabel",{attrs:{str:i.label,tag:"div",instructions:e.resInstructions(i)}})],1)])])}),e.desired_camera_resolution&&e.desired_camera_resolution.type==="custom"?t("div",{staticClass:"u-sameRow _customResolution"},[t("label",{staticClass:"u-label",attrs:{for:"custom_width"}},[t("input",{directives:[{name:"model",rawName:"v-model.number",value:e.desired_camera_resolution.width,expression:"desired_camera_resolution.width",modifiers:{number:!0}}],attrs:{name:"custom_width",type:"number",min:"2",max:"4096",step:"2"},domProps:{value:e.desired_camera_resolution.width},on:{input:function(i){i.target.composing||e.$set(e.desired_camera_resolution,"width",e._n(i.target.value))},blur:function(i){return e.$forceUpdate()}}})]),t("span",{staticClass:"u-padding_verysmall _customResolutionX"},[e._v(" √ó ")]),t("label",{staticClass:"u-label",attrs:{for:"custom_height"}},[t("input",{directives:[{name:"model",rawName:"v-model.number",value:e.desired_camera_resolution.height,expression:"desired_camera_resolution.height",modifiers:{number:!0}}],attrs:{name:"custom_height",type:"number",min:"2",max:"2160",step:"2"},domProps:{value:e.desired_camera_resolution.height},on:{input:function(i){i.target.composing||e.$set(e.desired_camera_resolution,"height",e._n(i.target.value))},blur:function(i){return e.$forceUpdate()}}}),e._v(" "+e._s(e.$t("pixels"))+" ")])]):e._e()],2)])])]),e._e()],1)},Ht=[],zt=ee(Ot,Vt,Ht,!1,null,"3252ec3b");const Nt=zt.exports,jt={props:{enable_effects:Boolean,videoElement:HTMLVideoElement,canvasElement:HTMLCanvasElement,project_path:String},components:{ImageSelect:()=>Qe(()=>import("./ImageSelect-WloVdUcR.js"),[])},data(){return{source_stream_resolution:{width:void 0,height:void 0},flip_horizontally:!1,flip_vertically:!1,select_image:!1,chroma_key_replacement_image_url:void 0,chroma_key_settings:{enable:!1,key_color:{r:0,g:255,b:0},similarity:.05,smoothness:.12,spill:.2,replacement_color:{r:252,g:75,b:96},replacement_mode:"color",replacement_image:void 0},zoom:{value:1,min:1,max:10,step:.1,ticks:[1,2,3,4,5,6,7,8,9,10],default:1},image_filters_settings:{brightness:{value:1,order:0,default:1,min:0,max:2,step:.01},contrast:{value:1,order:1,default:1,min:0,max:3,step:.01},hue:{value:0,order:2,default:0,min:-.5,max:.5,step:.01},saturation:{value:0,order:3,default:0,min:-1,max:1,step:.01},lightness:{value:0,order:4,default:0,min:-1,max:1,step:.01},dotscreen:{value:10,order:6,default:10,min:3,max:20,step:.01}},enable_pick_color_from_video:!1,offscreen_canvas:void 0,fragment_shader:`
precision mediump float;
#define PI 3.1415926538

uniform sampler2D videoTex;
uniform float texWidth;
uniform float texHeight;

uniform float zoom;
uniform int flipHorizontally;
uniform int flipVertically;


uniform vec3 keyColor;
uniform vec3 replacementColor;
uniform sampler2D replacementImage;

uniform float similarity;
uniform float smoothness;
uniform float spill;
uniform int chromaKeyMode;

uniform float brightness;
uniform float contrast;
uniform float mid;

uniform float hue;
uniform float saturation;
uniform float lightness;

uniform float dotscreen;


// From https://github.com/libretro/glsl-shaders/blob/master/nnedi3/shaders/rgb-to-yuv.glsl
vec2 RGBtoUV(vec3 rgb) {
  return vec2(
    rgb.r * -0.169 + rgb.g * -0.331 + rgb.b *  0.5    + 0.5,
    rgb.r *  0.5   + rgb.g * -0.419 + rgb.b * -0.081  + 0.5
  );
}

vec4 ProcessChromaKey(vec2 texCoord, vec4 videoColor) {
  float chromaDist = distance(RGBtoUV(videoColor.rgb), RGBtoUV(keyColor));

  float baseMask = chromaDist - similarity;
  float fullMask = pow(clamp(baseMask / smoothness, 0., 1.), 1.5);
  videoColor.a = fullMask;

  float spillVal = pow(clamp(baseMask / spill, 0., 1.), 1.5);
  float desat = clamp(videoColor.r * 0.2126 + videoColor.g * 0.7152 + videoColor.b * 0.0722, 0., 1.);
  videoColor.rgb = mix(vec3(desat, desat, desat), videoColor.rgb, spillVal);

  return videoColor;
}
vec4 ApplyChromaKey(vec2 texCoord, vec4 videoColor)  {
  vec4 chromaVideoColor = ProcessChromaKey(texCoord, videoColor);

  vec4 replaceWith = vec4(0.0);
  if(chromaKeyMode == 0) {
    // color
    replaceWith = vec4(replacementColor, 1.0);
  } else if(chromaKeyMode == 1) {
    // image
    replaceWith = vec4(texture2D(replacementImage, texCoord));
  }

  vec4 result = mix(vec4(chromaVideoColor.rgb, 1.0), replaceWith, 1.0 - chromaVideoColor.a);
  return result;
}

vec3 RGBtoHCV(vec3 RGB) {
  float Epsilon = 0.00000000001;
  // Based on work by Sam Hocevar and Emil Persson
  vec4 P = (RGB.g < RGB.b) ? vec4(RGB.bg, -1.0, 2.0/3.0) : vec4(RGB.gb, 0.0, -1.0/3.0);
  vec4 Q = (RGB.r < P.x) ? vec4(P.xyw, RGB.r) : vec4(RGB.r, P.yzx);
  float C = Q.x - min(Q.w, Q.y);
  float H = abs((Q.w - Q.y) / (6.0 * C + Epsilon) + Q.z);
  return vec3(H, C, Q.x);
}
vec3 HUEtoRGB(float h) {
  float r = abs(h * 6.0 - 3.0) - 1.0;
  float g = 2.0 - abs(h * 6.0 - 2.0);
  float b = 2.0 - abs(h * 6.0 - 4.0);
  return clamp(vec3(r, g, b), 0.0, 1.0);
}

vec3 RGBtoHSL(vec3 RGB) {
  float Epsilon = 0.00000000001;
  vec3 HCV = RGBtoHCV(RGB);
  float L = HCV.z - HCV.y * 0.5;
  float S = HCV.y / (1.0 - abs(L * 2.0 - 1.0) + Epsilon);
  return vec3(HCV.x, S, L);
}
vec3 HSLtoRGB(vec3 HSL) {
  vec3 RGB = HUEtoRGB(HSL.x);
  float C = (1.0 - abs(2.0 * HSL.z - 1.0)) * HSL.y;
  return (RGB - 0.5) * C + HSL.z;
}
float clamp_continuous(float value) {
  float unit = value;

  if (unit > 1.0) {
    unit = mod(unit, 1.0);
  } else if (unit < 0.0) {
    unit = 1.0 + unit;
  }

  return unit;
}

float mix_factor(vec4 range, vec3 hsl) {
  float mix_factor = 0.0;

  if (hsl.x >= range.x && hsl.x <= range.w) {
    // lower range
    if (hsl.x >= range.x && hsl.x < range.y) {
      mix_factor = smoothstep(range.x, range.y, hsl.x);
    }

    // target range
    if (hsl.x >= range.y && hsl.x <= range.z) {
      mix_factor = 1.0;
    }

    // upper range
    if (hsl.x > range.z && hsl.x <= range.w) {
      mix_factor = 1.0 - smoothstep(range.z, range.w, hsl.x);
    }
  }

  vec2 lightness_range = vec2(0.0, 0.08333);
  vec2 saturation_range = vec2(0.0, 0.08333);
  mix_factor *= smoothstep(saturation_range.x, saturation_range.y, hsl.y);
  mix_factor *= smoothstep(lightness_range.x, lightness_range.y, hsl.z);

  return mix_factor;
}

float pattern(vec2 texCoord) {
  float angle = PI / 8.0;
  float s = sin(angle), c = cos(angle);
  vec2 tex = texCoord * vec2(texWidth, texHeight) - vec2(0.5, 0.5);
  vec2 point = vec2(
      c * tex.x - s * tex.y,
      s * tex.x + c * tex.y
  ) * (PI / dotscreen);
  return (sin(point.x) * sin(point.y)) * 4.0;
}

void main(void) {
  // get video image
  vec2 texCoord = vec2(gl_FragCoord.x/texWidth, 1.0 - (gl_FragCoord.y/texHeight));

  if(flipVertically == 1)
    texCoord.y = 1.0 - texCoord.y;
  if(flipHorizontally == 1)
    texCoord.x = 1.0 - texCoord.x;

  // Apply zoom - center around 0.5, scale, then translate back
  texCoord.x = (texCoord.x - 0.5) / zoom + 0.5;
  texCoord.y = (texCoord.y - 0.5) / zoom + 0.5;

  // Check if coordinates are out of bounds after zoom
  if(texCoord.x < 0.0 || texCoord.x > 1.0 || texCoord.y < 0.0 || texCoord.y > 1.0) {
    gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);
    return;
  }

  vec4 videoColor = texture2D(videoTex, texCoord);

  // apply chroma key if necessary
  if (chromaKeyMode != -1000) {
    videoColor = ApplyChromaKey(texCoord, videoColor);
  }

  // apply brightness, from https://github.com/actionnick/exposure/blob/master/src/shaders/exposure.frag
  if(brightness != -1000.0) {
    videoColor = mix(videoColor, vec4(1.0, 1.0, 1.0, 1.0), brightness - 1.0);
    videoColor.a = 1.0;
  }

  // contrast
  if(contrast != -1000.0) {
    videoColor.r = ((videoColor.r - mid) * contrast) + mid;
    videoColor.g = ((videoColor.g - mid) * contrast) + mid;
    videoColor.b = ((videoColor.b - mid) * contrast) + mid;
    videoColor.a = 1.0;
  }

  // hue, saturation, lightness
  if(hue != -1000.0 || saturation != -1000.0 || lightness != -1000.0) {
    vec3 hsl = RGBtoHSL(videoColor.rgb);
    vec4 MASTER_RANGE = vec4(0.0, 0.0, 1.0, 1.0);

    float master_mix_factor = mix_factor(MASTER_RANGE, hsl);
    // hue
    if(hue != -1000.0) {
      hsl.x = clamp_continuous(hsl.x + (hue * master_mix_factor));
    }
    // saturation
    if(saturation != -1000.0) {
      hsl.y = clamp(hsl.y + (saturation * master_mix_factor), 0.0, 1.0);
    }
    // lightness
    if(lightness != -1000.0) {
      hsl.z = clamp(mix(hsl.z, 1.0, max(0.0, lightness)), 0.0, 1.0);
      hsl.z = clamp(mix(hsl.z, 0.0, abs(min(0.0, lightness))), 0.0, 1.0);
    }

    videoColor.rgb = HSLtoRGB(hsl);
  }

  if(dotscreen != -1000.0) {
    float average = (videoColor.r + videoColor.g + videoColor.b) / 3.0;
    videoColor = vec4(vec3(average * 10.0 - 5.0 + pattern(texCoord)), videoColor.a);
  }

  gl_FragColor = videoColor;

}
      `}},created(){},updated(){},mounted(){this.$eventHub.$on("captureCanvas.pixelColorUnderMouse",this.pixelColorUnderMouse)},beforeDestroy(){this.$eventHub.$off("captureCanvas.pixelColorUnderMouse",this.pixelColorUnderMouse),this.stopWebGL()},watch:{enable_effects(){this.enable_effects||this.disableAllEffects()},enable__(){this.$emit("update:enable_effects",this.enable__),this.enable__&&this.$nextTick(()=>{this.startWebGL()})},"chroma_key_settings.replacement_mode"(){this.chroma_key_settings.replacement_mode==="image"&&(this.chroma_key_replacement_image_url=void 0,this.select_image=!0)}},computed:{enable__(){return this.flip_vertically===!0||this.flip_horizontally===!0||this.zoom.value!==this.zoom.default||this.chroma_key_settings.enable===!0||Object.keys(this.image_filters_settings).some(o=>this.image_filters_settings[o].value!==this.image_filters_settings[o].default)},chroma_key_color_hex:{get(){return this.rgbToHex(this.chroma_key_settings.key_color)},set(o){this.chroma_key_settings.key_color=this.hexToRgb(o)}},chroma_key_replacement_color_hex:{get(){return this.rgbToHex(this.chroma_key_settings.replacement_color)},set(o){this.chroma_key_settings.replacement_color=this.hexToRgb(o)}}},methods:{disableAllEffects(){this.flip_vertically=!1,this.flip_horizontally=!1,this.zoom.value=1,this.chroma_key_settings.enable=!1,Object.keys(this.image_filters_settings).map(o=>{this.image_filters_settings[o].value=this.image_filters_settings[o].default})},hexToRgb(o){var e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(o);return e?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}:null},rgbToHex({r:o,g:e,b:t}){return o=o.toString(16),e=e.toString(16),t=t.toString(16),o.length==1&&(o="0"+o),e.length==1&&(e="0"+e),t.length==1&&(t="0"+t),"#"+o+e+t},setTogglePickColorFromVideo(){this.enable_pick_color_from_video?this.enable_pick_color_from_video=!1:this.enable_pick_color_from_video=!0},pixelColorUnderMouse({px_color:o,type:e}){this.enable_pick_color_from_video&&(this.chroma_key_settings.key_color=o,e==="click"&&this.setTogglePickColorFromVideo())},startWebGL(){console.log("CaptureEffects ‚Ä¢ METHODS : startWebGL"),this.offscreen_canvas&&this.stopWebGL(),this.offscreen_canvas=document.createElement("canvas"),this.offscreen_canvas.classList.add("offscreenCanvas");var o=this.canvasElement.getContext("2d");const e=this.offscreen_canvas.getContext("webgl",{premultipliedAlpha:!1}),t=e.createShader(e.VERTEX_SHADER);e.shaderSource(t,"attribute vec2 c; void main(void) { gl_Position=vec4(c, 0.0, 1.0); }"),e.compileShader(t);const i=e.createShader(e.FRAGMENT_SHADER);e.shaderSource(i,this.fragment_shader),e.compileShader(i),e.getShaderParameter(i,e.COMPILE_STATUS)||console.error(e.getShaderInfoLog(i));const r=e.createProgram();e.attachShader(r,t),e.attachShader(r,i),e.linkProgram(r),e.useProgram(r);const s=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,s),e.bufferData(e.ARRAY_BUFFER,new Float32Array([-1,1,-1,-1,1,-1,1,1]),e.STATIC_DRAW);const n=e.getAttribLocation(r,"c");e.vertexAttribPointer(n,2,e.FLOAT,!1,0,0),e.enableVertexAttribArray(n),e.activeTexture(e.TEXTURE0+0);const d=e.createTexture();e.bindTexture(e.TEXTURE_2D,d),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR);const c=e.getUniformLocation(r,"videoTex");e.uniform1i(c,0);const f=e.getUniformLocation(r,"texWidth"),l=e.getUniformLocation(r,"texHeight"),h=e.getUniformLocation(r,"zoom"),u=e.getUniformLocation(r,"flipHorizontally"),L=e.getUniformLocation(r,"flipVertically"),$=e.getUniformLocation(r,"keyColor"),P=e.getUniformLocation(r,"replacementColor"),C=e.getUniformLocation(r,"replacementImage");e.uniform1i(C,1);const D=e.getUniformLocation(r,"similarity"),j=e.getUniformLocation(r,"smoothness"),oe=e.getUniformLocation(r,"spill"),H=e.getUniformLocation(r,"chromaKeyMode"),ce=e.getUniformLocation(r,"mid"),_e=Object.keys(this.image_filters_settings).reduce((Y,q)=>(Y[q]=e.getUniformLocation(r,q),Y),{});this.loadReplacementImageInShader();const te=()=>{if(!this.offscreen_canvas||!this.enable__)return;console.log("CaptureEffects ‚Ä¢ METHODS : startWebGL ‚Ä¢ processFrame"),this.offscreen_canvas.width=this.videoElement.videoWidth,this.offscreen_canvas.height=this.videoElement.videoHeight,e.activeTexture(e.TEXTURE0+0),e.viewport(0,0,this.videoElement.videoWidth,this.videoElement.videoHeight),e.texImage2D(e.TEXTURE_2D,0,e.RGB,e.RGB,e.UNSIGNED_BYTE,this.videoElement),e.uniform1f(h,this.zoom.value),e.uniform1f(f,this.videoElement.videoWidth),e.uniform1f(l,this.videoElement.videoHeight),e.uniform1i(u,this.flip_horizontally?1:0),e.uniform1i(L,this.flip_vertically?1:0),e.uniform3f($,this.chroma_key_settings.key_color.r/255,this.chroma_key_settings.key_color.g/255,this.chroma_key_settings.key_color.b/255),e.uniform3f(P,this.chroma_key_settings.replacement_color.r/255,this.chroma_key_settings.replacement_color.g/255,this.chroma_key_settings.replacement_color.b/255),e.uniform1f(D,parseFloat(this.chroma_key_settings.similarity)),e.uniform1f(j,parseFloat(this.chroma_key_settings.smoothness)),e.uniform1f(oe,parseFloat(this.chroma_key_settings.spill)),Object.entries(_e).map(([q,fe])=>{e.uniform1f(fe,parseFloat(this.image_filters_settings[q].value!==this.image_filters_settings[q].default?this.image_filters_settings[q].value:-1e3))}),e.uniform1f(ce,parseFloat(.5));let Y=-1e3;this.chroma_key_settings.enable&&(this.chroma_key_settings.replacement_mode==="color"?Y=0:this.chroma_key_settings.replacement_mode==="image"&&(Y=1)),e.uniform1i(H,parseInt(Y)),e.drawArrays(e.TRIANGLE_FAN,0,4),o.drawImage(this.offscreen_canvas,0,0),window.requestAnimationFrame(te)};window.requestAnimationFrame(te)},stopWebGL(){this.offscreen_canvas=void 0},async newChromaKeyImage(o){if(console.log("CaptureEffects ‚Ä¢ METHODS : newChromaKeyImage"),!o){this.chroma_key_settings.replacement_image=void 0,this.chroma_key_replacement_image_url=void 0,this.loadReplacementImageInShader();return}const e=await createImageBitmap(o);this.chroma_key_replacement_image_url=URL.createObjectURL(o);const t=document.createElement("canvas"),i=t.getContext("2d");t.width=this.videoElement.videoWidth,t.height=this.videoElement.videoHeight;const r="cover",s=e.height/e.width,n=t.height/t.width;if(s<n&&r==="contain"||s>n&&r==="cover"){const d=t.width*s;i.drawImage(e,0,(t.height-d)/2,t.width,d)}if(s>n&&r==="contain"||s<n&&r==="cover"){const d=t.width*n/s;i.drawImage(e,(t.width-d)/2,0,d,t.height)}this.chroma_key_settings.replacement_image=i.getImageData(0,0,t.width,t.height),this.loadReplacementImageInShader(),t.remove()},getMediaSrcFromPath(o){const e=this.getMediaInFolder({path_to_source_media_meta:o}),t=this.getParent(e.$path);return this.makeRelativeURLFromThumbs({$thumbs:e.$thumbs,$type:e.$type,$path:t,resolution:1600})},loadReplacementImageInShader(){const o=this.offscreen_canvas.getContext("webgl",{premultipliedAlpha:!1});o.activeTexture(o.TEXTURE1);const e=o.createTexture();o.bindTexture(o.TEXTURE_2D,e),this.chroma_key_settings.replacement_image&&o.texImage2D(o.TEXTURE_2D,0,o.RGBA,o.RGBA,o.UNSIGNED_BYTE,this.chroma_key_settings.replacement_image),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.LINEAR)}}};var Gt=function(){var e=this,t=e._self._c;return t("div",{staticClass:"m_captureEffects"},[t("div",{staticClass:"_content"},[t("div",{staticClass:"_options"},[t("ToggleInput",{attrs:{content:e.flip_horizontally,label:e.$t("flip_horizontally")},on:{"update:content":function(i){e.flip_horizontally=i}}}),t("ToggleInput",{attrs:{content:e.flip_vertically,label:e.$t("flip_vertically")},on:{"update:content":function(i){e.flip_vertically=i}}}),t("RangeValueInput",{attrs:{label:e.$t("zoom"),value:e.zoom.value,can_toggle:!0,min:e.zoom.min,max:e.zoom.max,step:e.zoom.step,ticks:e.zoom.ticks,default_value:e.zoom.default},on:{input:function(i){e.zoom.value=i}}}),t("ToggledSection",{attrs:{label:e.$t("chroma_key"),show_toggle:e.chroma_key_settings.enable},on:{"update:show_toggle":function(i){return e.$set(e.chroma_key_settings,"enable",i)}}},[t("fieldset",[t("legend",{staticClass:"u-label"},[e._v(e._s(e.$t("chroma_key_color")))]),t("ColorInput",{attrs:{label:e.$t("color"),can_toggle:!1,value:e.chroma_key_color_hex},on:{save:function(i){e.chroma_key_color_hex=i}}}),t("div",[t("button",{staticClass:"u-buttonLink",attrs:{type:"button"},on:{click:e.setTogglePickColorFromVideo}},[e.enable_pick_color_from_video?[e._v(" "+e._s(e.$t("click_in_video‚Ä¶"))+" ")]:[e._v(" "+e._s(e.$t("pick_color_in_video"))+" ")]],2)]),t("br"),t("div",[t("div",{},[t("label",[e._v(e._s(e.$t("similarity")))]),t("input",{directives:[{name:"model",rawName:"v-model.number",value:e.chroma_key_settings.similarity,expression:"chroma_key_settings.similarity",modifiers:{number:!0}}],staticClass:"margin-none",attrs:{type:"range",min:"0",max:"0.2",step:"0.001"},domProps:{value:e.chroma_key_settings.similarity},on:{__r:function(i){e.$set(e.chroma_key_settings,"similarity",e._n(i.target.value))},blur:function(i){return e.$forceUpdate()}}})]),t("div",{},[t("label",[e._v(e._s(e.$t("smoothness")))]),t("input",{directives:[{name:"model",rawName:"v-model.number",value:e.chroma_key_settings.smoothness,expression:"chroma_key_settings.smoothness",modifiers:{number:!0}}],staticClass:"margin-none",attrs:{type:"range",min:"0",max:"0.3",step:"0.001"},domProps:{value:e.chroma_key_settings.smoothness},on:{__r:function(i){e.$set(e.chroma_key_settings,"smoothness",e._n(i.target.value))},blur:function(i){return e.$forceUpdate()}}})]),t("div",{},[t("label",[e._v(e._s(e.$t("spill")))]),t("input",{directives:[{name:"model",rawName:"v-model.number",value:e.chroma_key_settings.spill,expression:"chroma_key_settings.spill",modifiers:{number:!0}}],staticClass:"margin-none",attrs:{type:"range",min:"0",max:"0.5",step:"0.001",value:"0.1"},domProps:{value:e.chroma_key_settings.spill},on:{__r:function(i){e.$set(e.chroma_key_settings,"spill",e._n(i.target.value))},blur:function(i){return e.$forceUpdate()}}})])])],1),t("fieldset",[t("legend",{staticClass:"u-label"},[e._v(e._s(e.$t("replace_color_with")))]),t("RadioCheckboxInput",{attrs:{value:e.chroma_key_settings.replacement_mode,options:[{label:e.$t("color"),key:"color"},{label:e.$t("image"),key:"image"}],can_edit:!0},on:{"update:value":function(i){e.chroma_key_settings.replacement_mode=i}}}),e.chroma_key_settings.replacement_mode==="image"?t("div",[t("img",{staticClass:"_imgPreview",attrs:{src:e.chroma_key_replacement_image_url}}),t("EditBtn",{attrs:{label:e.chroma_key_replacement_image_url?e.$t("edit"):e.$t("select"),is_unfolded:!0},on:{click:function(i){e.select_image=!0}}}),e.select_image?t("ImageSelect",{attrs:{label:e.$t("image"),project_path:e.project_path},on:{newPreview:e.newChromaKeyImage,close:function(i){e.select_image=!1}}}):e._e()],1):t("div",[t("ColorInput",{attrs:{can_toggle:!1,value:e.chroma_key_replacement_color_hex},on:{save:function(i){e.chroma_key_replacement_color_hex=i}}})],1)],1)]),e._l(Object.entries(e.image_filters_settings),function([i,r]){return t("div",{key:i},[t("RangeValueInput",{attrs:{label:e.$t(i),value:e.image_filters_settings[i].value,can_toggle:!0,min:r.min,max:r.max,step:r.step,ticks:r.ticks,default_value:r.default},on:{save:function(s){e.image_filters_settings[i].value=s}}})],1)})],2)])])},Wt=[],qt=ee(jt,Gt,Wt,!1,null,"197e4ed1");const Kt=qt.exports,Xt={props:{stopmotion_path:String},components:{RemoveMenu:Ze},data(){return{stopmotion:void 0,fetch_stopmotion_error:void 0}},created(){},async mounted(){const o=await this.$api.getFolder({path:this.stopmotion_path}).catch(e=>{this.fetch_stopmotion_error=e.response});this.stopmotion=o},beforeDestroy(){},watch:{},computed:{images(){var o,e,t;return(o=this.stopmotion)!=null&&o.images_list&&((t=(e=this.stopmotion)==null?void 0:e.$files)==null?void 0:t.length)>0?this.stopmotion.images_list.reduce((r,s)=>{const n=s.m||s,d=this.stopmotion.$files.find(c=>c.$path.endsWith("/"+n));return d&&!r.find(c=>c.$path===d.$path)&&r.push(d),r},[]):[]}},methods:{}};var Yt=function(){var e=this,t=e._self._c;return e.stopmotion?t("div",{staticClass:"u-card2 _preview"},[t("div",{staticClass:"_topRow"},[t("DateDisplay",{attrs:{title:e.$t("date_created"),date:e.stopmotion.$date_created}}),t("DateDisplay",{attrs:{title:e.$t("date_modified"),date:e.stopmotion.$date_modified}})],1),t("div",{staticClass:"_images"},[t("label",{staticClass:"u-label"},[e._v(" "+e._s(e.$tc("x_images",e.images.length,{count:e.images.length}))+" ")]),t("div",{staticClass:"_imagesCont"},e._l(e.images,function(i){return t("div",{key:i.$path},[t("MediaContent",{attrs:{file:i,resolution:240}})],1)}),0)]),t("div",{staticClass:"_btns"},[t("RemoveMenu",{on:{remove:function(i){return e.$emit("remove")}}}),t("button",{staticClass:"u-button u-button_bleumarine",attrs:{type:"button"},on:{click:function(i){return e.$emit("load")}}},[e._v(" "+e._s(e.$t("resume"))+" ")])],1)]):e._e()},Jt=[],Qt=ee(Xt,Yt,Jt,!1,null,"2d8a831a");const Zt=Qt.exports,ei={props:{project_path:String},components:{StopmotionPreview:Zt},data(){return{path:`${this.project_path}/stopmotions`,is_loading:!0,stopmotions:[]}},created(){},async mounted(){this.is_loading=!0,this.stopmotions=await this.$api.getFolders({path:this.path}),this.is_loading=!1,this.$api.join({room:this.path})},beforeDestroy(){this.$api.leave({room:this.path})},watch:{},computed:{sorted_stopmotions(){return this.stopmotions.slice().sort((e,t)=>+new Date(t.$date_created)-+new Date(e.$date_created))}},methods:{async removeStopmotion(o){try{await this.$api.deleteItem({path:o})}catch{}}}};var ti=function(){var e=this,t=e._self._c;return t("BaseModal2",{attrs:{title:e.$t("stopmotion_list")},on:{close:function(i){return e.$emit("close")}}},[t("transition",{attrs:{name:"fade_fast",duration:150,mode:"out-in"}},[e.is_loading?t("LoaderSpinner"):t("div",{staticClass:"m_stopmotionList"},[e.sorted_stopmotions.length===0?t("div",{staticClass:"u-instructions"},[e._v(" "+e._s(e.$t("no_stopmotion_created_yet"))+" ")]):t("div",[t("transition-group",{attrs:{tag:"div",name:"listComplete"}},e._l(e.sorted_stopmotions,function(i){return t("div",{key:i.$path},[t("StopmotionPreview",{attrs:{stopmotion_path:i.$path},on:{load:function(r){return e.$emit("loadStopmotion",i.$path)},remove:function(r){return e.removeStopmotion(i.$path)}}})],1)}),0)],1)])],1)],1)},ii=[],ai=ee(ei,ti,ii,!1,null,"3f9fbedf");const oi=ai.exports;function ni(o,e,t){t||(t=e,e=null),e=e||{};var i={},r=e.context||new AudioContext,s=r.createMediaStreamSource(o),n=r.createAnalyser(),d=null;return t&&(d=r.createScriptProcessor(2048,1,1),d.onaudioprocess=function(){t(i.get())}),n.smoothingTimeConstant=.3,n.fftSize=256,s.connect(n),i.get=function(){var c=0,f=new Uint8Array(n.frequencyBinCount);n.getByteFrequencyData(f);for(var l=0;l<f.length;l++)c+=f[l];return c/f.length/255},i.destroy=function(){d&&(d.disconnect(),n.disconnect()),s.disconnect(),e.context||r.close()},s.connect(n),d&&(n.connect(d),d.connect(r.destination)),i}const ri={props:{stream:MediaStream,is_recording:Boolean,type:{type:String,default:"Full"}},components:{},data(){return{audio_activity:void 0,current_audio_level:0,audioHistory:[],maxHistoryPoints:1e3}},created(){},mounted(){this.startEqualizer()},beforeDestroy(){this.audio_activity.destroy()},watch:{stream(){this.startEqualizer()},is_recording(){this.audioHistory=[]}},computed:{},methods:{startEqualizer(){this.audio_activity&&this.audio_activity.destroy(),typeof this.stream=="object"&&(this.audio_activity=ni(this.stream,o=>{this.current_audio_level=o}),this.drawVolume())},drawVolume(){const o=this.$refs.canvas;if(!o)return;const e=1,t=this.$el.clientWidth*e,i=this.$el.clientHeight*e;(t!==o.width||i!==o.height)&&(o.width=t,o.height=i);const r=this.maxHistoryPoints;this.audioHistory.push(this.current_audio_level),this.audioHistory.length>r&&this.audioHistory.shift();const s=o.getContext("2d");s.fillStyle="white",s.fillRect(0,0,o.width,o.height),this.is_recording?s.fillStyle="#fc4b60":s.fillStyle="#333";const n=o.width/this.audioHistory.length,d=o.height*1.6;this.audioHistory.forEach((c,f)=>{const l=f*n,h=n,u=Math.max(c*d,2),L=o.height/2-u/2;s.fillRect(l,L,h,u)}),window.requestAnimationFrame(this.drawVolume)}}};var si=function(){var e=this,t=e._self._c;return t("div",{staticClass:"m_audioEqualizer"},[t("canvas",{ref:"canvas",attrs:{width:"1280",height:"720"}})])},li=[],di=ee(ri,si,li,!1,null,"4657f90e");const ci=di.exports;var He={exports:{}};(function(o){(function(){function e(){var t=this;this.versionnumber="1.2.6",this.imageToSVG=function(i,r,s){s=t.checkoptions(s),t.loadImage(i,function(n){r(t.imagedataToSVG(t.getImgdata(n),s))},s)},this.imagedataToSVG=function(i,r){r=t.checkoptions(r);var s=t.imagedataToTracedata(i,r);return t.getsvgstring(s,r)},this.imageToTracedata=function(i,r,s){s=t.checkoptions(s),t.loadImage(i,function(n){r(t.imagedataToTracedata(t.getImgdata(n),s))},s)},this.imagedataToTracedata=function(i,r){r=t.checkoptions(r);var s=t.colorquantization(i,r);if(r.layering===0)for(var n={layers:[],palette:s.palette,width:s.array[0].length-2,height:s.array.length-2},d=0;d<s.palette.length;d++){var c=t.batchtracepaths(t.internodes(t.pathscan(t.layeringstep(s,d),r.pathomit),r),r.ltres,r.qtres);n.layers.push(c)}else{var f=t.layering(s);r.layercontainerid&&t.drawLayers(f,t.specpalette,r.scale,r.layercontainerid);var l=t.batchpathscan(f,r.pathomit),h=t.batchinternodes(l,r),n={layers:t.batchtracelayers(h,r.ltres,r.qtres),palette:s.palette,width:i.width,height:i.height}}return n},this.optionpresets={default:{corsenabled:!1,ltres:1,qtres:1,pathomit:8,rightangleenhance:!0,colorsampling:2,numberofcolors:16,mincolorratio:0,colorquantcycles:3,layering:0,strokewidth:1,linefilter:!1,scale:1,roundcoords:1,viewbox:!1,desc:!1,lcpr:0,qcpr:0,blurradius:0,blurdelta:20},posterized1:{colorsampling:0,numberofcolors:2},posterized2:{numberofcolors:4,blurradius:5},curvy:{ltres:.01,linefilter:!0,rightangleenhance:!1},sharp:{qtres:.01,linefilter:!1},detailed:{pathomit:0,roundcoords:2,ltres:.5,qtres:.5,numberofcolors:64},smoothed:{blurradius:5,blurdelta:64},grayscale:{colorsampling:0,colorquantcycles:1,numberofcolors:7},fixedpalette:{colorsampling:0,colorquantcycles:1,numberofcolors:27},randomsampling1:{colorsampling:1,numberofcolors:8},randomsampling2:{colorsampling:1,numberofcolors:64},artistic1:{colorsampling:0,colorquantcycles:1,pathomit:0,blurradius:5,blurdelta:64,ltres:.01,linefilter:!0,numberofcolors:16,strokewidth:2},artistic2:{qtres:.01,colorsampling:0,colorquantcycles:1,numberofcolors:4,strokewidth:0},artistic3:{qtres:10,ltres:10,numberofcolors:8},artistic4:{qtres:10,ltres:10,numberofcolors:64,blurradius:5,blurdelta:256,strokewidth:2},posterized3:{ltres:1,qtres:1,pathomit:20,rightangleenhance:!0,colorsampling:0,numberofcolors:3,mincolorratio:0,colorquantcycles:3,blurradius:3,blurdelta:20,strokewidth:0,linefilter:!1,roundcoords:1,pal:[{r:0,g:0,b:100,a:255},{r:255,g:255,b:255,a:255}]}},this.checkoptions=function(i){i=i||{},typeof i=="string"&&(i=i.toLowerCase(),t.optionpresets[i]?i=t.optionpresets[i]:i={});for(var r=Object.keys(t.optionpresets.default),s=0;s<r.length;s++)i.hasOwnProperty(r[s])||(i[r[s]]=t.optionpresets.default[r[s]]);return i},this.colorquantization=function(i,r){var s=[],n=0,d,c,f,l=[],h=i.width*i.height,u,L,$,P,C;if(i.data.length<h*4){for(var D=new Uint8ClampedArray(h*4),j=0;j<h;j++)D[j*4]=i.data[j*3],D[j*4+1]=i.data[j*3+1],D[j*4+2]=i.data[j*3+2],D[j*4+3]=255;i.data=D}for(L=0;L<i.height+2;L++)for(s[L]=[],u=0;u<i.width+2;u++)s[L][u]=-1;for(r.pal?C=r.pal:r.colorsampling===0?C=t.generatepalette(r.numberofcolors):r.colorsampling===1?C=t.samplepalette(r.numberofcolors,i):C=t.samplepalette2(r.numberofcolors,i),r.blurradius>0&&(i=t.blur(i,r.blurradius,r.blurdelta)),P=0;P<r.colorquantcycles;P++){if(P>0)for($=0;$<C.length;$++)l[$].n>0&&(C[$]={r:Math.floor(l[$].r/l[$].n),g:Math.floor(l[$].g/l[$].n),b:Math.floor(l[$].b/l[$].n),a:Math.floor(l[$].a/l[$].n)}),l[$].n/h<r.mincolorratio&&P<r.colorquantcycles-1&&(C[$]={r:Math.floor(Math.random()*255),g:Math.floor(Math.random()*255),b:Math.floor(Math.random()*255),a:Math.floor(Math.random()*255)});for(u=0;u<C.length;u++)l[u]={r:0,g:0,b:0,a:0,n:0};for(L=0;L<i.height;L++)for(u=0;u<i.width;u++){for(n=(L*i.width+u)*4,f=0,c=1024,$=0;$<C.length;$++)d=Math.abs(C[$].r-i.data[n])+Math.abs(C[$].g-i.data[n+1])+Math.abs(C[$].b-i.data[n+2])+Math.abs(C[$].a-i.data[n+3]),d<c&&(c=d,f=$);l[f].r+=i.data[n],l[f].g+=i.data[n+1],l[f].b+=i.data[n+2],l[f].a+=i.data[n+3],l[f].n++,s[L+1][u+1]=f}}return{array:s,palette:C}},this.samplepalette=function(i,r){for(var s,n=[],d=0;d<i;d++)s=Math.floor(Math.random()*r.data.length/4)*4,n.push({r:r.data[s],g:r.data[s+1],b:r.data[s+2],a:r.data[s+3]});return n},this.samplepalette2=function(i,r){for(var s,n=[],d=Math.ceil(Math.sqrt(i)),c=Math.ceil(i/d),f=r.width/(d+1),l=r.height/(c+1),h=0;h<c;h++)for(var u=0;u<d&&n.length!==i;u++)s=Math.floor((h+1)*l*r.width+(u+1)*f)*4,n.push({r:r.data[s],g:r.data[s+1],b:r.data[s+2],a:r.data[s+3]});return n},this.generatepalette=function(i){var r=[],s,n,d;if(i<8)for(var c=Math.floor(255/(i-1)),f=0;f<i;f++)r.push({r:f*c,g:f*c,b:f*c,a:255});else{var l=Math.floor(Math.pow(i,.3333333333333333)),h=Math.floor(255/(l-1)),u=i-l*l*l;for(s=0;s<l;s++)for(n=0;n<l;n++)for(d=0;d<l;d++)r.push({r:s*h,g:n*h,b:d*h,a:255});for(s=0;s<u;s++)r.push({r:Math.floor(Math.random()*255),g:Math.floor(Math.random()*255),b:Math.floor(Math.random()*255),a:Math.floor(Math.random()*255)})}return r},this.layering=function(i){var r=[],s=0,n=i.array.length,d=i.array[0].length,c,f,l,h,u,L,$,P,C,D,j;for(j=0;j<i.palette.length;j++)for(r[j]=[],D=0;D<n;D++)for(r[j][D]=[],C=0;C<d;C++)r[j][D][C]=0;for(D=1;D<n-1;D++)for(C=1;C<d-1;C++)s=i.array[D][C],c=i.array[D-1][C-1]===s?1:0,f=i.array[D-1][C]===s?1:0,l=i.array[D-1][C+1]===s?1:0,h=i.array[D][C-1]===s?1:0,u=i.array[D][C+1]===s?1:0,L=i.array[D+1][C-1]===s?1:0,$=i.array[D+1][C]===s?1:0,P=i.array[D+1][C+1]===s?1:0,r[s][D+1][C+1]=1+u*2+P*4+$*8,h||(r[s][D+1][C]=2+$*4+L*8),f||(r[s][D][C+1]=0+l*2+u*4+8),c||(r[s][D][C]=0+f*2+4+h*8);return r},this.layeringstep=function(i,r){var s=[],n=i.array.length,d=i.array[0].length,c,f;for(f=0;f<n;f++)for(s[f]=[],c=0;c<d;c++)s[f][c]=0;for(f=1;f<n;f++)for(c=1;c<d;c++)s[f][c]=(i.array[f-1][c-1]===r?1:0)+(i.array[f-1][c]===r?2:0)+(i.array[f][c-1]===r?8:0)+(i.array[f][c]===r?4:0);return s},this.pointinpoly=function(i,r){for(var s=!1,n=0,d=r.length-1;n<r.length;d=n++)s=r[n].y>i.y!=r[d].y>i.y&&i.x<(r[d].x-r[n].x)*(i.y-r[n].y)/(r[d].y-r[n].y)+r[n].x?!s:s;return s},this.pathscan_combined_lookup=[[[-1,-1,-1,-1],[-1,-1,-1,-1],[-1,-1,-1,-1],[-1,-1,-1,-1]],[[0,1,0,-1],[-1,-1,-1,-1],[-1,-1,-1,-1],[0,2,-1,0]],[[-1,-1,-1,-1],[-1,-1,-1,-1],[0,1,0,-1],[0,0,1,0]],[[0,0,1,0],[-1,-1,-1,-1],[0,2,-1,0],[-1,-1,-1,-1]],[[-1,-1,-1,-1],[0,0,1,0],[0,3,0,1],[-1,-1,-1,-1]],[[13,3,0,1],[13,2,-1,0],[7,1,0,-1],[7,0,1,0]],[[-1,-1,-1,-1],[0,1,0,-1],[-1,-1,-1,-1],[0,3,0,1]],[[0,3,0,1],[0,2,-1,0],[-1,-1,-1,-1],[-1,-1,-1,-1]],[[0,3,0,1],[0,2,-1,0],[-1,-1,-1,-1],[-1,-1,-1,-1]],[[-1,-1,-1,-1],[0,1,0,-1],[-1,-1,-1,-1],[0,3,0,1]],[[11,1,0,-1],[14,0,1,0],[14,3,0,1],[11,2,-1,0]],[[-1,-1,-1,-1],[0,0,1,0],[0,3,0,1],[-1,-1,-1,-1]],[[0,0,1,0],[-1,-1,-1,-1],[0,2,-1,0],[-1,-1,-1,-1]],[[-1,-1,-1,-1],[-1,-1,-1,-1],[0,1,0,-1],[0,0,1,0]],[[0,1,0,-1],[-1,-1,-1,-1],[-1,-1,-1,-1],[0,2,-1,0]],[[-1,-1,-1,-1],[-1,-1,-1,-1],[-1,-1,-1,-1],[-1,-1,-1,-1]]],this.pathscan=function(i,r){for(var s=[],n=0,d=0,c=0,f=0,l=i[0].length,h=i.length,u=0,L=!0,$=!1,P,C=0;C<h;C++)for(var D=0;D<l;D++)if(i[C][D]==4||i[C][D]==11)for(c=D,f=C,s[n]={},s[n].points=[],s[n].boundingbox=[c,f,c,f],s[n].holechildren=[],L=!1,d=0,$=i[C][D]==11,u=1;!L;){if(s[n].points[d]={},s[n].points[d].x=c-1,s[n].points[d].y=f-1,s[n].points[d].t=i[f][c],c-1<s[n].boundingbox[0]&&(s[n].boundingbox[0]=c-1),c-1>s[n].boundingbox[2]&&(s[n].boundingbox[2]=c-1),f-1<s[n].boundingbox[1]&&(s[n].boundingbox[1]=f-1),f-1>s[n].boundingbox[3]&&(s[n].boundingbox[3]=f-1),P=t.pathscan_combined_lookup[i[f][c]][u],i[f][c]=P[0],u=P[1],c+=P[2],f+=P[3],c-1===s[n].points[0].x&&f-1===s[n].points[0].y)if(L=!0,s[n].points.length<r)s.pop();else{if(s[n].isholepath=!!$,$){for(var j=0,oe=[-1,-1,l+1,h+1],H=0;H<n;H++)!s[H].isholepath&&t.boundingboxincludes(s[H].boundingbox,s[n].boundingbox)&&t.boundingboxincludes(oe,s[H].boundingbox)&&t.pointinpoly(s[n].points[0],s[H].points)&&(j=H,oe=s[H].boundingbox);s[j].holechildren.push(n)}n++}d++}return s},this.boundingboxincludes=function(i,r){return i[0]<r[0]&&i[1]<r[1]&&i[2]>r[2]&&i[3]>r[3]},this.batchpathscan=function(i,r){var s=[];for(var n in i)i.hasOwnProperty(n)&&(s[n]=t.pathscan(i[n],r));return s},this.internodes=function(i,r){var s=[],n=0,d=0,c=0,f=0,l=0,h,u;for(h=0;h<i.length;h++)for(s[h]={},s[h].points=[],s[h].boundingbox=i[h].boundingbox,s[h].holechildren=i[h].holechildren,s[h].isholepath=i[h].isholepath,n=i[h].points.length,u=0;u<n;u++)d=(u+1)%n,c=(u+2)%n,f=(u-1+n)%n,l=(u-2+n)%n,r.rightangleenhance&&t.testrightangle(i[h],l,f,u,d,c)&&(s[h].points.length>0&&(s[h].points[s[h].points.length-1].linesegment=t.getdirection(s[h].points[s[h].points.length-1].x,s[h].points[s[h].points.length-1].y,i[h].points[u].x,i[h].points[u].y)),s[h].points.push({x:i[h].points[u].x,y:i[h].points[u].y,linesegment:t.getdirection(i[h].points[u].x,i[h].points[u].y,(i[h].points[u].x+i[h].points[d].x)/2,(i[h].points[u].y+i[h].points[d].y)/2)})),s[h].points.push({x:(i[h].points[u].x+i[h].points[d].x)/2,y:(i[h].points[u].y+i[h].points[d].y)/2,linesegment:t.getdirection((i[h].points[u].x+i[h].points[d].x)/2,(i[h].points[u].y+i[h].points[d].y)/2,(i[h].points[d].x+i[h].points[c].x)/2,(i[h].points[d].y+i[h].points[c].y)/2)});return s},this.testrightangle=function(i,r,s,n,d,c){return i.points[n].x===i.points[r].x&&i.points[n].x===i.points[s].x&&i.points[n].y===i.points[d].y&&i.points[n].y===i.points[c].y||i.points[n].y===i.points[r].y&&i.points[n].y===i.points[s].y&&i.points[n].x===i.points[d].x&&i.points[n].x===i.points[c].x},this.getdirection=function(i,r,s,n){var d=8;return i<s?r<n?d=1:r>n?d=7:d=0:i>s?r<n?d=3:r>n?d=5:d=4:r<n?d=2:r>n?d=6:d=8,d},this.batchinternodes=function(i,r){var s=[];for(var n in i)i.hasOwnProperty(n)&&(s[n]=t.internodes(i[n],r));return s},this.tracepath=function(i,r,s){var n=0,d,c,f,l={};for(l.segments=[],l.boundingbox=i.boundingbox,l.holechildren=i.holechildren,l.isholepath=i.isholepath;n<i.points.length;){for(d=i.points[n].linesegment,c=-1,f=n+1;(i.points[f].linesegment===d||i.points[f].linesegment===c||c===-1)&&f<i.points.length-1;)i.points[f].linesegment!==d&&c===-1&&(c=i.points[f].linesegment),f++;f===i.points.length-1&&(f=0),l.segments=l.segments.concat(t.fitseq(i,r,s,n,f)),f>0?n=f:n=i.points.length}return l},this.fitseq=function(i,r,s,n,d){if(d>i.points.length||d<0)return[];var c=n,f=0,l=!0,h,u,L,$=d-n;$<0&&($+=i.points.length);for(var P=(i.points[d].x-i.points[n].x)/$,C=(i.points[d].y-i.points[n].y)/$,D=(n+1)%i.points.length,j;D!=d;)j=D-n,j<0&&(j+=i.points.length),h=i.points[n].x+P*j,u=i.points[n].y+C*j,L=(i.points[D].x-h)*(i.points[D].x-h)+(i.points[D].y-u)*(i.points[D].y-u),L>r&&(l=!1),L>f&&(c=D,f=L),D=(D+1)%i.points.length;if(l)return[{type:"L",x1:i.points[n].x,y1:i.points[n].y,x2:i.points[d].x,y2:i.points[d].y}];var oe=c;l=!0,f=0;var H=(oe-n)/$,ce=(1-H)*(1-H),_e=2*(1-H)*H,te=H*H,Y=(ce*i.points[n].x+te*i.points[d].x-i.points[oe].x)/-_e,q=(ce*i.points[n].y+te*i.points[d].y-i.points[oe].y)/-_e;for(D=n+1;D!=d;)H=(D-n)/$,ce=(1-H)*(1-H),_e=2*(1-H)*H,te=H*H,h=ce*i.points[n].x+_e*Y+te*i.points[d].x,u=ce*i.points[n].y+_e*q+te*i.points[d].y,L=(i.points[D].x-h)*(i.points[D].x-h)+(i.points[D].y-u)*(i.points[D].y-u),L>s&&(l=!1),L>f&&(c=D,f=L),D=(D+1)%i.points.length;if(l)return[{type:"Q",x1:i.points[n].x,y1:i.points[n].y,x2:Y,y2:q,x3:i.points[d].x,y3:i.points[d].y}];var fe=oe;return t.fitseq(i,r,s,n,fe).concat(t.fitseq(i,r,s,fe,d))},this.batchtracepaths=function(i,r,s){var n=[];for(var d in i)i.hasOwnProperty(d)&&n.push(t.tracepath(i[d],r,s));return n},this.batchtracelayers=function(i,r,s){var n=[];for(var d in i)i.hasOwnProperty(d)&&(n[d]=t.batchtracepaths(i[d],r,s));return n},this.roundtodec=function(i,r){return+i.toFixed(r)},this.svgpathstring=function(i,r,s,n){var d=i.layers[r],c=d[s],f="",l;if(n.linefilter&&c.segments.length<3)return f;if(f="<path "+(n.desc?'desc="l '+r+" p "+s+'" ':"")+t.tosvgcolorstr(i.palette[r],n)+'d="',n.roundcoords===-1){for(f+="M "+c.segments[0].x1*n.scale+" "+c.segments[0].y1*n.scale+" ",l=0;l<c.segments.length;l++)f+=c.segments[l].type+" "+c.segments[l].x2*n.scale+" "+c.segments[l].y2*n.scale+" ",c.segments[l].hasOwnProperty("x3")&&(f+=c.segments[l].x3*n.scale+" "+c.segments[l].y3*n.scale+" ");f+="Z "}else{for(f+="M "+t.roundtodec(c.segments[0].x1*n.scale,n.roundcoords)+" "+t.roundtodec(c.segments[0].y1*n.scale,n.roundcoords)+" ",l=0;l<c.segments.length;l++)f+=c.segments[l].type+" "+t.roundtodec(c.segments[l].x2*n.scale,n.roundcoords)+" "+t.roundtodec(c.segments[l].y2*n.scale,n.roundcoords)+" ",c.segments[l].hasOwnProperty("x3")&&(f+=t.roundtodec(c.segments[l].x3*n.scale,n.roundcoords)+" "+t.roundtodec(c.segments[l].y3*n.scale,n.roundcoords)+" ");f+="Z "}for(var h=0;h<c.holechildren.length;h++){var u=d[c.holechildren[h]];if(n.roundcoords===-1)for(u.segments[u.segments.length-1].hasOwnProperty("x3")?f+="M "+u.segments[u.segments.length-1].x3*n.scale+" "+u.segments[u.segments.length-1].y3*n.scale+" ":f+="M "+u.segments[u.segments.length-1].x2*n.scale+" "+u.segments[u.segments.length-1].y2*n.scale+" ",l=u.segments.length-1;l>=0;l--)f+=u.segments[l].type+" ",u.segments[l].hasOwnProperty("x3")&&(f+=u.segments[l].x2*n.scale+" "+u.segments[l].y2*n.scale+" "),f+=u.segments[l].x1*n.scale+" "+u.segments[l].y1*n.scale+" ";else for(u.segments[u.segments.length-1].hasOwnProperty("x3")?f+="M "+t.roundtodec(u.segments[u.segments.length-1].x3*n.scale)+" "+t.roundtodec(u.segments[u.segments.length-1].y3*n.scale)+" ":f+="M "+t.roundtodec(u.segments[u.segments.length-1].x2*n.scale)+" "+t.roundtodec(u.segments[u.segments.length-1].y2*n.scale)+" ",l=u.segments.length-1;l>=0;l--)f+=u.segments[l].type+" ",u.segments[l].hasOwnProperty("x3")&&(f+=t.roundtodec(u.segments[l].x2*n.scale)+" "+t.roundtodec(u.segments[l].y2*n.scale)+" "),f+=t.roundtodec(u.segments[l].x1*n.scale)+" "+t.roundtodec(u.segments[l].y1*n.scale)+" ";f+="Z "}if(f+='" />',n.lcpr||n.qcpr){for(l=0;l<c.segments.length;l++)c.segments[l].hasOwnProperty("x3")&&n.qcpr&&(f+='<circle cx="'+c.segments[l].x2*n.scale+'" cy="'+c.segments[l].y2*n.scale+'" r="'+n.qcpr+'" fill="cyan" stroke-width="'+n.qcpr*.2+'" stroke="black" />',f+='<circle cx="'+c.segments[l].x3*n.scale+'" cy="'+c.segments[l].y3*n.scale+'" r="'+n.qcpr+'" fill="white" stroke-width="'+n.qcpr*.2+'" stroke="black" />',f+='<line x1="'+c.segments[l].x1*n.scale+'" y1="'+c.segments[l].y1*n.scale+'" x2="'+c.segments[l].x2*n.scale+'" y2="'+c.segments[l].y2*n.scale+'" stroke-width="'+n.qcpr*.2+'" stroke="cyan" />',f+='<line x1="'+c.segments[l].x2*n.scale+'" y1="'+c.segments[l].y2*n.scale+'" x2="'+c.segments[l].x3*n.scale+'" y2="'+c.segments[l].y3*n.scale+'" stroke-width="'+n.qcpr*.2+'" stroke="cyan" />'),!c.segments[l].hasOwnProperty("x3")&&n.lcpr&&(f+='<circle cx="'+c.segments[l].x2*n.scale+'" cy="'+c.segments[l].y2*n.scale+'" r="'+n.lcpr+'" fill="white" stroke-width="'+n.lcpr*.2+'" stroke="black" />');for(var h=0;h<c.holechildren.length;h++){var u=d[c.holechildren[h]];for(l=0;l<u.segments.length;l++)u.segments[l].hasOwnProperty("x3")&&n.qcpr&&(f+='<circle cx="'+u.segments[l].x2*n.scale+'" cy="'+u.segments[l].y2*n.scale+'" r="'+n.qcpr+'" fill="cyan" stroke-width="'+n.qcpr*.2+'" stroke="black" />',f+='<circle cx="'+u.segments[l].x3*n.scale+'" cy="'+u.segments[l].y3*n.scale+'" r="'+n.qcpr+'" fill="white" stroke-width="'+n.qcpr*.2+'" stroke="black" />',f+='<line x1="'+u.segments[l].x1*n.scale+'" y1="'+u.segments[l].y1*n.scale+'" x2="'+u.segments[l].x2*n.scale+'" y2="'+u.segments[l].y2*n.scale+'" stroke-width="'+n.qcpr*.2+'" stroke="cyan" />',f+='<line x1="'+u.segments[l].x2*n.scale+'" y1="'+u.segments[l].y2*n.scale+'" x2="'+u.segments[l].x3*n.scale+'" y2="'+u.segments[l].y3*n.scale+'" stroke-width="'+n.qcpr*.2+'" stroke="cyan" />'),!u.segments[l].hasOwnProperty("x3")&&n.lcpr&&(f+='<circle cx="'+u.segments[l].x2*n.scale+'" cy="'+u.segments[l].y2*n.scale+'" r="'+n.lcpr+'" fill="white" stroke-width="'+n.lcpr*.2+'" stroke="black" />')}}return f},this.getsvgstring=function(i,r){r=t.checkoptions(r);for(var s=i.width*r.scale,n=i.height*r.scale,d="<svg "+(r.viewbox?'viewBox="0 0 '+s+" "+n+'" ':'width="'+s+'" height="'+n+'" ')+'version="1.1" xmlns="http://www.w3.org/2000/svg" desc="Created with imagetracer.js version '+t.versionnumber+'" >',c=0;c<i.layers.length;c++)for(var f=0;f<i.layers[c].length;f++)i.layers[c][f].isholepath||(d+=t.svgpathstring(i,c,f,r));return d+="</svg>",d},this.compareNumbers=function(i,r){return i-r},this.torgbastr=function(i){return"rgba("+i.r+","+i.g+","+i.b+","+i.a+")"},this.tosvgcolorstr=function(i,r){return'fill="rgb('+i.r+","+i.g+","+i.b+')" stroke="rgb('+i.r+","+i.g+","+i.b+')" stroke-width="'+r.strokewidth+'" opacity="'+i.a/255+'" '},this.appendSVGString=function(i,r){var s;r?(s=document.getElementById(r),s||(s=document.createElement("div"),s.id=r,document.body.appendChild(s))):(s=document.createElement("div"),document.body.appendChild(s)),s.innerHTML+=i},this.gks=[[.27901,.44198,.27901],[.135336,.228569,.272192,.228569,.135336],[.086776,.136394,.178908,.195843,.178908,.136394,.086776],[.063327,.093095,.122589,.144599,.152781,.144599,.122589,.093095,.063327],[.049692,.069304,.089767,.107988,.120651,.125194,.120651,.107988,.089767,.069304,.049692]],this.blur=function(i,r,s){var n,d,c,f,l,h,u,L,$,P,C={width:i.width,height:i.height,data:[]};if(r=Math.floor(r),r<1)return i;r>5&&(r=5),s=Math.abs(s),s>1024&&(s=1024);var D=t.gks[r-1];for(d=0;d<i.height;d++)for(n=0;n<i.width;n++){for(h=0,u=0,L=0,$=0,P=0,c=-r;c<r+1;c++)n+c>0&&n+c<i.width&&(l=(d*i.width+n+c)*4,h+=i.data[l]*D[c+r],u+=i.data[l+1]*D[c+r],L+=i.data[l+2]*D[c+r],$+=i.data[l+3]*D[c+r],P+=D[c+r]);l=(d*i.width+n)*4,C.data[l]=Math.floor(h/P),C.data[l+1]=Math.floor(u/P),C.data[l+2]=Math.floor(L/P),C.data[l+3]=Math.floor($/P)}var j=new Uint8ClampedArray(C.data);for(d=0;d<i.height;d++)for(n=0;n<i.width;n++){for(h=0,u=0,L=0,$=0,P=0,c=-r;c<r+1;c++)d+c>0&&d+c<i.height&&(l=((d+c)*i.width+n)*4,h+=j[l]*D[c+r],u+=j[l+1]*D[c+r],L+=j[l+2]*D[c+r],$+=j[l+3]*D[c+r],P+=D[c+r]);l=(d*i.width+n)*4,C.data[l]=Math.floor(h/P),C.data[l+1]=Math.floor(u/P),C.data[l+2]=Math.floor(L/P),C.data[l+3]=Math.floor($/P)}for(d=0;d<i.height;d++)for(n=0;n<i.width;n++)l=(d*i.width+n)*4,f=Math.abs(C.data[l]-i.data[l])+Math.abs(C.data[l+1]-i.data[l+1])+Math.abs(C.data[l+2]-i.data[l+2])+Math.abs(C.data[l+3]-i.data[l+3]),f>s&&(C.data[l]=i.data[l],C.data[l+1]=i.data[l+1],C.data[l+2]=i.data[l+2],C.data[l+3]=i.data[l+3]);return C},this.loadImage=function(i,r,s){var n=new Image;s&&s.corsenabled&&(n.crossOrigin="Anonymous"),n.onload=function(){var d=document.createElement("canvas");d.width=n.width,d.height=n.height;var c=d.getContext("2d");c.drawImage(n,0,0),r(d)},n.src=i},this.getImgdata=function(i){var r=i.getContext("2d");return r.getImageData(0,0,i.width,i.height)},this.specpalette=[{r:0,g:0,b:0,a:255},{r:128,g:128,b:128,a:255},{r:0,g:0,b:128,a:255},{r:64,g:64,b:128,a:255},{r:192,g:192,b:192,a:255},{r:255,g:255,b:255,a:255},{r:128,g:128,b:192,a:255},{r:0,g:0,b:192,a:255},{r:128,g:0,b:0,a:255},{r:128,g:64,b:64,a:255},{r:128,g:0,b:128,a:255},{r:168,g:168,b:168,a:255},{r:192,g:128,b:128,a:255},{r:192,g:0,b:0,a:255},{r:255,g:255,b:255,a:255},{r:0,g:128,b:0,a:255}],this.drawLayers=function(i,r,s,n){s=s||1;var d,c,f,l,h,u;n?(u=document.getElementById(n),u||(u=document.createElement("div"),u.id=n,document.body.appendChild(u))):(u=document.createElement("div"),document.body.appendChild(u));for(h in i)if(i.hasOwnProperty(h)){d=i[h][0].length,c=i[h].length;var L=document.createElement("canvas");L.width=d*s,L.height=c*s;var $=L.getContext("2d");for(l=0;l<c;l++)for(f=0;f<d;f++)$.fillStyle=t.torgbastr(r[i[h][l][f]%r.length]),$.fillRect(f*s,l*s,s,s);u.appendChild(L)}}}o.exports=new e})()})(He);var ui=He.exports;const mi=Ee(ui),_i={props:{last_frame_from_video:Blob,number_of_colors:Number},components:{},data(){return{svgstr:"",is_processing_image:!1}},created(){},mounted(){},beforeDestroy(){},watch:{last_frame_from_video(){this.last_frame_from_video&&this.vectoImage()}},computed:{},methods:{vectoImage(){this.is_processing_image||(this.is_processing_image=!0,mi.imageToSVG(URL.createObjectURL(this.last_frame_from_video),o=>{this.is_processing_image=!1,this.svgstr=o},{colorsampling:0,numberofcolors:this.number_of_colors,colorquantcycles:1,scale:1,strokewidth:1,blurradius:5,blurdelta:64,viewbox:!0}))}}};var fi=function(){var e=this,t=e._self._c;return t("div",{staticClass:"m_vecto",domProps:{innerHTML:e._s(e.svgstr)}})},hi=[],pi=ee(_i,fi,hi,!1,null,null);const vi=pi.exports,gi={props:{last_frame_from_video:Blob,angle:{type:Number,default:116},boost_brightness:{type:Number,default:1},boost_contrast:{type:Number,default:1},density:{type:Number,default:.2}},components:{},data(){return{pixel_array:[],is_processing_image:!1,svg_width:600,svg_height:400}},created(){},mounted(){},beforeDestroy(){},watch:{last_frame_from_video(){this.last_frame_from_video&&this.last_frame_from_video.type==="image/jpeg"&&this.drawBlobToImage()}},computed:{lines_array(){const o=(n,d,c,f,l)=>(n-d)*(l-f)/(c-d)+f,e=1/this.density/2,t=this.svg_width-e*2,i=this.svg_height-e*2,r=this.svg_width*this.density,s=this.svg_height*this.density;return this.pixel_array.reduce((n,d)=>{let c=d.b;c*=this.boost_brightness;let f=this.boost_contrast+1,l=128*(1-f);c=c*f+l;const h=o(c,0,234,10,0);if(typeof h!="number"||h>20)return n;const u=d.x/r*t+e,L=d.y/s*i+e;return n.push({posX:u,posY:L,length:h}),n},[])}},methods:{drawBlobToImage(){if(!this.is_processing_image){this.is_processing_image=!0;var o=performance.now(),e=new Image;e.onload=()=>{var t=this.$refs.invisible_canvas;t.width=e.width,t.height=e.height,this.svg_width=e.width,this.svg_height=e.height;var i=t.getContext("2d");i.drawImage(e,0,0);var r=i.getImageData(0,0,t.width,t.height).data;let s=[];const n=Math.round(t.width*this.density),d=Math.round(t.height*this.density);for(let u=0;u<=n;u++)for(let L=0;L<=d;L++){const $=Math.floor(t.width/n*u),P=Math.floor(t.height/d*L);var[c,f,l]=this.getImageDataFaster($,P,1,1,t.width,t.height,r);const C=c+c+c+l+f+f+f+f>>3;s.push({x:u,y:L,b:C})}this.pixel_array=s,this.is_processing_image=!1;var h=performance.now();this.$root.debug_mode===!0&&console.log("Lines ‚Ä¢ METHODS : drawBlobToImage = took "+(h-o)+" milliseconds.")},e.src=URL.createObjectURL(this.last_frame_from_video)}},getImageDataFaster(o,e,t,i,r,s,n){for(var d=new Uint32Array(t*i*4),c=0,f=e;f<i+e;f+=1)for(var l=o;l<t+o;l+=1)for(var h=(f*r+l)*4,u=0;u<4;u++)l<0||l>=r||f<0||f>=s?d[c++]=0:d[c++]=n[h+u];return d}}};var yi=function(){var e=this,t=e._self._c;return t("div",{staticClass:"m_lines"},[t("svg",{ref:"pattern",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:`0 0 ${e.svg_width} ${e.svg_height}`,"stroke-linecap":"round",stroke:"#000","stroke-width":"1"}},[t("rect",{attrs:{x:"0",y:"0",width:"100%",height:"100%",fill:"#ffffff",stroke:"#ff0000"}}),e._l(e.lines_array,function(i){return t("line",{key:`${i.posX}_${i.posY}`,attrs:{x1:-i.length/2,y1:0,x2:i.length/2,y2:0,transform:`translate(${i.posX}, ${i.posY}) rotate(${e.angle} 0 0)`}})})],2),t("canvas",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"invisible_canvas"})])},bi=[],wi=ee(gi,yi,bi,!1,null,null);const xi=wi.exports;var ze={exports:{}};(function(o){/**
 * {@link https://github.com/muaz-khan/RecordRTC|RecordRTC} is a WebRTC JavaScript library for audio/video as well as screen activity recording. It supports Chrome, Firefox, Opera, Android, and Microsoft Edge. Platforms: Linux, Mac and Windows. 
 * @summary Record audio, video or screen inside the browser.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef RecordRTC
 * @class
 * @example
 * var recorder = RecordRTC(mediaStream or [arrayOfMediaStream], {
 *     type: 'video', // audio or video or gif or canvas
 *     recorderType: MediaStreamRecorder || CanvasRecorder || StereoAudioRecorder || Etc
 * });
 * recorder.startRecording();
 * @see For further information:
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - Single media-stream object, array of media-streams, html-canvas-element, etc.
 * @param {object} config - {type:"video", recorderType: MediaStreamRecorder, disableLogs: true, numberOfAudioChannels: 1, bufferSize: 0, sampleRate: 0, desiredSampRate: 16000, video: HTMLVideoElement, etc.}
 */function e(_,a){if(!_)throw"First parameter is required.";a=a||{type:"video"},a=new t(_,a);var m=this;function y(g){return a.disableLogs||console.log("RecordRTC version: ",m.version),g&&(a=new t(_,g)),a.disableLogs||console.log("started recording "+a.type+" stream."),R?(R.clearRecordedData(),R.record(),E("recording"),m.recordingDuration&&S(),m):(w(function(){m.recordingDuration&&S()}),m)}function w(g){g&&(a.initCallback=function(){g(),g=a.initCallback=null});var I=new i(_,a);R=new I(_,a),R.record(),E("recording"),a.disableLogs||console.log("Initialized recorderType:",R.constructor.name,"for output-type:",a.type)}function b(g){if(g=g||function(){},!R){U();return}if(m.state==="paused"){m.resumeRecording(),setTimeout(function(){b(g)},1);return}m.state!=="recording"&&!a.disableLogs&&console.warn('Recording state should be: "recording", however current state is: ',m.state),a.disableLogs||console.log("Stopped recording "+a.type+" stream."),a.type!=="gif"?R.stop(I):(R.stop(),I()),E("stopped");function I(O){if(!R){typeof g.call=="function"?g.call(m,""):g("");return}Object.keys(R).forEach(function(A){typeof R[A]!="function"&&(m[A]=R[A])});var v=R.blob;if(!v)if(O)R.blob=v=O;else throw"Recording failed.";if(v&&!a.disableLogs&&console.log(v.type,"->",D(v.size)),g){var x;try{x=l.createObjectURL(v)}catch{}typeof g.call=="function"?g.call(m,x):g(x)}a.autoWriteToDisk&&B(function(A){var F={};F[a.type+"Blob"]=A,ue.Store(F)})}}function k(){if(!R){U();return}if(m.state!=="recording"){a.disableLogs||console.warn("Unable to pause the recording. Recording state: ",m.state);return}E("paused"),R.pause(),a.disableLogs||console.log("Paused recording.")}function p(){if(!R){U();return}if(m.state!=="paused"){a.disableLogs||console.warn("Unable to resume the recording. Recording state: ",m.state);return}E("recording"),R.resume(),a.disableLogs||console.log("Resumed recording.")}function T(g){postMessage(new FileReaderSync().readAsDataURL(g))}function B(g,I){if(!g)throw"Pass a callback function over getDataURL.";var O=I?I.blob:(R||{}).blob;if(!O){a.disableLogs||console.warn("Blob encoder did not finish its job yet."),setTimeout(function(){B(g,I)},1e3);return}if(typeof Worker<"u"&&!navigator.mozGetUserMedia){var v=A(T);v.onmessage=function(F){g(F.data)},v.postMessage(O)}else{var x=new FileReader;x.readAsDataURL(O),x.onload=function(F){g(F.target.result)}}function A(F){try{var G=l.createObjectURL(new Blob([F.toString(),"this.onmessage =  function (eee) {"+F.name+"(eee.data);}"],{type:"application/javascript"})),z=new Worker(G);return l.revokeObjectURL(G),z}catch{}}}function S(g){if(g=g||0,m.state==="paused"){setTimeout(function(){S(g)},1e3);return}if(m.state!=="stopped"){if(g>=m.recordingDuration){b(m.onRecordingStopped);return}g+=1e3,setTimeout(function(){S(g)},1e3)}}function E(g){m&&(m.state=g,typeof m.onStateChanged.call=="function"?m.onStateChanged.call(m,g):m.onStateChanged(g))}var M='It seems that recorder is destroyed or "startRecording" is not invoked for '+a.type+" recorder.";function U(){a.disableLogs!==!0&&console.warn(M)}var R,V={startRecording:y,stopRecording:b,pauseRecording:k,resumeRecording:p,initRecorder:w,setRecordingDuration:function(g,I){if(typeof g>"u")throw"recordingDuration is required.";if(typeof g!="number")throw"recordingDuration must be a number.";return m.recordingDuration=g,m.onRecordingStopped=I||function(){},{onRecordingStopped:function(O){m.onRecordingStopped=O}}},clearRecordedData:function(){if(!R){U();return}R.clearRecordedData(),a.disableLogs||console.log("Cleared old recorded data.")},getBlob:function(){if(!R){U();return}return R.blob},getDataURL:B,toURL:function(){if(!R){U();return}return l.createObjectURL(R.blob)},getInternalRecorder:function(){return R},save:function(g){if(!R){U();return}j(R.blob,g)},getFromDisk:function(g){if(!R){U();return}e.getFromDisk(a.type,g)},setAdvertisementArray:function(g){a.advertisement=[];for(var I=g.length,O=0;O<I;O++)a.advertisement.push({duration:O,image:g[O]})},blob:null,bufferSize:0,sampleRate:0,buffer:null,reset:function(){m.state==="recording"&&!a.disableLogs&&console.warn("Stop an active recorder."),R&&typeof R.clearRecordedData=="function"&&R.clearRecordedData(),R=null,E("inactive"),m.blob=null},onStateChanged:function(g){a.disableLogs||console.log("Recorder state changed:",g)},state:"inactive",getState:function(){return m.state},destroy:function(){var g=a.disableLogs;a={disableLogs:!0},m.reset(),E("destroyed"),V=m=null,te.AudioContextConstructor&&(te.AudioContextConstructor.close(),te.AudioContextConstructor=null),a.disableLogs=g,a.disableLogs||console.log("RecordRTC is destroyed.")},version:"5.6.2"};if(!this)return m=V,V;for(var N in V)this[N]=V[N];return m=this,V}e.version="5.6.2",o.exports=e,e.getFromDisk=function(_,a){if(!a)throw"callback is mandatory.";console.log("Getting recorded "+(_==="all"?"blobs":_+" blob ")+" from disk!"),ue.Fetch(function(m,y){_!=="all"&&y===_+"Blob"&&a&&a(m),_==="all"&&a&&a(m,y.replace("Blob",""))})},e.writeToDisk=function(_){console.log("Writing recorded blob(s) to disk!"),_=_||{},_.audio&&_.video&&_.gif?_.audio.getDataURL(function(a){_.video.getDataURL(function(m){_.gif.getDataURL(function(y){ue.Store({audioBlob:a,videoBlob:m,gifBlob:y})})})}):_.audio&&_.video?_.audio.getDataURL(function(a){_.video.getDataURL(function(m){ue.Store({audioBlob:a,videoBlob:m})})}):_.audio&&_.gif?_.audio.getDataURL(function(a){_.gif.getDataURL(function(m){ue.Store({audioBlob:a,gifBlob:m})})}):_.video&&_.gif?_.video.getDataURL(function(a){_.gif.getDataURL(function(m){ue.Store({videoBlob:a,gifBlob:m})})}):_.audio?_.audio.getDataURL(function(a){ue.Store({audioBlob:a})}):_.video?_.video.getDataURL(function(a){ue.Store({videoBlob:a})}):_.gif&&_.gif.getDataURL(function(a){ue.Store({gifBlob:a})})};/**
 * {@link RecordRTCConfiguration} is an inner/private helper for {@link RecordRTC}.
 * @summary It configures the 2nd parameter passed over {@link RecordRTC} and returns a valid "config" object.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef RecordRTCConfiguration
 * @class
 * @example
 * var options = RecordRTCConfiguration(mediaStream, options);
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {type:"video", disableLogs: true, numberOfAudioChannels: 1, bufferSize: 0, sampleRate: 0, video: HTMLVideoElement, getNativeBlob:true, etc.}
 */function t(_,a){return!a.recorderType&&!a.type&&(a.audio&&a.video?a.type="video":a.audio&&!a.video&&(a.type="audio")),a.recorderType&&!a.type&&(a.recorderType===ke||a.recorderType===Ce||typeof be<"u"&&a.recorderType===be?a.type="video":a.recorderType===Se?a.type="gif":a.recorderType===fe?a.type="audio":a.recorderType===q&&(H(_,"audio").length&&H(_,"video").length||!H(_,"audio").length&&H(_,"video").length?a.type="video":H(_,"audio").length&&!H(_,"video").length&&(a.type="audio"))),typeof q<"u"&&typeof MediaRecorder<"u"&&"requestData"in MediaRecorder.prototype&&(a.mimeType||(a.mimeType="video/webm"),a.type||(a.type=a.mimeType.split("/")[0]),a.bitsPerSecond),a.type||(a.mimeType&&(a.type=a.mimeType.split("/")[0]),a.type||(a.type="audio")),a}/**
 * {@link GetRecorderType} is an inner/private helper for {@link RecordRTC}.
 * @summary It returns best recorder-type available for your browser.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef GetRecorderType
 * @class
 * @example
 * var RecorderType = GetRecorderType(options);
 * var recorder = new RecorderType(options);
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {type:"video", disableLogs: true, numberOfAudioChannels: 1, bufferSize: 0, sampleRate: 0, video: HTMLVideoElement, etc.}
 */function i(_,a){var m;return($||h||u)&&(m=fe),typeof MediaRecorder<"u"&&"requestData"in MediaRecorder.prototype&&!$&&(m=q),a.type==="video"&&($||u)&&(m=ke,typeof be<"u"&&typeof ReadableStream<"u"&&(m=be)),a.type==="gif"&&(m=Se),a.type==="canvas"&&(m=Ce),Y()&&m!==Ce&&m!==Se&&typeof MediaRecorder<"u"&&"requestData"in MediaRecorder.prototype&&(H(_,"video").length||H(_,"audio").length)&&(a.type==="audio"?typeof MediaRecorder.isTypeSupported=="function"&&MediaRecorder.isTypeSupported("audio/webm")&&(m=q):typeof MediaRecorder.isTypeSupported=="function"&&MediaRecorder.isTypeSupported("video/webm")&&(m=q)),_ instanceof Array&&_.length&&(m=Ae),a.recorderType&&(m=a.recorderType),!a.disableLogs&&m&&m.name&&console.log("Using recorderType:",m.name||m.constructor.name),!m&&P&&(m=q),m}/**
 * MRecordRTC runs on top of {@link RecordRTC} to bring multiple recordings in a single place, by providing simple API.
 * @summary MRecordRTC stands for "Multiple-RecordRTC".
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef MRecordRTC
 * @class
 * @example
 * var recorder = new MRecordRTC();
 * recorder.addStream(MediaStream);
 * recorder.mediaType = {
 *     audio: true, // or StereoAudioRecorder or MediaStreamRecorder
 *     video: true, // or WhammyRecorder or MediaStreamRecorder or WebAssemblyRecorder or CanvasRecorder
 *     gif: true    // or GifRecorder
 * };
 * // mimeType is optional and should be set only in advance cases.
 * recorder.mimeType = {
 *     audio: 'audio/wav',
 *     video: 'video/webm',
 *     gif:   'image/gif'
 * };
 * recorder.startRecording();
 * @see For further information:
 * @see {@link https://github.com/muaz-khan/RecordRTC/tree/master/MRecordRTC|MRecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @requires {@link RecordRTC}
 */function r(_){this.addStream=function(a){a&&(_=a)},this.mediaType={audio:!0,video:!0},this.startRecording=function(){var a=this.mediaType,m,y=this.mimeType||{audio:null,video:null,gif:null};if(typeof a.audio!="function"&&Y()&&!H(_,"audio").length&&(a.audio=!1),typeof a.video!="function"&&Y()&&!H(_,"video").length&&(a.video=!1),typeof a.gif!="function"&&Y()&&!H(_,"video").length&&(a.gif=!1),!a.audio&&!a.video&&!a.gif)throw"MediaStream must have either audio or video tracks.";if(a.audio&&(m=null,typeof a.audio=="function"&&(m=a.audio),this.audioRecorder=new e(_,{type:"audio",bufferSize:this.bufferSize,sampleRate:this.sampleRate,numberOfAudioChannels:this.numberOfAudioChannels||2,disableLogs:this.disableLogs,recorderType:m,mimeType:y.audio,timeSlice:this.timeSlice,onTimeStamp:this.onTimeStamp}),a.video||this.audioRecorder.startRecording()),a.video){m=null,typeof a.video=="function"&&(m=a.video);var w=_;if(Y()&&a.audio&&typeof a.audio=="function"){var b=H(_,"video")[0];L?(w=new C,w.addTrack(b),m&&m===ke&&(m=q)):(w=new C,w.addTrack(b))}this.videoRecorder=new e(w,{type:"video",video:this.video,canvas:this.canvas,frameInterval:this.frameInterval||10,disableLogs:this.disableLogs,recorderType:m,mimeType:y.video,timeSlice:this.timeSlice,onTimeStamp:this.onTimeStamp,workerPath:this.workerPath,webAssemblyPath:this.webAssemblyPath,frameRate:this.frameRate,bitrate:this.bitrate}),a.audio||this.videoRecorder.startRecording()}if(a.audio&&a.video){var k=this,p=Y()===!0;(a.audio instanceof fe&&a.video||a.audio!==!0&&a.video!==!0&&a.audio!==a.video)&&(p=!1),p===!0?(k.audioRecorder=null,k.videoRecorder.startRecording()):k.videoRecorder.initRecorder(function(){k.audioRecorder.initRecorder(function(){k.videoRecorder.startRecording(),k.audioRecorder.startRecording()})})}a.gif&&(m=null,typeof a.gif=="function"&&(m=a.gif),this.gifRecorder=new e(_,{type:"gif",frameRate:this.frameRate||200,quality:this.quality||10,disableLogs:this.disableLogs,recorderType:m,mimeType:y.gif}),this.gifRecorder.startRecording())},this.stopRecording=function(a){a=a||function(){},this.audioRecorder&&this.audioRecorder.stopRecording(function(m){a(m,"audio")}),this.videoRecorder&&this.videoRecorder.stopRecording(function(m){a(m,"video")}),this.gifRecorder&&this.gifRecorder.stopRecording(function(m){a(m,"gif")})},this.pauseRecording=function(){this.audioRecorder&&this.audioRecorder.pauseRecording(),this.videoRecorder&&this.videoRecorder.pauseRecording(),this.gifRecorder&&this.gifRecorder.pauseRecording()},this.resumeRecording=function(){this.audioRecorder&&this.audioRecorder.resumeRecording(),this.videoRecorder&&this.videoRecorder.resumeRecording(),this.gifRecorder&&this.gifRecorder.resumeRecording()},this.getBlob=function(a){var m={};return this.audioRecorder&&(m.audio=this.audioRecorder.getBlob()),this.videoRecorder&&(m.video=this.videoRecorder.getBlob()),this.gifRecorder&&(m.gif=this.gifRecorder.getBlob()),a&&a(m),m},this.destroy=function(){this.audioRecorder&&(this.audioRecorder.destroy(),this.audioRecorder=null),this.videoRecorder&&(this.videoRecorder.destroy(),this.videoRecorder=null),this.gifRecorder&&(this.gifRecorder.destroy(),this.gifRecorder=null)},this.getDataURL=function(a){this.getBlob(function(w){w.audio&&w.video?m(w.audio,function(b){m(w.video,function(k){a({audio:b,video:k})})}):w.audio?m(w.audio,function(b){a({audio:b})}):w.video&&m(w.video,function(b){a({video:b})})});function m(w,b){if(typeof Worker<"u"){var k=y(function(B){postMessage(new FileReaderSync().readAsDataURL(B))});k.onmessage=function(T){b(T.data)},k.postMessage(w)}else{var p=new FileReader;p.readAsDataURL(w),p.onload=function(T){b(T.target.result)}}}function y(w){var b=l.createObjectURL(new Blob([w.toString(),"this.onmessage =  function (eee) {"+w.name+"(eee.data);}"],{type:"application/javascript"})),k=new Worker(b),p;if(typeof l<"u")p=l;else if(typeof webkitURL<"u")p=webkitURL;else throw"Neither URL nor webkitURL detected.";return p.revokeObjectURL(b),k}},this.writeToDisk=function(){e.writeToDisk({audio:this.audioRecorder,video:this.videoRecorder,gif:this.gifRecorder})},this.save=function(a){a=a||{audio:!0,video:!0,gif:!0},a.audio&&this.audioRecorder&&this.audioRecorder.save(typeof a.audio=="string"?a.audio:""),a.video&&this.videoRecorder&&this.videoRecorder.save(typeof a.video=="string"?a.video:""),a.gif&&this.gifRecorder&&this.gifRecorder.save(typeof a.gif=="string"?a.gif:"")}}r.getFromDisk=e.getFromDisk,r.writeToDisk=e.writeToDisk,typeof e<"u"&&(e.MRecordRTC=r);var s="Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45";(function(_){_&&(typeof window<"u"||typeof W>"u"||(W.navigator={userAgent:s,getUserMedia:function(){}},W.console||(W.console={}),(typeof W.console.log>"u"||typeof W.console.error>"u")&&(W.console.error=W.console.log=W.console.log||function(){console.log(arguments)}),typeof document>"u"&&(_.document={documentElement:{appendChild:function(){return""}}},document.createElement=document.captureStream=document.mozCaptureStream=function(){var a={getContext:function(){return a},play:function(){},pause:function(){},drawImage:function(){},toDataURL:function(){return""},style:{}};return a},_.HTMLVideoElement=function(){}),typeof location>"u"&&(_.location={protocol:"file:",href:"",hash:""}),typeof screen>"u"&&(_.screen={width:0,height:0}),typeof l>"u"&&(_.URL={createObjectURL:function(){return""},revokeObjectURL:function(){return""}}),_.window=W))})(typeof W<"u"?W:null);var n=window.requestAnimationFrame;if(typeof n>"u"){if(typeof webkitRequestAnimationFrame<"u")n=webkitRequestAnimationFrame;else if(typeof mozRequestAnimationFrame<"u")n=mozRequestAnimationFrame;else if(typeof msRequestAnimationFrame<"u")n=msRequestAnimationFrame;else if(typeof n>"u"){var d=0;n=function(_,a){var m=new Date().getTime(),y=Math.max(0,16-(m-d)),w=setTimeout(function(){_(m+y)},y);return d=m+y,w}}}var c=window.cancelAnimationFrame;typeof c>"u"&&(typeof webkitCancelAnimationFrame<"u"?c=webkitCancelAnimationFrame:typeof mozCancelAnimationFrame<"u"?c=mozCancelAnimationFrame:typeof msCancelAnimationFrame<"u"?c=msCancelAnimationFrame:typeof c>"u"&&(c=function(_){clearTimeout(_)}));var f=window.AudioContext;typeof f>"u"&&(typeof webkitAudioContext<"u"&&(f=webkitAudioContext),typeof mozAudioContext<"u"&&(f=mozAudioContext));var l=window.URL;typeof l>"u"&&typeof webkitURL<"u"&&(l=webkitURL),typeof navigator<"u"&&typeof navigator.getUserMedia>"u"&&(typeof navigator.webkitGetUserMedia<"u"&&(navigator.getUserMedia=navigator.webkitGetUserMedia),typeof navigator.mozGetUserMedia<"u"&&(navigator.getUserMedia=navigator.mozGetUserMedia));var h=navigator.userAgent.indexOf("Edge")!==-1&&(!!navigator.msSaveBlob||!!navigator.msSaveOrOpenBlob),u=!!window.opera||navigator.userAgent.indexOf("OPR/")!==-1,L=navigator.userAgent.toLowerCase().indexOf("firefox")>-1&&"netscape"in window&&/ rv:/.test(navigator.userAgent),$=!u&&!h&&!!navigator.webkitGetUserMedia||oe()||navigator.userAgent.toLowerCase().indexOf("chrome/")!==-1,P=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);P&&!$&&navigator.userAgent.indexOf("CriOS")!==-1&&(P=!1,$=!0);var C=window.MediaStream;typeof C>"u"&&typeof webkitMediaStream<"u"&&(C=webkitMediaStream),typeof C<"u"&&typeof C.prototype.stop>"u"&&(C.prototype.stop=function(){this.getTracks().forEach(function(_){_.stop()})});function D(_){var a=1e3,m=["Bytes","KB","MB","GB","TB"];if(_===0)return"0 Bytes";var y=parseInt(Math.floor(Math.log(_)/Math.log(a)),10);return(_/Math.pow(a,y)).toPrecision(3)+" "+m[y]}function j(_,a){if(!_)throw"Blob object is required.";if(!_.type)try{_.type="video/webm"}catch{}var m=(_.type||"video/webm").split("/")[1];if(m.indexOf(";")!==-1&&(m=m.split(";")[0]),a&&a.indexOf(".")!==-1){var y=a.split(".");a=y[0],m=y[1]}var w=(a||Math.round(Math.random()*9999999999)+888888888)+"."+m;if(typeof navigator.msSaveOrOpenBlob<"u")return navigator.msSaveOrOpenBlob(_,w);if(typeof navigator.msSaveBlob<"u")return navigator.msSaveBlob(_,w);var b=document.createElement("a");b.href=l.createObjectURL(_),b.download=w,b.style="display:none;opacity:0;color:transparent;",(document.body||document.documentElement).appendChild(b),typeof b.click=="function"?b.click():(b.target="_blank",b.dispatchEvent(new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0}))),l.revokeObjectURL(b.href)}function oe(){return!!(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron||typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent.indexOf("Electron")>=0)}function H(_,a){return!_||!_.getTracks?[]:_.getTracks().filter(function(m){return m.kind===(a||"audio")})}function ce(_,a){"srcObject"in a?a.srcObject=_:"mozSrcObject"in a?a.mozSrcObject=_:a.srcObject=_}function _e(_,a){if(typeof EBML>"u")throw new Error("Please link: https://www.webrtc-experiment.com/EBML.js");var m=new EBML.Reader,y=new EBML.Decoder,w=EBML.tools,b=new FileReader;b.onload=function(k){var p=y.decode(this.result);p.forEach(function(E){m.read(E)}),m.stop();var T=w.makeMetadataSeekable(m.metadatas,m.duration,m.cues),B=this.result.slice(m.metadataSize),S=new Blob([T,B],{type:"video/webm"});a(S)},b.readAsArrayBuffer(_)}typeof e<"u"&&(e.invokeSaveAsDialog=j,e.getTracks=H,e.getSeekableBlob=_e,e.bytesToSize=D,e.isElectron=oe);/**
 * Storage is a standalone object used by {@link RecordRTC} to store reusable objects e.g. "new AudioContext".
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @example
 * Storage.AudioContext === webkitAudioContext
 * @property {webkitAudioContext} AudioContext - Keeps a reference to AudioContext object.
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 */var te={};typeof f<"u"?te.AudioContext=f:typeof webkitAudioContext<"u"&&(te.AudioContext=webkitAudioContext),typeof e<"u"&&(e.Storage=te);function Y(){if(L||P||h)return!0;var _=navigator.userAgent,a=""+parseFloat(navigator.appVersion),m=parseInt(navigator.appVersion,10),y,w;return($||u)&&(y=_.indexOf("Chrome"),a=_.substring(y+7)),(w=a.indexOf(";"))!==-1&&(a=a.substring(0,w)),(w=a.indexOf(" "))!==-1&&(a=a.substring(0,w)),m=parseInt(""+a,10),isNaN(m)&&(a=""+parseFloat(navigator.appVersion),m=parseInt(navigator.appVersion,10)),m>=49}/**
 * MediaStreamRecorder is an abstraction layer for {@link https://w3c.github.io/mediacapture-record/MediaRecorder.html|MediaRecorder API}. It is used by {@link RecordRTC} to record MediaStream(s) in both Chrome and Firefox.
 * @summary Runs top over {@link https://w3c.github.io/mediacapture-record/MediaRecorder.html|MediaRecorder API}.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://github.com/muaz-khan|Muaz Khan}
 * @typedef MediaStreamRecorder
 * @class
 * @example
 * var config = {
 *     mimeType: 'video/webm', // vp8, vp9, h264, mkv, opus/vorbis
 *     audioBitsPerSecond : 256 * 8 * 1024,
 *     videoBitsPerSecond : 256 * 8 * 1024,
 *     bitsPerSecond: 256 * 8 * 1024,  // if this is provided, skip above two
 *     checkForInactiveTracks: true,
 *     timeSlice: 1000, // concatenate intervals based blobs
 *     ondataavailable: function() {} // get intervals based blobs
 * }
 * var recorder = new MediaStreamRecorder(mediaStream, config);
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 *
 *     // or
 *     var blob = recorder.blob;
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {disableLogs:true, initCallback: function, mimeType: "video/webm", timeSlice: 1000}
 * @throws Will throw an error if first argument "MediaStream" is missing. Also throws error if "MediaRecorder API" are not supported by the browser.
 */function q(_,a){var S=this;if(typeof _>"u")throw'First argument "MediaStream" is required.';if(typeof MediaRecorder>"u")throw"Your browser does not support the Media Recorder API. Please try other modules e.g. WhammyRecorder or StereoAudioRecorder.";if(a=a||{mimeType:"video/webm"},a.type==="audio"){if(H(_,"video").length&&H(_,"audio").length){var m;navigator.mozGetUserMedia?(m=new C,m.addTrack(H(_,"audio")[0])):m=new C(H(_,"audio")),_=m}(!a.mimeType||a.mimeType.toString().toLowerCase().indexOf("audio")===-1)&&(a.mimeType=$?"audio/webm":"audio/ogg"),a.mimeType&&a.mimeType.toString().toLowerCase()!=="audio/ogg"&&navigator.mozGetUserMedia&&(a.mimeType="audio/ogg")}var y=[];this.getArrayOfBlobs=function(){return y},this.record=function(){S.blob=null,S.clearRecordedData(),S.timestamps=[],B=[],y=[];var E=a;a.disableLogs||console.log("Passing following config over MediaRecorder API.",E),p&&(p=null),$&&!Y()&&(E="video/vp8"),typeof MediaRecorder.isTypeSupported=="function"&&E.mimeType&&(MediaRecorder.isTypeSupported(E.mimeType)||(a.disableLogs||console.warn("MediaRecorder API seems unable to record mimeType:",E.mimeType),E.mimeType=a.type==="audio"?"audio/webm":"video/webm"));try{p=new MediaRecorder(_,E),a.mimeType=E.mimeType}catch{p=new MediaRecorder(_)}E.mimeType&&!MediaRecorder.isTypeSupported&&"canRecordMimeType"in p&&p.canRecordMimeType(E.mimeType)===!1&&(a.disableLogs||console.warn("MediaRecorder API seems unable to record mimeType:",E.mimeType)),p.ondataavailable=function(M){if(M.data&&B.push("ondataavailable: "+D(M.data.size)),typeof a.timeSlice=="number"){if(M.data&&M.data.size&&(y.push(M.data),w(),typeof a.ondataavailable=="function")){var U=a.getNativeBlob?M.data:new Blob([M.data],{type:b(E)});a.ondataavailable(U)}return}if(!M.data||!M.data.size||M.data.size<100||S.blob){S.recordingCallback&&(S.recordingCallback(new Blob([],{type:b(E)})),S.recordingCallback=null);return}S.blob=a.getNativeBlob?M.data:new Blob([M.data],{type:b(E)}),S.recordingCallback&&(S.recordingCallback(S.blob),S.recordingCallback=null)},p.onstart=function(){B.push("started")},p.onpause=function(){B.push("paused")},p.onresume=function(){B.push("resumed")},p.onstop=function(){B.push("stopped")},p.onerror=function(M){M&&(M.name||(M.name="UnknownError"),B.push("error: "+M),a.disableLogs||(M.name.toString().toLowerCase().indexOf("invalidstate")!==-1?console.error("The MediaRecorder is not in a state in which the proposed operation is allowed to be executed.",M):M.name.toString().toLowerCase().indexOf("notsupported")!==-1?console.error("MIME type (",E.mimeType,") is not supported.",M):M.name.toString().toLowerCase().indexOf("security")!==-1?console.error("MediaRecorder security error",M):M.name==="OutOfMemory"?console.error("The UA has exhaused the available memory. User agents SHOULD provide as much additional information as possible in the message attribute.",M):M.name==="IllegalStreamModification"?console.error("A modification to the stream has occurred that makes it impossible to continue recording. An example would be the addition of a Track while recording is occurring. User agents SHOULD provide as much additional information as possible in the message attribute.",M):M.name==="OtherRecordingError"?console.error("Used for an fatal error other than those listed above. User agents SHOULD provide as much additional information as possible in the message attribute.",M):M.name==="GenericError"?console.error("The UA cannot provide the codec or recording option that has been requested.",M):console.error("MediaRecorder Error",M)),function(U){if(!S.manuallyStopped&&p&&p.state==="inactive"){delete a.timeslice,p.start(10*60*1e3);return}setTimeout(U,1e3)}(),p.state!=="inactive"&&p.state!=="stopped"&&p.stop())},typeof a.timeSlice=="number"?(w(),p.start(a.timeSlice)):p.start(36e5),a.initCallback&&a.initCallback()},this.timestamps=[];function w(){S.timestamps.push(new Date().getTime()),typeof a.onTimeStamp=="function"&&a.onTimeStamp(S.timestamps[S.timestamps.length-1],S.timestamps)}function b(E){return p&&p.mimeType?p.mimeType:E.mimeType||"video/webm"}this.stop=function(E){E=E||function(){},S.manuallyStopped=!0,p&&(this.recordingCallback=E,p.state==="recording"&&p.stop(),typeof a.timeSlice=="number"&&setTimeout(function(){S.blob=new Blob(y,{type:b(a)}),S.recordingCallback(S.blob)},100))},this.pause=function(){p&&p.state==="recording"&&p.pause()},this.resume=function(){p&&p.state==="paused"&&p.resume()},this.clearRecordedData=function(){p&&p.state==="recording"&&S.stop(k),k()};function k(){y=[],p=null,S.timestamps=[]}var p;this.getInternalRecorder=function(){return p};function T(){if("active"in _){if(!_.active)return!1}else if("ended"in _&&_.ended)return!1;return!0}this.blob=null,this.getState=function(){return p&&p.state||"inactive"};var B=[];this.getAllStates=function(){return B},typeof a.checkForInactiveTracks>"u"&&(a.checkForInactiveTracks=!1);var S=this;(function E(){if(!(!p||a.checkForInactiveTracks===!1)){if(T()===!1){a.disableLogs||console.log("MediaStream seems stopped."),S.stop();return}setTimeout(E,1e3)}})(),this.name="MediaStreamRecorder",this.toString=function(){return this.name}}typeof e<"u"&&(e.MediaStreamRecorder=q);/**
 * StereoAudioRecorder is a standalone class used by {@link RecordRTC} to bring "stereo" audio-recording in chrome.
 * @summary JavaScript standalone object for stereo audio recording.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef StereoAudioRecorder
 * @class
 * @example
 * var recorder = new StereoAudioRecorder(MediaStream, {
 *     sampleRate: 44100,
 *     bufferSize: 4096
 * });
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {sampleRate: 44100, bufferSize: 4096, numberOfAudioChannels: 1, etc.}
 */function fe(_,a){if(!H(_,"audio").length)throw"Your stream has no audio tracks.";a=a||{};var m=this,y=[],w=[],b=!1,k=0,p,T=2,B=a.desiredSampRate;a.leftChannel===!0&&(T=1),a.numberOfAudioChannels===1&&(T=1),(!T||T<1)&&(T=2),a.disableLogs||console.log("StereoAudioRecorder is set to record number of channels: "+T),typeof a.checkForInactiveTracks>"u"&&(a.checkForInactiveTracks=!0);function S(){if(a.checkForInactiveTracks===!1)return!0;if("active"in _){if(!_.active)return!1}else if("ended"in _&&_.ended)return!1;return!0}this.record=function(){if(S()===!1)throw"Please make sure MediaStream is active.";O(),x=I=!1,b=!0,typeof a.timeSlice<"u"&&G()};function E(z,J){function Q(K,we){var le=K.numberOfAudioChannels,ae=K.leftBuffers.slice(0),pe=K.rightBuffers.slice(0),ne=K.sampleRate,ve=K.internalInterleavedLength,de=K.desiredSampRate;le===2&&(ae=De(ae,ve),pe=De(pe,ve),de&&(ae=xe(ae,de,ne),pe=xe(pe,de,ne))),le===1&&(ae=De(ae,ve),de&&(ae=xe(ae,de,ne))),de&&(ne=de);function xe(X,me,re){var se=Math.round(X.length*(me/re)),ie=[],ge=Number((X.length-1)/(se-1));ie[0]=X[0];for(var ye=1;ye<se-1;ye++){var Ie=ye*ge,Fe=Number(Math.floor(Ie)).toFixed(),Ye=Number(Math.ceil(Ie)).toFixed(),Je=Ie-Fe;ie[ye]=Ge(X[Fe],X[Ye],Je)}return ie[se-1]=X[X.length-1],ie}function Ge(X,me,re){return X+(me-X)*re}function De(X,me){for(var re=new Float64Array(me),se=0,ie=X.length,ge=0;ge<ie;ge++){var ye=X[ge];re.set(ye,se),se+=ye.length}return re}function We(X,me){for(var re=X.length+me.length,se=new Float64Array(re),ie=0,ge=0;ge<re;)se[ge++]=X[ie],se[ge++]=me[ie],ie++;return se}function $e(X,me,re){for(var se=re.length,ie=0;ie<se;ie++)X.setUint8(me+ie,re.charCodeAt(ie))}var Re;le===2&&(Re=We(ae,pe)),le===1&&(Re=ae);var Te=Re.length,qe=44+Te*2,Le=new ArrayBuffer(qe),Z=new DataView(Le);$e(Z,0,"RIFF"),Z.setUint32(4,36+Te*2,!0),$e(Z,8,"WAVE"),$e(Z,12,"fmt "),Z.setUint32(16,16,!0),Z.setUint16(20,1,!0),Z.setUint16(22,le,!0),Z.setUint32(24,ne,!0),Z.setUint32(28,ne*le*2,!0),Z.setUint16(32,le*2,!0),Z.setUint16(34,16,!0),$e(Z,36,"data"),Z.setUint32(40,Te*2,!0);for(var Ke=Te,Pe=44,Xe=1,Ue=0;Ue<Ke;Ue++)Z.setInt16(Pe,Re[Ue]*(32767*Xe),!0),Pe+=2;if(we)return we({buffer:Le,view:Z});postMessage({buffer:Le,view:Z})}if(z.noWorker){Q(z,function(K){J(K.buffer,K.view)});return}var he=M(Q);he.onmessage=function(K){J(K.data.buffer,K.data.view),l.revokeObjectURL(he.workerURL),he.terminate()},he.postMessage(z)}function M(z){var J=l.createObjectURL(new Blob([z.toString(),";this.onmessage =  function (eee) {"+z.name+"(eee.data);}"],{type:"application/javascript"})),Q=new Worker(J);return Q.workerURL=J,Q}this.stop=function(z){z=z||function(){},b=!1,E({desiredSampRate:B,sampleRate:g,numberOfAudioChannels:T,internalInterleavedLength:k,leftBuffers:y,rightBuffers:T===1?[]:w,noWorker:a.noWorker},function(J,Q){m.blob=new Blob([Q],{type:"audio/wav"}),m.buffer=new ArrayBuffer(Q.buffer.byteLength),m.view=Q,m.sampleRate=B||g,m.bufferSize=N,m.length=k,x=!1,z&&z(m.blob)})},typeof e.Storage>"u"&&(e.Storage={AudioContextConstructor:null,AudioContext:window.AudioContext||window.webkitAudioContext}),(!e.Storage.AudioContextConstructor||e.Storage.AudioContextConstructor.state==="closed")&&(e.Storage.AudioContextConstructor=new e.Storage.AudioContext);var U=e.Storage.AudioContextConstructor,R=U.createMediaStreamSource(_),V=[0,256,512,1024,2048,4096,8192,16384],N=typeof a.bufferSize>"u"?4096:a.bufferSize;if(V.indexOf(N)===-1&&(a.disableLogs||console.log("Legal values for buffer-size are "+JSON.stringify(V,null,"	"))),U.createJavaScriptNode)p=U.createJavaScriptNode(N,T,T);else if(U.createScriptProcessor)p=U.createScriptProcessor(N,T,T);else throw"WebAudio API has no support on this browser.";R.connect(p),a.bufferSize||(N=p.bufferSize);var g=typeof a.sampleRate<"u"?a.sampleRate:U.sampleRate||44100;(g<22050||g>96e3)&&(a.disableLogs||console.log("sample-rate must be under range 22050 and 96000.")),a.disableLogs||a.desiredSampRate&&console.log("Desired sample-rate: "+a.desiredSampRate);var I=!1;this.pause=function(){I=!0},this.resume=function(){if(S()===!1)throw"Please make sure MediaStream is active.";if(!b){a.disableLogs||console.log("Seems recording has been restarted."),this.record();return}I=!1},this.clearRecordedData=function(){a.checkForInactiveTracks=!1,b&&this.stop(v),v()};function O(){y=[],w=[],k=0,x=!1,b=!1,I=!1,U=null,m.leftchannel=y,m.rightchannel=w,m.numberOfAudioChannels=T,m.desiredSampRate=B,m.sampleRate=g,m.recordingLength=k,F={left:[],right:[],recordingLength:0}}function v(){p&&(p.onaudioprocess=null,p.disconnect(),p=null),R&&(R.disconnect(),R=null),O()}this.name="StereoAudioRecorder",this.toString=function(){return this.name};var x=!1;function A(z){if(!I){if(S()===!1&&(a.disableLogs||console.log("MediaStream seems stopped."),p.disconnect(),b=!1),!b){R&&(R.disconnect(),R=null);return}x||(x=!0,a.onAudioProcessStarted&&a.onAudioProcessStarted(),a.initCallback&&a.initCallback());var J=z.inputBuffer.getChannelData(0),Q=new Float32Array(J);if(y.push(Q),T===2){var he=z.inputBuffer.getChannelData(1),K=new Float32Array(he);w.push(K)}k+=N,m.recordingLength=k,typeof a.timeSlice<"u"&&(F.recordingLength+=N,F.left.push(Q),T===2&&F.right.push(K))}}p.onaudioprocess=A,U.createMediaStreamDestination?p.connect(U.createMediaStreamDestination()):p.connect(U.destination),this.leftchannel=y,this.rightchannel=w,this.numberOfAudioChannels=T,this.desiredSampRate=B,this.sampleRate=g,m.recordingLength=k;var F={left:[],right:[],recordingLength:0};function G(){!b||typeof a.ondataavailable!="function"||typeof a.timeSlice>"u"||(F.left.length?(E({desiredSampRate:B,sampleRate:g,numberOfAudioChannels:T,internalInterleavedLength:F.recordingLength,leftBuffers:F.left,rightBuffers:T===1?[]:F.right},function(z,J){var Q=new Blob([J],{type:"audio/wav"});a.ondataavailable(Q),setTimeout(G,a.timeSlice)}),F={left:[],right:[],recordingLength:0}):setTimeout(G,a.timeSlice))}}typeof e<"u"&&(e.StereoAudioRecorder=fe);/**
 * CanvasRecorder is a standalone class used by {@link RecordRTC} to bring HTML5-Canvas recording into video WebM. It uses HTML2Canvas library and runs top over {@link Whammy}.
 * @summary HTML2Canvas recording into video WebM.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef CanvasRecorder
 * @class
 * @example
 * var recorder = new CanvasRecorder(htmlElement, { disableLogs: true, useWhammyRecorder: true });
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {HTMLElement} htmlElement - querySelector/getElementById/getElementsByTagName[0]/etc.
 * @param {object} config - {disableLogs:true, initCallback: function}
 */function Ce(_,a){if(typeof html2canvas>"u")throw"Please link: https://www.webrtc-experiment.com/screenshot.js";a=a||{},a.frameInterval||(a.frameInterval=10);var m=!1;["captureStream","mozCaptureStream","webkitCaptureStream"].forEach(function(V){V in document.createElement("canvas")&&(m=!0)});var y=(!!window.webkitRTCPeerConnection||!!window.webkitGetUserMedia)&&!!window.chrome,w=50,b=navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./);y&&b&&b[2]&&(w=parseInt(b[2],10)),y&&w<52&&(m=!1),a.useWhammyRecorder&&(m=!1);var k,p;if(m)if(a.disableLogs||console.log("Your browser supports both MediRecorder API and canvas.captureStream!"),_ instanceof HTMLCanvasElement)k=_;else if(_ instanceof CanvasRenderingContext2D)k=_.canvas;else throw"Please pass either HTMLCanvasElement or CanvasRenderingContext2D.";else navigator.mozGetUserMedia&&(a.disableLogs||console.error("Canvas recording is NOT supported in Firefox."));var T;this.record=function(){if(T=!0,m&&!a.useWhammyRecorder){var V;"captureStream"in k?V=k.captureStream(25):"mozCaptureStream"in k?V=k.mozCaptureStream(25):"webkitCaptureStream"in k&&(V=k.webkitCaptureStream(25));try{var N=new C;N.addTrack(H(V,"video")[0]),V=N}catch{}if(!V)throw"captureStream API are NOT available.";p=new q(V,{mimeType:a.mimeType||"video/webm"}),p.record()}else R.frames=[],U=new Date().getTime(),M();a.initCallback&&a.initCallback()},this.getWebPImages=function(V){if(_.nodeName.toLowerCase()!=="canvas"){V();return}var N=R.frames.length;R.frames.forEach(function(g,I){var O=N-I;a.disableLogs||console.log(O+"/"+N+" frames remaining"),a.onEncodingCallback&&a.onEncodingCallback(O,N);var v=g.image.toDataURL("image/webp",1);R.frames[I].image=v}),a.disableLogs||console.log("Generating WebM"),V()},this.stop=function(V){T=!1;var N=this;if(m&&p){p.stop(V);return}this.getWebPImages(function(){R.compile(function(g){a.disableLogs||console.log("Recording finished!"),N.blob=g,N.blob.forEach&&(N.blob=new Blob([],{type:"video/webm"})),V&&V(N.blob),R.frames=[]})})};var B=!1;this.pause=function(){if(B=!0,p instanceof q){p.pause();return}},this.resume=function(){if(B=!1,p instanceof q){p.resume();return}T||this.record()},this.clearRecordedData=function(){T&&this.stop(S),S()};function S(){R.frames=[],T=!1,B=!1}this.name="CanvasRecorder",this.toString=function(){return this.name};function E(){var V=document.createElement("canvas"),N=V.getContext("2d");return V.width=_.width,V.height=_.height,N.drawImage(_,0,0),V}function M(){if(B)return U=new Date().getTime(),setTimeout(M,500);if(_.nodeName.toLowerCase()==="canvas"){var V=new Date().getTime()-U;U=new Date().getTime(),R.frames.push({image:E(),duration:V}),T&&setTimeout(M,a.frameInterval);return}html2canvas(_,{grabMouse:typeof a.showMousePointer>"u"||a.showMousePointer,onrendered:function(N){var g=new Date().getTime()-U;if(!g)return setTimeout(M,a.frameInterval);U=new Date().getTime(),R.frames.push({image:N.toDataURL("image/webp",1),duration:g}),T&&setTimeout(M,a.frameInterval)}})}var U=new Date().getTime(),R=new Me.Video(100)}typeof e<"u"&&(e.CanvasRecorder=Ce);/**
 * WhammyRecorder is a standalone class used by {@link RecordRTC} to bring video recording in Chrome. It runs top over {@link Whammy}.
 * @summary Video recording feature in Chrome.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef WhammyRecorder
 * @class
 * @example
 * var recorder = new WhammyRecorder(mediaStream);
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {disableLogs: true, initCallback: function, video: HTMLVideoElement, etc.}
 */function ke(_,a){a=a||{},a.frameInterval||(a.frameInterval=10),a.disableLogs||console.log("Using frames-interval:",a.frameInterval),this.record=function(){a.width||(a.width=320),a.height||(a.height=240),a.video||(a.video={width:a.width,height:a.height}),a.canvas||(a.canvas={width:a.width,height:a.height}),T.width=a.canvas.width||320,T.height=a.canvas.height||240,B=T.getContext("2d"),a.video&&a.video instanceof HTMLVideoElement?(S=a.video.cloneNode(),a.initCallback&&a.initCallback()):(S=document.createElement("video"),ce(_,S),S.onloadedmetadata=function(){a.initCallback&&a.initCallback()},S.width=a.video.width,S.height=a.video.height),S.muted=!0,S.play(),E=new Date().getTime(),M=new Me.Video,a.disableLogs||(console.log("canvas resolutions",T.width,"*",T.height),console.log("video width/height",S.width||T.width,"*",S.height||T.height)),m(a.frameInterval)};function m(U){U=typeof U<"u"?U:10;var R=new Date().getTime()-E;if(!R)return setTimeout(m,U,U);if(k)return E=new Date().getTime(),setTimeout(m,100);E=new Date().getTime(),S.paused&&S.play(),B.drawImage(S,0,0,T.width,T.height),M.frames.push({duration:R,image:T.toDataURL("image/webp")}),b||setTimeout(m,U,U)}function y(U){var R=-1,V=U.length;(function N(){if(R++,R===V){U.callback();return}setTimeout(function(){U.functionToLoop(N,R)},1)})()}function w(U,R,V,N,g){var I=document.createElement("canvas");I.width=T.width,I.height=T.height;var O=I.getContext("2d"),v=[],x=U.length,A={r:0,g:0,b:0},F=Math.sqrt(Math.pow(255,2)+Math.pow(255,2)+Math.pow(255,2)),G=0,z=0,J=!1;y({length:x,functionToLoop:function(Q,he){var K,we,le,ae=function(){!J&&le-K<=le*z||(J=!0,v.push(U[he])),Q()};if(J)ae();else{var pe=new Image;pe.onload=function(){O.drawImage(pe,0,0,T.width,T.height);var ne=O.getImageData(0,0,T.width,T.height);K=0,we=ne.data.length,le=ne.data.length/4;for(var ve=0;ve<we;ve+=4){var de={r:ne.data[ve],g:ne.data[ve+1],b:ne.data[ve+2]},xe=Math.sqrt(Math.pow(de.r-A.r,2)+Math.pow(de.g-A.g,2)+Math.pow(de.b-A.b,2));xe<=F*G&&K++}ae()},pe.src=U[he].image}},callback:function(){v=v.concat(U.slice(x)),v.length<=0&&v.push(U[U.length-1]),g(v)}})}var b=!1;this.stop=function(U){U=U||function(){},b=!0;var R=this;setTimeout(function(){w(M.frames,-1,null,null,function(V){M.frames=V,a.advertisement&&a.advertisement.length&&(M.frames=a.advertisement.concat(M.frames)),M.compile(function(N){R.blob=N,R.blob.forEach&&(R.blob=new Blob([],{type:"video/webm"})),U&&U(R.blob)})})},10)};var k=!1;this.pause=function(){k=!0},this.resume=function(){k=!1,b&&this.record()},this.clearRecordedData=function(){b||this.stop(p),p()};function p(){M.frames=[],b=!0,k=!1}this.name="WhammyRecorder",this.toString=function(){return this.name};var T=document.createElement("canvas"),B=T.getContext("2d"),S,E,M}typeof e<"u"&&(e.WhammyRecorder=ke);/**
 * Whammy is a standalone class used by {@link RecordRTC} to bring video recording in Chrome. It is written by {@link https://github.com/antimatter15|antimatter15}
 * @summary A real time javascript webm encoder based on a canvas hack.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef Whammy
 * @class
 * @example
 * var recorder = new Whammy().Video(15);
 * recorder.add(context || canvas || dataURL);
 * var output = recorder.compile();
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 */var Me=function(){function _(y){this.frames=[],this.duration=y||1,this.quality=.8}_.prototype.add=function(y,w){if("canvas"in y&&(y=y.canvas),"toDataURL"in y&&(y=y.toDataURL("image/webp",this.quality)),!/^data:image\/webp;base64,/ig.test(y))throw"Input must be formatted properly as a base64 encoded DataURI of type image/webp";this.frames.push({image:y,duration:w||this.duration})};function a(y){var w=l.createObjectURL(new Blob([y.toString(),"this.onmessage =  function (eee) {"+y.name+"(eee.data);}"],{type:"application/javascript"})),b=new Worker(w);return l.revokeObjectURL(w),b}function m(y){function w(g){var I=k(g);if(!I)return[];for(var O=3e4,v=[{id:440786851,data:[{data:1,id:17030},{data:1,id:17143},{data:4,id:17138},{data:8,id:17139},{data:"webm",id:17026},{data:2,id:17031},{data:2,id:17029}]},{id:408125543,data:[{id:357149030,data:[{data:1e6,id:2807729},{data:"whammy",id:19840},{data:"whammy",id:22337},{data:V(I.duration),id:17545}]},{id:374648427,data:[{id:174,data:[{data:1,id:215},{data:1,id:29637},{data:0,id:156},{data:"und",id:2274716},{data:"V_VP8",id:134},{data:"VP8",id:2459272},{data:1,id:131},{id:224,data:[{data:I.width,id:176},{data:I.height,id:186}]}]}]}]}],x=0,A=0;x<g.length;){var F=[],G=0;do F.push(g[x]),G+=g[x].duration,x++;while(x<g.length&&G<O);var z=0,J={id:524531317,data:b(A,z,F)};v[1].data.push(J),A+=G}return S(v)}function b(g,I,O){return[{data:g,id:231}].concat(O.map(function(v){var x=E({discardable:0,frame:v.data.slice(4),invisible:0,keyframe:1,lacing:0,trackNum:1,timecode:Math.round(I)});return I+=v.duration,{data:x,id:163}}))}function k(g){if(!g[0]){postMessage({error:"Something went wrong. Maybe WebP format is not supported in the current browser."});return}for(var I=g[0].width,O=g[0].height,v=g[0].duration,x=1;x<g.length;x++)v+=g[x].duration;return{duration:v,width:I,height:O}}function p(g){for(var I=[];g>0;)I.push(g&255),g=g>>8;return new Uint8Array(I.reverse())}function T(g){return new Uint8Array(g.split("").map(function(I){return I.charCodeAt(0)}))}function B(g){var I=[],O=g.length%8?new Array(9-g.length%8).join("0"):"";g=O+g;for(var v=0;v<g.length;v+=8)I.push(parseInt(g.substr(v,8),2));return new Uint8Array(I)}function S(g){for(var I=[],O=0;O<g.length;O++){var v=g[O].data;typeof v=="object"&&(v=S(v)),typeof v=="number"&&(v=B(v.toString(2))),typeof v=="string"&&(v=T(v));var x=v.size||v.byteLength||v.length,A=Math.ceil(Math.ceil(Math.log(x)/Math.log(2))/8),F=x.toString(2),G=new Array(A*7+7+1-F.length).join("0")+F,z=new Array(A).join("0")+"1"+G;I.push(p(g[O].id)),I.push(B(z)),I.push(v)}return new Blob(I,{type:"video/webm"})}function E(g){var I=0;if(I|=128,g.trackNum>127)throw"TrackNumber > 127 not supported";var O=[g.trackNum|128,g.timecode>>8,g.timecode&255,I].map(function(v){return String.fromCharCode(v)}).join("")+g.frame;return O}function M(g){for(var I=g.RIFF[0].WEBP[0],O=I.indexOf("¬ù*"),v=0,x=[];v<4;v++)x[v]=I.charCodeAt(O+3+v);var A,F,G;return G=x[1]<<8|x[0],A=G&16383,G=x[3]<<8|x[2],F=G&16383,{width:A,height:F,data:I,riff:g}}function U(g,I){return parseInt(g.substr(I+4,4).split("").map(function(O){var v=O.charCodeAt(0).toString(2);return new Array(8-v.length+1).join("0")+v}).join(""),2)}function R(g){for(var I=0,O={};I<g.length;){var v=g.substr(I,4),x=U(g,I),A=g.substr(I+4+4,x);I+=8+x,O[v]=O[v]||[],v==="RIFF"||v==="LIST"?O[v].push(R(A)):O[v].push(A)}return O}function V(g){return[].slice.call(new Uint8Array(new Float64Array([g]).buffer),0).map(function(I){return String.fromCharCode(I)}).reverse().join("")}var N=new w(y.map(function(g){var I=M(R(atob(g.image.slice(23))));return I.duration=g.duration,I}));postMessage(N)}return _.prototype.compile=function(y){var w=a(m);w.onmessage=function(b){if(b.data.error){console.error(b.data.error);return}y(b.data)},w.postMessage(this.frames)},{Video:_}}();typeof e<"u"&&(e.Whammy=Me);/**
 * DiskStorage is a standalone object used by {@link RecordRTC} to store recorded blobs in IndexedDB storage.
 * @summary Writing blobs into IndexedDB.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @example
 * DiskStorage.Store({
 *     audioBlob: yourAudioBlob,
 *     videoBlob: yourVideoBlob,
 *     gifBlob  : yourGifBlob
 * });
 * DiskStorage.Fetch(function(dataURL, type) {
 *     if(type === 'audioBlob') { }
 *     if(type === 'videoBlob') { }
 *     if(type === 'gifBlob')   { }
 * });
 * // DiskStorage.dataStoreName = 'recordRTC';
 * // DiskStorage.onError = function(error) { };
 * @property {function} init - This method must be called once to initialize IndexedDB ObjectStore. Though, it is auto-used internally.
 * @property {function} Fetch - This method fetches stored blobs from IndexedDB.
 * @property {function} Store - This method stores blobs in IndexedDB.
 * @property {function} onError - This function is invoked for any known/unknown error.
 * @property {string} dataStoreName - Name of the ObjectStore created in IndexedDB storage.
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 */var ue={init:function(){var _=this;if(typeof indexedDB>"u"||typeof indexedDB.open>"u"){console.error("IndexedDB API are not available in this browser.");return}var a=1,m=this.dbName||location.href.replace(/\/|:|#|%|\.|\[|\]/g,""),y,w=indexedDB.open(m,a);function b(p){p.createObjectStore(_.dataStoreName)}function k(){var p=y.transaction([_.dataStoreName],"readwrite");_.videoBlob&&p.objectStore(_.dataStoreName).put(_.videoBlob,"videoBlob"),_.gifBlob&&p.objectStore(_.dataStoreName).put(_.gifBlob,"gifBlob"),_.audioBlob&&p.objectStore(_.dataStoreName).put(_.audioBlob,"audioBlob");function T(B){p.objectStore(_.dataStoreName).get(B).onsuccess=function(S){_.callback&&_.callback(S.target.result,B)}}T("audioBlob"),T("videoBlob"),T("gifBlob")}w.onerror=_.onError,w.onsuccess=function(){if(y=w.result,y.onerror=_.onError,y.setVersion)if(y.version!==a){var p=y.setVersion(a);p.onsuccess=function(){b(y),k()}}else k();else k()},w.onupgradeneeded=function(p){b(p.target.result)}},Fetch:function(_){return this.callback=_,this.init(),this},Store:function(_){return this.audioBlob=_.audioBlob,this.videoBlob=_.videoBlob,this.gifBlob=_.gifBlob,this.init(),this},onError:function(_){console.error(JSON.stringify(_,null,"	"))},dataStoreName:"recordRTC",dbName:null};typeof e<"u"&&(e.DiskStorage=ue);/**
 * GifRecorder is standalone calss used by {@link RecordRTC} to record video or canvas into animated gif.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef GifRecorder
 * @class
 * @example
 * var recorder = new GifRecorder(mediaStream || canvas || context, { onGifPreview: function, onGifRecordingStarted: function, width: 1280, height: 720, frameRate: 200, quality: 10 });
 * recorder.record();
 * recorder.stop(function(blob) {
 *     img.src = URL.createObjectURL(blob);
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object or HTMLCanvasElement or CanvasRenderingContext2D.
 * @param {object} config - {disableLogs:true, initCallback: function, width: 320, height: 240, frameRate: 200, quality: 10}
 */function Se(_,a){if(typeof GIFEncoder>"u"){var m=document.createElement("script");m.src="https://www.webrtc-experiment.com/gif-recorder.js",(document.body||document.documentElement).appendChild(m)}a=a||{};var y=_ instanceof CanvasRenderingContext2D||_ instanceof HTMLCanvasElement;this.record=function(){if(typeof GIFEncoder>"u"){setTimeout(U.record,1e3);return}if(!T){setTimeout(U.record,1e3);return}y||(a.width||(a.width=B.offsetWidth||320),a.height||(a.height=B.offsetHeight||240),a.video||(a.video={width:a.width,height:a.height}),a.canvas||(a.canvas={width:a.width,height:a.height}),k.width=a.canvas.width||320,k.height=a.canvas.height||240,B.width=a.video.width||320,B.height=a.video.height||240),M=new GIFEncoder,M.setRepeat(0),M.setDelay(a.frameRate||200),M.setQuality(a.quality||10),M.start(),typeof a.onGifRecordingStarted=="function"&&a.onGifRecordingStarted();function R(V){if(U.clearedRecordedData!==!0){if(w)return setTimeout(function(){R(V)},100);S=n(R),typeof E===void 0&&(E=V),!(V-E<90)&&(!y&&B.paused&&B.play(),y||p.drawImage(B,0,0,k.width,k.height),a.onGifPreview&&a.onGifPreview(k.toDataURL("image/png")),M.addFrame(p),E=V)}}S=n(R),a.initCallback&&a.initCallback()},this.stop=function(R){R=R||function(){},S&&c(S),this.blob=new Blob([new Uint8Array(M.stream().bin)],{type:"image/gif"}),R(this.blob),M.stream().bin=[]};var w=!1;this.pause=function(){w=!0},this.resume=function(){w=!1},this.clearRecordedData=function(){U.clearedRecordedData=!0,b()};function b(){M&&(M.stream().bin=[])}this.name="GifRecorder",this.toString=function(){return this.name};var k=document.createElement("canvas"),p=k.getContext("2d");y&&(_ instanceof CanvasRenderingContext2D?(p=_,k=p.canvas):_ instanceof HTMLCanvasElement&&(p=_.getContext("2d"),k=_));var T=!0;if(!y){var B=document.createElement("video");B.muted=!0,B.autoplay=!0,B.playsInline=!0,T=!1,B.onloadedmetadata=function(){T=!0},ce(_,B),B.play()}var S=null,E,M,U=this}typeof e<"u"&&(e.GifRecorder=Se);function Be(_,a){var m="Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45";(function(v){typeof e<"u"||v&&(typeof window<"u"||typeof W>"u"||(W.navigator={userAgent:m,getUserMedia:function(){}},W.console||(W.console={}),(typeof W.console.log>"u"||typeof W.console.error>"u")&&(W.console.error=W.console.log=W.console.log||function(){console.log(arguments)}),typeof document>"u"&&(v.document={documentElement:{appendChild:function(){return""}}},document.createElement=document.captureStream=document.mozCaptureStream=function(){var x={getContext:function(){return x},play:function(){},pause:function(){},drawImage:function(){},toDataURL:function(){return""},style:{}};return x},v.HTMLVideoElement=function(){}),typeof location>"u"&&(v.location={protocol:"file:",href:"",hash:""}),typeof screen>"u"&&(v.screen={width:0,height:0}),typeof B>"u"&&(v.URL={createObjectURL:function(){return""},revokeObjectURL:function(){return""}}),v.window=W))})(typeof W<"u"?W:null),a=a||"multi-streams-mixer";var y=[],w=!1,b=document.createElement("canvas"),k=b.getContext("2d");b.style.opacity=0,b.style.position="absolute",b.style.zIndex=-1,b.style.top="-1000em",b.style.left="-1000em",b.className=a,(document.body||document.documentElement).appendChild(b),this.disableLogs=!1,this.frameInterval=10,this.width=360,this.height=240,this.useGainNode=!0;var p=this,T=window.AudioContext;typeof T>"u"&&(typeof webkitAudioContext<"u"&&(T=webkitAudioContext),typeof mozAudioContext<"u"&&(T=mozAudioContext));var B=window.URL;typeof B>"u"&&typeof webkitURL<"u"&&(B=webkitURL),typeof navigator<"u"&&typeof navigator.getUserMedia>"u"&&(typeof navigator.webkitGetUserMedia<"u"&&(navigator.getUserMedia=navigator.webkitGetUserMedia),typeof navigator.mozGetUserMedia<"u"&&(navigator.getUserMedia=navigator.mozGetUserMedia));var S=window.MediaStream;typeof S>"u"&&typeof webkitMediaStream<"u"&&(S=webkitMediaStream),typeof S<"u"&&typeof S.prototype.stop>"u"&&(S.prototype.stop=function(){this.getTracks().forEach(function(v){v.stop()})});var E={};typeof T<"u"?E.AudioContext=T:typeof webkitAudioContext<"u"&&(E.AudioContext=webkitAudioContext);function M(v,x){"srcObject"in x?x.srcObject=v:"mozSrcObject"in x?x.mozSrcObject=v:x.srcObject=v}this.startDrawingFrames=function(){U()};function U(){if(!w){var v=y.length,x=!1,A=[];if(y.forEach(function(G){G.stream||(G.stream={}),G.stream.fullcanvas?x=G:A.push(G)}),x)b.width=x.stream.width,b.height=x.stream.height;else if(A.length){b.width=v>1?A[0].width*2:A[0].width;var F=1;(v===3||v===4)&&(F=2),(v===5||v===6)&&(F=3),(v===7||v===8)&&(F=4),(v===9||v===10)&&(F=5),b.height=A[0].height*F}else b.width=p.width||360,b.height=p.height||240;x&&x instanceof HTMLVideoElement&&R(x),A.forEach(function(G,z){R(G,z)}),setTimeout(U,p.frameInterval)}}function R(v,x){if(!w){var A=0,F=0,G=v.width,z=v.height;x===1&&(A=v.width),x===2&&(F=v.height),x===3&&(A=v.width,F=v.height),x===4&&(F=v.height*2),x===5&&(A=v.width,F=v.height*2),x===6&&(F=v.height*3),x===7&&(A=v.width,F=v.height*3),typeof v.stream.left<"u"&&(A=v.stream.left),typeof v.stream.top<"u"&&(F=v.stream.top),typeof v.stream.width<"u"&&(G=v.stream.width),typeof v.stream.height<"u"&&(z=v.stream.height),k.drawImage(v,A,F,G,z),typeof v.stream.onRender=="function"&&v.stream.onRender(k,A,F,G,z,x)}}function V(){w=!1;var v=N(),x=g();return x&&x.getTracks().filter(function(A){return A.kind==="audio"}).forEach(function(A){v.addTrack(A)}),_.forEach(function(A){A.fullcanvas}),v}function N(){O();var v;"captureStream"in b?v=b.captureStream():"mozCaptureStream"in b?v=b.mozCaptureStream():p.disableLogs||console.error("Upgrade to latest Chrome or otherwise enable this flag: chrome://flags/#enable-experimental-web-platform-features");var x=new S;return v.getTracks().filter(function(A){return A.kind==="video"}).forEach(function(A){x.addTrack(A)}),b.stream=x,x}function g(){E.AudioContextConstructor||(E.AudioContextConstructor=new E.AudioContext),p.audioContext=E.AudioContextConstructor,p.audioSources=[],p.useGainNode===!0&&(p.gainNode=p.audioContext.createGain(),p.gainNode.connect(p.audioContext.destination),p.gainNode.gain.value=0);var v=0;if(_.forEach(function(x){if(x.getTracks().filter(function(F){return F.kind==="audio"}).length){v++;var A=p.audioContext.createMediaStreamSource(x);p.useGainNode===!0&&A.connect(p.gainNode),p.audioSources.push(A)}}),!!v)return p.audioDestination=p.audioContext.createMediaStreamDestination(),p.audioSources.forEach(function(x){x.connect(p.audioDestination)}),p.audioDestination.stream}function I(v){var x=document.createElement("video");return M(v,x),x.className=a,x.muted=!0,x.volume=0,x.width=v.width||p.width||360,x.height=v.height||p.height||240,x.play(),x}this.appendStreams=function(v){if(!v)throw"First parameter is required.";v instanceof Array||(v=[v]),v.forEach(function(x){var A=new S;if(x.getTracks().filter(function(z){return z.kind==="video"}).length){var F=I(x);F.stream=x,y.push(F),A.addTrack(x.getTracks().filter(function(z){return z.kind==="video"})[0])}if(x.getTracks().filter(function(z){return z.kind==="audio"}).length){var G=p.audioContext.createMediaStreamSource(x);p.audioDestination=p.audioContext.createMediaStreamDestination(),G.connect(p.audioDestination),A.addTrack(p.audioDestination.stream.getTracks().filter(function(z){return z.kind==="audio"})[0])}_.push(A)})},this.releaseStreams=function(){y=[],w=!0,p.gainNode&&(p.gainNode.disconnect(),p.gainNode=null),p.audioSources.length&&(p.audioSources.forEach(function(v){v.disconnect()}),p.audioSources=[]),p.audioDestination&&(p.audioDestination.disconnect(),p.audioDestination=null),p.audioContext&&p.audioContext.close(),p.audioContext=null,k.clearRect(0,0,b.width,b.height),b.stream&&(b.stream.stop(),b.stream=null)},this.resetVideoStreams=function(v){v&&!(v instanceof Array)&&(v=[v]),O(v)};function O(v){y=[],v=v||_,v.forEach(function(x){if(x.getTracks().filter(function(F){return F.kind==="video"}).length){var A=I(x);A.stream=x,y.push(A)}})}this.name="MultiStreamsMixer",this.toString=function(){return this.name},this.getMixedStream=V}typeof e>"u"&&(o.exports=Be);/**
 * MultiStreamRecorder can record multiple videos in single container.
 * @summary Multi-videos recorder.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef MultiStreamRecorder
 * @class
 * @example
 * var options = {
 *     mimeType: 'video/webm'
 * }
 * var recorder = new MultiStreamRecorder(ArrayOfMediaStreams, options);
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 *
 *     // or
 *     var blob = recorder.blob;
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStreams} mediaStreams - Array of MediaStreams.
 * @param {object} config - {disableLogs:true, frameInterval: 1, mimeType: "video/webm"}
 */function Ae(_,a){_=_||[];var m=this,y,w;a=a||{elementClass:"multi-streams-mixer",mimeType:"video/webm",video:{width:360,height:240}},a.frameInterval||(a.frameInterval=10),a.video||(a.video={}),a.video.width||(a.video.width=360),a.video.height||(a.video.height=240),this.record=function(){y=new Be(_,a.elementClass||"multi-streams-mixer"),b().length&&(y.frameInterval=a.frameInterval||10,y.width=a.video.width||360,y.height=a.video.height||240,y.startDrawingFrames()),a.previewStream&&typeof a.previewStream=="function"&&a.previewStream(y.getMixedStream()),w=new q(y.getMixedStream(),a),w.record()};function b(){var k=[];return _.forEach(function(p){H(p,"video").forEach(function(T){k.push(T)})}),k}this.stop=function(k){w&&w.stop(function(p){m.blob=p,k(p),m.clearRecordedData()})},this.pause=function(){w&&w.pause()},this.resume=function(){w&&w.resume()},this.clearRecordedData=function(){w&&(w.clearRecordedData(),w=null),y&&(y.releaseStreams(),y=null)},this.addStreams=function(k){if(!k)throw"First parameter is required.";k instanceof Array||(k=[k]),_.concat(k),!(!w||!y)&&(y.appendStreams(k),a.previewStream&&typeof a.previewStream=="function"&&a.previewStream(y.getMixedStream()))},this.resetVideoStreams=function(k){y&&(k&&!(k instanceof Array)&&(k=[k]),y.resetVideoStreams(k))},this.getMixer=function(){return y},this.name="MultiStreamRecorder",this.toString=function(){return this.name}}typeof e<"u"&&(e.MultiStreamRecorder=Ae);/**
 * RecordRTCPromisesHandler adds promises support in {@link RecordRTC}. Try a {@link https://github.com/muaz-khan/RecordRTC/blob/master/simple-demos/RecordRTCPromisesHandler.html|demo here}
 * @summary Promises for {@link RecordRTC}
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef RecordRTCPromisesHandler
 * @class
 * @example
 * var recorder = new RecordRTCPromisesHandler(mediaStream, options);
 * recorder.startRecording()
 *         .then(successCB)
 *         .catch(errorCB);
 * // Note: You can access all RecordRTC API using "recorder.recordRTC" e.g. 
 * recorder.recordRTC.onStateChanged = function(state) {};
 * recorder.recordRTC.setRecordingDuration(5000);
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - Single media-stream object, array of media-streams, html-canvas-element, etc.
 * @param {object} config - {type:"video", recorderType: MediaStreamRecorder, disableLogs: true, numberOfAudioChannels: 1, bufferSize: 0, sampleRate: 0, video: HTMLVideoElement, etc.}
 * @throws Will throw an error if "new" keyword is not used to initiate "RecordRTCPromisesHandler". Also throws error if first argument "MediaStream" is missing.
 * @requires {@link RecordRTC}
 */function je(_,a){if(!this)throw'Use "new RecordRTCPromisesHandler()"';if(typeof _>"u")throw'First argument "MediaStream" is required.';var m=this;m.recordRTC=new e(_,a),this.startRecording=function(){return new Promise(function(y,w){try{m.recordRTC.startRecording(),y()}catch(b){w(b)}})},this.stopRecording=function(){return new Promise(function(y,w){try{m.recordRTC.stopRecording(function(b){if(m.blob=m.recordRTC.getBlob(),!m.blob||!m.blob.size){w("Empty blob.",m.blob);return}y(b)})}catch(b){w(b)}})},this.pauseRecording=function(){return new Promise(function(y,w){try{m.recordRTC.pauseRecording(),y()}catch(b){w(b)}})},this.resumeRecording=function(){return new Promise(function(y,w){try{m.recordRTC.resumeRecording(),y()}catch(b){w(b)}})},this.getDataURL=function(y){return new Promise(function(w,b){try{m.recordRTC.getDataURL(function(k){w(k)})}catch(k){b(k)}})},this.getBlob=function(){return new Promise(function(y,w){try{y(m.recordRTC.getBlob())}catch(b){w(b)}})},this.getInternalRecorder=function(){return new Promise(function(y,w){try{y(m.recordRTC.getInternalRecorder())}catch(b){w(b)}})},this.reset=function(){return new Promise(function(y,w){try{y(m.recordRTC.reset())}catch(b){w(b)}})},this.destroy=function(){return new Promise(function(y,w){try{y(m.recordRTC.destroy())}catch(b){w(b)}})},this.getState=function(){return new Promise(function(y,w){try{y(m.recordRTC.getState())}catch(b){w(b)}})},this.blob=null,this.version="5.6.2"}typeof e<"u"&&(e.RecordRTCPromisesHandler=je);/**
 * WebAssemblyRecorder lets you create webm videos in JavaScript via WebAssembly. The library consumes raw RGBA32 buffers (4 bytes per pixel) and turns them into a webm video with the given framerate and quality. This makes it compatible out-of-the-box with ImageData from a CANVAS. With realtime mode you can also use webm-wasm for streaming webm videos.
 * @summary Video recording feature in Chrome, Firefox and maybe Edge.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef WebAssemblyRecorder
 * @class
 * @example
 * var recorder = new WebAssemblyRecorder(mediaStream);
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {webAssemblyPath:'webm-wasm.wasm',workerPath: 'webm-worker.js', frameRate: 30, width: 1920, height: 1080, bitrate: 1024, realtime: true}
 */function be(_,a){(typeof ReadableStream>"u"||typeof WritableStream>"u")&&console.error("Following polyfill is strongly recommended: https://unpkg.com/@mattiasbuelens/web-streams-polyfill/dist/polyfill.min.js"),a=a||{},a.width=a.width||640,a.height=a.height||480,a.frameRate=a.frameRate||30,a.bitrate=a.bitrate||1200,a.realtime=a.realtime||!0;var m;function y(){return new ReadableStream({start:function(B){var S=document.createElement("canvas"),E=document.createElement("video"),M=!0;E.srcObject=_,E.muted=!0,E.height=a.height,E.width=a.width,E.volume=0,E.onplaying=function(){S.width=a.width,S.height=a.height;var U=S.getContext("2d"),R=1e3/a.frameRate,V=setInterval(function(){if(m&&(clearInterval(V),B.close()),M&&(M=!1,a.onVideoProcessStarted&&a.onVideoProcessStarted()),U.drawImage(E,0,0),B._controlledReadableStream.state!=="closed")try{B.enqueue(U.getImageData(0,0,a.width,a.height))}catch{}},R)},E.play()}})}var w;function b(B,S){if(!a.workerPath&&!S){m=!1,fetch("https://unpkg.com/webm-wasm@latest/dist/webm-worker.js").then(function(M){M.arrayBuffer().then(function(U){b(B,U)})});return}if(!a.workerPath&&S instanceof ArrayBuffer){var E=new Blob([S],{type:"text/javascript"});a.workerPath=l.createObjectURL(E)}a.workerPath||console.error("workerPath parameter is missing."),w=new Worker(a.workerPath),w.postMessage(a.webAssemblyPath||"https://unpkg.com/webm-wasm@latest/dist/webm-wasm.wasm"),w.addEventListener("message",function(M){M.data==="READY"?(w.postMessage({width:a.width,height:a.height,bitrate:a.bitrate||1200,timebaseDen:a.frameRate||30,realtime:a.realtime}),y().pipeTo(new WritableStream({write:function(U){if(m){console.error("Got image, but recorder is finished!");return}w.postMessage(U.data.buffer,[U.data.buffer])}}))):M.data&&(k||T.push(M.data))})}this.record=function(){T=[],k=!1,this.blob=null,b(_),typeof a.initCallback=="function"&&a.initCallback()};var k;this.pause=function(){k=!0},this.resume=function(){k=!1};function p(B){if(!w){B&&B();return}w.addEventListener("message",function(S){S.data===null&&(w.terminate(),w=null,B&&B())}),w.postMessage(null)}var T=[];this.stop=function(B){m=!0;var S=this;p(function(){S.blob=new Blob(T,{type:"video/webm"}),B(S.blob)})},this.name="WebAssemblyRecorder",this.toString=function(){return this.name},this.clearRecordedData=function(){T=[],k=!1,this.blob=null},this.blob=null}typeof e<"u"&&(e.WebAssemblyRecorder=be)})(ze);var Ci=ze.exports;const ki=Ee(Ci);var Ne={exports:{}};(function(o){(function(e,t){o.exports?o.exports=t():window.ysFixWebmDuration=t()})("fix-webm-duration",function(){var e={172351395:{name:"EBML",type:"Container"},646:{name:"EBMLVersion",type:"Uint"},759:{name:"EBMLReadVersion",type:"Uint"},754:{name:"EBMLMaxIDLength",type:"Uint"},755:{name:"EBMLMaxSizeLength",type:"Uint"},642:{name:"DocType",type:"String"},647:{name:"DocTypeVersion",type:"Uint"},645:{name:"DocTypeReadVersion",type:"Uint"},108:{name:"Void",type:"Binary"},63:{name:"CRC-32",type:"Binary"},190023271:{name:"SignatureSlot",type:"Container"},16010:{name:"SignatureAlgo",type:"Uint"},16026:{name:"SignatureHash",type:"Uint"},16037:{name:"SignaturePublicKey",type:"Binary"},16053:{name:"Signature",type:"Binary"},15963:{name:"SignatureElements",type:"Container"},15995:{name:"SignatureElementList",type:"Container"},9522:{name:"SignedElement",type:"Binary"},139690087:{name:"Segment",type:"Container"},21863284:{name:"SeekHead",type:"Container"},3515:{name:"Seek",type:"Container"},5035:{name:"SeekID",type:"Binary"},5036:{name:"SeekPosition",type:"Uint"},88713574:{name:"Info",type:"Container"},13220:{name:"SegmentUID",type:"Binary"},13188:{name:"SegmentFilename",type:"String"},1882403:{name:"PrevUID",type:"Binary"},1868715:{name:"PrevFilename",type:"String"},2013475:{name:"NextUID",type:"Binary"},1999803:{name:"NextFilename",type:"String"},1092:{name:"SegmentFamily",type:"Binary"},10532:{name:"ChapterTranslate",type:"Container"},10748:{name:"ChapterTranslateEditionUID",type:"Uint"},10687:{name:"ChapterTranslateCodec",type:"Uint"},10661:{name:"ChapterTranslateID",type:"Binary"},710577:{name:"TimecodeScale",type:"Uint"},1161:{name:"Duration",type:"Float"},1121:{name:"DateUTC",type:"Date"},15273:{name:"Title",type:"String"},3456:{name:"MuxingApp",type:"String"},5953:{name:"WritingApp",type:"String"},103:{name:"Timecode",type:"Uint"},6228:{name:"SilentTracks",type:"Container"},6359:{name:"SilentTrackNumber",type:"Uint"},39:{name:"Position",type:"Uint"},43:{name:"PrevSize",type:"Uint"},35:{name:"SimpleBlock",type:"Binary"},32:{name:"BlockGroup",type:"Container"},33:{name:"Block",type:"Binary"},34:{name:"BlockVirtual",type:"Binary"},13729:{name:"BlockAdditions",type:"Container"},38:{name:"BlockMore",type:"Container"},110:{name:"BlockAddID",type:"Uint"},37:{name:"BlockAdditional",type:"Binary"},27:{name:"BlockDuration",type:"Uint"},122:{name:"ReferencePriority",type:"Uint"},123:{name:"ReferenceBlock",type:"Int"},125:{name:"ReferenceVirtual",type:"Int"},36:{name:"CodecState",type:"Binary"},13730:{name:"DiscardPadding",type:"Int"},14:{name:"Slices",type:"Container"},104:{name:"TimeSlice",type:"Container"},76:{name:"LaceNumber",type:"Uint"},77:{name:"FrameNumber",type:"Uint"},75:{name:"BlockAdditionID",type:"Uint"},78:{name:"Delay",type:"Uint"},79:{name:"SliceDuration",type:"Uint"},72:{name:"ReferenceFrame",type:"Container"},73:{name:"ReferenceOffset",type:"Uint"},74:{name:"ReferenceTimeCode",type:"Uint"},47:{name:"EncryptedBlock",type:"Binary"},106212971:{name:"Tracks",type:"Container"},46:{name:"TrackEntry",type:"Container"},87:{name:"TrackNumber",type:"Uint"},13253:{name:"TrackUID",type:"Uint"},3:{name:"TrackType",type:"Uint"},57:{name:"FlagEnabled",type:"Uint"},8:{name:"FlagDefault",type:"Uint"},5546:{name:"FlagForced",type:"Uint"},28:{name:"FlagLacing",type:"Uint"},11751:{name:"MinCache",type:"Uint"},11768:{name:"MaxCache",type:"Uint"},254851:{name:"DefaultDuration",type:"Uint"},216698:{name:"DefaultDecodedFieldDuration",type:"Uint"},209231:{name:"TrackTimecodeScale",type:"Float"},4991:{name:"TrackOffset",type:"Int"},5614:{name:"MaxBlockAdditionID",type:"Uint"},4974:{name:"Name",type:"String"},177564:{name:"Language",type:"String"},6:{name:"CodecID",type:"String"},9122:{name:"CodecPrivate",type:"Binary"},362120:{name:"CodecName",type:"String"},13382:{name:"AttachmentLink",type:"Uint"},1742487:{name:"CodecSettings",type:"String"},1785920:{name:"CodecInfoURL",type:"String"},438848:{name:"CodecDownloadURL",type:"String"},42:{name:"CodecDecodeAll",type:"Uint"},12203:{name:"TrackOverlay",type:"Uint"},5802:{name:"CodecDelay",type:"Uint"},5819:{name:"SeekPreRoll",type:"Uint"},9764:{name:"TrackTranslate",type:"Container"},9980:{name:"TrackTranslateEditionUID",type:"Uint"},9919:{name:"TrackTranslateCodec",type:"Uint"},9893:{name:"TrackTranslateTrackID",type:"Binary"},96:{name:"Video",type:"Container"},26:{name:"FlagInterlaced",type:"Uint"},5048:{name:"StereoMode",type:"Uint"},5056:{name:"AlphaMode",type:"Uint"},5049:{name:"OldStereoMode",type:"Uint"},48:{name:"PixelWidth",type:"Uint"},58:{name:"PixelHeight",type:"Uint"},5290:{name:"PixelCropBottom",type:"Uint"},5307:{name:"PixelCropTop",type:"Uint"},5324:{name:"PixelCropLeft",type:"Uint"},5341:{name:"PixelCropRight",type:"Uint"},5296:{name:"DisplayWidth",type:"Uint"},5306:{name:"DisplayHeight",type:"Uint"},5298:{name:"DisplayUnit",type:"Uint"},5299:{name:"AspectRatioType",type:"Uint"},963876:{name:"ColourSpace",type:"Binary"},1029411:{name:"GammaValue",type:"Float"},230371:{name:"FrameRate",type:"Float"},97:{name:"Audio",type:"Container"},53:{name:"SamplingFrequency",type:"Float"},14517:{name:"OutputSamplingFrequency",type:"Float"},31:{name:"Channels",type:"Uint"},15739:{name:"ChannelPositions",type:"Binary"},8804:{name:"BitDepth",type:"Uint"},98:{name:"TrackOperation",type:"Container"},99:{name:"TrackCombinePlanes",type:"Container"},100:{name:"TrackPlane",type:"Container"},101:{name:"TrackPlaneUID",type:"Uint"},102:{name:"TrackPlaneType",type:"Uint"},105:{name:"TrackJoinBlocks",type:"Container"},109:{name:"TrackJoinUID",type:"Uint"},64:{name:"TrickTrackUID",type:"Uint"},65:{name:"TrickTrackSegmentUID",type:"Binary"},70:{name:"TrickTrackFlag",type:"Uint"},71:{name:"TrickMasterTrackUID",type:"Uint"},68:{name:"TrickMasterTrackSegmentUID",type:"Binary"},11648:{name:"ContentEncodings",type:"Container"},8768:{name:"ContentEncoding",type:"Container"},4145:{name:"ContentEncodingOrder",type:"Uint"},4146:{name:"ContentEncodingScope",type:"Uint"},4147:{name:"ContentEncodingType",type:"Uint"},4148:{name:"ContentCompression",type:"Container"},596:{name:"ContentCompAlgo",type:"Uint"},597:{name:"ContentCompSettings",type:"Binary"},4149:{name:"ContentEncryption",type:"Container"},2017:{name:"ContentEncAlgo",type:"Uint"},2018:{name:"ContentEncKeyID",type:"Binary"},2019:{name:"ContentSignature",type:"Binary"},2020:{name:"ContentSigKeyID",type:"Binary"},2021:{name:"ContentSigAlgo",type:"Uint"},2022:{name:"ContentSigHashAlgo",type:"Uint"},206814059:{name:"Cues",type:"Container"},59:{name:"CuePoint",type:"Container"},51:{name:"CueTime",type:"Uint"},55:{name:"CueTrackPositions",type:"Container"},119:{name:"CueTrack",type:"Uint"},113:{name:"CueClusterPosition",type:"Uint"},112:{name:"CueRelativePosition",type:"Uint"},50:{name:"CueDuration",type:"Uint"},4984:{name:"CueBlockNumber",type:"Uint"},106:{name:"CueCodecState",type:"Uint"},91:{name:"CueReference",type:"Container"},22:{name:"CueRefTime",type:"Uint"},23:{name:"CueRefCluster",type:"Uint"},4959:{name:"CueRefNumber",type:"Uint"},107:{name:"CueRefCodecState",type:"Uint"},155296873:{name:"Attachments",type:"Container"},8615:{name:"AttachedFile",type:"Container"},1662:{name:"FileDescription",type:"String"},1646:{name:"FileName",type:"String"},1632:{name:"FileMimeType",type:"String"},1628:{name:"FileData",type:"Binary"},1710:{name:"FileUID",type:"Uint"},1653:{name:"FileReferral",type:"Binary"},1633:{name:"FileUsedStartTime",type:"Uint"},1634:{name:"FileUsedEndTime",type:"Uint"},4433776:{name:"Chapters",type:"Container"},1465:{name:"EditionEntry",type:"Container"},1468:{name:"EditionUID",type:"Uint"},1469:{name:"EditionFlagHidden",type:"Uint"},1499:{name:"EditionFlagDefault",type:"Uint"},1501:{name:"EditionFlagOrdered",type:"Uint"},54:{name:"ChapterAtom",type:"Container"},13252:{name:"ChapterUID",type:"Uint"},5716:{name:"ChapterStringUID",type:"String"},17:{name:"ChapterTimeStart",type:"Uint"},18:{name:"ChapterTimeEnd",type:"Uint"},24:{name:"ChapterFlagHidden",type:"Uint"},1432:{name:"ChapterFlagEnabled",type:"Uint"},11879:{name:"ChapterSegmentUID",type:"Binary"},11964:{name:"ChapterSegmentEditionUID",type:"Uint"},9155:{name:"ChapterPhysicalEquiv",type:"Uint"},15:{name:"ChapterTrack",type:"Container"},9:{name:"ChapterTrackNumber",type:"Uint"},0:{name:"ChapterDisplay",type:"Container"},5:{name:"ChapString",type:"String"},892:{name:"ChapLanguage",type:"String"},894:{name:"ChapCountry",type:"String"},10564:{name:"ChapProcess",type:"Container"},10581:{name:"ChapProcessCodecID",type:"Uint"},1293:{name:"ChapProcessPrivate",type:"Binary"},10513:{name:"ChapProcessCommand",type:"Container"},10530:{name:"ChapProcessTime",type:"Uint"},10547:{name:"ChapProcessData",type:"Binary"},39109479:{name:"Tags",type:"Container"},13171:{name:"Tag",type:"Container"},9152:{name:"Targets",type:"Container"},10442:{name:"TargetTypeValue",type:"Uint"},9162:{name:"TargetType",type:"String"},9157:{name:"TagTrackUID",type:"Uint"},9161:{name:"TagEditionUID",type:"Uint"},9156:{name:"TagChapterUID",type:"Uint"},9158:{name:"TagAttachmentUID",type:"Uint"},10184:{name:"SimpleTag",type:"Container"},1443:{name:"TagName",type:"String"},1146:{name:"TagLanguage",type:"String"},1156:{name:"TagDefault",type:"Uint"},1159:{name:"TagString",type:"String"},1157:{name:"TagBinary",type:"Binary"}};function t(l,h){l.prototype=Object.create(h.prototype),l.prototype.constructor=l}function i(l,h){this.name=l||"Unknown",this.type=h||"Unknown"}i.prototype.updateBySource=function(){},i.prototype.setSource=function(l){this.source=l,this.updateBySource()},i.prototype.updateByData=function(){},i.prototype.setData=function(l){this.data=l,this.updateByData()};function r(l,h){i.call(this,l,h||"Uint")}t(r,i);function s(l){return l.length%2===1?"0"+l:l}r.prototype.updateBySource=function(){this.data="";for(var l=0;l<this.source.length;l++){var h=this.source[l].toString(16);this.data+=s(h)}},r.prototype.updateByData=function(){var l=this.data.length/2;this.source=new Uint8Array(l);for(var h=0;h<l;h++){var u=this.data.substr(h*2,2);this.source[h]=parseInt(u,16)}},r.prototype.getValue=function(){return parseInt(this.data,16)},r.prototype.setValue=function(l){this.setData(s(l.toString(16)))};function n(l,h){i.call(this,l,h||"Float")}t(n,i),n.prototype.getFloatArrayType=function(){return this.source&&this.source.length===4?Float32Array:Float64Array},n.prototype.updateBySource=function(){var l=this.source.reverse(),h=this.getFloatArrayType(),u=new h(l.buffer);this.data=u[0]},n.prototype.updateByData=function(){var l=this.getFloatArrayType(),h=new l([this.data]),u=new Uint8Array(h.buffer);this.source=u.reverse()},n.prototype.getValue=function(){return this.data},n.prototype.setValue=function(l){this.setData(l)};function d(l,h){i.call(this,l,h||"Container")}t(d,i),d.prototype.readByte=function(){return this.source[this.offset++]},d.prototype.readUint=function(){for(var l=this.readByte(),h=8-l.toString(2).length,u=l-(1<<7-h),L=0;L<h;L++)u*=256,u+=this.readByte();return u},d.prototype.updateBySource=function(){for(this.data=[],this.offset=0;this.offset<this.source.length;this.offset=u){var l=this.readUint(),h=this.readUint(),u=Math.min(this.offset+h,this.source.length),L=this.source.slice(this.offset,u),$=e[l]||{name:"Unknown",type:"Unknown"},P=i;switch($.type){case"Container":P=d;break;case"Uint":P=r;break;case"Float":P=n;break}var C=new P($.name,$.type);C.setSource(L),this.data.push({id:l,idHex:l.toString(16),data:C})}},d.prototype.writeUint=function(l,h){for(var u=1,L=128;l>=L&&u<8;u++,L*=128);if(!h)for(var $=L+l,P=u-1;P>=0;P--){var C=$%256;this.source[this.offset+P]=C,$=($-C)/256}this.offset+=u},d.prototype.writeSections=function(l){this.offset=0;for(var h=0;h<this.data.length;h++){var u=this.data[h],L=u.data.source,$=L.length;this.writeUint(u.id,l),this.writeUint($,l),l||this.source.set(L,this.offset),this.offset+=$}return this.offset},d.prototype.updateByData=function(){var l=this.writeSections("draft");this.source=new Uint8Array(l),this.writeSections()},d.prototype.getSectionById=function(l){for(var h=0;h<this.data.length;h++){var u=this.data[h];if(u.id===l)return u.data}return null};function c(l){d.call(this,"File","File"),this.setSource(l)}t(c,d),c.prototype.fixDuration=function(l,h){var u=h&&h.logger;u===void 0?u=function(D){console.log(D)}:u||(u=function(){});var L=this.getSectionById(139690087);if(!L)return u("[fix-webm-duration] Segment section is missing"),!1;var $=L.getSectionById(88713574);if(!$)return u("[fix-webm-duration] Info section is missing"),!1;var P=$.getSectionById(710577);if(!P)return u("[fix-webm-duration] TimecodeScale section is missing"),!1;var C=$.getSectionById(1161);if(C)if(C.getValue()<=0)u(`[fix-webm-duration] Duration section is present, but the value is ${C.getValue()}`),C.setValue(l);else return u(`[fix-webm-duration] Duration section is present, and the value is ${C.getValue()}`),!1;else u("[fix-webm-duration] Duration section is missing"),C=new n("Duration","Float"),C.setValue(l),$.data.push({id:1161,data:C});return P.setValue(1e6),$.updateByData(),L.updateByData(),this.updateByData(),!0},c.prototype.toBlob=function(l){return new Blob([this.source.buffer],{type:l||"video/webm"})};function f(l,h,u,L){if(typeof u=="object"&&(L=u,u=void 0),!u)return new Promise(function(P){f(l,h,P,L)});try{var $=new FileReader;$.onloadend=function(){try{var P=new c(new Uint8Array($.result));P.fixDuration(h,L)&&(l=P.toBlob(l.type))}catch{}u(l)},$.readAsArrayBuffer(l)}catch{u(l)}}return f.default=f,f})})(Ne);var Si=Ne.exports;const Oe=Ee(Si),$i={props:{type:String,path:String,selected_mode:String,stopmotion_slug:String,available_modes:{type:Array,default:()=>["photo","video","stopmotion","audio","vecto","lines"]},origin:{type:String,default:"capture"},return_temp_media:{type:Boolean,default:!1},must_validate_media:{type:Boolean,default:!0}},components:{PickLocationForCaptures:It,ModeSelector:ot,MediaPreviewBeforeValidation:dt,MediaValidationButtons:Ve,StopmotionPanel:Tt,CapturePane:Ft,CaptureSettings:Nt,CaptureEffects:Kt,StopmotionList:oi,AudioEqualizer:ci,VectoMode:vi,LinesMode:xi},data(){return{is_sending_image:!1,is_loading_stream:!0,invisible_canvas:void 0,ask_before_leaving_capture:!1,capture_pane_is_small:!1,media_to_validate:!1,media_is_being_sent:!1,media_being_sent_percent:0,capture_button_pressed:!1,mode_just_changed:!1,is_validating_stopmotion_video:!1,video_recording_is_paused:!1,grids:{halfs:[[50,0,50,100],[0,50,100,50]],thirds:[[33,0,33,100],[66,0,66,100],[0,33,100,33],[0,66,100,66]],fourths:[[25,0,25,100],[50,0,50,100],[75,0,75,100],[0,25,100,25],[0,50,100,50],[0,75,100,75]]},current_grid_type:!1,location_to_add_to_medias:void 0,show_position_modal:!1,stream:void 0,showVideoElement:!0,audio_output_deviceId:void 0,show_capture_settings:!1,show_effects_pane:!1,enable_audio_recording_in_video:!0,enable_video:!0,is_recording:!1,timer_recording_in_seconds:!1,recording_timer_interval:void 0,stopmotion_frame_rate:4,timelapse_mode_enabled:!1,timelapse_interval:2,timelapse_event:!1,timelapse_time_before_next_picture:!1,delay_mode_enabled:!1,delay_seconds:5,delay_event:!1,delay_remaining_time:!1,recorder:null,actual_camera_resolution:{width:void 0,height:void 0},displayed_video_size:{width:void 0,height:void 0},show_live_feed:!1,show_stopmotion_list:!1,onion_skin_img:!1,onion_skin_opacity:0,last_frame_from_video:void 0,frameGrabber:void 0,show_lines_settings:!1,vecto_number_of_colors:2,lines_angle:108,lines_brightness:1,lines_contrast:1,lines_density:.25,enable_effects:!1,update_last_video_imageData:void 0}},created(){try{const o=localStorage.getItem("location_to_add_to_medias");o&&o!=="undefined"&&(this.location_to_add_to_medias=JSON.parse(o))}catch(o){console.error(o),this.location_to_add_to_medias=void 0}},mounted(){this.selected_mode||this.$emit("changeMode",this.available_modes[0]),document.addEventListener("keyup",this.captureKeyListener),this.checkCapturePanelSize(),this.$eventHub.$on("activity_panels_resized",this.checkCapturePanelSize),this.$eventHub.$on("window.resized",this.checkCapturePanelSize),this.$eventHub.$on("capture.stopRecording",this.stopRecording),this.$refs.videoElement.volume=0,this.$refs.videoElement.addEventListener("loadedmetadata",this.refreshVideoActualSize)},async beforeDestroy(){console.log("CaptureView: beforeDestroy - cleaning up camera resources"),this.$eventHub.$off("activity_panels_resized",this.checkCapturePanelSize),this.$eventHub.$off("window.resized",this.checkCapturePanelSize),this.$eventHub.$off("capture.stopRecording",this.stopRecording),document.removeEventListener("keyup",this.captureKeyListener),this.ask_before_leaving_capture=!1,this.is_recording&&(console.log("CaptureView: Stopping active recording before destroy"),this.stopRecording()),this.stopFrameGrabber(),this.stopTimelapseInterval(),this.cancelDelay(),this.eraseTimer(),await this.stopStream(),this.showVideoElement=!1,this.update_last_video_imageData&&window.cancelAnimationFrame(this.update_last_video_imageData),this.$refs.videoElement&&this.$refs.videoElement.removeEventListener("loadedmetadata",this.refreshVideoActualSize)},watch:{selected_mode(o,e){if(!o){this.$emit("changeMode",e);return}this.mode_just_changed=!0,window.setTimeout(()=>{this.mode_just_changed=!1},300),this.selected_mode==="audio"?(this.enable_audio=!0,this.enable_video=!1):this.enable_video=!0,this.stopFrameGrabber(),(this.selected_mode==="vecto"||this.selected_mode==="lines")&&this.startFrameGrabber(),this.selected_mode!=="stopmotion"&&(this.show_stopmotion_list=!1)},location_to_add_to_medias(){this.has_location_to_add_to_medias?localStorage.setItem("location_to_add_to_medias",JSON.stringify(this.location_to_add_to_medias)):localStorage.removeItem("location_to_add_to_medias")},is_validating_stopmotion_video(){this.is_validating_stopmotion_video?this.$refs.videoElement.pause():(this.$refs.videoElement.play(),this.show_live_feed=!0)},is_making_stopmotion(){this.is_making_stopmotion&&(this.show_capture_settings=!1)},audio_output_deviceId(){},media_to_validate(){if(console.log(`WATCH ‚Ä¢ Capture: media_to_validate = ${!!this.media_to_validate}`),this.media_to_validate&&!this.must_validate_media){this.sendMedia();return}this.media_to_validate?(this.$refs.videoElement&&this.$refs.videoElement.pause(),this.$refs.audioElement&&this.$refs.audioElement.pause(),this.ask_before_leaving_capture=!0):(this.$refs.videoElement&&this.$refs.videoElement.play(),this.$refs.audioElement&&this.$refs.audioElement.play(),this.ask_before_leaving_capture=!1)}},computed:{show_mode_selector(){return!this.media_to_validate&&!this.is_recording&&!this.is_making_stopmotion&&!this.delay_event},has_location_to_add_to_medias(){var o,e;return((o=this.location_to_add_to_medias)==null?void 0:o.longitude)&&((e=this.location_to_add_to_medias)==null?void 0:e.latitude)},is_making_stopmotion(){return!!this.stopmotion_slug},validated_media_href_blob(){return this.media_to_validate?window.URL.createObjectURL(this.media_to_validate.rawData):!1},show_videos(){return this.stream&&["photo","video","stopmotion"].includes(this.selected_mode)&&this.show_live_feed&&!(this.must_validate_media&&this.media_to_validate)}},methods:{async stopStream(){if(console.log("CaptureView: METHODS ‚Ä¢ stopStream"),this.stream&&(console.log("CaptureView: Stopping stream tracks:",this.stream.getTracks().length),this.stream.getTracks().forEach(o=>{console.log("CaptureView: Stopping track:",o.kind,o.label),o.stop()}),this.stream=null),console.log("CaptureView: Removing video element from DOM"),this.showVideoElement=!1,this.recorder){console.log("CaptureView: Stopping recorder");try{this.recorder.stopRecording(),this.recorder.destroy(),this.recorder=null}catch(o){console.warn("CaptureView: Error stopping recorder:",o)}}this.is_loading_stream=!1,this.show_live_feed=!1},hasFinishedLoading(){this.is_loading_stream=!1,this.show_live_feed=!0},setStream(o){console.log("CaptureView: METHODS ‚Ä¢ setStream",o),this.stream=o,this.showVideoElement=!0,this.$nextTick(()=>{this.$refs.videoElement&&(this.$refs.videoElement.volume=0)}),this.enable_effects=!1},updateSelectedColor({e:o,type:e}){if(!this.$refs.canvasElement)return;console.log("CaptureView: METHODS ‚Ä¢ updateSelectedColor");const t=this.getColorInCanvasFromPixelCount(o);this.$eventHub.$emit("captureCanvas.pixelColorUnderMouse",{px_color:t,type:e})},getColorInCanvasFromPixelCount(o){const t=((n,d,c,f)=>{let l,h,u;return d/f>n/c?(l=d/f,h=(n-c*l)/2,u=0):(l=n/c,u=(d-f*l)/2,h=0),{scale:l,offsetX:h,offsetY:u}})(this.actual_camera_resolution.width,this.actual_camera_resolution.height,this.$refs.canvasElement.getBoundingClientRect().width,this.$refs.canvasElement.getBoundingClientRect().height),i=o.offsetX*t.scale+t.offsetX,r=o.offsetY*t.scale+t.offsetY,s=this.$refs.canvasElement.getContext("2d").getImageData(i,r,1,1);return{r:s.data[0],g:s.data[1],b:s.data[2]}},refreshVideoActualSize(){this.getVideoActualSize().then(({width:o,height:e})=>{this.actual_camera_resolution.width=o,this.actual_camera_resolution.height=e}).catch(o=>{this.$root.debug_mode===!0&&console.log("CaptureView ‚Ä¢ METHODS : refreshVideoActualSize ‚Äî couldnt get video size: "+o)})},testStopmotion(){this.$eventHub.$emit("stopmotion.test")},getVideoActualSize(){return new Promise((o,e)=>{let t=0;this.$refs.videoElement.videoWidth||(t=500),(r=>new Promise(s=>window.setTimeout(s,r)))(t).then(()=>!this.$refs.videoElement||this.$refs.videoElement.videoWidth*this.$refs.videoElement.videoHeight>0?o({width:this.$refs.videoElement.videoWidth,height:this.$refs.videoElement.videoHeight}):e("couldn‚Äôt get video dimensions"))})},loadStopmotion(o){const e=o.substring(o.lastIndexOf("/")+1);this.$emit("openStopmotion",e),this.show_stopmotion_list=!1},checkCapturePanelSize(){var o;((o=this.$el)==null?void 0:o.offsetHeight)<=400?this.capture_pane_is_small=!0:this.capture_pane_is_small=!1},stopStopmotion(){this.closeStopmotionPanel()},startFrameGrabber(){const o=()=>{if(this.$root.debug_mode===!0&&console.log("CaptureView ‚Ä¢ METHODS : startFrameGrabber"),this.media_to_validate)return;const e=this.actual_camera_resolution.width/this.actual_camera_resolution.height;this.getImageDataFromFeed({width:240*e,height:240}).then(t=>this.last_frame_from_video=t)};o(),this.frameGrabber=window.setInterval(o,300)},stopFrameGrabber(){this.$root.debug_mode===!0&&console.log("CaptureView ‚Ä¢ METHODS : stopFrameGrabber  "),this.frameGrabber&&window.clearInterval(this.frameGrabber),this.last_frame_from_video=void 0},async addStopmotionImage(){if(this.show_live_feed=!0,this.$refs.videoElement.pause(),this.is_sending_image=!0,!this.stopmotion_slug){this.ask_before_leaving_capture=!0;const e=await this.$api.createFolder({path:`${this.path}/stopmotions`,additional_meta:{name:new Date().getTime(),$admins:"parent_contributors"}});this.$emit("openStopmotion",e)}const o=await this.getImageDataFromFeed();this.$eventHub.$emit("stopmotion.addImage",{imageData:o}),this.media_to_validate={rawData:o,objectURL:URL.createObjectURL(o),type:"image"},setTimeout(()=>{this.media_to_validate=!1},500),this.is_sending_image=!1,this.$refs.videoElement.play()},closeStopmotionPanel(){this.$emit("openStopmotion",void 0),this.media_is_being_sent=!1,this.media_being_sent_percent=100,this.media_to_validate=!1,this.is_recording=!1,this.ask_before_leaving_capture=!1,this.show_live_feed=!0},captureKeyListener(o){if(console.log("METHODS ‚Ä¢ CaptureView: captureKeyListener"),this.media_to_validate||this.is_validating_stopmotion_video)return!1;if(!(this.$root.modal_is_opened||o.target.tagName.toLowerCase()==="select"||o.target.tagName.toLowerCase()==="input"||o.target.tagName.toLowerCase()==="textarea"||o.target.className.includes("ql-editor")||o.target.hasAttribute("contenteditable")))switch(o.key){case"w":case"z":case"ArrowLeft":this.$eventHub.$emit("capture.navigate.previous");break;case"s":case"ArrowRight":this.$eventHub.$emit("capture.navigate.next");break;case"a":case"q":case" ":this.is_recording?this.stopRecording():this.setCaptureInit();break;case"Backspace":case"Delete":this.$eventHub.$emit("capture.remove");break}},setCaptureInit(){this.$root.debug_mode===!0&&console.log("CaptureView / setCaptureInit"),this.ask_before_leaving_capture=!0,this.delay_mode_enabled&&this.delay_event?this.cancelDelay():this.delay_mode_enabled?this.startDelay():this.setCapture()},startDelay(){let o=0;this.delay_remaining_time=this.delay_seconds,this.delay_event=window.setInterval(()=>{o+=1,o===this.delay_seconds?(this.setCapture(),this.cancelDelay()):this.delay_remaining_time=this.delay_seconds-o},1e3)},cancelDelay(){this.delay_remaining_time=!1,window.clearInterval(this.delay_event),this.delay_event=!1},startTimelapseInterval(){let o=0;this.timelapse_time_before_next_picture=this.timelapse_interval,this.timelapse_event=window.setInterval(()=>{o+=1,o===this.timelapse_interval?(this.setCapture(),this.stopTimelapseInterval(),this.startTimelapseInterval()):this.timelapse_time_before_next_picture=this.timelapse_interval-o},1e3)},stopTimelapseInterval(){window.clearInterval(this.timelapse_event),this.timelapse_event=!1,this.timelapse_time_before_next_picture=!1},setCapture(){if(this.capture_button_pressed=!0,window.setTimeout(()=>{this.capture_button_pressed=!1},400),this.show_capture_settings=!1,this.selected_mode==="photo")this.getImageDataFromFeed().then(o=>{this.media_to_validate={rawData:o,objectURL:URL.createObjectURL(o),temp_name:"image.jpeg",type:"image"}});else if(this.selected_mode==="video")this.video_recording_is_paused=!1,this.startRecordFeed({type:"video",mimeType:"video/webm;codecs=vp8,opus",videoBitsPerSecond:4112e3,enable_audio_recording_in_video:this.enable_audio_recording_in_video});else if(this.selected_mode==="audio")this.startRecordFeed({type:"audio"});else if(this.selected_mode==="stopmotion")this.addStopmotionImage(),this.timelapse_mode_enabled&&!this.is_recording&&(this.is_recording=!0,this.startTimelapseInterval());else if(this.selected_mode==="vecto"){const o=this.$refs.vectoElement.svgstr;this.media_to_validate={preview:o,rawData:new Blob([o],{type:"image/svg+xml"}),temp_name:"vecto.svg",type:"svg"}}else if(this.selected_mode==="lines"){const o=this.$refs.vectoElement.$el.querySelector("svg").outerHTML;this.media_to_validate={preview:o,rawData:new Blob([o],{type:"image/svg+xml"}),temp_name:"lines.svg",type:"svg"}}},stopRecording(){if(!this.is_recording)return;const o=this.timer_recording_in_seconds;if(this.selected_mode==="stopmotion"&&this.timelapse_mode_enabled){this.is_recording=!1,this.stopTimelapseInterval();return}this.selected_mode==="video"?this.recorder.stopRecording(()=>{this.is_recording=!1,this.eraseTimer();let e=this.recorder.getBlob();this.recorder.destroy(),this.recorder=null,Oe(e,o*1e3,{logger:!1}).then(t=>{this.media_to_validate={rawData:t,objectURL:URL.createObjectURL(t),temp_name:"video.webm",type:"video"}})}):this.selected_mode==="audio"&&this.recorder.stopRecording(()=>{this.is_recording=!1,this.eraseTimer();let e=this.recorder.getBlob();this.recorder.destroy(),this.recorder=null;const t=this.$refs.equalizerElement.$el.querySelector("canvas").toDataURL("image/png");Oe(e,o*1e3,{logger:!1}).then(i=>{this.media_to_validate={preview:t,rawData:i,objectURL:URL.createObjectURL(i),temp_name:"audio.wav",type:"audio"}})})},pauseOrResumeCapture(){this.recorder.state!=="paused"?(this.video_recording_is_paused=!0,this.pauseTimer(),this.recorder.pauseRecording()):(this.video_recording_is_paused=!1,this.unpauseTimer(),this.recorder.resumeRecording())},startTimer(){this.recording_timer_interval=window.setInterval(()=>{this.timer_recording_in_seconds=Number(Number(this.timer_recording_in_seconds)+.1).toFixed(1)},100)},pauseTimer(){window.clearInterval(this.recording_timer_interval)},unpauseTimer(){this.startTimer()},eraseTimer(){this.timer_recording_in_seconds=!1,window.clearInterval(this.recording_timer_interval)},getImageDataFromFeed({width:o,height:e}={}){return new Promise((t,i)=>{this.enable_effects&&this.$refs.canvasElement?this.getStaticImageFromVideoElement({width:o,height:e,from_element:this.$refs.canvasElement}).then(t).catch(i):this.getStaticImageFromVideoElement({width:o,height:e}).then(t).catch(i)})},async getStaticImageFromVideoElement({width:o,height:e,from_element:t=this.$refs.videoElement}={}){if(this.$root.debug_mode===!0&&console.log("CaptureView ‚Ä¢ METHODS : getStaticImageFromVideoElement"),!t)throw new Error("missing video element");let i;return t.tagName==="VIDEO"?(this.invisible_canvas||(this.invisible_canvas=document.createElement("canvas")),i=this.invisible_canvas,i.width=o||t.videoWidth,i.height=e||t.videoHeight,i.getContext("2d").drawImage(t,0,0,i.width,i.height)):t.tagName==="CANVAS"&&(i=t),await new Promise(s=>{i.toBlob(s,"image/jpeg",.95)})},startRecordFeed(o){return new Promise(()=>{const e=new MediaStream;o.type==="video"&&(this.enable_effects&&this.$refs.canvasElement?this.$refs.canvasElement.captureStream():this.stream).getVideoTracks().forEach(i=>{e.addTrack(i)}),((o==null?void 0:o.enable_audio_recording_in_video)===!0||o.type==="audio")&&this.stream.getAudioTracks().forEach(t=>e.addTrack(t)),this.recorder=ki(e,o);try{this.recorder.startRecording(),this.is_recording=!0,this.timer_recording_in_seconds=0,this.$eventHub.$emit("capture.isRecording",o.type),this.startTimer()}catch(t){this.$alertify.closeLogOnClick(!0).delay(4e3).error(this.$t("failed_to_start_recording")+"<br>"+t.message)}})},async sendMedia({fav:o=!1}={}){var f;if(console.log(`METHODS ‚Ä¢ CaptureView: sendMedia with fav=${o}`),this.$root.debug_mode===!0&&console.log("METHODS ‚Ä¢ CaptureView / sendMedia"),this.return_temp_media){this.$emit("tempMedia",this.media_to_validate);return}const e=+new Date,t=(Math.random().toString(36)+"00000000000000000").slice(2,5),i={image:"jpeg",video:"webm",audio:"wav",svg:"svg"},r=`${this.media_to_validate.type}-${e}-${t}.${i[this.media_to_validate.type]}`,s=this.media_to_validate.rawData;this.media_is_being_sent=!0,this.media_being_sent_percent=0;let n={fav:o,$origin:this.origin};(f=this.connected_as)!=null&&f.$path&&(n.$authors=[this.connected_as.$path]),this.has_location_to_add_to_medias&&(n.$location=this.location_to_add_to_medias);const d=l=>{console.log(`METHODS ‚Ä¢ CaptureView: onUploadProgress for name = ${r} / ${parseInt(Math.round(l.loaded*100/l.total))}% `),this.media_being_sent_percent=parseInt(Math.round(l.loaded*100/l.total))},{meta_filename:c}=await this.$api.uploadFile({path:this.path,filename:r,file:s,additional_meta:n,onProgress:d}).catch(l=>{throw console.log(`METHODS ‚Ä¢ sendThisFile: name = ${r} / failed uploading ${l}`),this.media_is_being_sent=!1,this.media_being_sent_percent=0,this.$alertify.closeLogOnClick(!0).delay(4e3).error(this.$t("media_couldnt_be_sent")),l});this.$alertify.closeLogOnClick(!0).delay(4e3).success(this.$t("media_was_saved")),this.media_is_being_sent=!1,this.media_being_sent_percent=100,this.media_to_validate=!1,this.$eventHub.$emit("pane.animate","collect"),this.$emit("insertMedia",c)},cancelValidation(){this.media_to_validate=!1}}};var Ri=function(){var e=this,t=e._self._c;return t("div",{staticClass:"m_captureview"},[t("CapturePane",{directives:[{name:"show",rawName:"v-show",value:e.show_capture_settings,expression:"show_capture_settings"}],attrs:{label:e.$t("settings"),pane_type:"settings"},on:{close:function(i){e.show_capture_settings=!1}}},[t("CaptureSettings",{attrs:{audio_output_deviceId:e.audio_output_deviceId},on:{"update:audio_output_deviceId":function(i){e.audio_output_deviceId=i},"update:audio_output_device-id":function(i){e.audio_output_deviceId=i},setStream:e.setStream,hasFinishedLoading:e.hasFinishedLoading,show:function(i){e.show_capture_settings=!0}}})],1),t("CapturePane",{directives:[{name:"show",rawName:"v-show",value:e.show_effects_pane,expression:"show_effects_pane"}],attrs:{label:e.$t("effects"),pane_type:"effects"},on:{close:function(i){e.show_effects_pane=!1}}},[t("CaptureEffects",{attrs:{enable_effects:e.enable_effects,videoElement:e.$refs.videoElement,canvasElement:e.$refs.canvasElement,project_path:e.path},on:{"update:enable_effects":function(i){e.enable_effects=i}}})],1),t("div",{staticClass:"m_captureview--videoPane"},[t("transition",{attrs:{name:"slidedown",duration:500}},[e.show_mode_selector?t("ModeSelector",{attrs:{available_modes:e.available_modes,selected_mode:e.selected_mode,disable_change_mode:e.is_recording||e.media_to_validate||e.mode_just_changed||e.is_making_stopmotion},on:{changeMode:function(i){return e.$emit("changeMode",i)}}}):e._e()],1),t("div",{directives:[{name:"show",rawName:"v-show",value:!e.is_validating_stopmotion_video,expression:"!is_validating_stopmotion_video"}],staticClass:"m_captureview--videoPane--top"},[t("div",{staticClass:"m_captureview--videoPane--top--videoContainer"},[t("div",{staticClass:"_videoEl",style:`opacity: ${e.show_videos?1:0}`},[e.showVideoElement?t("video",{ref:"videoElement",style:`opacity: ${e.enable_effects?"0":"1"}`,attrs:{autoplay:"",playsinline:"",controls:!1,muted:""},domProps:{srcObject:e.stream,muted:!0}}):e._e(),t("canvas",{directives:[{name:"show",rawName:"v-show",value:e.enable_effects,expression:"enable_effects"}],ref:"canvasElement",attrs:{width:e.actual_camera_resolution.width,height:e.actual_camera_resolution.height},on:{click:i=>e.updateSelectedColor({e:i,type:"click"})}})]),e.selected_mode==="vecto"&&!e.media_to_validate?t("VectoMode",{ref:"vectoElement",attrs:{last_frame_from_video:e.last_frame_from_video,number_of_colors:e.vecto_number_of_colors}}):e._e(),e.selected_mode==="lines"&&!e.media_to_validate?t("LinesMode",{ref:"vectoElement",attrs:{last_frame_from_video:e.last_frame_from_video,angle:e.lines_angle,boost_brightness:e.lines_brightness,boost_contrast:e.lines_contrast,density:e.lines_density}}):e._e(),e.selected_mode==="audio"&&!e.media_to_validate?t("AudioEqualizer",{ref:"equalizerElement",attrs:{stream:e.stream,is_recording:e.is_recording}}):e._e(),t("transition-group",{staticClass:"_capture_options",attrs:{tag:"div",name:"slideFromTop",mode:"out-in"}},[e.selected_mode!=="stopmotion"&&e.is_recording&&e.timer_recording_in_seconds!==!1?t("div",{key:"duration",staticClass:"_duration_timer",domProps:{innerHTML:e._s(e.timer_recording_in_seconds)}}):e._e(),e.selected_mode==="stopmotion"&&e.timelapse_mode_enabled&&!e.timelapse_event?t("div",{key:"timelapse_interval",staticClass:"record_options"},[t("div",[t("span",[e._v(e._s(e.$t("interval_between_pictures")))]),t("input",{directives:[{name:"model",rawName:"v-model.number",value:e.timelapse_interval,expression:"timelapse_interval",modifiers:{number:!0}}],attrs:{type:"number",min:"1"},domProps:{value:e.timelapse_interval},on:{input:function(i){i.target.composing||(e.timelapse_interval=e._n(i.target.value))},blur:function(i){return e.$forceUpdate()}}}),t("span",[e._v(e._s(e.$t("seconds")))])])]):e._e(),e.delay_mode_enabled&&!e.is_recording&&!e.media_to_validate&&!e.delay_event?t("div",{key:"delay_interval",staticClass:"record_options"},[t("div",[t("span",[e._v(e._s(e.$t("delay")))]),t("input",{directives:[{name:"model",rawName:"v-model.number",value:e.delay_seconds,expression:"delay_seconds",modifiers:{number:!0}}],attrs:{type:"number",min:"1",max:"60"},domProps:{value:e.delay_seconds},on:{input:function(i){i.target.composing||(e.delay_seconds=e._n(i.target.value))},blur:function(i){return e.$forceUpdate()}}}),t("span",[e._v(e._s(e.$t("seconds")))])])]):e._e()]),t("transition",{attrs:{name:"scaleInFade",mode:"out-in"}},[e.delay_remaining_time?t("label",{key:"delay_before_"+e.delay_remaining_time,staticClass:"_delay_timer",class:{"is--small":e.capture_pane_is_small},domProps:{innerHTML:e._s(e.delay_remaining_time)}}):e.timelapse_time_before_next_picture?t("label",{key:"timelapse_before_"+e.timelapse_time_before_next_picture,staticClass:"_delay_timer is--small is--timelapse",domProps:{innerHTML:e._s(e.timelapse_time_before_next_picture)}}):e._e()]),t("transition",{attrs:{name:"onionSkin",mode:"in-out"}},[e.selected_mode==="stopmotion"&&e.onion_skin_img&&e.stopmotion_slug&&!e.is_validating_stopmotion_video&&!(e.show_live_feed&&e.onion_skin_opacity===0)?t("MediaContent",{key:e.show_live_feed?!1:e.onion_skin_img.$path,staticClass:"_onion_skin",class:{"is--onionskin":e.show_live_feed},style:e.show_live_feed?`--onionskin-opacity: ${e.onion_skin_opacity}`:"",attrs:{file:e.onion_skin_img,resolution:1600}}):e._e()],1),e.current_grid_type&&e.enable_video&&!e.media_to_validate?t("div",{staticClass:"_video_grid_overlay"},[t("svg",{attrs:{width:e.actual_camera_resolution.width,height:e.actual_camera_resolution.height,viewBox:`0 0 ${e.actual_camera_resolution.width} ${e.actual_camera_resolution.height}`}},e._l(e.grids[e.current_grid_type],function([i,r,s,n],d){return t("line",{key:d,attrs:{x1:i+"%",y1:r+"%",x2:s+"%",y2:n+"%","vector-effect":"non-scaling-stroke"}})}),0)]):e._e(),t("transition",{attrs:{name:"fade_fast"}},[e.is_recording?e._e():t("div",{staticClass:"_settingsTag"},[!(e.must_validate_media&&e.media_to_validate)&&e.selected_mode!=="audio"?[e.enable_video?t("button",{staticClass:"u-button u-button_small",attrs:{type:"button"},on:{click:function(i){e.show_capture_settings=!e.show_capture_settings}}},[e._v(" "+e._s(e.actual_camera_resolution.width)+" √ó "+e._s(e.actual_camera_resolution.height)+" ")]):e._e(),e.enable_video&&e.selected_mode!=="audio"?t("select",{directives:[{name:"model",rawName:"v-model",value:e.current_grid_type,expression:"current_grid_type"}],class:{"is--active":e.current_grid_type!==!1},attrs:{size:"small"},on:{change:function(i){var r=Array.prototype.filter.call(i.target.options,function(s){return s.selected}).map(function(s){var n="_value"in s?s._value:s.value;return n});e.current_grid_type=i.target.multiple?r:r[0]}}},[t("option",{domProps:{value:!1}},[e._v(" --"+e._s(e.$t("grid").toLowerCase())+"-- ")]),e._l(Object.keys(e.grids),function(i){return t("option",{key:i,domProps:{value:i}},[e._v(" "+e._s(e.$t(i).toLowerCase())+" ")])})],2):e._e()]:e._e(),t("button",{staticClass:"u-button u-button_small",class:{"is--active":e.has_location_to_add_to_medias},attrs:{type:"button"},on:{click:function(i){e.show_position_modal=!0}}},[t("b-icon",{attrs:{icon:e.has_location_to_add_to_medias?"pin-map-fill":"pin-map"}})],1),e.show_position_modal?t("PickLocationForCaptures",{attrs:{location_to_add_to_medias:e.location_to_add_to_medias},on:{"update:location_to_add_to_medias":function(i){e.location_to_add_to_medias=i},close:function(i){e.show_position_modal=!1}}}):e._e()],2)]),t("transition",{attrs:{name:"enableMode",duration:800}},[e.mode_just_changed&&!e.is_loading_stream?t("div",{staticClass:"_mode_indicator",domProps:{innerHTML:e._s(e.$t(e.selected_mode))}}):e._e()]),t("transition",{attrs:{name:"justCaptured"}},[e.media_to_validate&&e.must_validate_media?t("MediaPreviewBeforeValidation",{attrs:{media_to_validate:e.media_to_validate,audio_output_deviceId:e.audio_output_deviceId}}):e._e()],1),t("transition",{attrs:{name:"fade_fast"}},[e.is_loading_stream?t("LoaderSpinner",{staticClass:"_loader"}):e._e()],1)],1)]),e.stopmotion_slug?t("StopmotionPanel",{attrs:{current_stopmotion_path:`${e.path}/stopmotions/${e.stopmotion_slug}`,stream:e.stream,show_live_feed:e.show_live_feed,is_validating_stopmotion_video:e.is_validating_stopmotion_video,onion_skin_opacity:e.onion_skin_opacity,stopmotion_frame_rate:e.stopmotion_frame_rate},on:{"update:show_live_feed":function(i){e.show_live_feed=i},"update:is_validating_stopmotion_video":function(i){e.is_validating_stopmotion_video=i},"update:onion_skin_opacity":function(i){e.onion_skin_opacity=i},"update:stopmotion_frame_rate":function(i){e.stopmotion_frame_rate=i},insertMedia:i=>e.$emit("insertMedia",i),close:e.closeStopmotionPanel,showPreviousImage:function(i){e.onion_skin_img=i}}}):e._e(),t("transition",{attrs:{name:"slideup",duration:150,mode:"out-in"}},[t("div",{staticClass:"m_captureview--videoPane--bottom"},[t("transition",{attrs:{name:"fade_fast",duration:150}},[e.is_sending_image?t("LoaderSpinner"):e._e()],1),t("transition",{attrs:{name:"slideup",duration:150,mode:"out-in"}},[!(e.media_to_validate.temp_name&&e.must_validate_media)&&!e.is_validating_stopmotion_video?t("div",{staticClass:"m_captureview--videoPane--bottom--buttons",class:{"is--recording":e.is_recording&&!e.video_recording_is_paused,"is--sending_image":e.is_sending_image}},[t("div",[!e.is_recording&&!e.is_making_stopmotion&&!e.is_recording&&!e.delay_event?[t("button",{staticClass:"u-button u-button_red _settingsBtn",class:{"is--active":e.show_capture_settings},attrs:{type:"button",content:e.$t("settings")},on:{click:function(i){e.show_capture_settings=!e.show_capture_settings}}},[t("svg",{staticClass:"inline-svg inline-svg_larger",attrs:{version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",x:"0px",y:"0px",viewBox:"15 15 140 140","xml:space":"preserve"}},[t("path",{staticStyle:{fill:"currentColor"},attrs:{d:`M122.7,88.8v-10c0-1.1,0.6-2.1,1.6-2.6l9.6-4.9l-2-5.8l-11,1.6c-1.1,0.2-2.2-0.3-2.9-1.2l-6-8.1
                  c-0.7-0.9-0.8-2.1-0.3-3l4.8-9.6l-5.2-3.6l-7.7,7.5c-0.8,0.8-2,1-3.1,0.7l-9.9-3c-1.1-0.3-1.9-1.3-2.1-2.4L86.8,34h-6.4l-1.7,10.4
                  c-0.2,1.1-0.9,2-2,2.4L66.8,50c-1.1,0.3-2.2,0.1-3.1-0.7L55.9,42l-5.1,3.7l4.9,9.4c0.5,1,0.4,2.1-0.2,3l-6,8.2
                  c-0.6,0.9-1.8,1.4-2.9,1.2L35.8,66L34,71.8l9.7,4.8c1,0.5,1.7,1.5,1.7,2.6v10c0,1.1-0.6,2.1-1.6,2.6l-9.6,4.9l2,5.9l10.9-1.6
                  c1.1-0.2,2.2,0.3,2.9,1.2l6,8.1c0.7,0.9,0.8,2.1,0.3,3l-4.8,9.6l5.1,3.6l7.7-7.5c0.8-0.8,2-1,3.1-0.7l9.9,3
                  c1.1,0.3,1.9,1.3,2.1,2.4l1.9,10.4h6.4l1.7-10.4c0.2-1.1,0.9-2,2-2.4l9.9-3.2c1.1-0.3,2.2-0.1,3.1,0.7l7.8,7.3l5.1-3.7l-4.9-9.4
                  c-0.5-1-0.4-2.1,0.2-3l6-8.1c0.7-0.9,1.8-1.4,2.9-1.2l10.8,1.5l1.8-5.9l-9.7-4.8C123.3,90.9,122.7,89.9,122.7,88.8z M84,104.5
                  c-11.7,0-21.1-9.2-21.1-20.5c0-11.3,9.5-20.5,21.1-20.5s21.1,9.2,21.1,20.5C105.1,95.3,95.7,104.5,84,104.5z`}})])]),e.selected_mode!=="audio"?t("button",{staticClass:"u-button u-button_bleumarine _settingsBtn",class:{"is--active":e.show_effects_pane},attrs:{type:"button",content:e.$t("effects")},on:{click:function(i){e.show_effects_pane=!e.show_effects_pane}}},[t("svg",{staticClass:"inline-svg inline-svg_larger",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 168 168"}},[t("path",{staticStyle:{fill:"#fc4b60",stroke:"#fc4b60","stroke-miterlimit":"10","stroke-width":"2.8346456692913384px"},attrs:{d:"M110.3488,72.0093,114.6377,59.36a4.4236,4.4236,0,0,0-1.07-4.59,4.4946,4.4946,0,0,0-4.59-1.0745L96.3334,57.9846,85.62,50a4.5219,4.5219,0,0,0-4.6965-.4029,4.4316,4.4316,0,0,0-2.4409,4.0388l.1714,13.3577L67.7468,74.7049A4.4686,4.4686,0,0,0,68.9974,82.62L79.2565,85.807,38.1043,126.9546a2.3155,2.3155,0,1,0,3.2745,3.2746L82.5311,89.0769l3.1865,10.2638a4.4571,4.4571,0,0,0,3.5664,3.08c.12.0185.579.0556.704.0556a4.4844,4.4844,0,0,0,3.6451-1.88L101.35,89.6883l13.6078.1621a4.6074,4.6074,0,0,0,3.784-2.4316,4.4328,4.4328,0,0,0-.3983-4.6965ZM100.1869,85.0381a2.5322,2.5322,0,0,0-1.9221.9773L90.039,97.6409,85.8149,84.0423a2.3238,2.3238,0,0,0-1.5192-1.5238l-13.8764-4.03,11.8987-8.42a2.3208,2.3208,0,0,0,.9773-1.9221L82.846,53.71l11.6764,8.7168a2.3569,2.3569,0,0,0,2.1259.3381l13.5986-4.8911L105.56,71.6758a2.3135,2.3135,0,0,0,.3428,2.1259l8.8464,11.417Z"}}),t("path",{staticStyle:{fill:"#fc4b60",stroke:"#fc4b60","stroke-miterlimit":"10","stroke-width":"2.8346456692913384px"},attrs:{d:"M58.9467,42.2277h2.3158v2.3158a2.3159,2.3159,0,1,0,4.6317,0V42.2277H68.21a2.3159,2.3159,0,0,0,0-4.6317H65.8942V35.28a2.3159,2.3159,0,0,0-4.6317,0V37.596H58.9467a2.3159,2.3159,0,0,0,0,4.6317Z"}}),t("path",{staticStyle:{fill:"#fc4b60",stroke:"#fc4b60","stroke-miterlimit":"10","stroke-width":"2.8346456692913384px"},attrs:{d:"M49.6834,65.386h2.3158v2.3158a2.3159,2.3159,0,0,0,4.6317,0V65.386h2.3158a2.3159,2.3159,0,0,0,0-4.6317H56.6309V58.4385a2.3159,2.3159,0,0,0-4.6317,0v2.3158H49.6834a2.3159,2.3159,0,0,0,0,4.6317Z"}}),t("path",{staticStyle:{fill:"#fc4b60",stroke:"#fc4b60","stroke-miterlimit":"10","stroke-width":"2.8346456692913384px"},attrs:{d:"M133.0531,102.4392h-2.3158v-2.3158a2.3159,2.3159,0,0,0-4.6317,0v2.3158H123.79a2.3159,2.3159,0,0,0,0,4.6317h2.3158v2.3158a2.3159,2.3159,0,1,0,4.6317,0v-2.3158h2.3158a2.3159,2.3159,0,0,0,0-4.6317Z"}}),t("path",{staticStyle:{fill:"#fc4b60",stroke:"#fc4b60","stroke-miterlimit":"10","stroke-width":"2.8346456692913384px"},attrs:{d:"M109.8949,111.7026H107.579v-2.3159a2.3158,2.3158,0,1,0-4.6316,0v2.3159h-2.3158a2.3158,2.3158,0,1,0,0,4.6316h2.3158V118.65a2.3158,2.3158,0,1,0,4.6316,0v-2.3158h2.3159a2.3158,2.3158,0,0,0,0-4.6316Z"}}),t("path",{staticStyle:{fill:"#fc4b60",stroke:"#fc4b60","stroke-miterlimit":"10","stroke-width":"2.8346456692913384px"},attrs:{d:"M119.1582,46.8594h2.3158v2.3158a2.3158,2.3158,0,1,0,4.6316,0V46.8594h2.3159a2.3159,2.3159,0,0,0,0-4.6317h-2.3159V39.9119a2.3158,2.3158,0,1,0-4.6316,0v2.3158h-2.3158a2.3159,2.3159,0,1,0,0,4.6317Z"}})])]):e._e()]:e._e(),e.selected_mode==="video"&&e.is_recording?t("button",{key:e.selected_mode+"_pause",staticClass:"u-button u-button_orange u-button_inline _captureButton",attrs:{type:"button"},on:{mousedown:function(i){return i.stopPropagation(),i.preventDefault(),e.pauseOrResumeCapture()},touchstart:function(i){return i.stopPropagation(),i.preventDefault(),e.pauseOrResumeCapture()}}},[e.video_recording_is_paused?[t("svg",{staticClass:"inline-svg inline-svg_larger",staticStyle:{"enable-background":"new 0 0 168 168"},attrs:{version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",x:"0px",y:"0px",viewBox:"0 0 168 168","xml:space":"preserve"}},[t("path",{staticStyle:{fill:"#ffbe32"},attrs:{id:"FOND_3_",d:`M84,0C37.6,0,0,37.6,0,84c0,46.4,37.6,84,84,84c46.4,0,84-37.6,84-84
			C168,37.6,130.4,0,84,0z`}}),t("polygon",{staticStyle:{fill:"#ff3e51"},attrs:{points:"45 40, 130 84.7, 45 128"}})]),e._v(" ¬† "),t("span",[e._v(" "+e._s(e.$t("unpause_recording"))+" ")])]:[t("svg",{staticClass:"inline-svg inline-svg_larger",staticStyle:{"enable-background":"new 0 0 168 168"},attrs:{version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",x:"0px",y:"0px",viewBox:"0 0 168 168","xml:space":"preserve"}},[t("path",{staticStyle:{fill:"#ffbe32"},attrs:{id:"FOND_3_",d:`M84,0C37.6,0,0,37.6,0,84c0,46.4,37.6,84,84,84c46.4,0,84-37.6,84-84
			C168,37.6,130.4,0,84,0z`}}),t("rect",{staticStyle:{fill:"#ff3e51"},attrs:{id:"CENTRE_3_",x:"35",y:"46.7",width:"38",height:"76"}}),t("rect",{staticStyle:{fill:"#ff3e51"},attrs:{id:"CENTRE_3_",x:"93",y:"46.7",width:"38",height:"76"}})]),e._v(" ¬† "),t("span",[e._v(" "+e._s(e.$t("pause_recording"))+" ")])]],2):e._e(),e.selected_mode==="stopmotion"&&e.is_making_stopmotion&&!e.timelapse_event?t("button",{key:e.selected_mode+"_pause",staticClass:"u-button u-button_transparent u-button_inline _captureButton",attrs:{type:"button"},on:{mousedown:function(i){return i.stopPropagation(),i.preventDefault(),e.stopStopmotion()},touchstart:function(i){return i.stopPropagation(),i.preventDefault(),e.stopStopmotion()}}},[t("span",{},[e._v("‚Äπ "+e._s(e.$t("back")))])]):e._e()],2),t("div",[t("transition",{attrs:{name:"fade_fast",mode:"out-in"}},[e.is_recording?e.is_recording?t("button",{key:e.selected_mode+e.is_recording,staticClass:"u-button u-button_orange u-button_inline _captureButton",attrs:{type:"button",disabled:e.is_sending_image},on:{mousedown:function(i){return i.stopPropagation(),i.preventDefault(),e.stopRecording()},touchstart:function(i){return i.stopPropagation(),i.preventDefault(),e.stopRecording()}}},[(e.is_sending_image,[t("img",{staticClass:"inline-svg inline-svg_larger",attrs:{src:`${e.$root.publicPath}images/i_stop.svg`}}),e._v(" ¬† "),["video","audio"].includes(e.selected_mode)?t("span",[e._v(" "+e._s(e.$t("stop_recording"))+" ")]):e.selected_mode==="stopmotion"?t("span",[e.timelapse_mode_enabled?[e._v(" "+e._s(e.$t("stop_timelapse"))+" ")]:e._e()],2):t("span",[e._v(" "+e._s(e.$t("stop"))+" ")])])],2):e._e():t("button",{key:e.selected_mode+e.is_recording,staticClass:"u-button u-button_orange _captureButton",class:{"is--active":e.capture_button_pressed},attrs:{type:"button",disabled:e.is_sending_image},on:{mousedown:function(i){return i.stopPropagation(),i.preventDefault(),e.setCaptureInit()},touchstart:function(i){return i.stopPropagation(),i.preventDefault(),e.setCaptureInit()}}},[e.delay_event?t("span",[e._v(" "+e._s(e.$t("cancel"))+" ")]):[t("img",{staticClass:"inline-svg inline-svg_larger",attrs:{src:e.$root.publicPath+"images/i_record.svg"}}),e._v(" ¬† "),["photo","vecto","lines"].includes(e.selected_mode)?t("span",{domProps:{innerHTML:e._s(e.$t("take_picture"))}}):e.selected_mode==="video"?t("span",{domProps:{innerHTML:e._s(e.$t("record_video"))}}):e.selected_mode==="audio"?t("span",{domProps:{innerHTML:e._s(e.$t("record_audio"))}}):e.selected_mode==="stopmotion"?t("span",{domProps:{innerHTML:e._s(e.timelapse_mode_enabled?e.$t("start_timelapse"):e.$t("take_picture"))}}):e._e()]],2)]),t("transition",{attrs:{name:"fade_fast",mode:"out-in"}},[e.selected_mode==="stopmotion"&&!e.timelapse_event&&!e.delay_event?t("button",{staticClass:"_enable_timelapse_button",class:{"is--active":e.timelapse_mode_enabled},attrs:{type:"button",content:e.$t("timelapse")},on:{click:function(i){e.timelapse_mode_enabled=!e.timelapse_mode_enabled}}},[t("svg",{staticClass:"inline-svg margin-right-verysmall",staticStyle:{"enable-background":"new 0 0 81 81"},attrs:{version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",x:"0px",y:"0px",width:"81px",height:"81px",viewBox:"0 0 81 81","xml:space":"preserve"}},[t("path",{attrs:{d:`M69.6,20.8c-0.9,0.6-1.7,1.1-2.6,1.7c-6-8.8-15.9-14-26.5-14c-17.6,0-32,14.4-32,32s14.4,32,32,32
                  c3.1,0,6.2-0.4,9.1-1.3l-1.7-5.8c-2.4,0.7-4.9,1.1-7.4,1.1c-14.3,0-26-11.7-26-26s11.7-26,26-26c8.6,0,16.6,4.2,21.5,11.4
                  c-0.8,0.5-1.6,1.1-2.4,1.6c-0.7,0.4-0.9,1.1-0.8,1.7c0,0.7,0.4,1.4,1.2,1.6c0.2,0.1,0.3,0.1,0.5,0.1c2.7,0.5,5.3,1.1,8,1.6
                  c1,0.2,2-0.4,2.3-1.4c0.6-2.8,1.1-5.5,1.7-8.3C72.8,21.3,71,19.9,69.6,20.8z`}}),t("path",{attrs:{d:`M23,49.4c-1.3,0-2.4-0.8-2.9-2.1c-0.5-1.6,0.4-3.3,1.9-3.8L39,38.3V27.2c0-1.7,1.3-3,3-3s3,1.3,3,3v13.3
                  c0,1.3-0.8,2.5-2.1,2.9l-19,5.9C23.6,49.4,23.3,49.4,23,49.4z`}})])]):e._e()]),t("transition",{attrs:{name:"fade_fast",mode:"out-in"}},[!e.is_recording&&!e.delay_event?t("button",{staticClass:"_enable_timelapse_button",class:{"is--active":e.delay_mode_enabled},attrs:{type:"button",content:e.$t("delay")},on:{click:function(i){e.delay_mode_enabled=!e.delay_mode_enabled}}},[t("svg",{staticClass:"inline-svg margin-right-verysmall",staticStyle:{"enable-background":"new 0 0 81 81"},attrs:{version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",x:"0px",y:"0px",width:"81px",height:"81px",viewBox:"0 0 81 81","xml:space":"preserve"}},[t("path",{attrs:{d:`M40.5,72.3c-15,0-27.1-12.2-27.1-27.1c0-15,12.2-27.1,27.1-27.1s27.1,12.2,27.1,27.1C67.6,60.2,55.5,72.3,40.5,72.3z
	 M40.5,23.7C28.7,23.7,19,33.4,19,45.2s9.6,21.5,21.5,21.5S62,57,62,45.2S52.3,23.7,40.5,23.7z`}}),t("path",{attrs:{d:"M40.5,48c-1.6,0-2.8-1.3-2.8-2.8l0-16.8c0-1.6,1.3-2.8,2.8-2.8s2.8,1.3,2.8,2.8l0,16.8C43.3,46.8,42.1,48,40.5,48z"}}),t("rect",{attrs:{x:"32.1",y:"10.7",width:"16.8",height:"5.7"}}),t("rect",{attrs:{x:"57.9",y:"22.4",transform:"matrix(0.7069 -0.7073 0.7073 0.7069 2.864400e-02 50.6141)",width:"6.3",height:"5.7"}})])]):e._e()])],1),t("div",[e.selected_mode==="video"?t("div",{staticClass:"_videoEq"},[e.enable_audio_recording_in_video?t("div",{staticClass:"_tiny_equalizer"},[t("AudioEqualizer",{attrs:{stream:e.stream,is_recording:e.is_recording,type:"Tiny"}})],1):e._e(),e.is_recording?e._e():t("span",{staticClass:"u-switch u-switch-xs"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.enable_audio_recording_in_video,expression:"enable_audio_recording_in_video"}],staticClass:"switch",attrs:{id:"recordVideoWithAudio",type:"checkbox",disabled:e.is_recording},domProps:{checked:Array.isArray(e.enable_audio_recording_in_video)?e._i(e.enable_audio_recording_in_video,null)>-1:e.enable_audio_recording_in_video},on:{change:function(i){var r=e.enable_audio_recording_in_video,s=i.target,n=!!s.checked;if(Array.isArray(r)){var d=null,c=e._i(r,d);s.checked?c<0&&(e.enable_audio_recording_in_video=r.concat([d])):c>-1&&(e.enable_audio_recording_in_video=r.slice(0,c).concat(r.slice(c+1)))}else e.enable_audio_recording_in_video=n}}}),t("label",{staticClass:"u-label",attrs:{for:"recordVideoWithAudio"}},[e._v(e._s(e.$t("with_sound")))])])]):e._e(),e.selected_mode==="stopmotion"?[e.is_making_stopmotion?t("div",{staticClass:"_stopmotionValidation"},[t("div",{staticClass:"_stopmotionValidation--fpscounter"},[t("label",{staticClass:"u-label"},[e._v(e._s(e.$t("img_per_second")))]),t("select",{directives:[{name:"model",rawName:"v-model.number",value:e.stopmotion_frame_rate,expression:"stopmotion_frame_rate",modifiers:{number:!0}}],attrs:{size:"small"},on:{change:function(i){var r=Array.prototype.filter.call(i.target.options,function(s){return s.selected}).map(function(s){var n="_value"in s?s._value:s.value;return e._n(n)});e.stopmotion_frame_rate=i.target.multiple?r:r[0]}}},[t("option",[e._v("2")]),t("option",[e._v("4")]),t("option",[e._v("8")]),t("option",[e._v("15")]),t("option",[e._v("24")]),t("option",[e._v("30")])])]),t("div",{},[t("button",{staticClass:"u-button u-button_bleuvert u-button_small",attrs:{type:"button"},on:{click:e.testStopmotion}},[t("img",{attrs:{src:`${e.$root.publicPath}images/i_play.svg`,width:"48",height:"48",draggable:"false"}}),e._v(" "+e._s(e.$t("assemble"))+" ")])])]):t("button",{staticClass:"u-button u-button_bleumarine",attrs:{type:"button"},on:{click:function(i){e.show_stopmotion_list=!e.show_stopmotion_list}}},[t("span",{},[e._v(e._s(e.$t("stopmotion_list")))])])]:e._e(),e.selected_mode==="vecto"?t("div",{staticClass:"_mode_accessory_range"},[t("label",{staticClass:"u-label"},[e._v(e._s(e.$t("number_of_colors"))+" = "+e._s(e.vecto_number_of_colors))]),t("input",{directives:[{name:"model",rawName:"v-model.number",value:e.vecto_number_of_colors,expression:"vecto_number_of_colors",modifiers:{number:!0}}],attrs:{type:"range",min:"2",max:"7",step:"1"},domProps:{value:e.vecto_number_of_colors},on:{__r:function(i){e.vecto_number_of_colors=e._n(i.target.value)},blur:function(i){return e.$forceUpdate()}}})]):e._e(),e.selected_mode==="lines"?t("button",{staticClass:"u-buttonLink",class:{"is--active":e.show_lines_settings},attrs:{type:"button"},on:{click:function(i){e.show_lines_settings=!e.show_lines_settings}}},[e._v(" "+e._s(e.$t("advanced_options"))+" ")]):e._e(),e.show_lines_settings?[e.selected_mode==="lines"?t("div",{staticClass:"_mode_accessory_range"},[t("label",{staticClass:"u-label"},[e._v(e._s(e.$t("lines_angle"))+" = "+e._s(e.lines_angle))]),t("input",{directives:[{name:"model",rawName:"v-model.number",value:e.lines_angle,expression:"lines_angle",modifiers:{number:!0}}],attrs:{type:"range",min:"0",max:"359",step:"1"},domProps:{value:e.lines_angle},on:{__r:function(i){e.lines_angle=e._n(i.target.value)},blur:function(i){return e.$forceUpdate()}}})]):e._e(),e.selected_mode==="lines"?t("div",{staticClass:"_mode_accessory_range"},[t("label",{staticClass:"u-label"},[e._v(e._s(e.$t("brightness"))+" = "+e._s(e.lines_brightness))]),t("input",{directives:[{name:"model",rawName:"v-model.number",value:e.lines_brightness,expression:"lines_brightness",modifiers:{number:!0}}],staticClass:"margin-none",attrs:{type:"range",min:".1",max:"5",step:".1"},domProps:{value:e.lines_brightness},on:{__r:function(i){e.lines_brightness=e._n(i.target.value)},blur:function(i){return e.$forceUpdate()}}})]):e._e(),e.selected_mode==="lines"?t("div",{staticClass:"_mode_accessory_range"},[t("label",{staticClass:"u-label"},[e._v(e._s(e.$t("contrast"))+" = "+e._s(e.lines_contrast))]),t("input",{directives:[{name:"model",rawName:"v-model.number",value:e.lines_contrast,expression:"lines_contrast",modifiers:{number:!0}}],staticClass:"margin-none",attrs:{type:"range",min:".1",max:"5",step:".1"},domProps:{value:e.lines_contrast},on:{__r:function(i){e.lines_contrast=e._n(i.target.value)},blur:function(i){return e.$forceUpdate()}}})]):e._e(),e.selected_mode==="lines"?t("div",{staticClass:"_mode_accessory_range"},[t("label",{staticClass:"u-label"},[e._v(e._s(e.$t("lines_density"))+" = "+e._s(e.lines_density))]),t("input",{directives:[{name:"model",rawName:"v-model.number",value:e.lines_density,expression:"lines_density",modifiers:{number:!0}}],staticClass:"margin-none",attrs:{type:"range",min:"0.2",max:"0.3",step:".01"},domProps:{value:e.lines_density},on:{__r:function(i){e.lines_density=e._n(i.target.value)},blur:function(i){return e.$forceUpdate()}}})]):e._e()]:e._e()],2)]):e.media_to_validate&&e.must_validate_media?t("div",{key:"validation"},[t("MediaValidationButtons",{attrs:{media_is_being_sent:e.media_is_being_sent,media_being_sent_percent:e.media_being_sent_percent,can_add_to_fav:!0},on:{cancel:function(i){return e.cancelValidation()},save:function(i){return e.sendMedia()},save_and_fav:function(i){return e.sendMedia({fav:!0})}}}),t("div",{staticClass:"_download_media_without_validation"},[t("small",[t("a",{ref:"",attrs:{href:e.validated_media_href_blob,download:e.media_to_validate.temp_name,target:"_blank"}},[e._v(" "+e._s(e.$t("or_download_media_on_device"))+" "),e.media_to_validate.rawData?[e._v(" ‚Äî "+e._s(e.formatBytes(e.media_to_validate.rawData.size))+" ")]:e._e()],2)])])],1):e._e()])],1)])],1),e.show_stopmotion_list&&!e.is_making_stopmotion?t("StopmotionList",{attrs:{project_path:e.path},on:{loadStopmotion:e.loadStopmotion}}):e._e()],1)},Ti=[],Mi=ee($i,Ri,Ti,!1,null,"f58c3e36");const Li=Mi.exports;export{Li as default};
