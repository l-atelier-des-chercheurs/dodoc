import{n,P as c,B as l,_ as r,D as d}from"../build.js";import{S as p,P as u}from"./ProjectsListWithFilter-Dyfmr6ZG.js";import m from"./AdminSettings-VRj_bDg9.js";import{P as h}from"./PublicationPreview-BdLCBdzZ.js";import"./ProjectPresentation-DEbCga9m.js";const f={props:{},components:{PinnedNonpinnedFolder:c,SpacePresentation:p,BinFolder:l},data(){return{settings:void 0,spaces:void 0,path:"spaces",fetch_spaces_error:void 0,show_create_modal:!1,is_loading:!0,order_key:"$date_created",order_options:[{key:"$date_created",text:this.$t("date_created")},{key:"$date_modified",text:this.$t("date_modified")},{key:"alphabetical",text:this.$t("alphabetical")}],search_space:"",show_bin_modal:!1}},created(){},async mounted(){this.settings=await this.$api.getFolder({path:""}).catch(s=>s),this.$api.join({room:"."}),this.spaces=await this.$api.getFolders({path:this.path}).catch(s=>{this.fetch_spaces_error=s.response}),this.$api.join({room:this.path}),this.is_loading=!1},beforeDestroy(){this.$api.leave({room:"."}),this.$api.leave({room:this.path})},watch:{},computed:{sorted_spaces(){return this.spaces?this.spaces.slice().filter(s=>this.canLoggedinSeeFolder({folder:s})).sort((s,t)=>{if(this.order_key==="$date_created")return+new Date(t.$date_created)-+new Date(s.$date_created);if(this.order_key==="$date_modified")return+new Date(t.$date_modified)-+new Date(s.$date_modified);if(this.order_key==="alphabetical")return s.title.localeCompare(t.title)}):[]},filtered_spaces(){return this.sorted_spaces.filter(s=>!(this.search_space&&!this.searchInSpace(s)))}},methods:{getSlug(s){return s.split("/").at(-1)},openNewSpace(s){this.show_create_modal=!1;const t=this.createURLFromPath(this.path+"/"+s);this.$router.push(t)},searchInSpace(s){return!!(s.title&&this.twoStringsSearch(s.title,this.search_space)||s.subtitle&&this.twoStringsSearch(s.subtitle,this.search_space))}}};var v=function(){var t=this,e=t._self._c;return e("div",{staticClass:"_spacesList"},[e("div",{staticClass:"_filterSortBar"},[e("div",{staticClass:"_filterSortBar--leftSide"},[t.is_instance_admin||t.is_instance_contributor?e("button",{staticClass:"u-button u-button_red u-button_small",attrs:{type:"button"},on:{click:function(a){t.show_create_modal=!0}}},[e("b-icon",{attrs:{icon:"plus",label:t.$t("create")}}),t._v(" "+t._s(t.$t("create"))+" ")],1):t._e(),t.sorted_spaces.length>0?e("div",{staticClass:"_searchField"},[e("SearchInput",{attrs:{search_placeholder:t.$t("search_by_title_or_subtitle"),name:"search_space"},model:{value:t.search_space,callback:function(a){t.search_space=a},expression:"search_space"}})],1):t._e()]),e("div",{},[e("select",{directives:[{name:"model",rawName:"v-model",value:t.order_key,expression:"order_key"}],staticClass:"_orderSelect",attrs:{size:"small","aria-label":"$t('sort')",name:"order_spaces",disabled:t.filtered_spaces.length<=1},on:{change:function(a){var o=Array.prototype.filter.call(a.target.options,function(i){return i.selected}).map(function(i){var _="_value"in i?i._value:i.value;return _});t.order_key=a.target.multiple?o:o[0]}}},t._l(t.order_options,function(a){return e("option",{key:a.key,domProps:{value:a.key,textContent:t._s(a.text)}})}),0)])]),t.show_create_modal?e("CreateFolder",{attrs:{modal_name:t.$t("create_a_space"),path:"spaces"},on:{close:function(a){t.show_create_modal=!1},openNew:t.openNewSpace}}):t._e(),t.is_loading?t._e():e("PinnedNonpinnedFolder",{attrs:{field_name:"spaces_pinned",label:t.$t("spaces_pinned"),content:t.settings.spaces_pinned,path:"",folders:t.filtered_spaces,can_edit:t.is_instance_admin},scopedSlots:t._u([{key:"default",fn:function(a){return[e("SpacePresentation",{attrs:{space:a.item,context:"list",can_edit:!1}})]}}],null,!1,3865280801)}),t.is_instance_admin?e("button",{staticClass:"u-buttonLink",attrs:{type:"button"},on:{click:function(a){t.show_bin_modal=!0}}},[e("b-icon",{attrs:{icon:"recycle"}}),t._v(" "+t._s(t.$t("bin"))+" ")],1):t._e(),t.show_bin_modal?e("BinFolder",{attrs:{modal_title:t.$t("restore_spaces"),path:"spaces"},on:{close:function(a){t.show_bin_modal=!1}},scopedSlots:t._u([{key:"default",fn:function(a){return[e("SpacePresentation",{attrs:{space:a.project,context:a.context,can_edit:a.can_edit}})]}}],null,!1,2360877550)}):t._e()],1)},g=[],$=n(f,v,g,!1,null,"c29c64c2");const b=$.exports,y={props:{show_only_my_projects:Boolean},components:{ProjectsListWithFilter:u},data(){return{all_projects:[],is_loading:!0}},created(){},async mounted(){this.all_projects=await this.loadAllFolders("spaces","projects")||[],this.is_loading=!1},beforeDestroy(){},watch:{},computed:{filtered_projects(){let s=this.all_projects;return this.show_only_my_projects&&(s=s.filter(t=>{var e,a;return t?!!(Array.isArray(t.$admins)&&((e=t.$admins)!=null&&e.includes(this.connected_as.$path))||Array.isArray(t.$contributors)&&((a=t.$contributors)!=null&&a.includes(this.connected_as.$path))):!1})),s}},methods:{}};var P=function(){var t=this,e=t._self._c;return e("div",{staticClass:"_allProjects"},[e("transition",{attrs:{name:"fade_fast",duration:150,mode:"out-in"}},[t.is_loading?e("LoaderSpinner"):e("ProjectsListWithFilter",{attrs:{projects:t.filtered_projects,display_original_space:!0}})],1)],1)},w=[],x=n(y,P,w,!1,null,"34bd1a46");const C=x.exports,k={name:"HomeTopHero",components:{AdminSettings:m},data(){return{settings_modal_starting_tab:void 0,show_settings_modal:!1}},computed:{name(){return this.$root.app_infos.instance_meta.name},description(){return this.$root.app_infos.instance_meta.presentation},hero_thumb(){return this.$root.app_infos.instance_meta.hero_thumb||!1},text_image_layout(){return this.$root.app_infos.instance_meta.text_image_layout||"image_text"},custom_layout(){return this.text_image_layout==="text_image"?["text","image"]:this.text_image_layout==="image_text"?["image","text"]:["text","image"]}},methods:{editHeroImage(){this.settings_modal_starting_tab="logo_and_images",this.show_settings_modal=!0},editPresentationText(){this.settings_modal_starting_tab="informations",this.show_settings_modal=!0},closeAdminSettings(){this.show_settings_modal=!1,this.settings_modal_starting_tab=void 0}}};var S=function(){var t=this,e=t._self._c;return e("section",{staticClass:"_hero--container"},[e("div",{staticClass:"_hero--content",attrs:{"data-layout":t.text_image_layout}},[t._l(t.custom_layout,function(a){return[a==="text"?e("div",{key:a,staticClass:"_textBlock"},[e("h1",{staticClass:"_sessionTitle",domProps:{textContent:t._s(t.name||t.$t("welcome_to_dodoc"))}}),e("div",{},[t.description?e("CollaborativeEditor2",{attrs:{content:t.description}}):[t.is_instance_admin?[e("p",{domProps:{innerHTML:t._s(t.$t("admins_edit_text_below"))}})]:[e("p",{domProps:{innerHTML:t._s(t.$t("admins_edit_text_here"))}})]]],2),t.$root.app_infos.instance_meta.contactmail?[e("div",{staticClass:"u-spacingBottom"}),e("p",[e("b",[t._v(t._s(t.$t("contactmail_of_instance")))]),t._v("Â  "),e("a",{attrs:{href:"mailto:"+t.$root.app_infos.instance_meta.contactmail,target:"_blank"}},[t._v(t._s(t.$root.app_infos.instance_meta.contactmail))])])]:t._e(),t.is_instance_admin?e("EditBtn",{staticClass:"_editAdminText",attrs:{label_position:"left"},on:{click:t.editPresentationText}}):t._e()],2):t._e(),a==="image"&&t.hero_thumb?e("div",{key:a,staticClass:"_imageBlock"},[e("img",{attrs:{src:t.hero_thumb,role:"presentation"}})]):t._e()]}),t.is_instance_admin?e("EditBtn",{staticClass:"_editAdminImg",attrs:{label_position:"left"},on:{click:t.editHeroImage}}):t._e()],2),t.show_settings_modal?e("AdminSettings",{attrs:{starting_tab:t.settings_modal_starting_tab},on:{close:t.closeAdminSettings}}):t._e(),e("svg",{staticClass:"_hidden"},[e("clipPath",{attrs:{id:"clipPathSquircle",clipPathUnits:"objectBoundingBox"}},[e("path",{attrs:{transform:"scale(1 1.835)",d:"M 0.114 0.045 h 0.773 c 0.055 0 0.068 0.013 0.068 0.068 v 0.318 c 0 0.055 -0.013 0.068 -0.068 0.068 h -0.773 c -0.055 0 -0.068 -0.013 -0.068 -0.068 v -0.318 c 0 -0.055 0.013 -0.068 0.068 -0.068"}})])])],1)},j=[],L=n(k,S,j,!1,null,"66b14c6c");const F=L.exports,T={name:"GetPinnedPublications",components:{PublicationPreview:h,SectionWithPrint:()=>r(()=>import("./SectionWithPrint-CyhauhjH.js"),[])},data(){return{pinnedPublications:[],publication_to_open:null}},created(){this.fetchPinnedPublications(),this.fetchPublicationToOpen()},methods:{async fetchPublicationToOpen(){const s=await this.$api.getFolder({path:"spaces/casou/projects/julien/publications/lkj"});this.publication_to_open=s},async fetchPinnedPublications(){const s=await this.loadAllFolders("spaces","projects","publications");this.pinnedPublications=s.slice(0,5)}}};var A=function(){var t=this,e=t._self._c;return e("div",{staticClass:"_allPublications"},[e("h2",[t._v(t._s(t.$t("all_publications")))]),t.pinnedPublications.length>0?e("div",{staticClass:"_allPublications--grid"},t._l(t.pinnedPublications,function(a){return e("div",{staticClass:"_allPublications--grid--card"},[e("PublicationPreview",{attrs:{publication:a,template_options:[],can_edit:!1},on:{open:function(o){return t.openEntry(a.$path)}}})],1)}),0):e("p",{staticClass:"no-publications"},[t._v(t._s(t.$t("no_pinned_publications")))])])},H=[],B=n(T,A,H,!1,null,"5a97506a");const E=B.exports,R={props:{},components:{HomeTopHero:F,EventsSection:()=>r(()=>import("./EventsSection-Cea52vK-.js"),[]),SpacesList:b,AllProjects:C,DodocLogo:d,RecentlyEdited:()=>r(()=>import("./RecentlyEdited-C3Kzo4bR.js"),[]),AllPublications:E},data(){return{load_whole_page:!1,current_mode:"spaces"}},created(){var s;((s=this.$route.query)!=null&&s.pfilters||this.opened_event)&&(this.current_mode="projects"),this.$api.updateSelfPath("/")},mounted(){setTimeout(()=>{this.load_whole_page=!0},100)},beforeDestroy(){},watch:{current_mode(){var s;if(this.current_mode==="spaces"&&(s=this.$route.query)!=null&&s.pfilters){let t=JSON.parse(JSON.stringify(this.$route.query));delete t.pfilters,this.$router.push({query:t})}},opened_event:{handler(){this.opened_event&&(this.current_mode="projects")}}},computed:{opened_event(){return this.$route.hash.substring(1)||!1},available_radioswitch_modes(){let s=[{label:this.$t("spaces"),value:"spaces"},{label:this.$t("all_projects"),value:"projects"}];return this.connected_as&&s.push({label:this.$t("my_projects"),value:"my_projects"}),s},name(){return this.$root.app_infos.instance_meta.name},description(){return this.$root.app_infos.instance_meta.presentation},hero_thumb(){return this.$root.app_infos.instance_meta.hero_thumb||!1},customStyling(){let s={};return this.$root.app_infos.instance_meta.hero_background_color&&(s["--hero-bg"]=this.$root.app_infos.instance_meta.hero_background_color),this.$root.app_infos.instance_meta.text_background_color&&(s["--text-bg"]=this.$root.app_infos.instance_meta.text_background_color),s},text_image_layout(){return this.$root.app_infos.instance_meta.text_image_layout||"image_text"},custom_layout(){return this.text_image_layout==="text_image"?["text","image"]:this.text_image_layout==="image_text"?["image","text"]:["text","image"]}},methods:{showCredits(){this.$eventHub.$emit("toolbar.openCredits")}}};var D=function(){var t=this,e=t._self._c;return e("div",{staticClass:"_homeView",style:t.customStyling},[e("HomeTopHero"),t.load_whole_page===!0?[t.connected_as?e("RecentlyEdited"):t._e(),t.$root.app_infos.instance_meta.enable_events?e("section",[e("EventsSection")],1):t._e(),e("transition",{attrs:{name:"pagechange",mode:"out-in"}},[e("div",{key:t.opened_event,staticClass:"_bottomCont"},[t.opened_event?t._e():e("RadioSwitch",{staticClass:"_switch",attrs:{content:t.current_mode,options:t.available_radioswitch_modes},on:{"update:content":function(a){t.current_mode=a}}}),e("transition",{attrs:{name:"pagechange",mode:"out-in"}},[e("div",{key:t.current_mode},[t.current_mode==="spaces"?[e("div",{staticClass:"u-instructions _content"},[e("small",{domProps:{innerHTML:t._s(t.$t("spaces_instr"))}})]),e("SpacesList")]:t.current_mode==="projects"?[e("div",{staticClass:"u-instructions _content"},[t.opened_event?[e("h2",[t._v(t._s(t.$t("list_of_projects")))])]:e("small",{domProps:{innerHTML:t._s(t.$t("all_projects_instr"))}})],2),e("AllProjects")]:t.current_mode==="my_projects"?[e("div",{staticClass:"u-instructions _content"},[e("small",{domProps:{innerHTML:t._s(t.$t("my_projects_instr"))}})]),e("AllProjects",{attrs:{show_only_my_projects:!0}})]:t._e()],2)])],1)]),e("footer",{staticClass:"_bottomFooter"},[e("div",{staticClass:"_bottomFooter--cont"},[t.$root.app_infos.instance_meta.terms_in_footer||t.$root.app_infos.instance_meta.confidentiality_in_footer?e("div",{staticClass:"u-spacingBottom _links"},[t.$root.app_infos.instance_meta.terms_in_footer?e("router-link",{staticClass:"u-buttonLink",attrs:{to:t.createURLFromPath("pages/terms")}},[t._v(" "+t._s(t.$t("terms"))+" ")]):t._e(),t.$root.app_infos.instance_meta.confidentiality_in_footer?e("router-link",{staticClass:"u-buttonLink",attrs:{to:t.createURLFromPath("pages/confidentiality")}},[t._v(" "+t._s(t.$t("confidentiality"))+" ")]):t._e()],1):t._e(),e("div",{staticClass:"_logoText"},[e("DodocLogo",{staticClass:"_logo"}),e("div",{staticClass:"_version"},[t._v(" "+t._s(t.$t("version"))+" "+t._s(t.$root.app_infos.version)+" ")])],1),e("p",{domProps:{innerHTML:t._s(t.$t("a_foss_made_by"))}}),e("button",{staticClass:"u-buttonLink u-button_small",attrs:{type:"button"},on:{click:t.showCredits}},[e("span",{domProps:{innerHTML:t._s(t.$t("more_informations"))}})])])])]:t._e()],2)},I=[],M=n(R,D,I,!1,null,"3b9e8026");const W=M.exports;export{W as default};
