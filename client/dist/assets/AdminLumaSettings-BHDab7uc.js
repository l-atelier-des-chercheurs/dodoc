import{S as o}from"./SingleKeyword-BLR2qpR_.js";import{n as a}from"../build.js";const r={props:{path:String},components:{SingleKeyword:o},data(){return{category:void 0,is_loading:!0,new_list_of_suggestions:[],new_suggestion:""}},created(){},async mounted(){this.category=await this.$api.getFolder({path:this.path}),this.$api.join({room:this.path}),this.new_list_of_suggestions=this.category.list_of_suggestions||[],this.is_loading=!1},beforeDestroy(){this.$api.leave({room:this.path})},watch:{},computed:{new_keyword_already_exists(){return this.new_list_of_suggestions.some(n=>n.toLowerCase()===this.new_suggestion.toLowerCase())},new_keyword_contains_slash(){return this.new_suggestion.includes("/")}},methods:{removeSuggestion(n){this.new_list_of_suggestions=this.new_list_of_suggestions.filter(t=>t!==n)},newKeyword(){if(this.new_suggestion.length===0||this.new_keyword_already_exists||this.new_keyword_contains_slash)return!1;this.new_list_of_suggestions.push(this.new_suggestion),this.new_suggestion=""},cancel(){this.new_list_of_suggestions=this.category.list_of_suggestions,this.new_suggestion="",this.$emit("close")},async saveNewSuggestion(){await this.$api.updateMeta({path:this.path,new_meta:{list_of_suggestions:this.new_list_of_suggestions}}),this.$emit("close")},async saveNewColor(n){await this.$api.updateMeta({path:this.path,new_meta:{tag_color:n||""}})},async removeCat(){await this.$api.deleteItem({path:this.path}),this.$emit("close")}}};var _=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"u-spacingBottom _top"},[e("div",[e("button",{staticClass:"u-buttonLink",attrs:{type:"button"},on:{click:function(s){return t.$emit("close")}}},[e("b-icon",{attrs:{icon:"arrow-left-short"}}),t._v(" "+t._s(t.$t("back"))+" ")],1)]),e("RemoveMenu",{attrs:{button_text:t.$t("remove_category")},on:{remove:t.removeCat}})],1),t.is_loading?e("div",{key:"loader",staticClass:"_spinner"},[e("LoaderSpinner")],1):e("div",[e("div",{staticClass:"_top"},[e("div",{staticClass:"u-spacingBottom"},[e("TitleField",{staticClass:"_title",attrs:{label:t.$t("category_title"),field_name:"title",content:t.category.title,path:t.category.$path,tag:"h3",required:!0,maxlength:20,can_edit:!0}})],1),e("ColorInput",{attrs:{label:t.$t("custom_color"),default_value:"#000000",value:t.category.tag_color,can_toggle:!0},on:{save:t.saveNewColor}})],1),e("div",{staticClass:"u-spacingBottom _kwSimulation"},[e("SingleKeyword",{attrs:{keyword:t.category.title+"/couleur",cat_color:t.category.tag_color}})],1),e("div",{staticClass:"u-spacingBottom u-keywords"},t._l(t.new_list_of_suggestions,function(s){return e("SingleKeyword",{key:s,attrs:{keyword:s,can_remove:!0},on:{remove:function(i){return t.removeSuggestion(s)}}})}),1),e("div",{staticClass:"u-spacingBottom"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.new_suggestion,expression:"new_suggestion"}],attrs:{type:"text",placeholder:"Nouveau mot-clé"},domProps:{value:t.new_suggestion},on:{keydown:function(s){return!s.type.indexOf("key")&&t._k(s.keyCode,"enter",13,s.key,"Enter")||s.ctrlKey||s.shiftKey||s.altKey||s.metaKey?null:(s.preventDefault(),t.newKeyword.apply(null,arguments))},input:function(s){s.target.composing||(t.new_suggestion=s.target.value)}}}),t.new_keyword_already_exists?e("div",{staticClass:"u-instructions"},[e("small",[t._v("Ce mot-clé existe déjà, vous ne pouvez pas l’ajouter. Si vous souhaitez changer la case, supprimez le de la liste puis ajoutez le à nouveau.")])]):t.new_keyword_contains_slash?e("div",{staticClass:"u-instructions"},[e("small",[t._v('Ce mot-clé contient le caractère "/", qui est interdit.')])]):t.new_suggestion.length>0?e("div",{staticClass:"u-instructions"},[e("small",[t._v("Validez avec la touche entrée.")])]):t._e()]),t.new_suggestion.length===0?e("SaveCancelButtons",{staticClass:"_scb",on:{save:t.saveNewSuggestion,cancel:t.cancel}}):t._e(),e("RemoveMenu",{attrs:{remove_text:t.$t("remove")},on:{remove:t.removeCat}})],1)])},c=[],l=a(r,_,c,!1,null,"e92249d2");const u=l.exports,d={props:{},components:{SingleCategory:u},data(){return{categories:void 0,show_create_category:!1,opened_category_path:!1,new_category_title:"",path:"categories"}},created(){},async mounted(){this.categories=await this.$api.getFolders({path:this.path}).catch(n=>{this.fetch_categories_error=n.response}),this.$api.join({room:this.path})},beforeDestroy(){this.$api.leave({room:this.path})},watch:{},computed:{},methods:{async createCategory(){const n=await this.$api.createFolder({path:this.path,additional_meta:{title:this.new_category_title.toUpperCase(),requested_slug:this.new_category_title,$status:"public"}});this.openCategory(this.path+"/"+n)},openCategory(n){this.opened_category_path=n},categoryStyles(n){return n.tag_color?`
        --cat-color: ${n.tag_color}
      `:""}}};var g=function(){var t=this,e=t._self._c;return e("div",[t.opened_category_path?[e("SingleCategory",{attrs:{path:t.opened_category_path},on:{close:function(s){t.opened_category_path=!1}}})]:[e("div",t._l(t.categories,function(s){return e("div",{key:s.$path,staticClass:"_categoryRow",style:t.categoryStyles(s)},[e("div",{staticClass:"_title"},[t._v(" "+t._s(s.title)+" ")]),e("button",{staticClass:"u-buttonLink",attrs:{type:"button"},domProps:{textContent:t._s(t.$t("open"))},on:{click:function(i){return t.openCategory(s.$path)}}})])}),0),e("button",{staticClass:"u-buttonLink",class:{"is--active":t.show_create_category},attrs:{type:"button"},on:{click:function(s){t.show_create_category=!t.show_create_category}}},[t._v(" "+t._s(t.$t("add_category"))+" ")]),t.show_create_category?e("form",{staticClass:"input-validation-required",on:{submit:function(s){return s.preventDefault(),t.createCategory.apply(null,arguments)}}},[e("fieldset",[e("legend",{staticClass:"u-label"},[t._v(t._s(t.$t("add_category")))]),e("TextInput",{staticClass:"u-spacingBottom",attrs:{content:t.new_category_title,label_str:"category_name",required:!0,input_type:"text"},on:{"update:content":function(s){t.new_category_title=s}}}),t._m(0),e("button",{staticClass:"u-button u-button_bleuvert",attrs:{slot:"footer",disabled:t.new_category_title.length===0,type:"submit"},slot:"footer"},[t._v(" "+t._s(t.$t("create"))+" ")])],1)]):t._e()]],2)},p=[function(){var n=this,t=n._self._c;return t("div",{staticClass:"u-instructions"},[t("small",[n._v(" Tout en majuscule ")])])}],h=a(d,g,p,!1,null,"e86a181a");const m=h.exports,f={props:{starting_tab:String},components:{SuggestedCategories:m},data(){return{settings:void 0,is_loading:!0,current_tab:"administration_and_access_control",tabs:[{key:"informations",text:this.$t("informations")},{text:this.$t("administration_and_access_control"),key:"administration_and_access_control"},{text:this.$t("suggested_cat_kw"),key:"suggested_cat_kw"}]}},created(){},async mounted(){this.settings=await this.$api.getFolder({path:""}).catch(n=>(this.is_loading=!1,n)),this.is_loading=!1,this.starting_tab&&setTimeout(()=>{this.$refs.tabgroup.show(this.starting_tab)},100),this.$api.join({room:this.settings.$path})},beforeDestroy(){this.$api.leave({room:this.settings.$path})},watch:{},computed:{},methods:{newTabShown(n){this.current_tab=n.detail.name}}};var v=function(){var t=this,e=t._self._c;return e("BaseModal2",{attrs:{title:t.$t("settings")},on:{close:function(s){return t.$emit("close")}}},[e("div",{},[t.is_loading?e("div",{key:"loader",staticClass:"_spinner"},[e("LoaderSpinner")],1):e("div",[e("div",[e("div",{staticClass:"_selectMenu"},[e("SelectField2",{attrs:{value:t.current_tab,options:t.tabs,can_edit:!0,hide_validation:!0},on:{change:function(s){t.current_tab=s}}})],1),e("div",{staticClass:"u-spacingBottom"}),t.current_tab==="informations"?[e("div",{staticClass:"u-spacingBottom"},[e("TitleField",{attrs:{field_name:"name_of_instance",label:t.$t("name_of_instance"),instructions:t.$t("name_of_instance_instructions"),content:t.settings.name_of_instance||"",path:t.settings.$path,tag:"h1",required:!0,minlength:3,maxlength:40,can_edit:t.is_instance_admin}})],1),e("div",{staticClass:"u-spacingBottom"},[e("CollaborativeEditor2",{attrs:{label:t.$t("presentation_of_instance")+" (en français)",field_to_edit:"presentation_of_instance_fr",instructions:t.$t("presentation_of_instance_instructions"),content:t.settings.presentation_of_instance_fr,path:t.settings.$path,custom_formats:["bold","italic","link"],is_collaborative:!1,can_edit:t.is_instance_admin}})],1),e("div",{staticClass:"u-spacingBottom"},[e("CollaborativeEditor2",{attrs:{label:t.$t("presentation_of_instance")+" (en anglais)",field_to_edit:"presentation_of_instance_en",instructions:t.$t("presentation_of_instance_instructions"),content:t.settings.presentation_of_instance_en,path:t.settings.$path,custom_formats:["bold","italic","link"],is_collaborative:!1,can_edit:t.is_instance_admin}})],1)]:t._e(),t.current_tab==="administration_and_access_control"?[e("AdminsAndContributorsField",{attrs:{folder:t.settings,can_edit:t.is_instance_admin,custom_label:t.$t("instance_admins_and_admins"),admin_label:t.$t("admin"),admin_instructions:t.$t("instance_admin_instructions"),contrib_instructions:t.$t("instance_contrib_instructions")}}),e("br"),e("TitleField",{attrs:{field_name:"general_password",label:t.$t("general_password"),instructions:t.$t("general_password_instructions"),content:t.settings.general_password,path:t.settings.$path,input_type:"password",required:!1,can_edit:t.is_instance_admin}}),e("br"),e("TitleField",{attrs:{field_name:"signup_password",label:t.$t("signup_password"),instructions:t.$t("signup_password_instructions"),content:t.settings.signup_password,path:t.settings.$path,required:!1,can_edit:t.is_instance_admin}}),e("br"),e("ToggleField",{attrs:{label:t.$t("require_mail_to_signup"),field_name:"require_mail_to_signup",content:t.settings.require_mail_to_signup===!0,path:t.settings.$path,can_edit:t.is_instance_admin}}),e("br"),e("TitleField",{attrs:{field_name:"contactmail_of_instance",label:t.$t("contactmail_of_instance"),instructions:t.$t("contactmail_of_instance_instructions"),content:t.settings.contactmail_of_instance,path:t.settings.$path,required:!1,input_type:"email",can_edit:t.is_instance_admin}})]:t._e(),t.current_tab==="suggested_cat_kw"?[e("SuggestedCategories")]:t._e()],2)])])])},w=[],y=a(f,v,w,!1,null,"9275ca2c");const C=y.exports;export{C as default};
