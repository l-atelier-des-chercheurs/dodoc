{"version":3,"file":"js/978.js","mappings":"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GAAI,CAAE,EAAG,EAAG,EAAG,GAAI,CAAE,EAAG,EAAG,EAAG,GAAI,EAAE,GAAG,GAAG,GAAG,IACzD,CAAC,CAAC,GAAI,EAAG,EAAG,GAAI,CAAC,GAAI,GAAG,EAAG,GAAI,CAAE,EAAG,EAAG,GAAG,GAAI,CAAE,EAAG,EAAG,EAAG,IACzD,CAAC,EAAE,GAAG,GAAG,GAAG,GAAI,CAAE,EAAG,EAAG,GAAG,GAAI,EAAE,GAAG,GAAG,GAAG,GAAI,CAAE,EAAG,EAAG,EAAG,IACzD,CAAC,CAAE,EAAG,EAAG,EAAG,GAAI,CAAE,EAAG,GAAG,EAAG,GAAI,EAAE,GAAG,GAAG,GAAG,GAAI,EAAE,GAAG,GAAG,GAAG,IAEzD,CAAC,CAAE,EAAG,EAAG,EAAG,GAAI,CAAE,EAAG,GAAG,EAAG,GAAI,EAAE,GAAG,GAAG,GAAG,GAAI,EAAE,GAAG,GAAG,GAAG,IACzD,CAAC,EAAE,GAAG,GAAG,GAAG,GAAI,CAAE,EAAG,EAAG,GAAG,GAAI,EAAE,GAAG,GAAG,GAAG,GAAI,CAAE,EAAG,EAAG,EAAG,IACzD,CAAC,CAAC,GAAI,EAAG,GAAG,GAAI,CAAC,GAAI,EAAG,EAAG,GAAI,CAAC,GAAI,EAAG,EAAG,GAAI,CAAC,GAAI,GAAG,EAAG,IACzD,CAAC,EAAE,GAAG,GAAG,GAAG,GAAI,CAAE,EAAG,EAAG,EAAG,GAAI,CAAE,EAAG,EAAG,EAAG,GAAI,EAAE,GAAG,GAAG,GAAG,IAEzD,CAAC,CAAE,EAAG,EAAG,EAAG,GAAI,EAAE,GAAG,GAAG,GAAG,GAAI,CAAE,EAAG,GAAG,EAAG,GAAI,EAAE,GAAG,GAAG,GAAG,IACzD,CAAC,EAAE,GAAG,GAAG,GAAG,GAAI,EAAE,GAAG,GAAG,GAAG,GAAI,CAAE,EAAG,EAAG,GAAG,GAAI,CAAE,EAAG,EAAG,EAAG,IACzD,CAAC,CAAE,EAAG,EAAG,GAAG,GAAI,EAAE,GAAG,GAAG,GAAG,GAAI,EAAE,GAAG,GAAG,GAAG,GAAI,CAAE,EAAG,GAAG,EAAG,IACzD,CAAC,EAAE,GAAG,GAAG,GAAG,GAAI,EAAE,GAAG,GAAG,GAAG,GAAI,EAAE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","sources":["webpack://app/./src/adc-core/capture/CaptureView.vue?7a25","webpack://app/./src/adc-core/capture/MediaPreviewBeforeValidation.vue?aa26","webpack://app/src/adc-core/capture/MediaPreviewBeforeValidation.vue","webpack://app/./src/adc-core/capture/MediaPreviewBeforeValidation.vue?8406","webpack://app/./src/adc-core/capture/MediaPreviewBeforeValidation.vue","webpack://app/./src/adc-core/capture/MediaValidationButtons.vue?6df0","webpack://app/src/adc-core/capture/MediaValidationButtons.vue","webpack://app/./src/adc-core/capture/MediaValidationButtons.vue?de10","webpack://app/./src/adc-core/capture/MediaValidationButtons.vue","webpack://app/./src/adc-core/capture/CaptureSettings.vue?4e94","webpack://app/src/adc-core/capture/CaptureSettings.vue","webpack://app/./src/adc-core/capture/CaptureSettings.vue?a4f7","webpack://app/./src/adc-core/capture/CaptureSettings.vue","webpack://app/./src/adc-core/capture/CaptureEffects.vue?ef01","webpack://app/src/adc-core/capture/CaptureEffects.vue","webpack://app/./src/adc-core/capture/CaptureEffects.vue?723d","webpack://app/./src/adc-core/capture/CaptureEffects.vue","webpack://app/./src/adc-core/capture/StopmotionList.vue?c11b","webpack://app/src/adc-core/capture/StopmotionList.vue","webpack://app/./src/adc-core/capture/StopmotionList.vue?184e","webpack://app/./src/adc-core/capture/StopmotionList.vue","webpack://app/./src/adc-core/capture/AudioEqualizer.vue?345a","webpack://app/src/adc-core/capture/AudioEqualizer.vue","webpack://app/./src/adc-core/capture/AudioEqualizer.vue?3475","webpack://app/./src/adc-core/capture/AudioEqualizer.vue","webpack://app/./src/adc-core/capture/VectoMode.vue?ee7a","webpack://app/src/adc-core/capture/VectoMode.vue","webpack://app/./src/adc-core/capture/VectoMode.vue?6070","webpack://app/./src/adc-core/capture/VectoMode.vue","webpack://app/./src/adc-core/capture/LinesMode.vue?c2db","webpack://app/src/adc-core/capture/LinesMode.vue","webpack://app/./src/adc-core/capture/LinesMode.vue?8d77","webpack://app/./src/adc-core/capture/LinesMode.vue","webpack://app/src/adc-core/capture/CaptureView.vue","webpack://app/./src/adc-core/capture/CaptureView.vue?56a9","webpack://app/./src/adc-core/capture/CaptureView.vue","webpack://app/./src/adc-core/capture/AudioEqualizer.vue?3939","webpack://app/./src/adc-core/capture/CaptureEffects.vue?2e4e","webpack://app/./src/adc-core/capture/CaptureSettings.vue?c492","webpack://app/./src/adc-core/capture/CaptureView.vue?2f27","webpack://app/./src/adc-core/capture/CaptureView.vue?b61d","webpack://app/./src/adc-core/capture/LinesMode.vue?a616","webpack://app/./src/adc-core/capture/MediaPreviewBeforeValidation.vue?b031","webpack://app/./src/adc-core/capture/MediaPreviewBeforeValidation.vue?f930","webpack://app/./src/adc-core/capture/MediaValidationButtons.vue?af83","webpack://app/./src/adc-core/capture/StopmotionList.vue?6a7e","webpack://app/./src/adc-core/capture/StopmotionList.vue?e31b","webpack://app/./src/adc-core/capture/VectoMode.vue?9f7e","webpack://app/./node_modules/imagetracerjs/imagetracer_v1.2.6.js","webpack://app/./node_modules/recordrtc/RecordRTC.js","webpack://app/./node_modules/rtcmulticonnection/dist/RTCMultiConnection.js","webpack://app/./src/adc-core/capture/audio-activity.js","webpack://app/./src/adc-core/capture/AudioEqualizer.vue?7819","webpack://app/./src/adc-core/capture/CaptureEffects.vue?390f","webpack://app/./src/adc-core/capture/CaptureSettings.vue?628c","webpack://app/./src/adc-core/capture/CaptureView.vue?2d93","webpack://app/./src/adc-core/capture/CaptureView.vue?5972","webpack://app/./src/adc-core/capture/LinesMode.vue?61e7","webpack://app/./src/adc-core/capture/MediaPreviewBeforeValidation.vue?4f3a","webpack://app/./src/adc-core/capture/MediaPreviewBeforeValidation.vue?82fd","webpack://app/./src/adc-core/capture/MediaValidationButtons.vue?d16a","webpack://app/./src/adc-core/capture/StopmotionList.vue?5d45","webpack://app/./src/adc-core/capture/StopmotionList.vue?1621","webpack://app/./src/adc-core/capture/VectoMode.vue?4769"],"sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"m_captureview\",class:{ 'is--collapsed': _vm.collapse_capture_pane }},[_c('CaptureSettings',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.show_capture_settings),expression:\"show_capture_settings\"}],attrs:{\"audio_output_deviceId\":_vm.audio_output_deviceId},on:{\"update:audio_output_deviceId\":function($event){_vm.audio_output_deviceId=$event},\"update:audio_output_device-id\":function($event){_vm.audio_output_deviceId=$event},\"setStream\":_vm.setStream,\"hasFinishedLoading\":_vm.hasFinishedLoading,\"show\":function($event){_vm.show_capture_settings = true},\"close\":function($event){_vm.show_capture_settings = false}}}),_c('CaptureEffects',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.show_effects_pane),expression:\"show_effects_pane\"}],attrs:{\"enable_effects\":_vm.enable_effects,\"videoElement\":_vm.$refs.videoElement,\"canvasElement\":_vm.$refs.canvasElement},on:{\"update:enable_effects\":function($event){_vm.enable_effects=$event},\"updateImageData\":_vm.setImageData,\"close\":function($event){_vm.show_effects_pane = false}}}),_c('div',{staticClass:\"m_captureview--videoPane\"},[_c('transition',{attrs:{\"name\":\"slidedown\",\"duration\":500}},[(\n            !_vm.media_to_validate &&\n            !_vm.is_recording &&\n            !_vm.is_making_stopmotion &&\n            !_vm.delay_event\n          )?_c('div',{staticClass:\"_modeSelector\"},[(_vm.available_modes.length > 1)?_c('div',{staticClass:\"_arrows\"},[_c('button',{staticClass:\"bg-transparent\",attrs:{\"type\":\"button\"},on:{\"mousedown\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.previousMode()},\"touchstart\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.previousMode()}}},[_c('svg',{staticStyle:{\"enable-background\":\"new 0 0 169 169\"},attrs:{\"version\":\"1.1\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"xmlns:xlink\":\"http://www.w3.org/1999/xlink\",\"x\":\"0px\",\"y\":\"0px\",\"width\":\"169px\",\"height\":\"169px\",\"viewBox\":\"0 0 169 169\",\"xml:space\":\"preserve\"}},[_c('path',{attrs:{\"fill\":\"currentColor\",\"stroke\":\"currentColor\",\"stroke-width\":\"10\",\"stroke-linejoin\":\"round\",\"d\":\"M60.2,84.5l48.6-24.3l0,48.6L60.2,84.5z\"}})])])]):_vm._e(),_vm._l((_vm.available_modes),function(mode){return _c('div',{key:mode},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.selected_mode),expression:\"selected_mode\"}],attrs:{\"type\":\"radio\",\"id\":_vm.id + '_' + mode},domProps:{\"value\":mode,\"checked\":_vm._q(_vm.selected_mode,mode)},on:{\"change\":function($event){_vm.selected_mode=mode}}}),_c('label',{attrs:{\"for\":_vm.id + '_' + mode}},[_c('div',{staticClass:\"_picto\",attrs:{\"content\":_vm.$t(mode)}},[_c('img',{attrs:{\"src\":_vm.available_mode_picto[mode]}})]),(_vm.selected_mode === mode)?_c('span',[_vm._v(_vm._s(_vm.$t(mode)))]):_vm._e()])])}),(_vm.available_modes.length > 1)?_c('div',{staticClass:\"_arrows\"},[_c('button',{staticClass:\"bg-transparent\",attrs:{\"type\":\"button\"},on:{\"mousedown\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.nextMode()},\"touchstart\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.nextMode()}}},[_c('svg',{staticStyle:{\"enable-background\":\"new 0 0 169 169\"},attrs:{\"version\":\"1.1\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"xmlns:xlink\":\"http://www.w3.org/1999/xlink\",\"x\":\"0px\",\"y\":\"0px\",\"width\":\"169px\",\"height\":\"169px\",\"viewBox\":\"0 0 169 169\",\"xml:space\":\"preserve\"}},[_c('path',{attrs:{\"fill\":\"currentColor\",\"stroke\":\"currentColor\",\"stroke-width\":\"10\",\"stroke-linejoin\":\"round\",\"d\":\"M108.8,84.5l-48.6,24.3V60.2L108.8,84.5z\"}})])])]):_vm._e()],2):_vm._e()]),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(!_vm.is_validating_stopmotion_video),expression:\"!is_validating_stopmotion_video\"}],staticClass:\"m_captureview--videoPane--top\",class:{\n          'is--being_streamed':\n            (_vm.stream_sharing_informations_status &&\n              _vm.stream_sharing_informations_status.enabled) ||\n            (_vm.stream_access_informations_status &&\n              _vm.stream_access_informations_status.enabled),\n        }},[_c('div',{staticClass:\"m_captureview--videoPane--top--videoContainer\"},[_c('div',{style:((\"opacity: \" + (_vm.show_videos ? 1 : 0)))},[_c('video',{directives:[{name:\"show\",rawName:\"v-show\",value:(!_vm.enable_effects),expression:\"!enable_effects\"}],ref:\"videoElement\",attrs:{\"autoplay\":\"\",\"playsinline\":\"\",\"controls\":_vm.stream_type === 'RemoteSources',\"muted\":\"\"},domProps:{\"srcObject\":_vm.stream,\"muted\":true}}),_c('canvas',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.enable_effects),expression:\"enable_effects\"}],ref:\"canvasElement\",attrs:{\"width\":_vm.actual_camera_resolution.width,\"height\":_vm.actual_camera_resolution.height},on:{\"click\":function (e) { return _vm.updateSelectedColor({ e: e, type: 'click' }); }}})]),(_vm.selected_mode === 'vecto' && !_vm.media_to_validate)?_c('VectoMode',{ref:\"vectoElement\",attrs:{\"last_frame_from_video\":_vm.last_frame_from_video,\"number_of_colors\":_vm.vecto_number_of_colors}}):_vm._e(),(_vm.selected_mode === 'lines' && !_vm.media_to_validate)?_c('LinesMode',{ref:\"vectoElement\",attrs:{\"last_frame_from_video\":_vm.last_frame_from_video,\"angle\":_vm.lines_angle,\"boost_brightness\":_vm.lines_brightness,\"boost_contrast\":_vm.lines_contrast,\"density\":_vm.lines_density}}):_vm._e(),(_vm.selected_mode === 'audio' && !_vm.media_to_validate)?_c('AudioEqualizer',{ref:\"equalizerElement\",attrs:{\"stream\":_vm.stream,\"is_recording\":_vm.is_recording}}):_vm._e(),_c('transition-group',{staticClass:\"_capture_options\",attrs:{\"tag\":\"div\",\"name\":\"slideFromTop\",\"mode\":\"out-in\"}},[(\n                _vm.selected_mode !== 'stopmotion' &&\n                _vm.is_recording &&\n                _vm.timer_recording_in_seconds !== false\n              )?_c('label',{key:'duration',domProps:{\"innerHTML\":_vm._s(_vm.timer_recording_in_seconds)}}):_vm._e(),(\n                _vm.selected_mode === 'stopmotion' &&\n                _vm.timelapse_mode_enabled &&\n                !_vm.timelapse_event\n              )?_c('div',{key:'timelapse_interval',staticClass:\"record_options\"},[_c('label',[_c('span',[_vm._v(_vm._s(_vm.$t(\"interval_between_pictures\")))]),_c('input',{directives:[{name:\"model\",rawName:\"v-model.number\",value:(_vm.timelapse_interval),expression:\"timelapse_interval\",modifiers:{\"number\":true}}],attrs:{\"type\":\"number\"},domProps:{\"value\":(_vm.timelapse_interval)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.timelapse_interval=_vm._n($event.target.value)},\"blur\":function($event){return _vm.$forceUpdate()}}}),_c('span',[_vm._v(_vm._s(_vm.$t(\"seconds\")))])])]):_vm._e(),(\n                _vm.stream_sharing_informations_status &&\n                _vm.stream_sharing_informations_status.enabled &&\n                _vm.stream_type === 'LocalSources'\n              )?_c('div',{key:'stream_share_name-' + _vm.stream_sharing_informations_status.name},[_c('label',[_c('span',{domProps:{\"innerHTML\":_vm._s(_vm.$t('stream_currently_shared_with_name:'))}}),_c('span',[_c('strong',[_vm._v(_vm._s(_vm.stream_sharing_informations_status.name))])]),_c('br'),(\n                    _vm.stream_sharing_informations_status.peers_connected &&\n                    _vm.stream_sharing_informations_status.peers_connected.length >\n                      0\n                  )?_c('span',[_vm._v(\" \"+_vm._s(_vm.$t(\"other_users_connected\"))+\" = \"+_vm._s(_vm.stream_sharing_informations_status.peers_connected.length)+\" \")]):_vm._e()])]):(\n                _vm.stream_access_informations_status &&\n                _vm.stream_access_informations_status.enabled &&\n                _vm.stream_type === 'RemoteSources'\n              )?_c('div',{key:'stream_share_name-' + _vm.stream_access_informations_status.callee},[_c('label',[_c('span',{domProps:{\"innerHTML\":_vm._s(_vm.$t('stream_shown:'))}}),_c('span',[_c('strong',[_vm._v(_vm._s(_vm.stream_access_informations_status.callee))])])])]):_vm._e(),(\n                _vm.delay_mode_enabled &&\n                !_vm.is_recording &&\n                !_vm.media_to_validate &&\n                !_vm.delay_event\n              )?_c('div',{key:'delay_interval',staticClass:\"record_options\"},[_c('label',[_c('span',[_vm._v(_vm._s(_vm.$t(\"delay\").toLowerCase()))]),_c('input',{directives:[{name:\"model\",rawName:\"v-model.number\",value:(_vm.delay_seconds),expression:\"delay_seconds\",modifiers:{\"number\":true}}],attrs:{\"type\":\"number\",\"min\":\"1\",\"max\":\"60\"},domProps:{\"value\":(_vm.delay_seconds)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.delay_seconds=_vm._n($event.target.value)},\"blur\":function($event){return _vm.$forceUpdate()}}}),_c('span',[_vm._v(_vm._s(_vm.$t(\"seconds\")))])])]):_vm._e()]),_c('transition',{attrs:{\"name\":\"scaleInFade\",\"mode\":\"out-in\",\"duration\":\"100\"}},[(!!_vm.delay_before_picture || !!_vm.time_before_next_picture)?_c('label',{key:'time_before_' + _vm.delay_before_picture,staticClass:\"_delay_timer\",class:{ 'is--timelapse': !!_vm.time_before_next_picture },attrs:{\"mode\":\"out-in\"}},[(!!_vm.delay_before_picture)?[_vm._v(\" \"+_vm._s(_vm.delay_before_picture)+\" \")]:(!!_vm.time_before_next_picture)?[_vm._v(\" \"+_vm._s(_vm.time_before_next_picture)+\" \")]:_vm._e()],2):_vm._e()]),_c('transition',{attrs:{\"name\":\"scaleInFade\",\"mode\":\"in-out\",\"duration\":\"100\"}}),(_vm.enable_grid && _vm.enable_video && !_vm.media_to_validate)?_c('div',{staticClass:\"_video_grid_overlay\"},[_c('svg',{attrs:{\"width\":_vm.actual_camera_resolution.width,\"height\":_vm.actual_camera_resolution.height,\"viewBox\":(\"0 0 \" + (_vm.actual_camera_resolution.width) + \" \" + (_vm.actual_camera_resolution.height))}},_vm._l((_vm.grids[_vm.current_grid_type]),function(ref,index){\n              var x1 = ref[0];\n              var y1 = ref[1];\n              var x2 = ref[2];\n              var y2 = ref[3];\nreturn _c('line',{key:index,attrs:{\"x1\":x1 + '%',\"y1\":y1 + '%',\"x2\":x2 + '%',\"y2\":y2 + '%',\"vector-effect\":\"non-scaling-stroke\"}})}),0)]):_vm._e(),_c('transition',{attrs:{\"name\":\"fade_fast\"}},[(!(_vm.must_validate_media && _vm.media_to_validate))?_c('div',{staticClass:\"_settingsTag\"},[(_vm.enable_video)?_c('button',{staticClass:\"button-nostyle\",attrs:{\"type\":\"button\"},on:{\"click\":function($event){_vm.show_capture_settings = !_vm.show_capture_settings}}},[_vm._v(\" \"+_vm._s(_vm.actual_camera_resolution.width)+\"\"+_vm._s(_vm.actual_camera_resolution.height)+\" \")]):_vm._e(),(_vm.enable_video)?_c('button',{staticClass:\"button-nostyle\",class:{ 'is--active': _vm.enable_grid },attrs:{\"type\":\"button\"},on:{\"click\":function($event){_vm.enable_grid = !_vm.enable_grid}}},[_vm._v(\" \"+_vm._s(_vm.$t(\"grid\").toLowerCase())+\" \")]):_vm._e(),(_vm.enable_video && _vm.enable_grid)?_c('div',_vm._l((Object.keys(_vm.grids)),function(grid_type){return _c('button',{key:grid_type,staticClass:\"button-nostyle\",class:{ 'is--active': _vm.current_grid_type === grid_type },attrs:{\"type\":\"button\"},on:{\"click\":function($event){_vm.current_grid_type = grid_type}}},[_vm._v(\" \"+_vm._s(_vm.$t(grid_type).toLowerCase())+\" \")])}),0):_vm._e()]):_vm._e()]),_c('transition',{attrs:{\"name\":\"enableMode\",\"duration\":800}},[(_vm.mode_just_changed)?_c('div',{staticClass:\"_mode_indicator\",domProps:{\"innerHTML\":_vm._s(_vm.$t(_vm.selected_mode))}}):_vm._e()]),_c('transition',{attrs:{\"name\":\"justCaptured\",\"duration\":200}},[(_vm.media_to_validate && _vm.must_validate_media)?_c('MediaPreviewBeforeValidation',{attrs:{\"media_to_validate\":_vm.media_to_validate,\"audio_output_deviceId\":_vm.audio_output_deviceId}}):_vm._e()],1)],1)]),_c('transition',{attrs:{\"name\":\"slideup\",\"duration\":150,\"mode\":\"out-in\"}},[_c('div',{staticClass:\"m_captureview--videoPane--bottom\"},[_c('transition',{attrs:{\"name\":\"fade_fast\",\"duration\":150}},[(_vm.is_sending_image)?_c('LoaderSpinner'):_vm._e()],1),_c('transition',{attrs:{\"name\":\"slideup\",\"duration\":150,\"mode\":\"out-in\"}},[(\n                !(_vm.media_to_validate && _vm.must_validate_media) &&\n                !_vm.is_validating_stopmotion_video\n              )?_c('div',{staticClass:\"m_captureview--videoPane--bottom--buttons\",class:{\n                'is--recording': _vm.is_recording && !_vm.video_recording_is_paused,\n                'is--sending_image': _vm.is_sending_image,\n              }},[_c('div',[(\n                    !_vm.is_recording &&\n                    !_vm.is_making_stopmotion &&\n                    !_vm.is_recording &&\n                    !_vm.delay_event\n                  )?[_c('button',{staticClass:\"bg-rouge button-inline\",class:{ 'is--active': _vm.show_capture_settings },attrs:{\"type\":\"button\",\"content\":_vm.$t('settings')},on:{\"click\":function($event){_vm.show_capture_settings = !_vm.show_capture_settings}}},[_c('svg',{staticClass:\"inline-svg inline-svg_larger\",attrs:{\"version\":\"1.1\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"xmlns:xlink\":\"http://www.w3.org/1999/xlink\",\"x\":\"0px\",\"y\":\"0px\",\"viewBox\":\"15 15 140 140\",\"xml:space\":\"preserve\"}},[_c('path',{staticStyle:{\"fill\":\"currentColor\"},attrs:{\"d\":\"M122.7,88.8v-10c0-1.1,0.6-2.1,1.6-2.6l9.6-4.9l-2-5.8l-11,1.6c-1.1,0.2-2.2-0.3-2.9-1.2l-6-8.1\\n                  c-0.7-0.9-0.8-2.1-0.3-3l4.8-9.6l-5.2-3.6l-7.7,7.5c-0.8,0.8-2,1-3.1,0.7l-9.9-3c-1.1-0.3-1.9-1.3-2.1-2.4L86.8,34h-6.4l-1.7,10.4\\n                  c-0.2,1.1-0.9,2-2,2.4L66.8,50c-1.1,0.3-2.2,0.1-3.1-0.7L55.9,42l-5.1,3.7l4.9,9.4c0.5,1,0.4,2.1-0.2,3l-6,8.2\\n                  c-0.6,0.9-1.8,1.4-2.9,1.2L35.8,66L34,71.8l9.7,4.8c1,0.5,1.7,1.5,1.7,2.6v10c0,1.1-0.6,2.1-1.6,2.6l-9.6,4.9l2,5.9l10.9-1.6\\n                  c1.1-0.2,2.2,0.3,2.9,1.2l6,8.1c0.7,0.9,0.8,2.1,0.3,3l-4.8,9.6l5.1,3.6l7.7-7.5c0.8-0.8,2-1,3.1-0.7l9.9,3\\n                  c1.1,0.3,1.9,1.3,2.1,2.4l1.9,10.4h6.4l1.7-10.4c0.2-1.1,0.9-2,2-2.4l9.9-3.2c1.1-0.3,2.2-0.1,3.1,0.7l7.8,7.3l5.1-3.7l-4.9-9.4\\n                  c-0.5-1-0.4-2.1,0.2-3l6-8.1c0.7-0.9,1.8-1.4,2.9-1.2l10.8,1.5l1.8-5.9l-9.7-4.8C123.3,90.9,122.7,89.9,122.7,88.8z M84,104.5\\n                  c-11.7,0-21.1-9.2-21.1-20.5c0-11.3,9.5-20.5,21.1-20.5s21.1,9.2,21.1,20.5C105.1,95.3,95.7,104.5,84,104.5z\"}})])]),_c('button',{staticClass:\"button-inline bg-bleumarine\",class:{ 'is--active': _vm.show_effects_pane },attrs:{\"type\":\"button\",\"content\":_vm.$t('effects')},on:{\"click\":function($event){_vm.show_effects_pane = !_vm.show_effects_pane}}},[_c('svg',{staticClass:\"inline-svg inline-svg_larger\",attrs:{\"xmlns\":\"http://www.w3.org/2000/svg\",\"viewBox\":\"0 0 168 168\"}},[_c('path',{staticStyle:{\"fill\":\"#fc4b60\",\"stroke\":\"#fc4b60\",\"stroke-miterlimit\":\"10\",\"stroke-width\":\"2.8346456692913384px\"},attrs:{\"d\":\"M110.3488,72.0093,114.6377,59.36a4.4236,4.4236,0,0,0-1.07-4.59,4.4946,4.4946,0,0,0-4.59-1.0745L96.3334,57.9846,85.62,50a4.5219,4.5219,0,0,0-4.6965-.4029,4.4316,4.4316,0,0,0-2.4409,4.0388l.1714,13.3577L67.7468,74.7049A4.4686,4.4686,0,0,0,68.9974,82.62L79.2565,85.807,38.1043,126.9546a2.3155,2.3155,0,1,0,3.2745,3.2746L82.5311,89.0769l3.1865,10.2638a4.4571,4.4571,0,0,0,3.5664,3.08c.12.0185.579.0556.704.0556a4.4844,4.4844,0,0,0,3.6451-1.88L101.35,89.6883l13.6078.1621a4.6074,4.6074,0,0,0,3.784-2.4316,4.4328,4.4328,0,0,0-.3983-4.6965ZM100.1869,85.0381a2.5322,2.5322,0,0,0-1.9221.9773L90.039,97.6409,85.8149,84.0423a2.3238,2.3238,0,0,0-1.5192-1.5238l-13.8764-4.03,11.8987-8.42a2.3208,2.3208,0,0,0,.9773-1.9221L82.846,53.71l11.6764,8.7168a2.3569,2.3569,0,0,0,2.1259.3381l13.5986-4.8911L105.56,71.6758a2.3135,2.3135,0,0,0,.3428,2.1259l8.8464,11.417Z\"}}),_c('path',{staticStyle:{\"fill\":\"#fc4b60\",\"stroke\":\"#fc4b60\",\"stroke-miterlimit\":\"10\",\"stroke-width\":\"2.8346456692913384px\"},attrs:{\"d\":\"M58.9467,42.2277h2.3158v2.3158a2.3159,2.3159,0,1,0,4.6317,0V42.2277H68.21a2.3159,2.3159,0,0,0,0-4.6317H65.8942V35.28a2.3159,2.3159,0,0,0-4.6317,0V37.596H58.9467a2.3159,2.3159,0,0,0,0,4.6317Z\"}}),_c('path',{staticStyle:{\"fill\":\"#fc4b60\",\"stroke\":\"#fc4b60\",\"stroke-miterlimit\":\"10\",\"stroke-width\":\"2.8346456692913384px\"},attrs:{\"d\":\"M49.6834,65.386h2.3158v2.3158a2.3159,2.3159,0,0,0,4.6317,0V65.386h2.3158a2.3159,2.3159,0,0,0,0-4.6317H56.6309V58.4385a2.3159,2.3159,0,0,0-4.6317,0v2.3158H49.6834a2.3159,2.3159,0,0,0,0,4.6317Z\"}}),_c('path',{staticStyle:{\"fill\":\"#fc4b60\",\"stroke\":\"#fc4b60\",\"stroke-miterlimit\":\"10\",\"stroke-width\":\"2.8346456692913384px\"},attrs:{\"d\":\"M133.0531,102.4392h-2.3158v-2.3158a2.3159,2.3159,0,0,0-4.6317,0v2.3158H123.79a2.3159,2.3159,0,0,0,0,4.6317h2.3158v2.3158a2.3159,2.3159,0,1,0,4.6317,0v-2.3158h2.3158a2.3159,2.3159,0,0,0,0-4.6317Z\"}}),_c('path',{staticStyle:{\"fill\":\"#fc4b60\",\"stroke\":\"#fc4b60\",\"stroke-miterlimit\":\"10\",\"stroke-width\":\"2.8346456692913384px\"},attrs:{\"d\":\"M109.8949,111.7026H107.579v-2.3159a2.3158,2.3158,0,1,0-4.6316,0v2.3159h-2.3158a2.3158,2.3158,0,1,0,0,4.6316h2.3158V118.65a2.3158,2.3158,0,1,0,4.6316,0v-2.3158h2.3159a2.3158,2.3158,0,0,0,0-4.6316Z\"}}),_c('path',{staticStyle:{\"fill\":\"#fc4b60\",\"stroke\":\"#fc4b60\",\"stroke-miterlimit\":\"10\",\"stroke-width\":\"2.8346456692913384px\"},attrs:{\"d\":\"M119.1582,46.8594h2.3158v2.3158a2.3158,2.3158,0,1,0,4.6316,0V46.8594h2.3159a2.3159,2.3159,0,0,0,0-4.6317h-2.3159V39.9119a2.3158,2.3158,0,1,0-4.6316,0v2.3158h-2.3158a2.3159,2.3159,0,1,0,0,4.6317Z\"}})])])]:_vm._e(),(_vm.selected_mode === 'video' && _vm.is_recording)?_c('button',{key:_vm.selected_mode + '_pause',staticClass:\"bg-orange button-inline _captureButton\",attrs:{\"type\":\"button\"},on:{\"mousedown\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.pauseOrResumeCapture()},\"touchstart\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.pauseOrResumeCapture()}}},[(!_vm.video_recording_is_paused)?[_c('svg',{staticClass:\"inline-svg inline-svg_larger\",staticStyle:{\"enable-background\":\"new 0 0 168 168\"},attrs:{\"version\":\"1.1\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"xmlns:xlink\":\"http://www.w3.org/1999/xlink\",\"x\":\"0px\",\"y\":\"0px\",\"viewBox\":\"0 0 168 168\",\"xml:space\":\"preserve\"}},[_c('path',{staticStyle:{\"fill\":\"#ffbe32\"},attrs:{\"id\":\"FOND_3_\",\"d\":\"M84,0C37.6,0,0,37.6,0,84c0,46.4,37.6,84,84,84c46.4,0,84-37.6,84-84\\n\\t\\t\\tC168,37.6,130.4,0,84,0z\"}}),_c('rect',{staticStyle:{\"fill\":\"#ff3e51\"},attrs:{\"id\":\"CENTRE_3_\",\"x\":\"35\",\"y\":\"46.7\",\"width\":\"38\",\"height\":\"76\"}}),_c('rect',{staticStyle:{\"fill\":\"#ff3e51\"},attrs:{\"id\":\"CENTRE_3_\",\"x\":\"93\",\"y\":\"46.7\",\"width\":\"38\",\"height\":\"76\"}})]),_vm._v(\"  \"),_c('span',[_vm._v(\" \"+_vm._s(_vm.$t(\"pause_recording\"))+\" \")])]:[_c('svg',{staticClass:\"inline-svg inline-svg_larger\",staticStyle:{\"enable-background\":\"new 0 0 168 168\"},attrs:{\"version\":\"1.1\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"xmlns:xlink\":\"http://www.w3.org/1999/xlink\",\"x\":\"0px\",\"y\":\"0px\",\"viewBox\":\"0 0 168 168\",\"xml:space\":\"preserve\"}},[_c('path',{staticStyle:{\"fill\":\"#ffbe32\"},attrs:{\"id\":\"FOND_3_\",\"d\":\"M84,0C37.6,0,0,37.6,0,84c0,46.4,37.6,84,84,84c46.4,0,84-37.6,84-84\\n\\t\\t\\tC168,37.6,130.4,0,84,0z\"}}),_c('polygon',{staticStyle:{\"fill\":\"#ff3e51\"},attrs:{\"points\":\"45 40, 130 84.7, 45 128\"}})]),_vm._v(\"  \"),_c('span',[_vm._v(\" \"+_vm._s(_vm.$t(\"unpause_recording\"))+\" \")])]],2):_vm._e(),(\n                    _vm.selected_mode === 'stopmotion' &&\n                    _vm.is_making_stopmotion &&\n                    !_vm.timelapse_event\n                  )?_c('button',{key:_vm.selected_mode + '_pause',staticClass:\"bg-orange button-inline _captureButton\",attrs:{\"type\":\"button\"},on:{\"mousedown\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.stopStopmotion()},\"touchstart\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.stopStopmotion()}}},[_vm._v(\" \"+_vm._s(_vm.$t(\"stop_stopmotion\"))+\" \")]):_vm._e()],2),_c('div',[_c('transition',{attrs:{\"name\":\"fade_fast\",\"mode\":\"out-in\"}},[(!_vm.is_recording)?_c('button',{key:_vm.selected_mode + _vm.is_recording,staticClass:\"bg-orange button-inline _captureButton\",attrs:{\"type\":\"button\",\"disabled\":_vm.is_sending_image},on:{\"mousedown\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.setCaptureInit()},\"touchstart\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.setCaptureInit()}}},[(_vm.delay_event)?_c('span',[_vm._v(\" \"+_vm._s(_vm.$t(\"cancel\"))+\" \")]):[_c('img',{staticClass:\"inline-svg inline-svg_larger\",attrs:{\"src\":_vm.$root.publicPath + 'images/i_record.svg'}}),_vm._v(\"  \"),(\n                          ['photo', 'vecto', 'lines'].includes(_vm.selected_mode)\n                        )?_c('span',{domProps:{\"innerHTML\":_vm._s(_vm.$t('take_picture'))}}):(_vm.selected_mode === 'video')?_c('span',{domProps:{\"innerHTML\":_vm._s(_vm.$t('record_video'))}}):(_vm.selected_mode === 'audio')?_c('span',{domProps:{\"innerHTML\":_vm._s(_vm.$t('record_audio'))}}):(_vm.selected_mode === 'stopmotion')?_c('span',{domProps:{\"innerHTML\":_vm._s(\n                          !_vm.timelapse_mode_enabled\n                            ? _vm.$t('take_picture')\n                            : _vm.$t('start_timelapse')\n                        )}}):_vm._e()]],2):(_vm.is_recording)?_c('button',{key:_vm.selected_mode + _vm.is_recording,staticClass:\"bg-orange button-inline _captureButton\",attrs:{\"type\":\"button\",\"disabled\":_vm.is_sending_image},on:{\"mousedown\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.stopRecording()},\"touchstart\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.stopRecording()}}},[(_vm.is_sending_image && false)?_c('span',[_vm._v(\" \"+_vm._s(_vm.$t(\"loading\"))+\" \")]):[_c('img',{staticClass:\"inline-svg inline-svg_larger\",attrs:{\"src\":\"/images/i_stop.svg\"}}),_vm._v(\"  \"),(['video', 'audio'].includes(_vm.selected_mode))?_c('span',[_vm._v(\" \"+_vm._s(_vm.$t(\"stop_recording\"))+\" \")]):(_vm.selected_mode === 'stopmotion')?_c('span',[(_vm.timelapse_mode_enabled)?[_vm._v(\" \"+_vm._s(_vm.$t(\"stop_timelapse\"))+\" \")]:_vm._e()],2):_c('span',[_vm._v(\" \"+_vm._s(_vm.$t(\"stop\"))+\" \")])]],2):_vm._e()]),_c('transition',{attrs:{\"name\":\"fade_fast\",\"mode\":\"out-in\"}},[(_vm.selected_mode === 'stopmotion' && !_vm.timelapse_event)?_c('button',{staticClass:\"_enable_timelapse_button\",class:{ 'is--active': _vm.timelapse_mode_enabled },attrs:{\"type\":\"button\",\"content\":_vm.$t('timelapse')},on:{\"click\":function($event){_vm.timelapse_mode_enabled = !_vm.timelapse_mode_enabled}}},[_c('svg',{staticClass:\"inline-svg margin-right-verysmall\",staticStyle:{\"enable-background\":\"new 0 0 81 81\"},attrs:{\"version\":\"1.1\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"xmlns:xlink\":\"http://www.w3.org/1999/xlink\",\"x\":\"0px\",\"y\":\"0px\",\"width\":\"81px\",\"height\":\"81px\",\"viewBox\":\"0 0 81 81\",\"xml:space\":\"preserve\"}},[_c('path',{attrs:{\"d\":\"M69.6,20.8c-0.9,0.6-1.7,1.1-2.6,1.7c-6-8.8-15.9-14-26.5-14c-17.6,0-32,14.4-32,32s14.4,32,32,32\\n                  c3.1,0,6.2-0.4,9.1-1.3l-1.7-5.8c-2.4,0.7-4.9,1.1-7.4,1.1c-14.3,0-26-11.7-26-26s11.7-26,26-26c8.6,0,16.6,4.2,21.5,11.4\\n                  c-0.8,0.5-1.6,1.1-2.4,1.6c-0.7,0.4-0.9,1.1-0.8,1.7c0,0.7,0.4,1.4,1.2,1.6c0.2,0.1,0.3,0.1,0.5,0.1c2.7,0.5,5.3,1.1,8,1.6\\n                  c1,0.2,2-0.4,2.3-1.4c0.6-2.8,1.1-5.5,1.7-8.3C72.8,21.3,71,19.9,69.6,20.8z\"}}),_c('path',{attrs:{\"d\":\"M23,49.4c-1.3,0-2.4-0.8-2.9-2.1c-0.5-1.6,0.4-3.3,1.9-3.8L39,38.3V27.2c0-1.7,1.3-3,3-3s3,1.3,3,3v13.3\\n                  c0,1.3-0.8,2.5-2.1,2.9l-19,5.9C23.6,49.4,23.3,49.4,23,49.4z\"}})])]):_vm._e()]),_c('transition',{attrs:{\"name\":\"fade_fast\",\"mode\":\"out-in\"}},[(!_vm.is_recording)?_c('button',{staticClass:\"_enable_timelapse_button\",class:{ 'is--active': _vm.delay_mode_enabled },attrs:{\"type\":\"button\",\"content\":_vm.$t('delay')},on:{\"click\":function($event){_vm.delay_mode_enabled = !_vm.delay_mode_enabled}}},[_c('svg',{staticClass:\"inline-svg margin-right-verysmall\",staticStyle:{\"enable-background\":\"new 0 0 81 81\"},attrs:{\"version\":\"1.1\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"xmlns:xlink\":\"http://www.w3.org/1999/xlink\",\"x\":\"0px\",\"y\":\"0px\",\"width\":\"81px\",\"height\":\"81px\",\"viewBox\":\"0 0 81 81\",\"xml:space\":\"preserve\"}},[_c('path',{attrs:{\"d\":\"M40.5,72.3c-15,0-27.1-12.2-27.1-27.1c0-15,12.2-27.1,27.1-27.1s27.1,12.2,27.1,27.1C67.6,60.2,55.5,72.3,40.5,72.3z\\n\\t M40.5,23.7C28.7,23.7,19,33.4,19,45.2s9.6,21.5,21.5,21.5S62,57,62,45.2S52.3,23.7,40.5,23.7z\"}}),_c('path',{attrs:{\"d\":\"M40.5,48c-1.6,0-2.8-1.3-2.8-2.8l0-16.8c0-1.6,1.3-2.8,2.8-2.8s2.8,1.3,2.8,2.8l0,16.8C43.3,46.8,42.1,48,40.5,48z\"}}),_c('rect',{attrs:{\"x\":\"32.1\",\"y\":\"10.7\",\"width\":\"16.8\",\"height\":\"5.7\"}}),_c('rect',{attrs:{\"x\":\"57.9\",\"y\":\"22.4\",\"transform\":\"matrix(0.7069 -0.7073 0.7073 0.7069 2.864400e-02 50.6141)\",\"width\":\"6.3\",\"height\":\"5.7\"}})])]):_vm._e()])],1),_c('div',[(_vm.selected_mode === 'video')?_c('div',{staticClass:\"flex-wrap flex-vertically-centered\"},[(_vm.enable_audio_recording_in_video)?_c('div',{staticClass:\"_tiny_equalizer\"},[_c('AudioEqualizer',{attrs:{\"stream\":_vm.stream,\"is_recording\":_vm.is_recording,\"type\":'Tiny'}})],1):_vm._e(),(!_vm.is_recording)?_c('span',{staticClass:\"switch switch-xs\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.enable_audio_recording_in_video),expression:\"enable_audio_recording_in_video\"}],staticClass:\"switch\",attrs:{\"id\":\"recordVideoWithAudio\",\"type\":\"checkbox\",\"disabled\":_vm.is_recording},domProps:{\"checked\":Array.isArray(_vm.enable_audio_recording_in_video)?_vm._i(_vm.enable_audio_recording_in_video,null)>-1:(_vm.enable_audio_recording_in_video)},on:{\"change\":function($event){var $$a=_vm.enable_audio_recording_in_video,$$el=$event.target,$$c=$$el.checked?(true):(false);if(Array.isArray($$a)){var $$v=null,$$i=_vm._i($$a,$$v);if($$el.checked){$$i<0&&(_vm.enable_audio_recording_in_video=$$a.concat([$$v]))}else{$$i>-1&&(_vm.enable_audio_recording_in_video=$$a.slice(0,$$i).concat($$a.slice($$i+1)))}}else{_vm.enable_audio_recording_in_video=$$c}}}}),_c('label',{attrs:{\"for\":\"recordVideoWithAudio\"}},[_vm._v(_vm._s(_vm.$t(\"with_sound\")))])]):_vm._e()]):_vm._e(),(\n                    _vm.selected_mode === 'stopmotion' &&\n                    _vm.stopmotion.onion_skin_img &&\n                    _vm.show_live_feed &&\n                    _vm.is_making_stopmotion &&\n                    !_vm.timelapse_event\n                  )?_c('div',{staticClass:\"_mode_accessory_range\"},[_c('label',[_vm._v(_vm._s(_vm.$t(\"onion_skin\"))+\" \")]),_c('input',{directives:[{name:\"model\",rawName:\"v-model.number\",value:(_vm.stopmotion.onion_skin_opacity),expression:\"stopmotion.onion_skin_opacity\",modifiers:{\"number\":true}}],staticClass:\"_rtl\",attrs:{\"type\":\"range\",\"min\":\"0\",\"max\":\".9\",\"step\":\"0.01\",\"title\":_vm.stopmotion.onion_skin_opacity,\"data-use\":\"onionskin\"},domProps:{\"value\":(_vm.stopmotion.onion_skin_opacity)},on:{\"__r\":function($event){_vm.$set(_vm.stopmotion, \"onion_skin_opacity\", _vm._n($event.target.value))},\"blur\":function($event){return _vm.$forceUpdate()}}})]):_vm._e(),(_vm.selected_mode === 'stopmotion' && !_vm.is_making_stopmotion)?_c('button',{staticClass:\"bg-bleumarine font-small\",attrs:{\"type\":\"button\"},on:{\"click\":function($event){_vm.show_stopmotion_list = !_vm.show_stopmotion_list}}},[_c('span',{},[_vm._v(_vm._s(_vm.$t(\"stopmotion_list\")))])]):_vm._e(),(_vm.selected_mode === 'vecto')?_c('div',{staticClass:\"_mode_accessory_range\"},[_c('label',[_vm._v(_vm._s(_vm.$t(\"number_of_colors\"))+\" = \"+_vm._s(_vm.vecto_number_of_colors))]),_c('input',{directives:[{name:\"model\",rawName:\"v-model.number\",value:(_vm.vecto_number_of_colors),expression:\"vecto_number_of_colors\",modifiers:{\"number\":true}}],attrs:{\"type\":\"range\",\"min\":\"2\",\"max\":\"7\",\"step\":\"1\"},domProps:{\"value\":(_vm.vecto_number_of_colors)},on:{\"__r\":function($event){_vm.vecto_number_of_colors=_vm._n($event.target.value)},\"blur\":function($event){return _vm.$forceUpdate()}}})]):_vm._e(),(_vm.selected_mode === 'lines')?_c('button',{staticClass:\"u-buttonLink\",class:{ 'is--active': _vm.show_lines_settings },attrs:{\"type\":\"button\"},on:{\"click\":function($event){_vm.show_lines_settings = !_vm.show_lines_settings}}},[_vm._v(\" \"+_vm._s(_vm.$t(\"advanced_options\"))+\" \")]):_vm._e(),(_vm.show_lines_settings)?[(_vm.selected_mode === 'lines')?_c('div',{staticClass:\"_mode_accessory_range\"},[_c('label',[_vm._v(_vm._s(_vm.$t(\"lines_angle\"))+\" = \"+_vm._s(_vm.lines_angle))]),_c('input',{directives:[{name:\"model\",rawName:\"v-model.number\",value:(_vm.lines_angle),expression:\"lines_angle\",modifiers:{\"number\":true}}],attrs:{\"type\":\"range\",\"min\":\"0\",\"max\":\"359\",\"step\":\"1\"},domProps:{\"value\":(_vm.lines_angle)},on:{\"__r\":function($event){_vm.lines_angle=_vm._n($event.target.value)},\"blur\":function($event){return _vm.$forceUpdate()}}})]):_vm._e(),(_vm.selected_mode === 'lines')?_c('div',{staticClass:\"_mode_accessory_range\"},[_c('label',[_vm._v(_vm._s(_vm.$t(\"brightness\"))+\" = \"+_vm._s(_vm.lines_brightness))]),_c('input',{directives:[{name:\"model\",rawName:\"v-model.number\",value:(_vm.lines_brightness),expression:\"lines_brightness\",modifiers:{\"number\":true}}],staticClass:\"margin-none\",attrs:{\"type\":\"range\",\"min\":\".1\",\"max\":\"5\",\"step\":\".1\"},domProps:{\"value\":(_vm.lines_brightness)},on:{\"__r\":function($event){_vm.lines_brightness=_vm._n($event.target.value)},\"blur\":function($event){return _vm.$forceUpdate()}}})]):_vm._e(),(_vm.selected_mode === 'lines')?_c('div',{staticClass:\"_mode_accessory_range\"},[_c('label',[_vm._v(_vm._s(_vm.$t(\"contrast\"))+\" = \"+_vm._s(_vm.lines_contrast))]),_c('input',{directives:[{name:\"model\",rawName:\"v-model.number\",value:(_vm.lines_contrast),expression:\"lines_contrast\",modifiers:{\"number\":true}}],staticClass:\"margin-none\",attrs:{\"type\":\"range\",\"min\":\".1\",\"max\":\"5\",\"step\":\".1\"},domProps:{\"value\":(_vm.lines_contrast)},on:{\"__r\":function($event){_vm.lines_contrast=_vm._n($event.target.value)},\"blur\":function($event){return _vm.$forceUpdate()}}})]):_vm._e(),(_vm.selected_mode === 'lines')?_c('div',{staticClass:\"_mode_accessory_range\"},[_c('label',[_vm._v(_vm._s(_vm.$t(\"lines_density\"))+\" = \"+_vm._s(_vm.lines_density))]),_c('input',{directives:[{name:\"model\",rawName:\"v-model.number\",value:(_vm.lines_density),expression:\"lines_density\",modifiers:{\"number\":true}}],staticClass:\"margin-none\",attrs:{\"type\":\"range\",\"min\":\"0.2\",\"max\":\"0.3\",\"step\":\".01\"},domProps:{\"value\":(_vm.lines_density)},on:{\"__r\":function($event){_vm.lines_density=_vm._n($event.target.value)},\"blur\":function($event){return _vm.$forceUpdate()}}})]):_vm._e()]:_vm._e()],2)]):(_vm.media_to_validate && _vm.must_validate_media)?_c('div',{key:\"validation\"},[_c('div',{staticClass:\"_download_media_without_validation\"},[_c('small',[_c('a',{ref:\"\",attrs:{\"href\":_vm.validated_media_href_blob,\"download\":_vm.media_to_validate.temp_name,\"target\":\"_blank\"}},[_vm._v(\" \"+_vm._s(_vm.$t(\"or_download_media_on_device\"))+\" \"),(_vm.media_to_validate.rawData)?[_vm._v(\"  \"+_vm._s(_vm.$root.formatBytes(_vm.media_to_validate.rawData.size))+\" \")]:_vm._e()],2)])]),_c('MediaValidationButtons',{attrs:{\"read_only\":_vm.read_only,\"can_add_to_fav\":_vm.can_add_to_fav,\"media_is_being_sent\":_vm.media_is_being_sent,\"media_being_sent_percent\":_vm.media_being_sent_percent},on:{\"cancel\":function($event){return _vm.cancelValidation()},\"save\":function($event){return _vm.sendMedia({})},\"save_and_fav\":function($event){return _vm.sendMedia({ fav: true })}}})],1):_vm._e()])],1)])],1),(_vm.show_stopmotion_list && !_vm.is_making_stopmotion)?_c('StopmotionList',{attrs:{\"slugFolderName\":_vm.slugFolderName},on:{\"loadStopmotion\":_vm.loadStopmotion}}):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return (_vm.media_to_validate)?_c('div',{staticClass:\"m_previewValidation\"},[(_vm.media_to_validate.type === 'image')?_c('img',{attrs:{\"src\":_vm.media_to_validate.objectURL}}):(_vm.media_to_validate.type === 'video')?_c('vue-plyr',{staticClass:\"m_previewValidation--video\",attrs:{\"options\":_vm.plyr_options}},[_c('video',{ref:\"videoElement\",attrs:{\"poster\":_vm.linkToVideoThumb,\"src\":_vm.media_to_validate.objectURL,\"preload\":\"none\"}})]):(_vm.media_to_validate.type === 'audio')?_c('div',{staticClass:\"m_previewValidation--audio\"},[_c('img',{attrs:{\"src\":_vm.media_to_validate.preview}}),_c('vue-plyr',{attrs:{\"options\":_vm.plyr_options}},[_c('audio',{ref:\"audioElement\",attrs:{\"src\":_vm.media_to_validate.objectURL,\"preload\":\"none\"},on:{\"canplay\":_vm.updatePaused,\"playing\":_vm.updatePaused,\"pause\":_vm.updatePaused}}),(_vm.is_paused)?_c('div',{staticClass:\"play_picto\",on:{\"click\":_vm.play}},[_c('svg',{staticStyle:{\"enable-background\":\"new 0 0 169 169\"},attrs:{\"version\":\"1.1\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"xmlns:xlink\":\"http://www.w3.org/1999/xlink\",\"x\":\"0px\",\"y\":\"0px\",\"width\":\"169px\",\"height\":\"169px\",\"viewBox\":\"0 0 169 169\",\"xml:space\":\"preserve\"}},[_c('path',{attrs:{\"d\":\"M53.2,138.4c-4.6,3-8.4,0.9-8.4-4.6V30.4c0-5.5,3.8-7.6,8.4-4.6l78.5,50.9c4.6,3,4.6,7.9,0,10.9L53.2,138.4z\"}})])]):_vm._e()])],1):(_vm.media_to_validate.type === 'svg')?_c('div',{staticClass:\"m_previewValidation--svg\",domProps:{\"innerHTML\":_vm._s(_vm.media_to_validate.preview)}}):_vm._e()],1):_vm._e()}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"m_previewValidation\" v-if=\"media_to_validate\">\n    <img\n      v-if=\"media_to_validate.type === 'image'\"\n      :src=\"media_to_validate.objectURL\"\n    />\n    <vue-plyr\n      class=\"m_previewValidation--video\"\n      v-else-if=\"media_to_validate.type === 'video'\"\n      :options=\"plyr_options\"\n    >\n      <video\n        ref=\"videoElement\"\n        :poster=\"linkToVideoThumb\"\n        :src=\"media_to_validate.objectURL\"\n        preload=\"none\"\n      />\n    </vue-plyr>\n    <div\n      v-else-if=\"media_to_validate.type === 'audio'\"\n      class=\"m_previewValidation--audio\"\n    >\n      <img :src=\"media_to_validate.preview\" />\n      <vue-plyr :options=\"plyr_options\">\n        <audio\n          ref=\"audioElement\"\n          :src=\"media_to_validate.objectURL\"\n          preload=\"none\"\n          @canplay=\"updatePaused\"\n          @playing=\"updatePaused\"\n          @pause=\"updatePaused\"\n        />\n        <div class=\"play_picto\" @click=\"play\" v-if=\"is_paused\">\n          <svg\n            class\n            version=\"1.1\"\n            xmlns=\"http://www.w3.org/2000/svg\"\n            xmlns:xlink=\"http://www.w3.org/1999/xlink\"\n            x=\"0px\"\n            y=\"0px\"\n            width=\"169px\"\n            height=\"169px\"\n            viewBox=\"0 0 169 169\"\n            style=\"enable-background: new 0 0 169 169\"\n            xml:space=\"preserve\"\n          >\n            <path\n              d=\"M53.2,138.4c-4.6,3-8.4,0.9-8.4-4.6V30.4c0-5.5,3.8-7.6,8.4-4.6l78.5,50.9c4.6,3,4.6,7.9,0,10.9L53.2,138.4z\"\n            />\n          </svg>\n        </div>\n      </vue-plyr>\n    </div>\n    <div\n      v-else-if=\"media_to_validate.type === 'svg'\"\n      v-html=\"media_to_validate.preview\"\n      class=\"m_previewValidation--svg\"\n    />\n  </div>\n</template>\n<script>\nexport default {\n  props: {\n    media_to_validate: Object,\n    audio_output_deviceId: String,\n  },\n  components: {},\n  data() {\n    return {\n      is_paused: false,\n\n      plyr_options: {\n        controls: [\n          \"play-large\",\n          \"play\",\n          \"progress\",\n          \"current-time\",\n          \"mute\",\n          \"volume\",\n          \"fullscreen\",\n        ],\n        iconUrl: \"/images/plyr.svg\",\n      },\n    };\n  },\n  created() {},\n  mounted() {\n    this.setSinkId();\n  },\n  beforeDestroy() {},\n  watch: {\n    audio_output_deviceId: {\n      handler() {\n        this.setSinkId();\n      },\n    },\n  },\n  computed: {},\n  methods: {\n    setSinkId() {\n      if (!this.audio_output_deviceId) return;\n\n      if (this.media_to_validate.type === \"video\") {\n        this.$refs.videoElement.setSinkId(this.audio_output_deviceId);\n      } else if (this.media_to_validate.type === \"audio\") {\n        this.$refs.audioElement.setSinkId(this.audio_output_deviceId);\n      }\n    },\n    play() {\n      this.$refs.audioElement.play();\n    },\n    updatePaused(event) {\n      this.videoElement = event.target;\n      this.is_paused = event.target.paused;\n    },\n  },\n};\n</script>\n<style lang=\"scss\" scoped>\n.m_previewValidation {\n  position: absolute;\n  top: 0;\n  left: 0;\n  // background-color: var(--c-noir);\n\n  display: flex;\n  justify-content: center;\n  align-items: center;\n\n  width: 100%;\n  height: 100%;\n  object-fit: contain;\n\n  > * {\n    // position: absolute;\n    object-fit: contain;\n    width: 100%;\n    height: 100%;\n    margin: 0;\n    // .padding-medium;\n  }\n  .m_previewValidation--audio {\n    height: 100%;\n    width: 100%;\n    display: flex;\n    flex-flow: column nowrap;\n\n    .plyr .plyr__controls {\n      color: white;\n    }\n\n    img {\n      object-fit: contain;\n    }\n\n    > * {\n      flex: 1 1 auto;\n      // width: 100%;\n      // height: 100%;\n      height: 90%;\n\n      &:last-child {\n        height: auto;\n      }\n    }\n  }\n}\n\n.play_picto {\n  position: absolute;\n  top: 0;\n  left: 0;\n  svg {\n    width: 50px;\n    height: 50px;\n    padding: 10px;\n    border-radius: 50%;\n  }\n}\n</style>\n<style lang=\"scss\">\n.m_previewValidation--svg {\n  svg {\n    width: 100%;\n    height: 100%;\n    max-width: 100%;\n    margin: auto;\n  }\n}\n</style>\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-37[0].rules[0].use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./MediaPreviewBeforeValidation.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-37[0].rules[0].use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./MediaPreviewBeforeValidation.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./MediaPreviewBeforeValidation.vue?vue&type=template&id=0f193272&scoped=true&\"\nimport script from \"./MediaPreviewBeforeValidation.vue?vue&type=script&lang=js&\"\nexport * from \"./MediaPreviewBeforeValidation.vue?vue&type=script&lang=js&\"\nimport style0 from \"./MediaPreviewBeforeValidation.vue?vue&type=style&index=0&id=0f193272&lang=scss&scoped=true&\"\nimport style1 from \"./MediaPreviewBeforeValidation.vue?vue&type=style&index=1&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"0f193272\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"m_mediaValidationButtons\"},[_c('button',{staticClass:\"bg-transparent button-arrow\",attrs:{\"type\":\"button\"},on:{\"click\":_vm.selectedMoveLeft}},[_c('svg',{staticStyle:{\"enable-background\":\"new 0 0 169 169\"},attrs:{\"version\":\"1.1\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"xmlns:xlink\":\"http://www.w3.org/1999/xlink\",\"x\":\"0px\",\"y\":\"0px\",\"width\":\"169px\",\"height\":\"169px\",\"viewBox\":\"0 0 169 169\",\"xml:space\":\"preserve\"}},[_c('path',{attrs:{\"fill\":\"currentColor\",\"d\":\"M60.2,84.5l48.6-24.3l0,48.6L60.2,84.5z\"}})])]),_c('button',{staticClass:\"button button-bg_rounded button-outline c-blanc\",class:{ 'is--selected': _vm.selected_button === 0 },attrs:{\"type\":\"button\"},on:{\"mousedown\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.validateButton(0)},\"touchstart\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.validateButton(0)},\"mouseover\":function($event){_vm.selected_button = 0}}},[(_vm.cancelButtonIsBackButton)?[_c('span',{},[_vm._v(\" \"+_vm._s(_vm.$t(\"back\")))])]:[_c('svg',{staticStyle:{\"enable-background\":\"new 0 0 168 168\"},attrs:{\"version\":\"1.1\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"xmlns:xlink\":\"http://www.w3.org/1999/xlink\",\"x\":\"0px\",\"y\":\"0px\",\"viewBox\":\"0 0 168 168\",\"xml:space\":\"preserve\"}},[_c('polygon',{attrs:{\"points\":\"42.6,57.2 57.5,42.4 84.1,69 110.8,42.4 125.6,57.2 99,83.9 125.6,110.5 110.8,125.4 \\n      84.1,98.7 57.5,125.4 42.6,110.5 69.3,83.9 \\t\\t\\t\"}})]),_c('span',{},[_vm._v(_vm._s(_vm.$t(\"cancel\")))])]],2),_c('button',{staticClass:\"button button-bg_rounded button-outline c-rouge\",class:{ 'is--selected': _vm.selected_button === 1 },attrs:{\"type\":\"button\",\"disabled\":_vm.read_only},on:{\"click\":function($event){return _vm.validateButton(1)},\"mouseover\":function($event){_vm.selected_button = 1}}},[_c('svg',{staticStyle:{\"enable-background\":\"new 0 0 168 168\"},attrs:{\"version\":\"1.1\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"xmlns:xlink\":\"http://www.w3.org/1999/xlink\",\"x\":\"0px\",\"y\":\"0px\",\"viewBox\":\"0 0 168 168\",\"xml:space\":\"preserve\"}},[_c('rect',{attrs:{\"x\":\"51.4\",\"y\":\"73.1\",\"transform\":\"matrix(0.7071 -0.7071 0.7071 0.7071 -53.857 72.9892)\",\"width\":\"19.5\",\"height\":\"56.8\"}}),_c('rect',{attrs:{\"x\":\"53.2\",\"y\":\"77.3\",\"transform\":\"matrix(0.7071 -0.7071 0.7071 0.7071 -31.6875 97.6563)\",\"width\":\"97.6\",\"height\":\"19.5\"}})]),_c('span',{staticClass:\"c-rouge\"},[_vm._v(_vm._s(_vm.$t(\"save\")))])]),(_vm.can_add_to_fav)?_c('button',{staticClass:\"button button-bg_rounded button-outline c-rouge\",class:{ 'is--selected': _vm.selected_button === 2 },attrs:{\"type\":\"button\",\"disabled\":_vm.read_only},on:{\"click\":function($event){return _vm.validateButton(2)},\"mouseover\":function($event){_vm.selected_button = 2}}},[_c('svg',{staticClass:\"padding-verysmall\",staticStyle:{\"enable-background\":\"new 0 0 78.5 106.4\"},attrs:{\"version\":\"1.1\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"xmlns:xlink\":\"http://www.w3.org/1999/xlink\",\"xmlns:a\":\"http://ns.adobe.com/AdobeSVGViewerExtensions/3.0/\",\"x\":\"0px\",\"y\":\"0px\",\"width\":\"68.5px\",\"height\":\"80.4px\",\"viewBox\":\"0 0 78.5 106.4\",\"xml:space\":\"preserve\"}},[_c('polygon',{staticClass:\"st0\",attrs:{\"points\":\"60.4,29.7 78.5,7.3 78.5,7.3 12.7,7.3 12.7,52 78.5,52 78.5,52 \\t\"}}),_c('polygon',{staticClass:\"st0\",attrs:{\"points\":\"9.6,106.4 0,106.4 0,2 9.6,0 \"}})]),_c('span',{},[_vm._v(\" \"+_vm._s(_vm.$t(\"save\"))+\" \"),_c('br'),_vm._v(\" \"+_vm._s(_vm.$t(\"as_favorite\"))+\" \")])]):_vm._e(),_c('button',{staticClass:\"bg-transparent button-arrow\",attrs:{\"type\":\"button\"},on:{\"click\":_vm.selectedMoveRight}},[_c('svg',{staticStyle:{\"enable-background\":\"new 0 0 169 169\"},attrs:{\"version\":\"1.1\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"xmlns:xlink\":\"http://www.w3.org/1999/xlink\",\"x\":\"0px\",\"y\":\"0px\",\"width\":\"169px\",\"height\":\"169px\",\"viewBox\":\"0 0 169 169\",\"xml:space\":\"preserve\"}},[_c('path',{attrs:{\"fill\":\"currentColor\",\"d\":\"M108.8,84.5l-48.6,24.3V60.2L108.8,84.5z\"}})])]),(_vm.media_is_being_sent)?_c('div',{staticClass:\"m_mediaValidationButtons--overlay\"},[_c('transition',{attrs:{\"name\":\"fade_fast\",\"duration\":150}},[_c('LoaderSpinner')],1),_c('span',{staticClass:\"m_mediaValidationButtons--overlay--percent\",domProps:{\"innerHTML\":_vm._s(_vm.media_being_sent_percent + '%')}})],1):_vm._e()])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"m_mediaValidationButtons\">\n    <button\n      type=\"button\"\n      class=\"bg-transparent button-arrow\"\n      @click=\"selectedMoveLeft\"\n    >\n      <svg\n        version=\"1.1\"\n        xmlns=\"http://www.w3.org/2000/svg\"\n        xmlns:xlink=\"http://www.w3.org/1999/xlink\"\n        x=\"0px\"\n        y=\"0px\"\n        width=\"169px\"\n        height=\"169px\"\n        viewBox=\"0 0 169 169\"\n        style=\"enable-background: new 0 0 169 169\"\n        xml:space=\"preserve\"\n      >\n        <path fill=\"currentColor\" d=\"M60.2,84.5l48.6-24.3l0,48.6L60.2,84.5z\" />\n      </svg>\n    </button>\n\n    <button\n      type=\"button\"\n      class=\"button button-bg_rounded button-outline c-blanc\"\n      @mousedown.stop.prevent=\"validateButton(0)\"\n      @touchstart.stop.prevent=\"validateButton(0)\"\n      :class=\"{ 'is--selected': selected_button === 0 }\"\n      @mouseover=\"selected_button = 0\"\n    >\n      <template v-if=\"cancelButtonIsBackButton\">\n        <span class> {{ $t(\"back\") }}</span>\n      </template>\n      <template v-else>\n        <svg\n          version=\"1.1\"\n          xmlns=\"http://www.w3.org/2000/svg\"\n          xmlns:xlink=\"http://www.w3.org/1999/xlink\"\n          x=\"0px\"\n          y=\"0px\"\n          viewBox=\"0 0 168 168\"\n          style=\"enable-background: new 0 0 168 168\"\n          xml:space=\"preserve\"\n        >\n          <polygon\n            points=\"42.6,57.2 57.5,42.4 84.1,69 110.8,42.4 125.6,57.2 99,83.9 125.6,110.5 110.8,125.4 \n        84.1,98.7 57.5,125.4 42.6,110.5 69.3,83.9 \t\t\t\"\n          />\n        </svg>\n        <span class>{{ $t(\"cancel\") }}</span>\n      </template>\n    </button>\n\n    <button\n      type=\"button\"\n      :disabled=\"read_only\"\n      @click=\"validateButton(1)\"\n      class=\"button button-bg_rounded button-outline c-rouge\"\n      :class=\"{ 'is--selected': selected_button === 1 }\"\n      @mouseover=\"selected_button = 1\"\n    >\n      <svg\n        version=\"1.1\"\n        class\n        xmlns=\"http://www.w3.org/2000/svg\"\n        xmlns:xlink=\"http://www.w3.org/1999/xlink\"\n        x=\"0px\"\n        y=\"0px\"\n        viewBox=\"0 0 168 168\"\n        style=\"enable-background: new 0 0 168 168\"\n        xml:space=\"preserve\"\n      >\n        <rect\n          x=\"51.4\"\n          y=\"73.1\"\n          transform=\"matrix(0.7071 -0.7071 0.7071 0.7071 -53.857 72.9892)\"\n          width=\"19.5\"\n          height=\"56.8\"\n        />\n        <rect\n          x=\"53.2\"\n          y=\"77.3\"\n          transform=\"matrix(0.7071 -0.7071 0.7071 0.7071 -31.6875 97.6563)\"\n          width=\"97.6\"\n          height=\"19.5\"\n        />\n      </svg>\n      <span class=\"c-rouge\">{{ $t(\"save\") }}</span>\n    </button>\n\n    <button\n      type=\"button\"\n      v-if=\"can_add_to_fav\"\n      :disabled=\"read_only\"\n      @click=\"validateButton(2)\"\n      class=\"button button-bg_rounded button-outline c-rouge\"\n      :class=\"{ 'is--selected': selected_button === 2 }\"\n      @mouseover=\"selected_button = 2\"\n    >\n      <svg\n        version=\"1.1\"\n        class=\"padding-verysmall\"\n        xmlns=\"http://www.w3.org/2000/svg\"\n        xmlns:xlink=\"http://www.w3.org/1999/xlink\"\n        xmlns:a=\"http://ns.adobe.com/AdobeSVGViewerExtensions/3.0/\"\n        x=\"0px\"\n        y=\"0px\"\n        width=\"68.5px\"\n        height=\"80.4px\"\n        viewBox=\"0 0 78.5 106.4\"\n        style=\"enable-background: new 0 0 78.5 106.4\"\n        xml:space=\"preserve\"\n      >\n        <polygon\n          class=\"st0\"\n          points=\"60.4,29.7 78.5,7.3 78.5,7.3 12.7,7.3 12.7,52 78.5,52 78.5,52 \t\"\n        />\n        <polygon class=\"st0\" points=\"9.6,106.4 0,106.4 0,2 9.6,0 \" />\n      </svg>\n      <span class>\n        {{ $t(\"save\") }}\n        <br />\n        {{ $t(\"as_favorite\") }}\n      </span>\n    </button>\n\n    <button\n      type=\"button\"\n      class=\"bg-transparent button-arrow\"\n      @click=\"selectedMoveRight\"\n    >\n      <svg\n        version=\"1.1\"\n        xmlns=\"http://www.w3.org/2000/svg\"\n        xmlns:xlink=\"http://www.w3.org/1999/xlink\"\n        x=\"0px\"\n        y=\"0px\"\n        width=\"169px\"\n        height=\"169px\"\n        viewBox=\"0 0 169 169\"\n        style=\"enable-background: new 0 0 169 169\"\n        xml:space=\"preserve\"\n      >\n        <path fill=\"currentColor\" d=\"M108.8,84.5l-48.6,24.3V60.2L108.8,84.5z\" />\n      </svg>\n    </button>\n\n    <div class=\"m_mediaValidationButtons--overlay\" v-if=\"media_is_being_sent\">\n      <transition name=\"fade_fast\" :duration=\"150\">\n        <LoaderSpinner />\n      </transition>\n      <span\n        class=\"m_mediaValidationButtons--overlay--percent\"\n        v-html=\"media_being_sent_percent + '%'\"\n      />\n    </div>\n  </div>\n</template>\n<script>\nexport default {\n  props: {\n    read_only: Boolean,\n    media_is_being_sent: Boolean,\n    media_being_sent_percent: Number,\n    cancelButtonIsBackButton: {\n      type: Boolean,\n      default: false,\n    },\n    can_add_to_fav: Boolean,\n  },\n  components: {},\n  data() {\n    return {\n      selected_button: 1,\n    };\n  },\n\n  created() {},\n  mounted() {\n    document.addEventListener(\"keyup\", this.captureKeyListener);\n  },\n  beforeDestroy() {\n    document.removeEventListener(\"keyup\", this.captureKeyListener);\n  },\n\n  watch: {},\n  computed: {},\n  methods: {\n    captureKeyListener(evt) {\n      console.log(\"METHODS  MediaValidationButtons: captureKeyListener\");\n\n      switch (evt.key) {\n        case \"w\":\n        case \"z\":\n        case \"ArrowLeft\":\n          this.selectedMoveLeft();\n          break;\n        case \"s\":\n        case \"ArrowRight\":\n          this.selectedMoveRight();\n          break;\n        case \"a\":\n        case \"q\":\n        case \" \":\n          this.validateButton(this.selected_button);\n          break;\n      }\n\n      evt.preventDefault();\n      return false;\n    },\n    selectedMoveLeft() {\n      console.log(\n        \"METHODS  MediaValidationButtons: captureKeyListener / goleft\"\n      );\n      this.selected_button += this.selected_button > 0 ? -1 : 0;\n    },\n    selectedMoveRight() {\n      console.log(\n        \"METHODS  MediaValidationButtons: captureKeyListener / goright\"\n      );\n      this.selected_button += this.selected_button < 2 ? +1 : 0;\n    },\n    validateButton(idx) {\n      if (idx === 0) {\n        this.$emit(\"cancel\");\n      } else if (idx === 1) {\n        this.$emit(\"save\");\n      } else if (idx === 2) {\n        this.$emit(\"save_and_fav\");\n      }\n    },\n  },\n};\n</script>\n<style lang=\"scss\" scoped>\n.m_mediaValidationButtons {\n  position: relative;\n  z-index: 105;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: calc(var(--spacing) / 2);\n  flex: 0 0 auto;\n  text-transform: uppercase;\n  font-weight: 500;\n  letter-spacing: 0.06em;\n\n  font-size: var(--font-verysmall);\n  height: auto;\n\n  background-color: var(--c-noir);\n\n  > * {\n    flex: 0 1 180px;\n    display: flex;\n    align-items: center;\n  }\n\n  .m_mediaValidationButtons--overlay {\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    background-color: rgba(53, 53, 53, 1);\n    --loader-bg-color: transparent;\n    --loader-border-color: var(--c-rouge);\n\n    ._loader {\n      background-color: transparent;\n    }\n\n    .m_mediaValidationButtons--overlay--percent {\n      position: absolute;\n      margin-left: 8em;\n      z-index: 55000;\n      color: white;\n      padding: 2px;\n      border-radius: 4px;\n    }\n  }\n\n  button {\n    svg {\n      width: 36px;\n      height: 36px;\n    }\n  }\n}\n</style>\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-37[0].rules[0].use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./MediaValidationButtons.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-37[0].rules[0].use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./MediaValidationButtons.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./MediaValidationButtons.vue?vue&type=template&id=485c2ab5&scoped=true&\"\nimport script from \"./MediaValidationButtons.vue?vue&type=script&lang=js&\"\nexport * from \"./MediaValidationButtons.vue?vue&type=script&lang=js&\"\nimport style0 from \"./MediaValidationButtons.vue?vue&type=style&index=0&id=485c2ab5&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"485c2ab5\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"m_captureSettings\"},[_c('transition',{attrs:{\"name\":\"fade_fast\",\"duration\":400}},[(_vm.is_loading_available_devices || _vm.is_loading_feed)?_c('LoaderSpinner'):_vm._e()],1),_c('div',{staticClass:\"m_captureSettings--topbar\"},[_c('div',{staticClass:\"m_captureSettings--topbar--title\"},[_c('span',{},[_vm._v(_vm._s(_vm.$t(\"settings\")))]),_c('button',{staticClass:\"button-nostyle bg-rouge _close_button\",attrs:{\"type\":\"button\"},on:{\"click\":function($event){return _vm.$emit('close')}}},[_c('img',{attrs:{\"src\":\"/images/i_close_sansfond.svg\",\"draggable\":\"false\"}})])])]),_c('div',[_c('div',{staticClass:\"m_sideBySideSwitches\"},[_c('label',{attrs:{\"for\":\"LocalSources\"}},[_c('div',[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.current_mode),expression:\"current_mode\"}],attrs:{\"type\":\"radio\",\"id\":\"LocalSources\",\"value\":\"LocalSources\"},domProps:{\"checked\":_vm._q(_vm.current_mode,\"LocalSources\")},on:{\"change\":function($event){_vm.current_mode=\"LocalSources\"}}}),_c('span',[_vm._v(\" \"+_vm._s(_vm.$t(\"stream_local_mode\"))+\" \")])])]),_c('label',{attrs:{\"for\":\"RemoteSources\"}},[_c('div',[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.current_mode),expression:\"current_mode\"}],attrs:{\"type\":\"radio\",\"id\":\"RemoteSources\",\"value\":\"RemoteSources\"},domProps:{\"checked\":_vm._q(_vm.current_mode,\"RemoteSources\")},on:{\"change\":function($event){_vm.current_mode=\"RemoteSources\"}}}),_c('span',[_vm._v(\" \"+_vm._s(_vm.$t(\"stream_remote_mode\"))+\" \")])])])])]),_c('div',{staticClass:\"m_captureSettings--settings\"},[(_vm.current_mode === 'LocalSources')?_c('div',{},[(_vm.status === 'not_allowed')?_c('div',[_c('div',{staticClass:\"padding-top-verysmall\"},[_vm._v(\" \"+_vm._s(_vm.$t(\"camera_access_refused\"))+\" \")])]):_vm._e(),_c('label',[_vm._v(_vm._s(_vm.$t(\"sources\")))]),_c('button',{staticClass:\"u-buttonLink margin-none margin-left padding-bottom-none\",attrs:{\"type\":\"button\"},on:{\"click\":_vm.refreshAvailableDevices}},[_vm._v(\" \"+_vm._s(_vm.$t(\"reload\"))+\" \")]),_c('div',{},[_c('div',{},[_c('label',[_vm._v(_vm._s(_vm.$t(\"camera\")))]),_c('div',[(_vm.all_video_input_devices.length === 0)?_c('small',[_vm._v(\" \"+_vm._s(_vm.$t(\"no_video_input_available\"))+\" \")]):_c('select',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.selected_devices.video_input_device),expression:\"selected_devices.video_input_device\"}],attrs:{\"id\":\"devices\",\"name\":\"Video devices\",\"title\":\"devices\"},on:{\"change\":function($event){var $$selectedVal = Array.prototype.filter.call($event.target.options,function(o){return o.selected}).map(function(o){var val = \"_value\" in o ? o._value : o.value;return val}); _vm.$set(_vm.selected_devices, \"video_input_device\", $event.target.multiple ? $$selectedVal : $$selectedVal[0])}}},_vm._l((_vm.all_video_input_devices),function(d){return _c('option',{key:d.deviceId,domProps:{\"value\":d}},[_vm._v(\" \"+_vm._s(d.label)+\" \")])}),0)]),(\n              _vm.selected_devices.video_input_device &&\n              _vm.selected_devices.video_input_device.deviceId ===\n                'screen_capture'\n            )?_c('div',{staticClass:\"margin-top-veryverysmall\"},[_c('span',{staticClass:\"switch switch-xs\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.advanced_capture_options.cursor.enabled),expression:\"advanced_capture_options.cursor.enabled\"}],staticClass:\"switch\",attrs:{\"id\":\"show_cursor\",\"type\":\"checkbox\",\"disabled\":!_vm.advanced_capture_options.cursor.supported,\"true-value\":\"always\",\"false-value\":\"never\"},domProps:{\"checked\":Array.isArray(_vm.advanced_capture_options.cursor.enabled)?_vm._i(_vm.advanced_capture_options.cursor.enabled,null)>-1:_vm._q(_vm.advanced_capture_options.cursor.enabled,\"always\")},on:{\"change\":function($event){var $$a=_vm.advanced_capture_options.cursor.enabled,$$el=$event.target,$$c=$$el.checked?(\"always\"):(\"never\");if(Array.isArray($$a)){var $$v=null,$$i=_vm._i($$a,$$v);if($$el.checked){$$i<0&&(_vm.$set(_vm.advanced_capture_options.cursor, \"enabled\", $$a.concat([$$v])))}else{$$i>-1&&(_vm.$set(_vm.advanced_capture_options.cursor, \"enabled\", $$a.slice(0,$$i).concat($$a.slice($$i+1))))}}else{_vm.$set(_vm.advanced_capture_options.cursor, \"enabled\", $$c)}}}}),_c('label',{attrs:{\"for\":\"show_cursor\"}},[_vm._v(_vm._s(_vm.$t(\"show_cursor\")))]),(!_vm.advanced_capture_options.cursor.supported)?_c('small',[_vm._v(\" \"+_vm._s(_vm.$t(\"not_supported_on_this_device\"))+\" \")]):_vm._e()])]):_vm._e()]),_c('div',[_c('label',[_vm._v(_vm._s(_vm.$t(\"audioinput\")))]),_c('div',[(_vm.all_audio_input_devices.length === 0)?_c('small',[_vm._v(\" \"+_vm._s(_vm.$t(\"no_audio_input_available\"))+\" \")]):_c('select',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.selected_devices.audio_input_device),expression:\"selected_devices.audio_input_device\"}],attrs:{\"id\":\"devices\",\"name\":\"Video devices\",\"title\":\"devices\"},on:{\"change\":function($event){var $$selectedVal = Array.prototype.filter.call($event.target.options,function(o){return o.selected}).map(function(o){var val = \"_value\" in o ? o._value : o.value;return val}); _vm.$set(_vm.selected_devices, \"audio_input_device\", $event.target.multiple ? $$selectedVal : $$selectedVal[0])}}},_vm._l((_vm.all_audio_input_devices),function(d){return _c('option',{key:d.deviceId,domProps:{\"value\":d}},[_vm._v(\" \"+_vm._s(d.label)+\" \")])}),0)]),(_vm.selected_devices.audio_input_device)?_c('div',{staticClass:\"margin-top-veryverysmall\"},[_c('span',{staticClass:\"switch switch-xs\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.advanced_capture_options.echoCancellation.enabled),expression:\"advanced_capture_options.echoCancellation.enabled\"}],staticClass:\"switch\",attrs:{\"id\":\"echoCancellation\",\"type\":\"checkbox\",\"disabled\":!_vm.advanced_capture_options.echoCancellation.supported},domProps:{\"checked\":Array.isArray(_vm.advanced_capture_options.echoCancellation.enabled)?_vm._i(_vm.advanced_capture_options.echoCancellation.enabled,null)>-1:(_vm.advanced_capture_options.echoCancellation.enabled)},on:{\"change\":function($event){var $$a=_vm.advanced_capture_options.echoCancellation.enabled,$$el=$event.target,$$c=$$el.checked?(true):(false);if(Array.isArray($$a)){var $$v=null,$$i=_vm._i($$a,$$v);if($$el.checked){$$i<0&&(_vm.$set(_vm.advanced_capture_options.echoCancellation, \"enabled\", $$a.concat([$$v])))}else{$$i>-1&&(_vm.$set(_vm.advanced_capture_options.echoCancellation, \"enabled\", $$a.slice(0,$$i).concat($$a.slice($$i+1))))}}else{_vm.$set(_vm.advanced_capture_options.echoCancellation, \"enabled\", $$c)}}}}),_c('label',{attrs:{\"for\":\"echoCancellation\"}},[_vm._v(_vm._s(_vm.$t(\"echoCancellation\")))]),(!_vm.advanced_capture_options.echoCancellation.supported)?_c('small',[_vm._v(\" \"+_vm._s(_vm.$t(\"not_supported_on_this_device\"))+\" \")]):_vm._e()])]):_vm._e(),(_vm.selected_devices.audio_input_device)?_c('div',{staticClass:\"margin-top-veryverysmall\"},[_c('span',{staticClass:\"switch switch-xs\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.advanced_capture_options.noiseSuppression.enabled),expression:\"advanced_capture_options.noiseSuppression.enabled\"}],staticClass:\"switch\",attrs:{\"id\":\"noiseSuppression\",\"type\":\"checkbox\",\"disabled\":!_vm.advanced_capture_options.noiseSuppression.supported},domProps:{\"checked\":Array.isArray(_vm.advanced_capture_options.noiseSuppression.enabled)?_vm._i(_vm.advanced_capture_options.noiseSuppression.enabled,null)>-1:(_vm.advanced_capture_options.noiseSuppression.enabled)},on:{\"change\":function($event){var $$a=_vm.advanced_capture_options.noiseSuppression.enabled,$$el=$event.target,$$c=$$el.checked?(true):(false);if(Array.isArray($$a)){var $$v=null,$$i=_vm._i($$a,$$v);if($$el.checked){$$i<0&&(_vm.$set(_vm.advanced_capture_options.noiseSuppression, \"enabled\", $$a.concat([$$v])))}else{$$i>-1&&(_vm.$set(_vm.advanced_capture_options.noiseSuppression, \"enabled\", $$a.slice(0,$$i).concat($$a.slice($$i+1))))}}else{_vm.$set(_vm.advanced_capture_options.noiseSuppression, \"enabled\", $$c)}}}}),_c('label',{attrs:{\"for\":\"noiseSuppression\"}},[_vm._v(_vm._s(_vm.$t(\"noiseSuppression\")))]),(!_vm.advanced_capture_options.noiseSuppression.supported)?_c('small',[_vm._v(\" \"+_vm._s(_vm.$t(\"not_supported_on_this_device\"))+\" \")]):_vm._e()])]):_vm._e()]),_c('div',[_c('label',[_vm._v(_vm._s(_vm.$t(\"audiooutput\")))]),_c('div',[(_vm.all_audio_output_devices.length === 0)?_c('small',[_vm._v(\" \"+_vm._s(_vm.$t(\"no_audio_output_available\"))+\" \")]):_c('select',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.selected_devices.audio_output_device),expression:\"selected_devices.audio_output_device\"}],attrs:{\"id\":\"devices\",\"name\":\"Video devices\",\"title\":\"devices\"},on:{\"change\":function($event){var $$selectedVal = Array.prototype.filter.call($event.target.options,function(o){return o.selected}).map(function(o){var val = \"_value\" in o ? o._value : o.value;return val}); _vm.$set(_vm.selected_devices, \"audio_output_device\", $event.target.multiple ? $$selectedVal : $$selectedVal[0])}}},_vm._l((_vm.all_audio_output_devices),function(d){return _c('option',{key:d.deviceId,domProps:{\"value\":d}},[_vm._v(\" \"+_vm._s(d.label)+\" \")])}),0)])])]),_c('label',[_vm._v(_vm._s(_vm.$t(\"resolutions\")))]),_c('div',[(\n            !_vm.selected_devices.video_input_device ||\n            !_vm.selected_devices.video_input_device.deviceId\n          )?_c('div',[_c('small',[_vm._v(\" \"+_vm._s(_vm.$t(\"pick_a_camera\"))+\" \")])]):_vm._e(),(\n            _vm.selected_devices.video_input_device &&\n            (_vm.selected_devices.video_input_device.deviceId ===\n              'screen_capture' ||\n              _vm.selected_devices.video_input_device.chromeMediaSource)\n          )?_c('div',[_c('small',[_vm._v(\" \"+_vm._s(_vm.$t(\"cant_pick_resolution_when_screen_capture\"))+\" \")])]):_c('div',{staticClass:\"m_captureSettings--settings--resolutions\"},[_vm._l((_vm.predefined_resolutions.concat(\n              _vm.custom_camera_resolution\n            )),function(res){return _c('div',{key:res.name},[_c('label',{attrs:{\"for\":res.label}},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.desired_camera_resolution),expression:\"desired_camera_resolution\"}],attrs:{\"type\":\"radio\",\"id\":res.label,\"disabled\":_vm.unavailable_camera_resolutions.includes(res.label)},domProps:{\"value\":res,\"checked\":_vm._q(_vm.desired_camera_resolution,res)},on:{\"change\":function($event){_vm.desired_camera_resolution=res}}}),_c('span',[_vm._v(_vm._s(res.label)+\" \"),(res.type !== 'custom')?[_vm._v(\"  \"),(res.ratio)?[_vm._v(_vm._s(res.ratio))]:_vm._e(),_vm._v(\"  \"+_vm._s(res.width)+\"/\"+_vm._s(res.height)+\") \")]:_vm._e()],2)])])}),(\n              _vm.desired_camera_resolution &&\n              _vm.desired_camera_resolution.type === 'custom'\n            )?_c('div',{staticClass:\"margin-bottom-small input-group\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model.number\",value:(_vm.desired_camera_resolution.width),expression:\"desired_camera_resolution.width\",modifiers:{\"number\":true}}],attrs:{\"type\":\"number\",\"min\":\"2\",\"max\":\"4096\",\"step\":\"2\"},domProps:{\"value\":(_vm.desired_camera_resolution.width)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.$set(_vm.desired_camera_resolution, \"width\", _vm._n($event.target.value))},\"blur\":function($event){return _vm.$forceUpdate()}}}),_c('span',{staticClass:\"font-large padding-verysmall\"},[_vm._v(\"\")]),_c('input',{directives:[{name:\"model\",rawName:\"v-model.number\",value:(_vm.desired_camera_resolution.height),expression:\"desired_camera_resolution.height\",modifiers:{\"number\":true}}],attrs:{\"type\":\"number\",\"min\":\"2\",\"max\":\"2160\",\"step\":\"2\"},domProps:{\"value\":(_vm.desired_camera_resolution.height)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.$set(_vm.desired_camera_resolution, \"height\", _vm._n($event.target.value))},\"blur\":function($event){return _vm.$forceUpdate()}}})]):_vm._e()],2)])]):(_vm.current_mode === 'RemoteSources')?_c('div',[_c('div',[_c('small',[_vm._v(_vm._s(_vm.$t(\"connect_to_other_users\")))]),_c('div',{staticClass:\"padding-vert-small padding-bottom-small\"},[_c('label',{domProps:{\"innerHTML\":_vm._s(_vm.$t('name_of_stream'))}}),_c('input',{directives:[{name:\"model\",rawName:\"v-model.trim\",value:(_vm.access_distant_stream.callee),expression:\"access_distant_stream.callee\",modifiers:{\"trim\":true}}],attrs:{\"type\":\"text\",\"required\":\"\",\"disabled\":_vm.access_distant_stream.status.enabled,\"autofocus\":\"autofocus\",\"onfocus\":\"this.select()\"},domProps:{\"value\":(_vm.access_distant_stream.callee)},on:{\"keydown\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\")){ return null; }$event.preventDefault();return _vm.callStream.apply(null, arguments)},\"input\":function($event){if($event.target.composing){ return; }_vm.$set(_vm.access_distant_stream, \"callee\", $event.target.value.trim())},\"blur\":function($event){return _vm.$forceUpdate()}}})])])]):_vm._e()]),_c('div',{staticClass:\"m_captureSettings--updateButton\"},[(_vm.current_mode === 'LocalSources')?_c('div',{staticClass:\"m_captureSettings--updateButton--shareStreamToggle\"},[_c('transition',{attrs:{\"name\":\"fade_fast\",\"duration\":150}},[(_vm.share_this_stream.status.loading)?_c('LoaderSpinner'):_vm._e()],1),_c('div',{staticClass:\"switch switch-xs\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.share_this_stream.enabled),expression:\"share_this_stream.enabled\"}],staticClass:\"switch\",attrs:{\"id\":\"shareStream\",\"type\":\"checkbox\"},domProps:{\"checked\":Array.isArray(_vm.share_this_stream.enabled)?_vm._i(_vm.share_this_stream.enabled,null)>-1:(_vm.share_this_stream.enabled)},on:{\"change\":function($event){var $$a=_vm.share_this_stream.enabled,$$el=$event.target,$$c=$$el.checked?(true):(false);if(Array.isArray($$a)){var $$v=null,$$i=_vm._i($$a,$$v);if($$el.checked){$$i<0&&(_vm.$set(_vm.share_this_stream, \"enabled\", $$a.concat([$$v])))}else{$$i>-1&&(_vm.$set(_vm.share_this_stream, \"enabled\", $$a.slice(0,$$i).concat($$a.slice($$i+1))))}}else{_vm.$set(_vm.share_this_stream, \"enabled\", $$c)}}}}),_c('label',{attrs:{\"for\":\"shareStream\"}},[_vm._v(_vm._s(_vm.$t(\"share_stream\")))])]),(_vm.share_this_stream.enabled)?_c('div',{staticClass:\"padding-sides-small padding-bottom-small\"},[_c('label',{domProps:{\"innerHTML\":_vm._s(_vm.$t('name_of_stream'))}}),_c('input',{directives:[{name:\"model\",rawName:\"v-model.trim\",value:(_vm.share_this_stream.name),expression:\"share_this_stream.name\",modifiers:{\"trim\":true}}],attrs:{\"type\":\"text\",\"required\":\"\",\"autofocus\":\"autofocus\",\"onfocus\":\"this.select()\"},domProps:{\"value\":(_vm.share_this_stream.name)},on:{\"keydown\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\")){ return null; }$event.preventDefault();return _vm.setCameraStreamFromDefaults.apply(null, arguments)},\"input\":function($event){if($event.target.composing){ return; }_vm.$set(_vm.share_this_stream, \"name\", $event.target.value.trim())},\"blur\":function($event){return _vm.$forceUpdate()}}})]):_vm._e()],1):_vm._e(),_c('div',{staticClass:\"m_captureSettings--updateButton--buttons\"},[(_vm.current_mode === 'LocalSources')?[_c('button',{staticClass:\"bg-rouge button-wide\",attrs:{\"type\":\"button\"},on:{\"click\":_vm.setCameraStreamFromDefaults}},[_vm._v(\" \"+_vm._s(_vm.$t(\"update\"))+\" \")])]:(_vm.current_mode === 'RemoteSources')?[_c('transition',{attrs:{\"name\":\"fade_fast\",\"duration\":150}},[(_vm.access_distant_stream.calling)?_c('LoaderSpinner'):_vm._e()],1),(!_vm.access_distant_stream.status.enabled)?_c('button',{staticClass:\"bg-rouge button-wide\",attrs:{\"type\":\"button\",\"disabled\":_vm.access_distant_stream.callee.length === 0 ||\n            _vm.access_distant_stream.calling},on:{\"click\":_vm.callStream}},[_vm._v(\" \"+_vm._s(_vm.$t(\"connect\"))+\" \")]):_vm._e(),(_vm.access_distant_stream.status.enabled)?_c('button',{staticClass:\"bg-rouge button-wide\",attrs:{\"type\":\"button\",\"disabled\":_vm.access_distant_stream.callee.length === 0 ||\n            _vm.access_distant_stream.calling},on:{\"click\":_vm.hangupStream}},[_vm._v(\" \"+_vm._s(_vm.$t(\"hangup\"))+\" \")]):_vm._e()]:_vm._e()],2)])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"m_captureSettings\">\n    <transition name=\"fade_fast\" :duration=\"400\">\n      <LoaderSpinner v-if=\"is_loading_available_devices || is_loading_feed\" />\n    </transition>\n\n    <div class=\"m_captureSettings--topbar\">\n      <div class=\"m_captureSettings--topbar--title\">\n        <span class>{{ $t(\"settings\") }}</span>\n        <button\n          type=\"button\"\n          class=\"button-nostyle bg-rouge _close_button\"\n          @click=\"$emit('close')\"\n        >\n          <img src=\"/images/i_close_sansfond.svg\" draggable=\"false\" />\n        </button>\n      </div>\n    </div>\n    <div>\n      <div class=\"m_sideBySideSwitches\">\n        <label for=\"LocalSources\">\n          <div>\n            <input\n              type=\"radio\"\n              id=\"LocalSources\"\n              value=\"LocalSources\"\n              v-model=\"current_mode\"\n            />\n            <span>\n              {{ $t(\"stream_local_mode\") }}\n            </span>\n          </div>\n        </label>\n        <label for=\"RemoteSources\">\n          <div>\n            <input\n              type=\"radio\"\n              id=\"RemoteSources\"\n              value=\"RemoteSources\"\n              v-model=\"current_mode\"\n            />\n            <span> {{ $t(\"stream_remote_mode\") }} </span>\n          </div>\n        </label>\n      </div>\n    </div>\n\n    <div class=\"m_captureSettings--settings\">\n      <div v-if=\"current_mode === 'LocalSources'\" class>\n        <div v-if=\"status === 'not_allowed'\">\n          <div class=\"padding-top-verysmall\">\n            {{ $t(\"camera_access_refused\") }}\n          </div>\n        </div>\n\n        <label>{{ $t(\"sources\") }}</label>\n        <button\n          type=\"button\"\n          class=\"u-buttonLink margin-none margin-left padding-bottom-none\"\n          @click=\"refreshAvailableDevices\"\n        >\n          {{ $t(\"reload\") }}\n        </button>\n\n        <div class=\"\">\n          <div class=\"\">\n            <label>{{ $t(\"camera\") }}</label>\n\n            <div>\n              <small v-if=\"all_video_input_devices.length === 0\">\n                {{ $t(\"no_video_input_available\") }}\n              </small>\n              <select\n                v-else\n                id=\"devices\"\n                name=\"Video devices\"\n                title=\"devices\"\n                v-model=\"selected_devices.video_input_device\"\n              >\n                <option\n                  v-for=\"d in all_video_input_devices\"\n                  :key=\"d.deviceId\"\n                  :value=\"d\"\n                >\n                  {{ d.label }}\n                </option>\n              </select>\n            </div>\n\n            <div\n              v-if=\"\n                selected_devices.video_input_device &&\n                selected_devices.video_input_device.deviceId ===\n                  'screen_capture'\n              \"\n              class=\"margin-top-veryverysmall\"\n            >\n              <span class=\"switch switch-xs\">\n                <input\n                  class=\"switch\"\n                  id=\"show_cursor\"\n                  type=\"checkbox\"\n                  v-model=\"advanced_capture_options.cursor.enabled\"\n                  :disabled=\"!advanced_capture_options.cursor.supported\"\n                  true-value=\"always\"\n                  false-value=\"never\"\n                />\n                <label for=\"show_cursor\">{{ $t(\"show_cursor\") }}</label>\n                <small v-if=\"!advanced_capture_options.cursor.supported\">\n                  {{ $t(\"not_supported_on_this_device\") }}\n                </small>\n              </span>\n            </div>\n          </div>\n          <div>\n            <label>{{ $t(\"audioinput\") }}</label>\n            <div>\n              <small v-if=\"all_audio_input_devices.length === 0\">\n                {{ $t(\"no_audio_input_available\") }}\n              </small>\n              <select\n                v-else\n                id=\"devices\"\n                name=\"Video devices\"\n                title=\"devices\"\n                v-model=\"selected_devices.audio_input_device\"\n              >\n                <option\n                  v-for=\"d in all_audio_input_devices\"\n                  :key=\"d.deviceId\"\n                  :value=\"d\"\n                >\n                  {{ d.label }}\n                </option>\n              </select>\n            </div>\n\n            <div\n              v-if=\"selected_devices.audio_input_device\"\n              class=\"margin-top-veryverysmall\"\n            >\n              <span class=\"switch switch-xs\">\n                <input\n                  class=\"switch\"\n                  id=\"echoCancellation\"\n                  type=\"checkbox\"\n                  :disabled=\"\n                    !advanced_capture_options.echoCancellation.supported\n                  \"\n                  v-model=\"advanced_capture_options.echoCancellation.enabled\"\n                />\n                <label for=\"echoCancellation\">{{\n                  $t(\"echoCancellation\")\n                }}</label>\n                <small\n                  v-if=\"!advanced_capture_options.echoCancellation.supported\"\n                >\n                  {{ $t(\"not_supported_on_this_device\") }}\n                </small>\n              </span>\n            </div>\n            <div\n              v-if=\"selected_devices.audio_input_device\"\n              class=\"margin-top-veryverysmall\"\n            >\n              <span class=\"switch switch-xs\">\n                <input\n                  class=\"switch\"\n                  id=\"noiseSuppression\"\n                  type=\"checkbox\"\n                  :disabled=\"\n                    !advanced_capture_options.noiseSuppression.supported\n                  \"\n                  v-model=\"advanced_capture_options.noiseSuppression.enabled\"\n                />\n                <label for=\"noiseSuppression\">{{\n                  $t(\"noiseSuppression\")\n                }}</label>\n                <small\n                  v-if=\"!advanced_capture_options.noiseSuppression.supported\"\n                >\n                  {{ $t(\"not_supported_on_this_device\") }}\n                </small>\n              </span>\n            </div>\n          </div>\n          <div>\n            <label>{{ $t(\"audiooutput\") }}</label>\n\n            <div>\n              <small v-if=\"all_audio_output_devices.length === 0\">\n                {{ $t(\"no_audio_output_available\") }}\n              </small>\n              <select\n                v-else\n                id=\"devices\"\n                name=\"Video devices\"\n                title=\"devices\"\n                v-model=\"selected_devices.audio_output_device\"\n              >\n                <option\n                  v-for=\"d in all_audio_output_devices\"\n                  :key=\"d.deviceId\"\n                  :value=\"d\"\n                >\n                  {{ d.label }}\n                </option>\n              </select>\n            </div>\n          </div>\n        </div>\n        <label>{{ $t(\"resolutions\") }}</label>\n        <div>\n          <div\n            v-if=\"\n              !selected_devices.video_input_device ||\n              !selected_devices.video_input_device.deviceId\n            \"\n          >\n            <small>\n              {{ $t(\"pick_a_camera\") }}\n            </small>\n          </div>\n          <div\n            v-if=\"\n              selected_devices.video_input_device &&\n              (selected_devices.video_input_device.deviceId ===\n                'screen_capture' ||\n                selected_devices.video_input_device.chromeMediaSource)\n            \"\n          >\n            <small>\n              {{ $t(\"cant_pick_resolution_when_screen_capture\") }}\n            </small>\n          </div>\n          <div class=\"m_captureSettings--settings--resolutions\" v-else>\n            <div\n              v-for=\"res in predefined_resolutions.concat(\n                custom_camera_resolution\n              )\"\n              :key=\"res.name\"\n            >\n              <label :for=\"res.label\">\n                <input\n                  type=\"radio\"\n                  :id=\"res.label\"\n                  :value=\"res\"\n                  :disabled=\"unavailable_camera_resolutions.includes(res.label)\"\n                  v-model=\"desired_camera_resolution\"\n                />\n                <span\n                  >{{ res.label }}\n                  <template v-if=\"res.type !== 'custom'\">\n                    \n                    <template v-if=\"res.ratio\">{{ res.ratio }}</template>\n                     {{ res.width }}/{{ res.height }})\n                  </template>\n                </span>\n              </label>\n            </div>\n\n            <div\n              v-if=\"\n                desired_camera_resolution &&\n                desired_camera_resolution.type === 'custom'\n              \"\n              class=\"margin-bottom-small input-group\"\n            >\n              <input\n                type=\"number\"\n                min=\"2\"\n                max=\"4096\"\n                step=\"2\"\n                v-model.number=\"desired_camera_resolution.width\"\n              />\n              <span class=\"font-large padding-verysmall\"></span>\n              <input\n                type=\"number\"\n                min=\"2\"\n                max=\"2160\"\n                step=\"2\"\n                v-model.number=\"desired_camera_resolution.height\"\n              />\n            </div>\n          </div>\n        </div>\n      </div>\n      <div v-else-if=\"current_mode === 'RemoteSources'\">\n        <div>\n          <!-- <label>{{ $t(\"remote_access\") }}</label> -->\n          <small>{{ $t(\"connect_to_other_users\") }}</small>\n          <div class=\"padding-vert-small padding-bottom-small\">\n            <label v-html=\"$t('name_of_stream')\" />\n            <input\n              type=\"text\"\n              v-model.trim=\"access_distant_stream.callee\"\n              required\n              :disabled=\"access_distant_stream.status.enabled\"\n              autofocus=\"autofocus\"\n              onfocus=\"this.select()\"\n              @keydown.enter.prevent=\"callStream\"\n            />\n          </div>\n        </div>\n      </div>\n    </div>\n    <div class=\"m_captureSettings--updateButton\">\n      <!-- <small v-if=\"!desired_camera_resolution\">\n          Select a camera resolution first\n        </small> -->\n\n      <div\n        class=\"m_captureSettings--updateButton--shareStreamToggle\"\n        v-if=\"current_mode === 'LocalSources'\"\n      >\n        <transition name=\"fade_fast\" :duration=\"150\">\n          <LoaderSpinner v-if=\"share_this_stream.status.loading\" />\n        </transition>\n\n        <div class=\"switch switch-xs\">\n          <input\n            class=\"switch\"\n            id=\"shareStream\"\n            type=\"checkbox\"\n            v-model=\"share_this_stream.enabled\"\n          />\n          <label for=\"shareStream\">{{ $t(\"share_stream\") }}</label>\n        </div>\n\n        <div\n          v-if=\"share_this_stream.enabled\"\n          class=\"padding-sides-small padding-bottom-small\"\n        >\n          <label v-html=\"$t('name_of_stream')\" />\n          <input\n            type=\"text\"\n            v-model.trim=\"share_this_stream.name\"\n            required\n            autofocus=\"autofocus\"\n            onfocus=\"this.select()\"\n            @keydown.enter.prevent=\"setCameraStreamFromDefaults\"\n          />\n        </div>\n      </div>\n\n      <div class=\"m_captureSettings--updateButton--buttons\">\n        <template v-if=\"current_mode === 'LocalSources'\">\n          <button\n            type=\"button\"\n            class=\"bg-rouge button-wide\"\n            @click=\"setCameraStreamFromDefaults\"\n          >\n            {{ $t(\"update\") }}\n          </button>\n        </template>\n        <template v-else-if=\"current_mode === 'RemoteSources'\">\n          <transition name=\"fade_fast\" :duration=\"150\">\n            <LoaderSpinner v-if=\"access_distant_stream.calling\" />\n          </transition>\n          <button\n            type=\"button\"\n            class=\"bg-rouge button-wide\"\n            v-if=\"!access_distant_stream.status.enabled\"\n            :disabled=\"\n              access_distant_stream.callee.length === 0 ||\n              access_distant_stream.calling\n            \"\n            @click=\"callStream\"\n          >\n            {{ $t(\"connect\") }}\n          </button>\n          <button\n            type=\"button\"\n            class=\"bg-rouge button-wide\"\n            v-if=\"access_distant_stream.status.enabled\"\n            :disabled=\"\n              access_distant_stream.callee.length === 0 ||\n              access_distant_stream.calling\n            \"\n            @click=\"hangupStream\"\n          >\n            {{ $t(\"hangup\") }}\n          </button>\n        </template>\n\n        <!-- <button\n          type=\"button\"\n          class=\"bg-rouge u-buttonLink\"\n          @click=\"$emit('close')\"\n        >\n          <span class>{{ $t(\"close\") }}</span>\n        </button> -->\n      </div>\n    </div>\n  </div>\n</template>\n<script>\nimport RTCMultiConnection from \"rtcmulticonnection\";\n\nexport default {\n  props: {\n    audio_output_deviceId: String,\n  },\n  components: {},\n  data() {\n    return {\n      is_loading_available_devices: false,\n      is_loading_feed: false,\n      status: undefined,\n\n      current_mode: \"LocalSources\",\n\n      current_stream: undefined,\n      local_stream: undefined,\n      remote_stream: undefined,\n\n      stream_current_settings: undefined,\n      desired_camera_resolution: undefined,\n      last_working_resolution: undefined,\n\n      selected_devices: {\n        video_input_device: undefined,\n        audio_input_device: undefined,\n        audio_output_device: undefined,\n      },\n\n      connected_devices: [],\n\n      predefined_resolutions: [\n        {\n          label: \"4K(UHD)\",\n          width: 3840,\n          height: 2160,\n          ratio: \"16:9\",\n        },\n        {\n          label: \"1080p(FHD)\",\n          width: 1920,\n          height: 1080,\n          ratio: \"16:9\",\n        },\n        {\n          label: \"720p(HD)\",\n          width: 1280,\n          height: 720,\n          ratio: \"16:9\",\n        },\n        {\n          label: \"VGA\",\n          width: 640,\n          height: 480,\n          ratio: \"4:3\",\n        },\n        {\n          label: \"QVGA\",\n          width: 320,\n          height: 240,\n          ratio: \"4:3\",\n        },\n      ],\n\n      unavailable_camera_resolutions: [],\n      custom_camera_resolution: {\n        label: this.$t(\"custom\"),\n        type: \"custom\",\n        width: 1280,\n        height: 720,\n      },\n\n      advanced_capture_options: {\n        echoCancellation: {\n          supported: undefined,\n          enabled: false,\n        },\n        noiseSuppression: {\n          supported: undefined,\n          enabled: false,\n        },\n        cursor: {\n          supported: undefined,\n          enabled: false,\n        },\n      },\n\n      rtcmulti_connection: undefined,\n\n      share_this_stream: {\n        enabled: false,\n        name: `dodoc-${(Math.random().toString(36) + \"00000000000000000\").slice(\n          2,\n          3 + 2\n        )}`,\n        status: {\n          loading: false,\n          enabled: undefined,\n          name: undefined,\n          peers_connected: [],\n        },\n      },\n\n      access_distant_stream: {\n        calling: false,\n        callee: \"\",\n        status: {\n          enabled: false,\n          callee: undefined,\n        },\n      },\n    };\n  },\n  created() {},\n  mounted() {\n    if (!navigator.mediaDevices.getUserMedia) {\n      alert(\"You need a browser that supports WebRTC\");\n      return;\n    }\n\n    this.is_loading_feed = true;\n    this.is_loading_available_devices = true;\n\n    //Call gUM early to force user gesture and allow device enumeration\n    navigator.mediaDevices\n      .getUserMedia({ audio: true, video: true })\n      .then((stream) => {\n        this.local_stream = stream;\n        // if (\"srcObject\" in this.$refs.videoElement) {\n        //   this.$refs.videoElement.srcObject = stream;\n        // } else {\n        //   // Avoid using this in new browsers, as it is going away.\n        //   this.$refs.videoElement.src = window.URL.createObjectURL(stream);\n        // }\n        return;\n      })\n      .catch((err) => {\n        this.$alertify\n          .closeLogOnClick(true)\n          .delay(4000)\n          .error(\n            this.$t(\"notifications.couldnt_load_getusermedia\") +\n              \"<br>\" +\n              err.name +\n              \": \" +\n              err.message\n          );\n        // if (err.message === \"Could not start audio source\") {\n        // }\n        this.is_loading_feed = false;\n        this.$emit(\"hasFinishedLoading\");\n        this.$emit(\"show\");\n        return;\n      })\n      .then(this.refreshAvailableDevices)\n      .then(() => {\n        this.setDefaultInputsAndOutputs();\n      })\n      .catch((err) => {\n        this.is_loading_feed = false;\n        this.$alertify\n          .closeLogOnClick(true)\n          .delay(4000)\n          .error(\n            this.$t(\"notifications.failed_listing_devices\") +\n              \"<br>\" +\n              err.name +\n              \": \" +\n              err.message\n          );\n      })\n      .then(() => this.setCameraStreamFromDefaults())\n      .then(() => {\n        this.is_loading_feed = false;\n        this.$emit(\"hasFinishedLoading\");\n      })\n      .catch(() => {\n        this.is_loading_feed = false;\n        this.$emit(\"hasFinishedLoading\");\n      });\n  },\n  beforeDestroy() {\n    if (this.local_stream)\n      this.local_stream.getTracks().forEach((track) => track.stop());\n    if (this.remote_stream)\n      this.remote_stream.getTracks().forEach((track) => track.stop());\n    this.closeMultiRTC();\n  },\n  watch: {\n    \"selected_devices.video_input_device\": function () {\n      this.unavailable_camera_resolutions = [];\n      this.last_working_resolution = false;\n    },\n    local_stream: function () {\n      this.setCurrentStream();\n    },\n    remote_stream: function () {\n      this.setCurrentStream();\n    },\n    current_mode: function () {\n      this.setCurrentStream();\n    },\n    current_stream: function () {\n      this.$emit(\"setStream\", {\n        stream: this.current_stream,\n        type: this.current_mode,\n      });\n    },\n    selected_devices: {\n      handler() {\n        // TODO save selected devices in localstorage\n        // this.$root.settings.capture_options.selected_devices = JSON.parse(\n        //   JSON.stringify(this.selected_devices)\n        // );\n      },\n      deep: true,\n    },\n    last_working_resolution: {\n      handler() {\n        // TODO save last working res\n        // if (!this.last_working_resolution)\n        //   this.$root.settings.capture_options.last_working_resolution = false;\n        // this.$root.settings.capture_options.last_working_resolution =\n        //   JSON.parse(JSON.stringify(this.last_working_resolution));\n      },\n      deep: true,\n    },\n    share_this_stream: {\n      handler() {\n        this.$eventHub.$emit(\n          `stream.newSharingInformations`,\n          this.share_this_stream.status\n        );\n      },\n      deep: true,\n    },\n    access_distant_stream: {\n      handler() {\n        this.$eventHub.$emit(\n          `stream.newDistantAccessInformations`,\n          this.access_distant_stream.status\n        );\n      },\n      deep: true,\n    },\n  },\n  computed: {\n    all_video_input_devices() {\n      return this.connected_devices.filter((d) => d.kind === \"videoinput\");\n    },\n    all_audio_input_devices() {\n      return this.connected_devices.filter((d) => d.kind === \"audioinput\");\n    },\n    all_audio_output_devices() {\n      return this.connected_devices.filter((d) => d.kind === \"audiooutput\");\n    },\n    current_settings() {\n      let _settings = \"\";\n\n      if (this.selected_devices.video_input_device) {\n        _settings += this.selected_devices.video_input_device.deviceId + \"-\";\n        if (\n          this.selected_devices.video_input_device.deviceId === \"screen_capture\"\n        )\n          _settings += this.advanced_capture_options.cursor.enabled + \"-\";\n      }\n\n      if (\n        !!this.desired_camera_resolution &&\n        !!this.desired_camera_resolution.width &&\n        !!this.desired_camera_resolution.height\n      ) {\n        _settings +=\n          this.desired_camera_resolution.width +\n          \"x\" +\n          this.desired_camera_resolution.height +\n          \"-\";\n      }\n\n      if (this.selected_devices.audio_input_device) {\n        _settings += this.selected_devices.audio_input_device.deviceId + \"-\";\n        _settings += this.noiseSuppression + \"-\";\n        _settings += this.echoCancellation + \"-\";\n      }\n\n      if (this.share_this_stream.enabled)\n        _settings += this.share_this_stream.name + \"-\";\n\n      if (this.selected_devices.audio_output_device)\n        _settings += this.selected_devices.audio_output_device.deviceId + \"-\";\n\n      return _settings;\n    },\n  },\n  methods: {\n    listDevices() {\n      return new Promise((resolve, reject) => {\n        if (this.$root.dev_mode === true)\n          console.log(`CaptureSettings  METHODS : listDevices`);\n\n        navigator.mediaDevices\n          .enumerateDevices()\n          .then((devices) => {\n            if (!this.$root.is_electron) {\n              return resolve(devices);\n            } else return devices;\n          })\n          .then((devices) => {\n            this.getDesktopCapturer()\n              .then((sources) => {\n                devices = devices.concat(sources);\n              })\n              .catch(() => {})\n              .then(() => {\n                return resolve(devices);\n              });\n          })\n          .catch((err) => {\n            return reject(err);\n          });\n      });\n    },\n    setCurrentStream() {\n      if (this.$root.dev_mode === true)\n        console.log(`CaptureSettings  METHODS : setCurrentStream`);\n\n      if (this.current_mode === \"RemoteSources\") {\n        this.current_stream = this.remote_stream;\n      } else if (this.current_mode === \"LocalSources\") {\n        this.current_stream = this.local_stream;\n      }\n    },\n    setSupportedConstraints() {\n      return new Promise((resolve) => {\n        if (this.$root.dev_mode === true)\n          console.log(`CaptureSettings  METHODS : setSupportedConstraints`);\n\n        const supported_constraints =\n          navigator.mediaDevices.getSupportedConstraints();\n        if (!supported_constraints) return resolve();\n\n        Object.entries(this.advanced_capture_options).map(([prop]) => {\n          this.advanced_capture_options[prop].supported =\n            this.advanced_capture_options[prop].enabled =\n              supported_constraints[prop] === true;\n        });\n        return resolve();\n      });\n    },\n    setDefaultInputsAndOutputs() {\n      if (this.$root.dev_mode === true)\n        console.log(`CaptureSettings  METHODS : setDefaultInputsAndOutputs`);\n\n      if (this.connected_devices.length === 0) return;\n\n      // find in $root.settings.capture_options.selected_devices if video_input_device already exists\n      if (this.all_video_input_devices.length > 0)\n        this.selected_devices.video_input_device = this.getDefaultDevice({\n          key: \"video_input_device\",\n          devices_list: this.all_video_input_devices,\n        });\n\n      if (this.all_audio_input_devices.length > 0)\n        this.selected_devices.audio_input_device = this.getDefaultDevice({\n          key: \"audio_input_device\",\n          devices_list: this.all_audio_input_devices,\n        });\n      if (this.all_audio_output_devices.length > 0)\n        this.selected_devices.audio_output_device = this.getDefaultDevice({\n          key: \"audio_output_device\",\n          devices_list: this.all_audio_output_devices,\n        });\n\n      // TODO restore last working res\n      // if (\n      //   this.$root.settings.capture_options &&\n      //   this.$root.settings.capture_options.last_working_resolution\n      // ) {\n      //   this.desired_camera_resolution = JSON.parse(\n      //     JSON.stringify(\n      //       this.$root.settings.capture_options.last_working_resolution\n      //     )\n      //   );\n      // } else {\n      this.desired_camera_resolution = this.predefined_resolutions.find(\n        (r) => r.label === \"720p(HD)\"\n      );\n      // }\n    },\n    getDefaultDevice({ key, devices_list }) {\n      if (this.$root.dev_mode === true)\n        console.log(`CaptureSettings  METHODS : getDefaultDevice`);\n\n      // find if this.$root.settings.capture_options.selected_devices has key, and if value is in devices_list\n      // TODO restore last devices\n      const previously_used = false;\n      // this.$root.settings.capture_options.selected_devices;\n      if (previously_used?.[key]) {\n        const found_device = devices_list.find(\n          (d) => d.deviceId === previously_used[key].deviceId\n        );\n        // if true, use this\n        if (found_device) {\n          if (this.$root.dev_mode === true)\n            console.log(\n              `CaptureSettings  METHODS : getDefaultDevice  found previously used device for ` +\n                key\n            );\n\n          return found_device;\n        }\n      }\n\n      if (this.$root.dev_mode === true)\n        console.log(\n          `CaptureSettings  METHODS : getDefaultDevice  settings first available device for ` +\n            key\n        );\n\n      return devices_list[0];\n    },\n    startMediaDeviceFeed(constraints) {\n      return new Promise((resolve, reject) => {\n        if (this.$root.dev_mode === true)\n          console.log(`CaptureSettings  METHODS : startMediaDeviceFeed`);\n\n        let processFeeds = [];\n\n        // start video feed\n        processFeeds.push(\n          new Promise((resolve, reject) => {\n            if (!constraints.video) return resolve();\n            if (constraints._is_webrtc_screen_capture === true) {\n              navigator.mediaDevices\n                .getDisplayMedia({ video: constraints.video, audio: false })\n                .then((stream) => resolve({ type: \"videoStream\", stream }))\n                .catch((err) => reject(err));\n            } else {\n              navigator.mediaDevices\n                .getUserMedia({ video: constraints.video, audio: false })\n                .then((stream) => resolve({ type: \"videoStream\", stream }))\n                .catch((err) => reject(err));\n            }\n          })\n        );\n\n        // start audio feed\n        processFeeds.push(\n          new Promise((resolve, reject) => {\n            if (!constraints.audio) return resolve();\n            navigator.mediaDevices\n              .getUserMedia({ video: false, audio: constraints.audio })\n              .then((stream) => resolve({ type: \"audioStream\", stream }))\n              .catch((err) => reject(err));\n          })\n        );\n\n        Promise.all(processFeeds)\n          .then((streams) => {\n            if (!streams) reject(\"no feed available\");\n\n            let tracks = [];\n\n            const video_stream = streams.find(\n              (s) => s && s.type === \"videoStream\"\n            );\n            if (video_stream) tracks.push(...video_stream.stream.getTracks());\n\n            const audio_stream = streams.find(\n              (s) => s && s.type === \"audioStream\"\n            );\n            if (audio_stream)\n              tracks.push(...audio_stream.stream.getAudioTracks());\n\n            let stream = new MediaStream(tracks);\n\n            resolve(stream);\n          })\n          .catch((err) => reject(err));\n      });\n    },\n    // getAllAvailableResolutions() {\n    //   const all_resolutions = [];\n\n    //   this.is_scanning_resolutions = true;\n    //   // this.$refs.videoElement.pause();\n\n    //   let tasks = this.predefined_resolutions.map((resolution) => () =>\n    //     this.setCameraStream(\n    //       resolution,\n    //       this.selected_devices.video_input_device,\n    //       false\n    //     )\n    //   );\n\n    //   const serial = (funcs) =>\n    //     funcs.reduce(\n    //       (promise, func) =>\n    //         promise.then((result) =>\n    //           func().then(Array.prototype.concat.bind(result))\n    //         ),\n    //       Promise.resolve([])\n    //     );\n    //   serial(tasks).then((res) => {\n    //     res = res.filter((r) => !r.status && r.status !== \"error\");\n    //     // this.unavailable_camera_resolutions = res;\n    //     this.is_scanning_resolutions = false;\n    //     // this.$refs.videoElement.play();\n    //   });\n    // },\n    getDesktopCapturer() {\n      return new Promise((resolve, reject) => {\n        if (!window.electronAPI.desktopCapturer) return;\n\n        if (this.$root.dev_mode === true)\n          console.log(`CaptureSettings  METHODS : getDesktopCapturer`);\n\n        window.electronAPI\n          .desktopCapturer({ types: [\"window\", \"screen\"] })\n          .then((sources) => {\n            sources = sources.map((s) => {\n              return {\n                chromeMediaSource: \"desktop\",\n                deviceId: s.id,\n                kind: \"videoinput\",\n                label: \" \" + s.name,\n              };\n            });\n\n            return resolve(sources);\n          })\n          .catch((err) => reject(err));\n        // .catch((err) => reject(err));\n      });\n    },\n    refreshAvailableDevices() {\n      return new Promise((resolve) => {\n        if (this.$root.dev_mode === true)\n          console.log(`CaptureSettings  METHODS : refreshAvailableDevices`);\n\n        this.connected_devices = [];\n        this.is_loading_available_devices = true;\n        this.setSupportedConstraints()\n          .then(() => this.listDevices())\n          .then((devices) => {\n            this.connected_devices = devices.map((d) => {\n              return {\n                label: d.label,\n                kind: d.kind,\n                deviceId: d.deviceId,\n                chromeMediaSource: d.chromeMediaSource\n                  ? d.chromeMediaSource\n                  : false,\n              };\n            });\n\n            if (!this.$root.is_electron) {\n              this.connected_devices.push({\n                deviceId: \"screen_capture\",\n                kind: \"videoinput\",\n                label: \" \" + this.$t(\"screen_capture\"),\n              });\n            }\n\n            this.is_loading_available_devices = false;\n            return resolve();\n          });\n      });\n    },\n    setCameraStreamFromDefaults() {\n      return new Promise((resolve, reject) => {\n        if (this.$root.dev_mode === true)\n          console.log(\n            `CaptureSettings  METHODS : setCameraStreamFromDefaults`\n          );\n\n        this.is_loading_feed = true;\n\n        if (this.selected_devices.audio_output_device)\n          this.$emit(\n            \"update:audio_output_deviceId\",\n            this.selected_devices.audio_output_device.deviceId\n          );\n\n        this.startLocalStream()\n          .then(() => {\n            this.stream_current_settings = this.current_settings;\n            this.last_working_resolution = this.desired_camera_resolution;\n            this.is_loading_feed = false;\n            return;\n          })\n          .catch((error) => {\n            this.is_loading_feed = false;\n            this.$alertify\n              .closeLogOnClick(true)\n              .delay(4000)\n              .error(\n                this.$t(\n                  \"notifications.failed_to_start_streams_change_source_or_res\"\n                ) +\n                  \"<br>\" +\n                  error.name\n              );\n            if (this.desired_camera_resolution.type !== \"custom\") {\n              this.unavailable_camera_resolutions.push(\n                this.desired_camera_resolution.label\n              );\n              if (this.last_working_resolution) {\n                this.desired_camera_resolution = this.last_working_resolution;\n                this.last_working_resolution = false;\n                setTimeout(() => {\n                  this.setCameraStreamFromDefaults()\n                    .then(() => resolve())\n                    .catch(() => reject());\n                }, 500);\n              } else {\n                return reject();\n              }\n            }\n          })\n          .then(() => {\n            this.share_this_stream.status.loading = true;\n            return this.setStreamSharing();\n          })\n          .then(() => {\n            this.share_this_stream.status.loading = false;\n            this.is_loading_feed = false;\n            return resolve();\n          })\n          .catch((error) => {\n            this.share_this_stream.status.loading = false;\n            this.is_loading_feed = false;\n            this.$alertify\n              .closeLogOnClick(true)\n              .delay(4000)\n              .error(\n                this.$t(\"notifications.failed_to_share_stream\") +\n                  \"<br>\" +\n                  error.name\n              );\n          });\n      });\n    },\n    startLocalStream() {\n      return new Promise((resolve, reject) => {\n        if (this.$root.dev_mode === true)\n          console.log(`CaptureSettings  METHODS : startLocalStream`);\n\n        //Kill any running streams;\n        if (this.local_stream)\n          this.local_stream.getTracks().forEach((track) => track.stop());\n\n        let constraints = this.createConstraintsFromSelected();\n\n        setTimeout(\n          () => {\n            this.startMediaDeviceFeed(constraints)\n              .then((stream) => {\n                this.local_stream = stream;\n                return resolve();\n              })\n              .catch((error) => {\n                console.log(\"getUserMedia error : \", error);\n                this.$emit(\"show\");\n                if (error.name === \"NotAllowedError\") {\n                  this.status = \"not_allowed\";\n                }\n                return reject(error);\n              });\n          },\n          this.local_stream ? 200 : 0\n        ); //official examples had this at 200\n      });\n    },\n    createConstraintsFromSelected() {\n      if (this.$root.dev_mode === true)\n        console.log(\n          `CaptureSettings  METHODS : createConstraintsFromSelected`\n        );\n\n      let _constraints = {\n        audio: false,\n        video: false,\n      };\n\n      _constraints.audio = {\n        deviceId: this.selected_devices.audio_input_device.deviceId\n          ? { exact: this.selected_devices.audio_input_device.deviceId }\n          : undefined,\n        echoCancellation:\n          this.advanced_capture_options.echoCancellation.enabled,\n        noiseSuppression:\n          this.advanced_capture_options.noiseSuppression.enabled,\n      };\n\n      // IF ELECTRON DESKTOP CAPTURER AND VIDEO ENABLED\n      if (this.selected_devices.video_input_device?.chromeMediaSource) {\n        // screen capture devices\n        _constraints._is_electron_screen_capture = true;\n        _constraints.video = {\n          mandatory: {\n            chromeMediaSource:\n              this.selected_devices.video_input_device.chromeMediaSource,\n            chromeMediaSourceId:\n              this.selected_devices.video_input_device.deviceId,\n            // minWidth: this.desired_camera_resolution.width,\n            // maxWidth: this.desired_camera_resolution.width,\n            // minHeight: this.desired_camera_resolution.height,\n            // maxHeight: this.desired_camera_resolution.height,\n          },\n        };\n      } else {\n        // IF BROWSER SCREEN CAPTURE\n        // IF BROWSER OR ELECTRON CAMERA FEED\n        if (\n          this.selected_devices.video_input_device &&\n          this.selected_devices.video_input_device.deviceId === \"screen_capture\"\n        ) {\n          _constraints._is_webrtc_screen_capture = true;\n          _constraints.video = {\n            cursor: this.advanced_capture_options.cursor.enabled,\n          };\n        } else {\n          _constraints.video = {\n            deviceId: this.selected_devices.video_input_device.deviceId\n              ? {\n                  exact: this.selected_devices.video_input_device.deviceId,\n                }\n              : undefined,\n            width: { exact: this.desired_camera_resolution.width }, //new syntax\n            height: { exact: this.desired_camera_resolution.height }, //new syntax\n          };\n        }\n      }\n\n      console.log(\"Constraints = \" + JSON.stringify(_constraints, null, 4));\n\n      return _constraints;\n    },\n    setStreamSharing() {\n      return new Promise((resolve, reject) => {\n        if (this.$root.dev_mode === true)\n          console.log(`CaptureSettings  METHODS : setStreamSharing`);\n\n        if (!this.share_this_stream.enabled) {\n          this.stopSharingStream();\n          return resolve();\n        }\n\n        if (this.share_this_stream.name.length === 0)\n          return reject(\"missing_stream_name\");\n\n        if (!this.local_stream)\n          this.$alertify\n            .closeLogOnClick(true)\n            .delay(4000)\n            .error(this.$t(\"notifications.no_stream_found_while_sharing\"));\n\n        if (!this.rtcmulti_connection) {\n          this.initRTCMulti();\n        }\n\n        this.rtcmulti_connection.addStream(this.local_stream);\n\n        this.rtcmulti_connection.open(\n          this.share_this_stream.name,\n          (isRoomOpened, roomid, error) => {\n            if (this.$root.dev_mode === true)\n              console.log(\n                `CaptureSettings  METHODS : setStreamSharing  opened room ${roomid}`\n              );\n\n            this.share_this_stream.status.enabled = true;\n            this.share_this_stream.status.name = roomid;\n\n            this.rtcmulti_connection.onNewParticipant = (\n              participantId,\n              userPreferences\n            ) =>\n              this.newParticipantOnStream({ participantId, userPreferences });\n\n            this.rtcmulti_connection.onleave = (participantId) =>\n              this.onParticipantLeave({ participantId });\n\n            if (error) {\n              this.$alertify\n                .closeLogOnClick(true)\n                .delay(4000)\n                .error(\n                  this.$t(\"notifications.failed_to_start_stream_sharing\") +\n                    \" \" +\n                    error.message\n                );\n            }\n          }\n        );\n\n        return resolve();\n      });\n    },\n    newParticipantOnStream({ participantId, userPreferences }) {\n      this.share_this_stream.status.peers_connected.push(participantId);\n\n      this.$alertify\n        .closeLogOnClick(true)\n        .delay(8000)\n        .success(this.$t(\"notifications.new_user_connected_to_stream\"));\n\n      this.rtcmulti_connection.acceptParticipationRequest(\n        participantId,\n        userPreferences\n      );\n    },\n    onParticipantLeave(participantId) {\n      if (this.$root.dev_mode === true)\n        console.log(\n          `CaptureSettings  METHODS : onParticipantLeave ${participantId}`\n        );\n\n      this.share_this_stream.status.peers_connected.filter(\n        (id) => id !== participantId\n      );\n    },\n    callStream() {\n      if (this.$root.dev_mode === true)\n        console.log(`CaptureSettings  METHODS : callStream`);\n\n      this.access_distant_stream.calling = true;\n\n      if (!this.rtcmulti_connection) this.initRTCMulti();\n\n      const call_timeout = setTimeout(() => {\n        this.access_distant_stream.calling = false;\n        this.$alertify\n          .closeLogOnClick(true)\n          .delay(4000)\n          .error(\"Failed to call timeout\");\n      }, 5000);\n\n      this.rtcmulti_connection.onstream = (event) => {\n        if (this.$root.dev_mode === true)\n          console.log(`CaptureSettings  METHODS : callStream  onstream`);\n\n        event.mediaElement.removeAttribute(\"src\");\n        event.mediaElement.removeAttribute(\"srcObject\");\n        event.mediaElement.muted = true;\n        event.mediaElement.volume = 0;\n\n        if (this.access_distant_stream.calling) {\n          this.remote_stream = event.stream;\n          this.access_distant_stream.calling = false;\n          this.access_distant_stream.status.enabled = true;\n          clearTimeout(call_timeout);\n        }\n      };\n\n      this.rtcmulti_connection.checkPresence(\n        this.access_distant_stream.callee,\n        (isOnline, username) => {\n          if (this.$root.dev_mode === true)\n            console.log(\n              `CaptureSettings  METHODS : username  for ${username} and ${isOnline}`\n            );\n          if (!isOnline) {\n            this.$alertify\n              .closeLogOnClick(true)\n              .delay(4000)\n              .error(username + \" is not online.\");\n\n            this.access_distant_stream.calling = false;\n            clearTimeout(call_timeout);\n            return;\n          }\n\n          this.$alertify\n            .closeLogOnClick(true)\n            .delay(4000)\n            .success(username + \" is online.\");\n          this.access_distant_stream.status.callee = username;\n          this.rtcmulti_connection.join(username);\n        }\n      );\n    },\n    hangupStream() {\n      if (this.$root.dev_mode === true)\n        console.log(`CaptureSettings  METHODS : hangupStream`);\n\n      this.rtcmulti_connection.leave();\n      this.access_distant_stream.status.enabled = false;\n    },\n    initRTCMulti() {\n      if (this.$root.dev_mode === true)\n        console.log(`CaptureSettings  METHODS : initRTCMulti`);\n\n      if (!window.rtcmulti_connection)\n        window.rtcmulti_connection = new RTCMultiConnection();\n      this.rtcmulti_connection = window.rtcmulti_connection;\n\n      this.rtcmulti_connection.iceServers = [\n        {\n          urls: [\n            \"stun:stun.l.google.com:19302\",\n            \"stun:stun1.l.google.com:19302\",\n            \"stun:stun2.l.google.com:19302\",\n            \"stun:stun.l.google.com:19302?transport=udp\",\n          ],\n        },\n      ];\n\n      // detect 2G\n      if (\n        navigator.connection &&\n        navigator.connection.type === \"cellular\" &&\n        navigator.connection.downlinkMax <= 0.115\n      )\n        this.$alertify\n          .closeLogOnClick(true)\n          .delay(4000)\n          .error(this.$t(\"bandwidth_very_low_for_stream_sharing\"));\n\n      this.rtcmulti_connection.socketURL =\n        \"https://rtcmulticonnection.herokuapp.com:443/\";\n\n      this.rtcmulti_connection.dontCaptureUserMedia = true;\n\n      this.rtcmulti_connection.session = {\n        video: true,\n        audio: true,\n        oneway: true,\n      };\n\n      this.rtcmulti_connection.onstream = (event) => {\n        console.log(\"CaptureSettings: onstream\");\n        event.mediaElement.volume = 0;\n      };\n      this.rtcmulti_connection.onstreamended = () => {\n        console.log(\"CaptureSettings: onstreamended\");\n        this.$alertify.closeLogOnClick(true).delay(4000).error(\"onstreamended\");\n        // this.share_this_stream.status.enabled = false;\n      };\n      this.rtcmulti_connection.onMediaError = (e) => {\n        console.log(\"CaptureSettings: onMediaError\");\n        this.$alertify\n          .closeLogOnClick(true)\n          .delay(4000)\n          .error(this.$t(\"stream_sharing_media_error\") + e.message);\n      };\n    },\n    stopSharingStream() {\n      if (this.$root.dev_mode === true)\n        console.log(`CaptureSettings  METHODS : stopSharingStream`);\n\n      if (!this.rtcmulti_connection) return;\n\n      // only disconnect peers connected to this stream\n\n      this.share_this_stream.status.peers_connected.map((pid) => {\n        this.rtcmulti_connection.disconnectWith(pid);\n      });\n    },\n    closeMultiRTC() {\n      if (this.$root.dev_mode === true)\n        console.log(`CaptureSettings  METHODS : closeMultiRTC`);\n\n      if (!this.rtcmulti_connection) return;\n\n      this.stopSharingStream();\n      this.rtcmulti_connection.closeSocket();\n    },\n  },\n};\n</script>\n<style lang=\"scss\" scoped>\n.m_captureSettings {\n  position: relative;\n  flex: 1 0 200px;\n  max-width: 280px;\n  background-color: var(--c-rouge);\n  color: white;\n\n  display: flex;\n  flex-flow: column nowrap;\n\n  label,\n  small,\n  .u-buttonLink {\n    color: inherit;\n  }\n}\n\n.m_captureSettings--topbar {\n  flex: 0 0 auto;\n  border-bottom: 2px solid var(--c-rouge_fonce);\n  // padding: calc(var(--spacing) / 2);\n  color: white;\n\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.m_captureSettings--topbar--title {\n  padding: calc(var(--spacing) / 2) var(--spacing);\n  font-weight: 700;\n  font-size: var(--font-large);\n}\n\n.m_captureSettings--settings {\n  overflow-y: auto;\n  flex: 1 1 auto;\n  // padding-bottom: var(--spacing);\n\n  > div {\n    padding: calc(var(--spacing) / 2);\n    padding-top: calc(var(--spacing) / 4);\n    > div {\n      background-color: rgba(0, 0, 0, 0.1);\n      padding: 0 calc(var(--spacing) / 2) calc(var(--spacing) / 2);\n      border-radius: 6px;\n\n      > div {\n        padding-top: calc(var(--spacing) / 4);\n        margin-bottom: calc(var(--spacing) / 4);\n\n        &:last-child {\n          margin-bottom: 0;\n        }\n      }\n    }\n    > label {\n      line-height: 2;\n    }\n  }\n}\n\n.m_captureSettings--settings--resolutions {\n  label {\n    padding: calc(var(--spacing) / 4) 0;\n\n    display: flex;\n    align-items: center;\n\n    > input {\n      flex: 0 0 auto;\n      margin-right: calc(var(--spacing) / 3);\n    }\n  }\n}\n\n.m_captureSettings--updateButton {\n  flex: 0 0 auto;\n  border-top: 2px solid var(--c-rouge_fonce);\n  color: black;\n\n  display: flex;\n  flex-flow: column wrap;\n  // align-items: center;\n  // justify-content: center;\n}\n\n.m_sideBySideSwitches {\n  flex-flow: row nowrap;\n}\n\n.m_sideBySideSwitches > * {\n  display: block;\n  border-color: var(--c-rouge_fonce);\n  min-width: 100px;\n  padding: calc(var(--spacing) / 8) 0;\n\n  display: flex;\n  flex-flow: row wrap;\n  align-items: stretch;\n\n  input {\n    margin: calc(var(--spacing) / 2);\n\n    @media only screen and (max-width: 780px) {\n      margin: calc(var(--spacing) / 4);\n    }\n  }\n\n  > div {\n    flex: 1 1 0;\n    display: flex;\n    flex-flow: row nowrap;\n    align-items: center;\n  }\n\n  small {\n    flex: 0 0 100%;\n    background-color: var(--c-rouge_fonce);\n    display: block;\n    text-align: center;\n    font-style: normal;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n  }\n}\n\n.m_captureSettings--updateButton--buttons {\n  padding: calc(var(--spacing) / 2);\n  display: flex;\n  justify-content: center;\n}\n.m_captureSettings--updateButton--shareStreamToggle {\n  position: relative;\n  background-color: var(--c-rouge_fonce);\n  color: white;\n  text-align: center;\n}\n\n._close_button {\n  position: absolute;\n  top: 0;\n  right: 0;\n  min-height: 0;\n  padding: 0;\n  margin: calc(var(--spacing) / 4);\n}\n</style>\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-37[0].rules[0].use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./CaptureSettings.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-37[0].rules[0].use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./CaptureSettings.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./CaptureSettings.vue?vue&type=template&id=75a82b24&scoped=true&\"\nimport script from \"./CaptureSettings.vue?vue&type=script&lang=js&\"\nexport * from \"./CaptureSettings.vue?vue&type=script&lang=js&\"\nimport style0 from \"./CaptureSettings.vue?vue&type=style&index=0&id=75a82b24&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"75a82b24\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"m_captureEffects\"},[_c('div',{},[_c('div',{staticClass:\"switch switch-xs\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.enable),expression:\"enable\"}],staticClass:\"switch\",attrs:{\"id\":\"enable_effects\",\"type\":\"checkbox\"},domProps:{\"checked\":Array.isArray(_vm.enable)?_vm._i(_vm.enable,null)>-1:(_vm.enable)},on:{\"change\":function($event){var $$a=_vm.enable,$$el=$event.target,$$c=$$el.checked?(true):(false);if(Array.isArray($$a)){var $$v=null,$$i=_vm._i($$a,$$v);if($$el.checked){$$i<0&&(_vm.enable=$$a.concat([$$v]))}else{$$i>-1&&(_vm.enable=$$a.slice(0,$$i).concat($$a.slice($$i+1)))}}else{_vm.enable=$$c}}}}),_c('label',{attrs:{\"for\":\"enable_effects\"}},[_vm._v(_vm._s(_vm.$t(\"enable_effects\")))])]),_c('div',{class:{\n        'is--disabled': !_vm.enable_effects,\n      }},[_c('div',{staticClass:\"switch switch-xs\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.flip_horizontally),expression:\"flip_horizontally\"}],staticClass:\"switch\",attrs:{\"id\":\"flip_horizontally\",\"type\":\"checkbox\"},domProps:{\"checked\":Array.isArray(_vm.flip_horizontally)?_vm._i(_vm.flip_horizontally,null)>-1:(_vm.flip_horizontally)},on:{\"change\":function($event){var $$a=_vm.flip_horizontally,$$el=$event.target,$$c=$$el.checked?(true):(false);if(Array.isArray($$a)){var $$v=null,$$i=_vm._i($$a,$$v);if($$el.checked){$$i<0&&(_vm.flip_horizontally=$$a.concat([$$v]))}else{$$i>-1&&(_vm.flip_horizontally=$$a.slice(0,$$i).concat($$a.slice($$i+1)))}}else{_vm.flip_horizontally=$$c}}}}),_c('label',{attrs:{\"for\":\"flip_horizontally\"}},[_vm._v(_vm._s(_vm.$t(\"flip_horizontally\")))])]),_c('div',{staticClass:\"switch switch-xs\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.flip_vertically),expression:\"flip_vertically\"}],staticClass:\"switch\",attrs:{\"id\":\"flip_vertically\",\"type\":\"checkbox\"},domProps:{\"checked\":Array.isArray(_vm.flip_vertically)?_vm._i(_vm.flip_vertically,null)>-1:(_vm.flip_vertically)},on:{\"change\":function($event){var $$a=_vm.flip_vertically,$$el=$event.target,$$c=$$el.checked?(true):(false);if(Array.isArray($$a)){var $$v=null,$$i=_vm._i($$a,$$v);if($$el.checked){$$i<0&&(_vm.flip_vertically=$$a.concat([$$v]))}else{$$i>-1&&(_vm.flip_vertically=$$a.slice(0,$$i).concat($$a.slice($$i+1)))}}else{_vm.flip_vertically=$$c}}}}),_c('label',{attrs:{\"for\":\"flip_vertically\"}},[_vm._v(_vm._s(_vm.$t(\"flip_vertically\")))])]),_c('div',[_c('div',{staticClass:\"switch switch-xs\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.chroma_key_settings.enable),expression:\"chroma_key_settings.enable\"}],staticClass:\"switch\",attrs:{\"id\":\"chroma_key\",\"type\":\"checkbox\"},domProps:{\"checked\":Array.isArray(_vm.chroma_key_settings.enable)?_vm._i(_vm.chroma_key_settings.enable,null)>-1:(_vm.chroma_key_settings.enable)},on:{\"change\":function($event){var $$a=_vm.chroma_key_settings.enable,$$el=$event.target,$$c=$$el.checked?(true):(false);if(Array.isArray($$a)){var $$v=null,$$i=_vm._i($$a,$$v);if($$el.checked){$$i<0&&(_vm.$set(_vm.chroma_key_settings, \"enable\", $$a.concat([$$v])))}else{$$i>-1&&(_vm.$set(_vm.chroma_key_settings, \"enable\", $$a.slice(0,$$i).concat($$a.slice($$i+1))))}}else{_vm.$set(_vm.chroma_key_settings, \"enable\", $$c)}}}}),_c('label',{attrs:{\"for\":\"chroma_key\"}},[_vm._v(_vm._s(_vm.$t(\"chroma_key\")))])]),_c('div',{class:{\n            'is--disabled': !_vm.chroma_key_settings.enable,\n          }},[_c('div',[_c('label',[_vm._v(_vm._s(_vm.$t(\"color\")))]),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.chroma_key_color_hex),expression:\"chroma_key_color_hex\"}],attrs:{\"type\":\"color\",\"novalue\":_vm.chroma_key_color_hex === ''},domProps:{\"value\":(_vm.chroma_key_color_hex)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.chroma_key_color_hex=$event.target.value}}})]),_c('div',[_c('button',{staticClass:\"u-buttonLink\",attrs:{\"type\":\"button\"},on:{\"click\":_vm.setTogglePickColorFromVideo}},[(!_vm.enable_pick_color_from_video)?[_vm._v(\" \"+_vm._s(_vm.$t(\"pick_color_in_video\"))+\" \")]:[_vm._v(\" \"+_vm._s(_vm.$t(\"click_in_video\"))+\" \")]],2)]),_c('div',[_c('label',[_vm._v(_vm._s(_vm.$t(\"similarity\")))]),_c('input',{directives:[{name:\"model\",rawName:\"v-model.number\",value:(_vm.chroma_key_settings.similarity),expression:\"chroma_key_settings.similarity\",modifiers:{\"number\":true}}],staticClass:\"margin-none\",attrs:{\"type\":\"range\",\"min\":\"0\",\"max\":\"1\",\"step\":\"0.001\"},domProps:{\"value\":(_vm.chroma_key_settings.similarity)},on:{\"__r\":function($event){_vm.$set(_vm.chroma_key_settings, \"similarity\", _vm._n($event.target.value))},\"blur\":function($event){return _vm.$forceUpdate()}}}),_c('label',[_vm._v(_vm._s(_vm.$t(\"smoothness\")))]),_c('input',{directives:[{name:\"model\",rawName:\"v-model.number\",value:(_vm.chroma_key_settings.smoothness),expression:\"chroma_key_settings.smoothness\",modifiers:{\"number\":true}}],staticClass:\"margin-none\",attrs:{\"type\":\"range\",\"min\":\"0\",\"max\":\"1\",\"step\":\"0.001\"},domProps:{\"value\":(_vm.chroma_key_settings.smoothness)},on:{\"__r\":function($event){_vm.$set(_vm.chroma_key_settings, \"smoothness\", _vm._n($event.target.value))},\"blur\":function($event){return _vm.$forceUpdate()}}}),_c('label',[_vm._v(_vm._s(_vm.$t(\"spill\")))]),_c('input',{directives:[{name:\"model\",rawName:\"v-model.number\",value:(_vm.chroma_key_settings.spill),expression:\"chroma_key_settings.spill\",modifiers:{\"number\":true}}],staticClass:\"margin-none\",attrs:{\"type\":\"range\",\"min\":\"0\",\"max\":\"1\",\"step\":\"0.001\",\"value\":\"0.1\"},domProps:{\"value\":(_vm.chroma_key_settings.spill)},on:{\"__r\":function($event){_vm.$set(_vm.chroma_key_settings, \"spill\", _vm._n($event.target.value))},\"blur\":function($event){return _vm.$forceUpdate()}}})]),_c('label',[_vm._v(_vm._s(_vm.$t(\"replace_color_with\")))]),_c('div',{staticClass:\"switch switch-xs switch_twoway padding-verysmall\"},[_c('label',{staticClass:\"cursor-pointer\",class:{\n                'is--active':\n                  _vm.chroma_key_settings.replacement_mode === 'color',\n              },attrs:{\"for\":\"chroma_key_use_image\"}},[_c('span',{},[_vm._v(_vm._s(_vm.$t(\"color\")))])]),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.chroma_key_settings.replacement_mode),expression:\"chroma_key_settings.replacement_mode\"}],attrs:{\"type\":\"checkbox\",\"id\":\"chroma_key_use_image\",\"value\":\"color\",\"true-value\":\"image\",\"false-value\":\"color\"},domProps:{\"checked\":Array.isArray(_vm.chroma_key_settings.replacement_mode)?_vm._i(_vm.chroma_key_settings.replacement_mode,\"color\")>-1:_vm._q(_vm.chroma_key_settings.replacement_mode,\"image\")},on:{\"change\":function($event){var $$a=_vm.chroma_key_settings.replacement_mode,$$el=$event.target,$$c=$$el.checked?(\"image\"):(\"color\");if(Array.isArray($$a)){var $$v=\"color\",$$i=_vm._i($$a,$$v);if($$el.checked){$$i<0&&(_vm.$set(_vm.chroma_key_settings, \"replacement_mode\", $$a.concat([$$v])))}else{$$i>-1&&(_vm.$set(_vm.chroma_key_settings, \"replacement_mode\", $$a.slice(0,$$i).concat($$a.slice($$i+1))))}}else{_vm.$set(_vm.chroma_key_settings, \"replacement_mode\", $$c)}}}}),_c('label',{class:{\n                'is--active':\n                  _vm.chroma_key_settings.replacement_mode === 'image',\n              },attrs:{\"for\":\"chroma_key_use_image\"}},[_c('span',{},[_vm._v(_vm._s(_vm.$t(\"image\")))])])]),(_vm.chroma_key_settings.replacement_mode === 'image')?_c('div',[_c('ImageSelect',{attrs:{\"load_from_projects_medias\":true,\"project_slug\":_vm.project_slug},on:{\"newPreview\":_vm.newChromaKeyImage}})],1):_c('div',[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.chroma_key_replacement_color_hex),expression:\"chroma_key_replacement_color_hex\"}],attrs:{\"type\":\"color\",\"novalue\":_vm.chroma_key_replacement_color_hex === ''},domProps:{\"value\":(_vm.chroma_key_replacement_color_hex)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.chroma_key_replacement_color_hex=$event.target.value}}})])])]),_vm._l((Object.entries(_vm.image_filters_settings)),function(ref){\n              var name = ref[0];\n              var props = ref[1];\nreturn _c('div',{key:name},[_c('div',{staticClass:\"switch switch-xs\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.image_filters_settings[name].enable),expression:\"image_filters_settings[name].enable\"}],staticClass:\"switch\",attrs:{\"id\":(name + \"_slider\"),\"type\":\"checkbox\"},domProps:{\"checked\":Array.isArray(_vm.image_filters_settings[name].enable)?_vm._i(_vm.image_filters_settings[name].enable,null)>-1:(_vm.image_filters_settings[name].enable)},on:{\"change\":function($event){var $$a=_vm.image_filters_settings[name].enable,$$el=$event.target,$$c=$$el.checked?(true):(false);if(Array.isArray($$a)){var $$v=null,$$i=_vm._i($$a,$$v);if($$el.checked){$$i<0&&(_vm.$set(_vm.image_filters_settings[name], \"enable\", $$a.concat([$$v])))}else{$$i>-1&&(_vm.$set(_vm.image_filters_settings[name], \"enable\", $$a.slice(0,$$i).concat($$a.slice($$i+1))))}}else{_vm.$set(_vm.image_filters_settings[name], \"enable\", $$c)}}}}),_c('label',{attrs:{\"for\":(name + \"_slider\")}},[_vm._v(_vm._s(_vm.$t(name))+\"  \"+_vm._s(_vm.image_filters_settings[name].value))])]),_c('div',{class:{\n            'is--disabled': !_vm.image_filters_settings[name].enable,\n          }},[_c('input',{directives:[{name:\"model\",rawName:\"v-model.number\",value:(_vm.image_filters_settings[name].value),expression:\"image_filters_settings[name].value\",modifiers:{\"number\":true}}],staticClass:\"margin-none\",attrs:{\"type\":\"range\",\"min\":props.min,\"max\":props.max,\"step\":props.step,\"title\":_vm.image_filters_settings[name].value},domProps:{\"value\":(_vm.image_filters_settings[name].value)},on:{\"__r\":function($event){_vm.$set(_vm.image_filters_settings[name], \"value\", _vm._n($event.target.value))},\"blur\":function($event){return _vm.$forceUpdate()}}})])])})],2)])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"m_captureEffects\">\n    <div class=\"\">\n      <div class=\"switch switch-xs\">\n        <input\n          class=\"switch\"\n          id=\"enable_effects\"\n          type=\"checkbox\"\n          v-model=\"enable\"\n        />\n        <label for=\"enable_effects\">{{ $t(\"enable_effects\") }}</label>\n      </div>\n\n      <div\n        :class=\"{\n          'is--disabled': !enable_effects,\n        }\"\n      >\n        <div class=\"switch switch-xs\">\n          <input\n            class=\"switch\"\n            id=\"flip_horizontally\"\n            type=\"checkbox\"\n            v-model=\"flip_horizontally\"\n          />\n          <label for=\"flip_horizontally\">{{ $t(\"flip_horizontally\") }}</label>\n        </div>\n        <div class=\"switch switch-xs\">\n          <input\n            class=\"switch\"\n            id=\"flip_vertically\"\n            type=\"checkbox\"\n            v-model=\"flip_vertically\"\n          />\n          <label for=\"flip_vertically\">{{ $t(\"flip_vertically\") }}</label>\n        </div>\n\n        <div>\n          <div class=\"switch switch-xs\">\n            <input\n              class=\"switch\"\n              id=\"chroma_key\"\n              type=\"checkbox\"\n              v-model=\"chroma_key_settings.enable\"\n            />\n            <label for=\"chroma_key\">{{ $t(\"chroma_key\") }}</label>\n          </div>\n          <div\n            :class=\"{\n              'is--disabled': !chroma_key_settings.enable,\n            }\"\n          >\n            <div>\n              <label>{{ $t(\"color\") }}</label>\n              <input\n                type=\"color\"\n                v-model=\"chroma_key_color_hex\"\n                :novalue=\"chroma_key_color_hex === ''\"\n              />\n            </div>\n            <div>\n              <button\n                type=\"button\"\n                class=\"u-buttonLink\"\n                @click=\"setTogglePickColorFromVideo\"\n              >\n                <template v-if=\"!enable_pick_color_from_video\">\n                  {{ $t(\"pick_color_in_video\") }}\n                </template>\n                <template v-else>\n                  {{ $t(\"click_in_video\") }}\n                </template>\n              </button>\n            </div>\n\n            <div>\n              <label>{{ $t(\"similarity\") }}</label>\n              <input\n                class=\"margin-none\"\n                type=\"range\"\n                v-model.number=\"chroma_key_settings.similarity\"\n                min=\"0\"\n                max=\"1\"\n                step=\"0.001\"\n              />\n\n              <label>{{ $t(\"smoothness\") }}</label>\n              <input\n                class=\"margin-none\"\n                type=\"range\"\n                v-model.number=\"chroma_key_settings.smoothness\"\n                min=\"0\"\n                max=\"1\"\n                step=\"0.001\"\n              />\n\n              <label>{{ $t(\"spill\") }}</label>\n              <input\n                class=\"margin-none\"\n                type=\"range\"\n                v-model.number=\"chroma_key_settings.spill\"\n                min=\"0\"\n                max=\"1\"\n                step=\"0.001\"\n                value=\"0.1\"\n              />\n            </div>\n\n            <label>{{ $t(\"replace_color_with\") }}</label>\n\n            <div class=\"switch switch-xs switch_twoway padding-verysmall\">\n              <label\n                for=\"chroma_key_use_image\"\n                class=\"cursor-pointer\"\n                :class=\"{\n                  'is--active':\n                    chroma_key_settings.replacement_mode === 'color',\n                }\"\n              >\n                <span class>{{ $t(\"color\") }}</span>\n              </label>\n              <input\n                type=\"checkbox\"\n                id=\"chroma_key_use_image\"\n                v-model=\"chroma_key_settings.replacement_mode\"\n                value=\"color\"\n                true-value=\"image\"\n                false-value=\"color\"\n              />\n              <label\n                for=\"chroma_key_use_image\"\n                :class=\"{\n                  'is--active':\n                    chroma_key_settings.replacement_mode === 'image',\n                }\"\n              >\n                <span class>{{ $t(\"image\") }}</span>\n              </label>\n            </div>\n\n            <div v-if=\"chroma_key_settings.replacement_mode === 'image'\">\n              <ImageSelect\n                :load_from_projects_medias=\"true\"\n                :project_slug=\"project_slug\"\n                @newPreview=\"newChromaKeyImage\"\n              />\n              <!-- {{ chroma_key_settings.replacement_image }} -->\n            </div>\n            <div v-else>\n              <input\n                type=\"color\"\n                v-model=\"chroma_key_replacement_color_hex\"\n                :novalue=\"chroma_key_replacement_color_hex === ''\"\n              />\n            </div>\n          </div>\n        </div>\n        <div\n          v-for=\"[name, props] in Object.entries(image_filters_settings)\"\n          :key=\"name\"\n        >\n          <div class=\"switch switch-xs\">\n            <input\n              class=\"switch\"\n              :id=\"`${name}_slider`\"\n              type=\"checkbox\"\n              v-model=\"image_filters_settings[name].enable\"\n            />\n            <label :for=\"`${name}_slider`\"\n              >{{ $t(name) }}  {{ image_filters_settings[name].value }}</label\n            >\n          </div>\n\n          <div\n            :class=\"{\n              'is--disabled': !image_filters_settings[name].enable,\n            }\"\n          >\n            <input\n              class=\"margin-none\"\n              type=\"range\"\n              v-model.number=\"image_filters_settings[name].value\"\n              :min=\"props.min\"\n              :max=\"props.max\"\n              :step=\"props.step\"\n              :title=\"image_filters_settings[name].value\"\n            />\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n<script>\nimport ImageSelect from \"@/adc-core/fields/ImageSelect.vue\";\n\nexport default {\n  props: {\n    enable_effects: Boolean,\n    videoElement: HTMLVideoElement,\n    canvasElement: HTMLCanvasElement,\n  },\n  components: {\n    ImageSelect,\n  },\n  data() {\n    return {\n      enable: this.enable_effects,\n\n      source_stream_resolution: {\n        width: undefined,\n        height: undefined,\n      },\n\n      flip_horizontally: false,\n      flip_vertically: false,\n\n      chroma_key_settings: {\n        enable: false,\n        key_color: {\n          r: 0,\n          g: 255,\n          b: 0,\n        }, // 0 -> 1 by 0.001\n        similarity: 0.04, // 0 -> 1 by 0.001\n        smoothness: 0.08, // 0 -> 1 by 0.001\n        spill: 0.1, // 0 -> 1 by 0.001\n        replacement_color: {\n          r: 252,\n          g: 75,\n          b: 96,\n        },\n        replacement_mode: \"color\",\n        replacement_image: undefined,\n      },\n\n      project_slug: \"\",\n\n      image_filters_settings: {\n        brightness: {\n          enable: false,\n          value: 1,\n          order: 0,\n          default: 1,\n          min: 0,\n          max: 2,\n          step: 0.01,\n        },\n        contrast: {\n          enable: false,\n          value: 1,\n          order: 1,\n          default: 1,\n          min: 0,\n          max: 3,\n          step: 0.01,\n        },\n        hue: {\n          enable: false,\n          value: 0,\n          order: 2,\n          default: 0,\n          min: -0.5,\n          max: 0.5,\n          step: 0.01,\n        },\n        saturation: {\n          enable: false,\n          value: 0,\n          order: 3,\n          default: 0,\n          min: -1,\n          max: 1,\n          step: 0.01,\n        },\n        lightness: {\n          enable: false,\n          value: 0,\n          order: 4,\n          default: 0,\n          min: -1,\n          max: 1,\n          step: 0.01,\n        },\n        dotscreen: {\n          enable: false,\n          value: 10,\n          order: 6,\n          default: 10,\n          min: 3,\n          max: 20,\n          step: 0.01,\n        },\n      },\n\n      enable_pick_color_from_video: false,\n\n      offscreen_canvas: undefined,\n\n      fragment_shader: `\nprecision mediump float;\n#define PI 3.1415926538\n\nuniform sampler2D videoTex;\nuniform float texWidth;\nuniform float texHeight;\n\n\nuniform int flipHorizontally;\nuniform int flipVertically;\n\nuniform vec3 keyColor;\nuniform vec3 replacementColor;\nuniform sampler2D replacementImage;\n\nuniform float similarity;\nuniform float smoothness;\nuniform float spill;\nuniform int chromaKeyMode;\n\nuniform float brightness;\nuniform float contrast;\nuniform float mid;\n\nuniform float hue;\nuniform float saturation;\nuniform float lightness;\n\nuniform float dotscreen;\n\n\n// From https://github.com/libretro/glsl-shaders/blob/master/nnedi3/shaders/rgb-to-yuv.glsl\nvec2 RGBtoUV(vec3 rgb) {\n  return vec2(\n    rgb.r * -0.169 + rgb.g * -0.331 + rgb.b *  0.5    + 0.5,\n    rgb.r *  0.5   + rgb.g * -0.419 + rgb.b * -0.081  + 0.5\n  );\n}\n\nvec4 ProcessChromaKey(vec2 texCoord, vec4 videoColor) {\n  float chromaDist = distance(RGBtoUV(videoColor.rgb), RGBtoUV(keyColor));\n\n  float baseMask = chromaDist - similarity;\n  float fullMask = pow(clamp(baseMask / smoothness, 0., 1.), 1.5);\n  videoColor.a = fullMask;\n\n  float spillVal = pow(clamp(baseMask / spill, 0., 1.), 1.5);\n  float desat = clamp(videoColor.r * 0.2126 + videoColor.g * 0.7152 + videoColor.b * 0.0722, 0., 1.);\n  videoColor.rgb = mix(vec3(desat, desat, desat), videoColor.rgb, spillVal);\n\n  return videoColor;\n}\nvec4 ApplyChromaKey(vec2 texCoord, vec4 videoColor)  {\n  vec4 chromaVideoColor = ProcessChromaKey(texCoord, videoColor);\n\n  vec4 replaceWith = vec4(0.0);\n  if(chromaKeyMode == 0) {\n    // color\n    replaceWith = vec4(replacementColor, 1.0);\n  } else if(chromaKeyMode == 1) {\n    // image\n    replaceWith = vec4(texture2D(replacementImage, texCoord));\n  }\n\n  vec4 result = mix(vec4(chromaVideoColor.rgb, 1.0), replaceWith, 1.0 - chromaVideoColor.a);\n  return result;\n}\n\nvec3 RGBtoHCV(vec3 RGB) {\n  float Epsilon = 0.00000000001;\n  // Based on work by Sam Hocevar and Emil Persson\n  vec4 P = (RGB.g < RGB.b) ? vec4(RGB.bg, -1.0, 2.0/3.0) : vec4(RGB.gb, 0.0, -1.0/3.0);\n  vec4 Q = (RGB.r < P.x) ? vec4(P.xyw, RGB.r) : vec4(RGB.r, P.yzx);\n  float C = Q.x - min(Q.w, Q.y);\n  float H = abs((Q.w - Q.y) / (6.0 * C + Epsilon) + Q.z);\n  return vec3(H, C, Q.x);\n}\nvec3 HUEtoRGB(float h) {\n  float r = abs(h * 6.0 - 3.0) - 1.0;\n  float g = 2.0 - abs(h * 6.0 - 2.0);\n  float b = 2.0 - abs(h * 6.0 - 4.0);\n  return clamp(vec3(r, g, b), 0.0, 1.0);\n}\n\nvec3 RGBtoHSL(vec3 RGB) {\n  float Epsilon = 0.00000000001;\n  vec3 HCV = RGBtoHCV(RGB);\n  float L = HCV.z - HCV.y * 0.5;\n  float S = HCV.y / (1.0 - abs(L * 2.0 - 1.0) + Epsilon);\n  return vec3(HCV.x, S, L);\n}\nvec3 HSLtoRGB(vec3 HSL) {\n  vec3 RGB = HUEtoRGB(HSL.x);\n  float C = (1.0 - abs(2.0 * HSL.z - 1.0)) * HSL.y;\n  return (RGB - 0.5) * C + HSL.z;\n}\nfloat clamp_continuous(float value) {\n  float unit = value;\n\n  if (unit > 1.0) {\n    unit = mod(unit, 1.0);\n  } else if (unit < 0.0) {\n    unit = 1.0 + unit;\n  }\n\n  return unit;\n}\n\nfloat mix_factor(vec4 range, vec3 hsl) {\n  float mix_factor = 0.0;\n\n  if (hsl.x >= range.x && hsl.x <= range.w) {\n    // lower range\n    if (hsl.x >= range.x && hsl.x < range.y) {\n      mix_factor = smoothstep(range.x, range.y, hsl.x);\n    }\n\n    // target range\n    if (hsl.x >= range.y && hsl.x <= range.z) {\n      mix_factor = 1.0;\n    }\n\n    // upper range\n    if (hsl.x > range.z && hsl.x <= range.w) {\n      mix_factor = 1.0 - smoothstep(range.z, range.w, hsl.x);\n    }\n  }\n\n  vec2 lightness_range = vec2(0.0, 0.08333);\n  vec2 saturation_range = vec2(0.0, 0.08333);\n  mix_factor *= smoothstep(saturation_range.x, saturation_range.y, hsl.y);\n  mix_factor *= smoothstep(lightness_range.x, lightness_range.y, hsl.z);\n\n  return mix_factor;\n}\n\nfloat pattern(vec2 texCoord) {\n  float angle = PI / 8.0;\n  float s = sin(angle), c = cos(angle);\n  vec2 tex = texCoord * vec2(texWidth, texHeight) - vec2(0.5, 0.5);\n  vec2 point = vec2(\n      c * tex.x - s * tex.y,\n      s * tex.x + c * tex.y\n  ) * (PI / dotscreen);\n  return (sin(point.x) * sin(point.y)) * 4.0;\n}\n\nvoid main(void) {\n  // get video image\n  vec2 texCoord = vec2(gl_FragCoord.x/texWidth, 1.0 - (gl_FragCoord.y/texHeight));\n\n  if(flipVertically == 1)\n    texCoord.y = 1.0 - texCoord.y;\n  if(flipHorizontally == 1)\n    texCoord.x = 1.0 - texCoord.x;\n\n  vec4 videoColor = texture2D(videoTex, texCoord);\n\n  // apply chroma key if necessary\n  if (chromaKeyMode != -1000) {\n    videoColor = ApplyChromaKey(texCoord, videoColor);\n  }\n\n  // apply brightness, from https://github.com/actionnick/exposure/blob/master/src/shaders/exposure.frag\n  if(brightness != -1000.0) {\n    videoColor = mix(videoColor, vec4(1.0, 1.0, 1.0, 1.0), brightness - 1.0);\n    videoColor.a = 1.0;\n  }\n\n  // contrast\n  if(contrast != -1000.0) {\n    videoColor.r = ((videoColor.r - mid) * contrast) + mid;\n    videoColor.g = ((videoColor.g - mid) * contrast) + mid;\n    videoColor.b = ((videoColor.b - mid) * contrast) + mid;\n    videoColor.a = 1.0;\n  }\n\n  // hue, saturation, lightness\n  if(hue != -1000.0 || saturation != -1000.0 || lightness != -1000.0) {\n    vec3 hsl = RGBtoHSL(videoColor.rgb);\n    vec4 MASTER_RANGE = vec4(0.0, 0.0, 1.0, 1.0);\n\n    float master_mix_factor = mix_factor(MASTER_RANGE, hsl);\n    // hue\n    if(hue != -1000.0) {\n      hsl.x = clamp_continuous(hsl.x + (hue * master_mix_factor));\n    }\n    // saturation\n    if(saturation != -1000.0) {\n      hsl.y = clamp(hsl.y + (saturation * master_mix_factor), 0.0, 1.0);\n    }\n    // lightness\n    if(lightness != -1000.0) {\n      hsl.z = clamp(mix(hsl.z, 1.0, max(0.0, lightness)), 0.0, 1.0);\n      hsl.z = clamp(mix(hsl.z, 0.0, abs(min(0.0, lightness))), 0.0, 1.0);\n    }\n\n    videoColor.rgb = HSLtoRGB(hsl);\n  }\n\n  if(dotscreen != -1000.0) {\n    float average = (videoColor.r + videoColor.g + videoColor.b) / 3.0;\n    videoColor = vec4(vec3(average * 10.0 - 5.0 + pattern(texCoord)), videoColor.a);\n  }\n\n  gl_FragColor = videoColor;\n\n}\n      `,\n    };\n  },\n  created() {\n    // if (this.$root.do_navigation.current_project_slug) {\n    //   this.project_slug = this.$root.do_navigation.current_project_slug;\n    // }\n  },\n  updated() {},\n  mounted() {\n    this.$eventHub.$on(\n      \"captureCanvas.pixelColorUnderMouse\",\n      this.pixelColorUnderMouse\n    );\n  },\n  beforeDestroy() {\n    this.$eventHub.$off(\n      \"captureCanvas.pixelColorUnderMouse\",\n      this.pixelColorUnderMouse\n    );\n    this.stopWebGL();\n  },\n  watch: {\n    enable_effects() {\n      if (this.enable !== this.enable_effects) {\n        this.enable = this.enable_effects;\n      }\n    },\n    enable() {\n      this.$emit(\"update:enable_effects\", this.enable);\n      if (this.enable) {\n        this.$nextTick(() => {\n          this.startWebGL();\n        });\n      }\n    },\n  },\n  computed: {\n    chroma_key_color_hex: {\n      get() {\n        return this.rgbToHex(this.chroma_key_settings.key_color);\n      },\n      set(value) {\n        this.chroma_key_settings.key_color = this.hexToRgb(value);\n      },\n    },\n    chroma_key_replacement_color_hex: {\n      get() {\n        return this.rgbToHex(this.chroma_key_settings.replacement_color);\n      },\n      set(value) {\n        this.chroma_key_settings.replacement_color = this.hexToRgb(value);\n      },\n    },\n  },\n  methods: {\n    hexToRgb(hex) {\n      var result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\n      return result\n        ? {\n            r: parseInt(result[1], 16),\n            g: parseInt(result[2], 16),\n            b: parseInt(result[3], 16),\n          }\n        : null;\n    },\n    rgbToHex({ r, g, b }) {\n      r = r.toString(16);\n      g = g.toString(16);\n      b = b.toString(16);\n\n      if (r.length == 1) r = \"0\" + r;\n      if (g.length == 1) g = \"0\" + g;\n      if (b.length == 1) b = \"0\" + b;\n\n      return \"#\" + r + g + b;\n    },\n    setTogglePickColorFromVideo() {\n      if (!this.enable_pick_color_from_video) {\n        this.chroma_key_settings.enable = false;\n        this.enable = true;\n        this.enable_pick_color_from_video = true;\n      } else {\n        this.chroma_key_settings.enable = true;\n        this.enable_pick_color_from_video = false;\n      }\n    },\n    pixelColorUnderMouse({ px_color, type }) {\n      if (!this.enable_pick_color_from_video) return;\n\n      this.chroma_key_settings.key_color = px_color;\n      if (type === \"click\") this.setTogglePickColorFromVideo();\n    },\n    startWebGL() {\n      console.log(`CaptureEffects  METHODS : startWebGL`);\n\n      if (this.offscreen_canvas) this.stopWebGL();\n\n      this.offscreen_canvas = document.createElement(\"canvas\");\n      this.offscreen_canvas.classList.add(\"offscreenCanvas\");\n\n      var destination_canvas = this.canvasElement.getContext(\"2d\");\n\n      const gl = this.offscreen_canvas.getContext(\"webgl\", {\n        premultipliedAlpha: false,\n      });\n\n      // setting default vertex shader\n      const vs = gl.createShader(gl.VERTEX_SHADER);\n      gl.shaderSource(\n        vs,\n        \"attribute vec2 c; void main(void) { gl_Position=vec4(c, 0.0, 1.0); }\"\n      );\n      gl.compileShader(vs);\n\n      // setting default fragment shader\n      const fs = gl.createShader(gl.FRAGMENT_SHADER);\n      gl.shaderSource(fs, this.fragment_shader);\n      gl.compileShader(fs);\n\n      if (!gl.getShaderParameter(fs, gl.COMPILE_STATUS)) {\n        console.error(gl.getShaderInfoLog(fs));\n      }\n\n      const prog = gl.createProgram();\n      gl.attachShader(prog, vs);\n      gl.attachShader(prog, fs);\n      gl.linkProgram(prog);\n      gl.useProgram(prog);\n\n      const vb = gl.createBuffer();\n      gl.bindBuffer(gl.ARRAY_BUFFER, vb);\n      gl.bufferData(\n        gl.ARRAY_BUFFER,\n        new Float32Array([-1, 1, -1, -1, 1, -1, 1, 1]),\n        gl.STATIC_DRAW\n      );\n\n      const coordLoc = gl.getAttribLocation(prog, \"c\");\n      gl.vertexAttribPointer(coordLoc, 2, gl.FLOAT, false, 0, 0);\n      gl.enableVertexAttribArray(coordLoc);\n\n      gl.activeTexture(gl.TEXTURE0 + 0);\n      const tex = gl.createTexture();\n      gl.bindTexture(gl.TEXTURE_2D, tex);\n\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n\n      const videoTexLoc = gl.getUniformLocation(prog, \"videoTex\");\n      gl.uniform1i(videoTexLoc, 0);\n\n      const texWidthLoc = gl.getUniformLocation(prog, \"texWidth\");\n      const texHeightLoc = gl.getUniformLocation(prog, \"texHeight\");\n\n      const flipHorizontallyLoc = gl.getUniformLocation(\n        prog,\n        \"flipHorizontally\"\n      );\n      const flipVerticallyLoc = gl.getUniformLocation(prog, \"flipVertically\");\n\n      const keyColorLoc = gl.getUniformLocation(prog, \"keyColor\");\n      const replacementColorLoc = gl.getUniformLocation(\n        prog,\n        \"replacementColor\"\n      );\n      const replacementImageLoc = gl.getUniformLocation(\n        prog,\n        \"replacementImage\"\n      );\n      gl.uniform1i(replacementImageLoc, 1);\n\n      const similarityLoc = gl.getUniformLocation(prog, \"similarity\");\n      const smoothnessLoc = gl.getUniformLocation(prog, \"smoothness\");\n      const spillLoc = gl.getUniformLocation(prog, \"spill\");\n      const chromaKeyModeLoc = gl.getUniformLocation(prog, \"chromaKeyMode\");\n      const midLoc = gl.getUniformLocation(prog, \"mid\");\n\n      const imageFiltersLoc = Object.keys(this.image_filters_settings).reduce(\n        (acc, _s) => {\n          acc[_s] = gl.getUniformLocation(prog, _s);\n          return acc;\n        },\n        {}\n      );\n\n      this.loadReplacementImageInShader();\n\n      const processFrame = () => {\n        if (!this.offscreen_canvas || !this.enable) return;\n\n        console.log(`CaptureEffects  METHODS : startWebGL  processFrame`);\n\n        this.offscreen_canvas.width = this.videoElement.videoWidth;\n        this.offscreen_canvas.height = this.videoElement.videoHeight;\n\n        // LOADING VIDEO IMAGE TO WEBGL\n        gl.activeTexture(gl.TEXTURE0 + 0);\n        gl.viewport(\n          0,\n          0,\n          this.videoElement.videoWidth,\n          this.videoElement.videoHeight\n        );\n\n        gl.texImage2D(\n          gl.TEXTURE_2D,\n          0,\n          gl.RGB,\n          gl.RGB,\n          gl.UNSIGNED_BYTE,\n          this.videoElement\n        );\n        // STOPPED LOADING WEBGL IMAGE\n\n        gl.uniform1f(texWidthLoc, this.videoElement.videoWidth);\n        gl.uniform1f(texHeightLoc, this.videoElement.videoHeight);\n\n        gl.uniform1i(flipHorizontallyLoc, this.flip_horizontally ? 1 : 0);\n        gl.uniform1i(flipVerticallyLoc, this.flip_vertically ? 1 : 0);\n\n        gl.uniform3f(\n          keyColorLoc,\n          this.chroma_key_settings.key_color.r / 255,\n          this.chroma_key_settings.key_color.g / 255,\n          this.chroma_key_settings.key_color.b / 255\n        );\n        gl.uniform3f(\n          replacementColorLoc,\n          this.chroma_key_settings.replacement_color.r / 255,\n          this.chroma_key_settings.replacement_color.g / 255,\n          this.chroma_key_settings.replacement_color.b / 255\n        );\n\n        gl.uniform1f(\n          similarityLoc,\n          parseFloat(this.chroma_key_settings.similarity)\n        );\n        gl.uniform1f(\n          smoothnessLoc,\n          parseFloat(this.chroma_key_settings.smoothness)\n        );\n        gl.uniform1f(spillLoc, parseFloat(this.chroma_key_settings.spill));\n\n        Object.entries(imageFiltersLoc).map(([name, loc]) => {\n          gl.uniform1f(\n            loc,\n            parseFloat(\n              this.image_filters_settings[name].enable\n                ? this.image_filters_settings[name].value\n                : -1000\n            )\n          );\n        });\n        gl.uniform1f(midLoc, parseFloat(0.5));\n\n        // check if chroma_key_settings.enable\n        // -1000 = false\n        let chromaKeyMode = -1000;\n        if (this.chroma_key_settings.enable) {\n          if (this.chroma_key_settings.replacement_mode === \"color\") {\n            chromaKeyMode = 0;\n          } else if (this.chroma_key_settings.replacement_mode === \"image\") {\n            chromaKeyMode = 1;\n          }\n        }\n        gl.uniform1i(chromaKeyModeLoc, parseInt(chromaKeyMode));\n\n        gl.drawArrays(gl.TRIANGLE_FAN, 0, 4);\n\n        destination_canvas.drawImage(this.offscreen_canvas, 0, 0);\n\n        window.requestAnimationFrame(processFrame);\n      };\n      window.requestAnimationFrame(processFrame);\n    },\n    stopWebGL() {\n      this.offscreen_canvas = undefined;\n    },\n    newChromaKeyImage(img) {\n      console.log(`CaptureEffects  METHODS : newChromaKeyImage`);\n\n      if (img === false) {\n        this.chroma_key_settings.replacement_image = undefined;\n        this.loadReplacementImageInShader();\n        return;\n      }\n\n      var imageElement = new Image();\n\n      if (typeof img === \"string\") imageElement.src = img;\n      else if (typeof img === \"object\") imageElement.src = img.thumb;\n\n      imageElement.onload = () => {\n        const canvas = document.createElement(\"canvas\"),\n          ctx = canvas.getContext(\"2d\");\n\n        canvas.width = this.videoElement.videoWidth;\n        canvas.height = this.videoElement.videoHeight;\n\n        const coverImg = (img, type, c_width, c_height) => {\n          const img_ratio = img.height / img.width;\n          const c_ratio = c_height / c_width;\n          if (\n            (img_ratio < c_ratio && type === \"contain\") ||\n            (img_ratio > c_ratio && type === \"cover\")\n          ) {\n            const h = c_width * img_ratio;\n            ctx.drawImage(img, 0, (c_height - h) / 2, c_width, h);\n          }\n          if (\n            (img_ratio > c_ratio && type === \"contain\") ||\n            (img_ratio < c_ratio && type === \"cover\")\n          ) {\n            const w = (c_width * c_ratio) / img_ratio;\n            ctx.drawImage(img, (c_width - w) / 2, 0, w, c_height);\n          }\n        };\n\n        coverImg(imageElement, \"cover\", canvas.width, canvas.height);\n\n        this.chroma_key_settings.replacement_image = ctx.getImageData(\n          0,\n          0,\n          canvas.width,\n          canvas.height\n        );\n\n        this.loadReplacementImageInShader();\n\n        canvas.remove();\n      };\n    },\n    loadReplacementImageInShader() {\n      const gl = this.offscreen_canvas.getContext(\"webgl\", {\n        premultipliedAlpha: false,\n      });\n\n      gl.activeTexture(gl.TEXTURE1);\n      const tex2 = gl.createTexture();\n      gl.bindTexture(gl.TEXTURE_2D, tex2);\n\n      // gl.texImage2D(\n      //   gl.TEXTURE_2D,\n      //   0,\n      //   gl.RGBA,\n      //   1,\n      //   1,\n      //   0,\n      //   gl.RGBA,\n      //   gl.UNSIGNED_BYTE,\n      //   new Uint8Array([0, 0, 255, 255])\n      // );\n\n      if (this.chroma_key_settings.replacement_image)\n        gl.texImage2D(\n          gl.TEXTURE_2D,\n          0,\n          gl.RGBA,\n          gl.RGBA,\n          gl.UNSIGNED_BYTE,\n          this.chroma_key_settings.replacement_image\n        );\n\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n    },\n  },\n};\n</script>\n<style lang=\"scss\" scoped>\n.m_captureEffects {\n  position: relative;\n  flex: 1 0 200px;\n  max-width: 280px;\n  background-color: var(--c-bleumarine);\n  padding: calc(var(--spacing) / 8);\n  overflow: auto;\n\n  label {\n    display: block;\n  }\n\n  > * {\n    background-color: #fff;\n    border-radius: 4px;\n    margin: calc(var(--spacing) / 2);\n    padding: calc(var(--spacing) / 8);\n\n    > * {\n      &:first-child {\n        padding: calc(var(--spacing) / 4);\n      }\n      &:not(:first-child) {\n        > * {\n          padding: calc(var(--spacing) / 4);\n          margin: 0 calc(var(--spacing) / 4) calc(var(--spacing) / 2);\n          background-color: var(--c-gris-clair);\n          border-radius: 4px;\n        }\n      }\n    }\n  }\n}\n\n.is--disabled {\n  filter: grayscale(100%);\n  opacity: 0.7;\n  cursor: not-allowed;\n  user-select: none;\n\n  > * {\n    pointer-events: none;\n  }\n}\n</style>\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-37[0].rules[0].use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./CaptureEffects.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-37[0].rules[0].use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./CaptureEffects.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./CaptureEffects.vue?vue&type=template&id=03babde1&scoped=true&\"\nimport script from \"./CaptureEffects.vue?vue&type=script&lang=js&\"\nexport * from \"./CaptureEffects.vue?vue&type=script&lang=js&\"\nimport style0 from \"./CaptureEffects.vue?vue&type=style&index=0&id=03babde1&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"03babde1\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"m_stopmotionList\"},[(Object.keys(_vm.stopmotions).length > 0)?[_c('ul',_vm._l((_vm.stopmotions),function(stopmotion,index){return _c('li',{key:stopmotion.slugFolderName},[_c('div',{staticClass:\"_preview\",on:{\"click\":function($event){return _vm.loadStopmotion(stopmotion.slugFolderName)}}},[_vm._v(\" MediaContent \")]),_c('label',{},[_vm._v(\" \"+_vm._s(_vm.$t(\"stopmotion\"))+\" \"+_vm._s(index + 1)+\" \")]),_c('DateField',{attrs:{\"title\":'created',\"date\":stopmotion.date_created,\"show_detail_initially\":false}}),_c('div',{staticClass:\"m_metaField\",on:{\"click\":function($event){_vm.show_detail = !_vm.show_detail}}},[_c('div',{},[_vm._v(\" \"+_vm._s(_vm.$t(\"photos\"))+\" \")]),_c('div',{},[_vm._v(\" \"+_vm._s(Object.values(stopmotion.medias).length)+\" \")])]),_c('div',{staticClass:\"_options\"},[_c('button',{staticClass:\"u-buttonLink\",attrs:{\"type\":\"button\"},on:{\"click\":function($event){return _vm.loadStopmotion(stopmotion.slugFolderName)}}},[_vm._v(\" \"+_vm._s(_vm.$t(\"load\"))+\" \")]),_c('button',{staticClass:\"u-buttonLink\",attrs:{\"type\":\"button\"},on:{\"click\":function($event){return _vm.removeStopmotion(stopmotion.slugFolderName)}}},[_vm._v(\" \"+_vm._s(_vm.$t(\"remove\"))+\" \")])])],1)}),0)]:[_vm._v(\" \"+_vm._s(_vm.$t(\"no_stopmotion_created_yet\"))+\" \")]],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"m_stopmotionList\">\n    <template v-if=\"Object.keys(stopmotions).length > 0\">\n      <ul>\n        <li\n          v-for=\"(stopmotion, index) in stopmotions\"\n          :key=\"stopmotion.slugFolderName\"\n          class=\"\"\n        >\n          <!-- @mouseenter=\"loadStopmotionMedias(stopmotion.slugFolderName)\" -->\n\n          <div\n            class=\"_preview\"\n            @click=\"loadStopmotion(stopmotion.slugFolderName)\"\n          >\n            MediaContent\n            <!-- <MediaContent\n              :context=\"'preview'\"\n              :slugFolderName=\"stopmotion.slugFolderName\"\n              :media=\"mediasPreviewed(stopmotion)[0]\"\n              :folderType=\"'stopmotions'\"\n              :preview_size=\"600\"\n            /> -->\n          </div>\n\n          <label class=\"\"> {{ $t(\"stopmotion\") }} {{ index + 1 }} </label>\n          <DateField\n            :title=\"'created'\"\n            :date=\"stopmotion.date_created\"\n            :show_detail_initially=\"false\"\n          />\n\n          <div class=\"m_metaField\" @click=\"show_detail = !show_detail\">\n            <div class=\"\">\n              {{ $t(\"photos\") }}\n            </div>\n            <div class=\"\">\n              {{ Object.values(stopmotion.medias).length }}\n            </div>\n          </div>\n\n          <div class=\"_options\">\n            <button\n              type=\"button\"\n              class=\"u-buttonLink\"\n              @click=\"loadStopmotion(stopmotion.slugFolderName)\"\n            >\n              {{ $t(\"load\") }}\n            </button>\n            <button\n              type=\"button\"\n              class=\"u-buttonLink\"\n              @click=\"removeStopmotion(stopmotion.slugFolderName)\"\n            >\n              {{ $t(\"remove\") }}\n            </button>\n          </div>\n        </li>\n      </ul>\n    </template>\n    <template v-else>\n      {{ $t(\"no_stopmotion_created_yet\") }}\n    </template>\n  </div>\n</template>\n<script>\n// import MediaContent from \"../subcomponents/MediaContent.vue\";\n\nexport default {\n  props: {\n    slugFolderName: {\n      type: String,\n      default: \"\",\n    },\n  },\n  components: {\n    // MediaContent,\n  },\n  data() {\n    return {\n      has_loaded_stopmotions_content: false,\n    };\n  },\n  created() {},\n  mounted() {\n    this.$socketio.listFolders({ type: \"stopmotions\" });\n    // this.$eventHub.$once(\"socketio.stopmotions.medias_listed\", () => {});\n  },\n  beforeDestroy() {},\n  watch: {},\n  computed: {\n    stopmotions() {\n      let stopmotions = Object.values(this.$root.store.stopmotions);\n      stopmotions = this.$_.sortBy(stopmotions, function (o) {\n        return o.date_created;\n      }).reverse();\n\n      stopmotions = stopmotions.filter((s) => {\n        if (!s.linked_project || s.linked_project === this.slugFolderName)\n          return true;\n      });\n\n      if (!this.has_loaded_stopmotions_content && stopmotions.length > 0) {\n        stopmotions.map((s) => this.loadStopmotionMedias(s.slugFolderName));\n        // eslint-disable-next-line\n        this.has_loaded_stopmotions_content = true;\n      }\n\n      return stopmotions;\n    },\n  },\n  methods: {\n    loadStopmotionMedias(slugFolderName) {\n      if (this.$root.dev_mode === true)\n        console.log(\n          `StopmotionList  METHODS : loadStopmotionMedias  load ${slugFolderName}`\n        );\n      if (\n        Object.values(this.$root.store.stopmotions[slugFolderName].medias)\n          .length === 0\n      ) {\n        this.$socketio.listMedias({\n          type: \"stopmotions\",\n          slugFolderName,\n        });\n      }\n    },\n    loadStopmotion(slugFolderName) {\n      this.$emit(\"loadStopmotion\", slugFolderName);\n    },\n    mediasPreviewed(stopmotion) {\n      if (\n        typeof stopmotion.medias === \"object\" &&\n        Object.values(stopmotion.medias).length > 0\n      )\n        return Object.values(stopmotion.medias).slice(0, 1);\n      return [];\n    },\n\n    removeStopmotion(slugFolderName) {\n      this.$alertify\n        .okBtn(this.$t(\"yes\"))\n        .cancelBtn(this.$t(\"cancel\"))\n        .confirm(\n          this.$t(\"sure_to_remove_stopmotion\"),\n          () => {\n            this.$root.removeFolder({\n              type: \"stopmotions\",\n              slugFolderName: slugFolderName,\n            });\n          },\n          () => {}\n        );\n    },\n  },\n};\n</script>\n<style lang=\"scss\" scoped>\n.m_stopmotionList {\n  position: relative;\n  flex: 0 0 250px;\n  max-width: 250px;\n  background-color: var(--c-bleumarine);\n\n  color: var(--c-bleumarine);\n  padding: calc(var(--spacing) / 2);\n  padding-top: calc(var(--spacing) * 2);\n  padding-bottom: calc(var(--spacing) * 2);\n\n  overflow-y: auto;\n  height: 100%;\n\n  // border-left: 4px solid var(--c-bleumarine);\n  font-size: var(--font-verysmall);\n\n  ul {\n    margin: 0;\n    padding: 0;\n    list-style: none;\n  }\n\n  li {\n    position: relative;\n    // border: 2px solid @c-bleumarine;\n    border-radius: 4px;\n    background-color: white;\n    display: block;\n    width: 100%;\n    padding: 0;\n    margin: calc(var(--spacing) / 2) 0;\n    overflow: hidden;\n\n    // &:hover {\n    //   background-color: var(--c-bleumarine_clair);\n    // }\n\n    label {\n      color: black;\n      // margin: 0;\n      margin-top: 4px;\n    }\n\n    > *:not(._preview) {\n      padding: 0 calc(var(--spacing) / 4);\n    }\n\n    > ._preview {\n      position: relative;\n\n      .mediaContainer {\n      }\n    }\n\n    .pictures_cont {\n      // padding-left: calc(var(--spacing) / 8);\n      // padding-left: calc(var(--spacing) / 8);\n    }\n\n    .pictures_list {\n      display: flex;\n      flex-flow: row wrap;\n      background-color: var(--c-bleumarine);\n      // justify-content: flex-start;\n      // overflow-x: auto;\n      // .padding-right-verysmall;\n      > * {\n        flex: 0 0 50px;\n        // .padding-left-verysmall;\n        padding-bottom: calc(var(--spacing) / 8);\n\n        &:last-child {\n          padding-right: calc(var(--spacing) / 8);\n        }\n\n        img {\n          max-width: 100%;\n          width: auto;\n          height: auto;\n        }\n      }\n    }\n\n    &:first-child {\n      margin-top: 0;\n    }\n  }\n}\n._options {\n  display: flex;\n  flex-flow: row wrap;\n  justify-content: center;\n\n  background-color: var(--c-bleumarine_clair);\n}\n</style>\n<style lang=\"scss\">\n._preview .mediaContainer img {\n  // height: 100%;\n  max-height: 140px;\n  object-fit: contain;\n}\n</style>\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-37[0].rules[0].use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./StopmotionList.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-37[0].rules[0].use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./StopmotionList.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./StopmotionList.vue?vue&type=template&id=5e50c66c&scoped=true&\"\nimport script from \"./StopmotionList.vue?vue&type=script&lang=js&\"\nexport * from \"./StopmotionList.vue?vue&type=script&lang=js&\"\nimport style0 from \"./StopmotionList.vue?vue&type=style&index=0&id=5e50c66c&lang=scss&scoped=true&\"\nimport style1 from \"./StopmotionList.vue?vue&type=style&index=1&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"5e50c66c\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"m_audioEqualizer\"},[_c('canvas',{ref:\"canvas\",attrs:{\"width\":\"1280\",\"height\":\"720\"}})])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"m_audioEqualizer\">\n    <canvas ref=\"canvas\" width=\"1280\" height=\"720\" />\n  </div>\n</template>\n<script>\nimport audioActivity from \"./audio-activity.js\";\n\nexport default {\n  props: {\n    stream: MediaStream,\n    is_recording: Boolean,\n    type: {\n      type: String,\n      default: \"Full\",\n    },\n  },\n  components: {},\n  data() {\n    return {\n      audio_activity: undefined,\n      current_audio_level: 0,\n      current_audio_level_smoothed: 0,\n\n      current_draw_percentage: 0,\n    };\n  },\n  created() {},\n  mounted() {\n    this.startEqualizer();\n  },\n  beforeDestroy() {\n    this.audio_activity.destroy();\n  },\n  watch: {\n    stream() {\n      this.startEqualizer();\n    },\n    current_audio_level() {\n      this.current_audio_level_smoothed = Math.round(\n        (this.current_audio_level_smoothed * 9 + this.current_audio_level) / 10\n      );\n    },\n    is_recording() {\n      this.clearCanvas();\n    },\n  },\n  computed: {},\n  methods: {\n    startEqualizer() {\n      if (this.audio_activity) this.audio_activity.destroy();\n\n      if (typeof this.stream !== \"object\") return;\n\n      this.audio_activity = audioActivity(this.stream, (level) => {\n        // 'level' indicates the audio activity in percentage\n        this.current_audio_level = Math.round(level * 100);\n      });\n      this.drawVolume();\n    },\n    drawVolume() {\n      const canvas = this.$refs.canvas;\n      if (canvas) window.requestAnimationFrame(this.drawVolume);\n      else return;\n\n      const ctx = canvas.getContext(\"2d\");\n\n      if (!this.is_recording) ctx.fillStyle = \"#333\";\n      else ctx.fillStyle = \"#fc4b60\";\n\n      // draw at pos\n      let number_of_bars = canvas.width / 4;\n\n      if (this.type === \"Tiny\") number_of_bars = canvas.width / 20;\n\n      const bar_pos =\n        canvas.width * (this.current_draw_percentage / number_of_bars);\n\n      let bar_width = canvas.width / number_of_bars / 2;\n\n      if (this.type === \"Tiny\") bar_width = canvas.width / number_of_bars;\n\n      let bar_height = (this.current_audio_level / 100) * canvas.height;\n      bar_height = Math.max(bar_width, bar_height);\n\n      ctx.fillRect(\n        bar_pos,\n        canvas.height / 2 - bar_height / 2,\n        bar_width,\n        bar_height\n      );\n\n      this.current_draw_percentage++;\n      if (this.current_draw_percentage >= number_of_bars) {\n        this.clearCanvas();\n      }\n    },\n    clearCanvas() {\n      const canvas = this.$refs.canvas;\n      const ctx = canvas.getContext(\"2d\");\n      ctx.fillStyle = \"#fff\";\n      ctx.fillRect(0, 0, canvas.width, canvas.height);\n\n      // ctx.clearRect(0, 0, canvas.width, canvas.height);\n      this.current_draw_percentage = 0;\n    },\n  },\n};\n</script>\n<style lang=\"scss\" scoped>\n.m_audioEqualizer {\n  width: 100%;\n  height: 100%;\n  object-fit: scale-down;\n\n  display: flex;\n  align-items: center;\n  justify-content: center;\n\n  canvas {\n    display: block;\n    max-width: 100%;\n    max-height: 100%;\n\n    background-color: white;\n  }\n}\n</style>\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-37[0].rules[0].use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./AudioEqualizer.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-37[0].rules[0].use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./AudioEqualizer.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./AudioEqualizer.vue?vue&type=template&id=56c3da71&scoped=true&\"\nimport script from \"./AudioEqualizer.vue?vue&type=script&lang=js&\"\nexport * from \"./AudioEqualizer.vue?vue&type=script&lang=js&\"\nimport style0 from \"./AudioEqualizer.vue?vue&type=style&index=0&id=56c3da71&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"56c3da71\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"m_vecto\",domProps:{\"innerHTML\":_vm._s(_vm.svgstr)}})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"m_vecto\" v-html=\"svgstr\"></div>\n</template>\n<script>\nimport ImageTracer from \"imagetracerjs\";\n\nexport default {\n  props: {\n    last_frame_from_video: Blob,\n    number_of_colors: Number,\n  },\n  components: {},\n  data() {\n    return {\n      svgstr: \"\",\n      is_processing_image: false,\n    };\n  },\n  created() {},\n  mounted() {},\n  beforeDestroy() {},\n  watch: {\n    last_frame_from_video() {\n      if (this.last_frame_from_video) {\n        this.vectoImage();\n      }\n    },\n  },\n  computed: {},\n  methods: {\n    vectoImage() {\n      if (this.is_processing_image) return;\n\n      this.is_processing_image = true;\n      ImageTracer.imageToSVG(\n        URL.createObjectURL(this.last_frame_from_video),\n        (svgstr) => {\n          this.is_processing_image = false;\n          this.svgstr = svgstr;\n        },\n        // \"posterized2\"\n\n        {\n          colorsampling: 0,\n\n          numberofcolors: this.number_of_colors,\n          colorquantcycles: 1,\n\n          scale: 1,\n          strokewidth: 1,\n          blurradius: 5,\n          blurdelta: 64,\n\n          viewbox: true,\n\n          // pal: [\n          //   { r: 255, g: 255, b: 255, a: 255 },\n          //   { r: 0, g: 0, b: 0, a: 255 },\n          // ],\n          // pal : [{r:255,g:255,b:255,a:255}, {r:214,g:0,b:103,a:255}]\n        }\n      );\n    },\n  },\n};\n</script>\n<style lang=\"scss\">\n.m_vecto {\n  width: 100%;\n  height: 100%;\n  object-fit: scale-down;\n\n  // display: flex;\n  // align-items: center;\n  // justify-content: center;\n\n  svg {\n    width: 100%;\n    height: 100%;\n  }\n}\n</style>\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-37[0].rules[0].use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./VectoMode.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-37[0].rules[0].use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./VectoMode.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./VectoMode.vue?vue&type=template&id=66c336eb&\"\nimport script from \"./VectoMode.vue?vue&type=script&lang=js&\"\nexport * from \"./VectoMode.vue?vue&type=script&lang=js&\"\nimport style0 from \"./VectoMode.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"m_lines\"},[_c('svg',{ref:\"pattern\",attrs:{\"xmlns\":\"http://www.w3.org/2000/svg\",\"viewBox\":(\"0 0 \" + _vm.svg_width + \" \" + _vm.svg_height),\"stroke-linecap\":\"round\",\"stroke\":\"#000\",\"stroke-width\":\"1\"}},[_c('rect',{attrs:{\"x\":\"0\",\"y\":\"0\",\"width\":\"100%\",\"height\":\"100%\",\"fill\":\"#ffffff\",\"stroke\":\"#ff0000\"}}),_vm._l((_vm.lines_array),function(line){return _c('line',{key:((line.posX) + \"_\" + (line.posY)),attrs:{\"x1\":-line.length / 2,\"y1\":0,\"x2\":line.length / 2,\"y2\":0,\"transform\":(\"translate(\" + (line.posX) + \", \" + (line.posY) + \") rotate(\" + _vm.angle + \" 0 0)\")}})})],2),_c('canvas',{directives:[{name:\"show\",rawName:\"v-show\",value:(false),expression:\"false\"}],ref:\"invisible_canvas\"})])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"m_lines\">\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      :viewBox=\"`0 0 ${svg_width} ${svg_height}`\"\n      ref=\"pattern\"\n      stroke-linecap=\"round\"\n      stroke=\"#000\"\n      stroke-width=\"1\"\n    >\n      <rect\n        x=\"0\"\n        y=\"0\"\n        width=\"100%\"\n        height=\"100%\"\n        fill=\"#ffffff\"\n        stroke=\"#ff0000\"\n      />\n      <!-- :width=\"svg_width\"\n      :height=\"svg_height\" -->\n      <line\n        v-for=\"line in lines_array\"\n        :key=\"`${line.posX}_${line.posY}`\"\n        :x1=\"-line.length / 2\"\n        :y1=\"0\"\n        :x2=\"line.length / 2\"\n        :y2=\"0\"\n        :transform=\"`translate(${line.posX}, ${line.posY}) rotate(${angle} 0 0)`\"\n      />\n    </svg>\n    <canvas ref=\"invisible_canvas\" v-show=\"false\" />\n  </div>\n</template>\n<script>\nexport default {\n  props: {\n    last_frame_from_video: Blob,\n    angle: {\n      type: Number,\n      default: 116,\n    },\n    boost_brightness: {\n      type: Number,\n      default: 1,\n    },\n    boost_contrast: {\n      type: Number,\n      default: 1,\n    },\n    density: {\n      type: Number,\n      default: 0.2,\n    },\n  },\n  components: {},\n  data() {\n    return {\n      pixel_array: [],\n\n      // for each pixel create this many lines\n\n      is_processing_image: false,\n\n      svg_width: 600,\n      svg_height: 400,\n    };\n  },\n  created() {},\n  mounted() {},\n  beforeDestroy() {},\n  watch: {\n    last_frame_from_video() {\n      if (\n        this.last_frame_from_video &&\n        this.last_frame_from_video.type === \"image/jpeg\"\n      )\n        this.drawBlobToImage();\n    },\n  },\n  computed: {\n    lines_array() {\n      const map = (value, x1, y1, x2, y2) =>\n        ((value - x1) * (y2 - x2)) / (y1 - x1) + x2;\n\n      const svg_padding = 1 / this.density / 2;\n      const svg_width_with_padding = this.svg_width - svg_padding * 2;\n      const svg_height_with_padding = this.svg_height - svg_padding * 2;\n\n      const line_density_x = this.svg_width * this.density;\n      const line_density_y = this.svg_height * this.density;\n\n      return this.pixel_array.reduce((acc, p) => {\n        let brightness = p.b;\n\n        brightness *= this.boost_brightness;\n\n        let contrast = this.boost_contrast + 1; //convert to decimal & shift range: [0..2]\n        let intercept = 128 * (1 - contrast);\n\n        brightness = brightness * contrast + intercept;\n\n        const mapped_brightness = map(brightness, 0, 234, 10, 0);\n        // const mapped_brightness = brightness;\n\n        // de 0  1 vers 17  0\n        if (typeof mapped_brightness !== \"number\" || mapped_brightness > 20)\n          return acc;\n\n        const posX =\n          (p.x / line_density_x) * svg_width_with_padding + svg_padding;\n        const posY =\n          (p.y / line_density_y) * svg_height_with_padding + svg_padding;\n        acc.push({\n          posX,\n          posY,\n          length: mapped_brightness,\n        });\n        return acc;\n      }, []);\n    },\n  },\n  methods: {\n    drawBlobToImage() {\n      if (this.is_processing_image) return;\n      this.is_processing_image = true;\n\n      var t0 = performance.now();\n\n      var img = new Image();\n\n      img.onload = () => {\n        var canvas = this.$refs.invisible_canvas;\n        canvas.width = img.width;\n        canvas.height = img.height;\n\n        this.svg_width = img.width;\n        this.svg_height = img.height;\n\n        var ctx = canvas.getContext(\"2d\");\n        ctx.drawImage(img, 0, 0);\n\n        var imgData = ctx.getImageData(0, 0, canvas.width, canvas.height).data;\n\n        let _pixel_array = [];\n\n        const line_density_x = Math.round(canvas.width * this.density);\n        const line_density_y = Math.round(canvas.height * this.density);\n\n        for (let x = 0; x <= line_density_x; x++) {\n          for (let y = 0; y <= line_density_y; y++) {\n            const pos_x = Math.floor((canvas.width / line_density_x) * x);\n            const pos_y = Math.floor((canvas.height / line_density_y) * y);\n\n            var [R, G, B] = this.getImageDataFaster(\n              // var pixel_data = this.getImageDataFaster(\n              pos_x,\n              pos_y,\n              1,\n              1,\n              canvas.width,\n              canvas.height,\n              imgData\n            );\n\n            const b = (R + R + R + B + G + G + G + G) >> 3;\n\n            _pixel_array.push({\n              x,\n              y,\n              b,\n            });\n          }\n        }\n\n        this.pixel_array = _pixel_array;\n        this.is_processing_image = false;\n\n        var t1 = performance.now();\n        if (this.$root.dev_mode === true)\n          console.log(\n            \"Lines  METHODS : drawBlobToImage = took \" +\n              (t1 - t0) +\n              \" milliseconds.\"\n          );\n      };\n      img.src = URL.createObjectURL(this.last_frame_from_video);\n    },\n    getImageDataFaster(x, y, w, h, W, H, d) {\n      var arr = new Uint32Array(w * h * 4),\n        i = 0;\n\n      for (var r = y; r < h + y; r += 1) {\n        for (var c = x; c < w + x; c += 1) {\n          var O = (r * W + c) * 4;\n          for (var n = 0; n < 4; n++) {\n            if (c < 0 || c >= W || r < 0 || r >= H) {\n              arr[i++] = 0;\n            } else {\n              arr[i++] = d[O + n];\n            }\n          }\n        }\n      }\n\n      return arr;\n    },\n  },\n};\n</script>\n<style lang=\"scss\">\n.m_lines {\n  width: 100%;\n  height: 100%;\n\n  // background: white;\n  padding: var(--spacing);\n\n  svg {\n    width: 100%;\n    height: 100%;\n    pointer-events: none;\n\n    line {\n      // transition-property: all;\n      // transition-duration: 1s;\n    }\n  }\n}\n</style>\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-37[0].rules[0].use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./LinesMode.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-37[0].rules[0].use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./LinesMode.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./LinesMode.vue?vue&type=template&id=eab3d1c8&\"\nimport script from \"./LinesMode.vue?vue&type=script&lang=js&\"\nexport * from \"./LinesMode.vue?vue&type=script&lang=js&\"\nimport style0 from \"./LinesMode.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","<template>\n  <div\n    class=\"m_captureview\"\n    :class=\"{ 'is--collapsed': collapse_capture_pane }\"\n  >\n    <CaptureSettings\n      v-show=\"show_capture_settings\"\n      :audio_output_deviceId.sync=\"audio_output_deviceId\"\n      @setStream=\"setStream\"\n      @hasFinishedLoading=\"hasFinishedLoading\"\n      @show=\"show_capture_settings = true\"\n      @close=\"show_capture_settings = false\"\n    />\n\n    <CaptureEffects\n      v-show=\"show_effects_pane\"\n      :enable_effects.sync=\"enable_effects\"\n      :videoElement=\"$refs.videoElement\"\n      :canvasElement=\"$refs.canvasElement\"\n      @updateImageData=\"setImageData\"\n      @close=\"show_effects_pane = false\"\n    />\n\n    <div class=\"m_captureview--videoPane\">\n      <transition name=\"slidedown\" :duration=\"500\">\n        <div\n          class=\"_modeSelector\"\n          v-if=\"\n            !media_to_validate &&\n            !is_recording &&\n            !is_making_stopmotion &&\n            !delay_event\n          \"\n        >\n          <div class=\"_arrows\" v-if=\"available_modes.length > 1\">\n            <button\n              type=\"button\"\n              class=\"bg-transparent\"\n              @mousedown.stop.prevent=\"previousMode()\"\n              @touchstart.stop.prevent=\"previousMode()\"\n            >\n              <svg\n                version=\"1.1\"\n                xmlns=\"http://www.w3.org/2000/svg\"\n                xmlns:xlink=\"http://www.w3.org/1999/xlink\"\n                x=\"0px\"\n                y=\"0px\"\n                width=\"169px\"\n                height=\"169px\"\n                viewBox=\"0 0 169 169\"\n                style=\"enable-background: new 0 0 169 169\"\n                xml:space=\"preserve\"\n              >\n                <path\n                  fill=\"currentColor\"\n                  stroke=\"currentColor\"\n                  stroke-width=\"10\"\n                  stroke-linejoin=\"round\"\n                  d=\"M60.2,84.5l48.6-24.3l0,48.6L60.2,84.5z\"\n                />\n              </svg>\n            </button>\n          </div>\n\n          <div v-for=\"mode in available_modes\" :key=\"mode\">\n            <input\n              type=\"radio\"\n              :id=\"id + '_' + mode\"\n              :value=\"mode\"\n              v-model=\"selected_mode\"\n            />\n            <label :for=\"id + '_' + mode\">\n              <div class=\"_picto\" :content=\"$t(mode)\">\n                <!-- v-tippy=\"\n                  mode !== selected_mode\n                    ? {\n                        placement: 'bottom',\n                        delay: [600, 0],\n                      }\n                    : ''\n                \" -->\n                <img :src=\"available_mode_picto[mode]\" />\n              </div>\n              <span v-if=\"selected_mode === mode\">{{ $t(mode) }}</span>\n            </label>\n          </div>\n\n          <div class=\"_arrows\" v-if=\"available_modes.length > 1\">\n            <button\n              type=\"button\"\n              class=\"bg-transparent\"\n              @mousedown.stop.prevent=\"nextMode()\"\n              @touchstart.stop.prevent=\"nextMode()\"\n            >\n              <svg\n                version=\"1.1\"\n                xmlns=\"http://www.w3.org/2000/svg\"\n                xmlns:xlink=\"http://www.w3.org/1999/xlink\"\n                x=\"0px\"\n                y=\"0px\"\n                width=\"169px\"\n                height=\"169px\"\n                viewBox=\"0 0 169 169\"\n                style=\"enable-background: new 0 0 169 169\"\n                xml:space=\"preserve\"\n              >\n                <path\n                  fill=\"currentColor\"\n                  stroke=\"currentColor\"\n                  stroke-width=\"10\"\n                  stroke-linejoin=\"round\"\n                  d=\"M108.8,84.5l-48.6,24.3V60.2L108.8,84.5z\"\n                />\n              </svg>\n            </button>\n          </div>\n        </div>\n      </transition>\n      <div\n        class=\"m_captureview--videoPane--top\"\n        v-show=\"!is_validating_stopmotion_video\"\n        :class=\"{\n          'is--being_streamed':\n            (stream_sharing_informations_status &&\n              stream_sharing_informations_status.enabled) ||\n            (stream_access_informations_status &&\n              stream_access_informations_status.enabled),\n        }\"\n      >\n        <div class=\"m_captureview--videoPane--top--videoContainer\">\n          <div :style=\"`opacity: ${show_videos ? 1 : 0}`\">\n            <video\n              ref=\"videoElement\"\n              autoplay\n              playsinline\n              :src-object.prop.camel=\"stream\"\n              :controls=\"stream_type === 'RemoteSources'\"\n              muted\n              v-show=\"!enable_effects\"\n            />\n            <canvas\n              ref=\"canvasElement\"\n              v-show=\"enable_effects\"\n              :width=\"actual_camera_resolution.width\"\n              :height=\"actual_camera_resolution.height\"\n              @click=\"(e) => updateSelectedColor({ e, type: 'click' })\"\n            />\n            <!-- @mousemove=\"(e) => updateSelectedColor({ e, type: 'move' })\" -->\n          </div>\n\n          <VectoMode\n            v-if=\"selected_mode === 'vecto' && !media_to_validate\"\n            ref=\"vectoElement\"\n            :last_frame_from_video=\"last_frame_from_video\"\n            :number_of_colors=\"vecto_number_of_colors\"\n          />\n\n          <LinesMode\n            v-if=\"selected_mode === 'lines' && !media_to_validate\"\n            ref=\"vectoElement\"\n            :last_frame_from_video=\"last_frame_from_video\"\n            :angle=\"lines_angle\"\n            :boost_brightness=\"lines_brightness\"\n            :boost_contrast=\"lines_contrast\"\n            :density=\"lines_density\"\n          />\n\n          <AudioEqualizer\n            v-if=\"selected_mode === 'audio' && !media_to_validate\"\n            ref=\"equalizerElement\"\n            :stream=\"stream\"\n            :is_recording=\"is_recording\"\n          />\n\n          <transition-group\n            tag=\"div\"\n            class=\"_capture_options\"\n            name=\"slideFromTop\"\n            mode=\"out-in\"\n          >\n            <label\n              v-if=\"\n                selected_mode !== 'stopmotion' &&\n                is_recording &&\n                timer_recording_in_seconds !== false\n              \"\n              :key=\"'duration'\"\n              v-html=\"timer_recording_in_seconds\"\n            />\n\n            <div\n              v-if=\"\n                selected_mode === 'stopmotion' &&\n                timelapse_mode_enabled &&\n                !timelapse_event\n              \"\n              :key=\"'timelapse_interval'\"\n              class=\"record_options\"\n            >\n              <label>\n                <span>{{ $t(\"interval_between_pictures\") }}</span>\n                <input type=\"number\" v-model.number=\"timelapse_interval\" />\n                <span>{{ $t(\"seconds\") }}</span>\n              </label>\n            </div>\n\n            <div\n              v-if=\"\n                stream_sharing_informations_status &&\n                stream_sharing_informations_status.enabled &&\n                stream_type === 'LocalSources'\n              \"\n              :key=\"\n                'stream_share_name-' + stream_sharing_informations_status.name\n              \"\n            >\n              <label>\n                <span v-html=\"$t('stream_currently_shared_with_name:')\" />\n                <span>\n                  <strong>{{ stream_sharing_informations_status.name }}</strong>\n                </span>\n                <br />\n                <span\n                  v-if=\"\n                    stream_sharing_informations_status.peers_connected &&\n                    stream_sharing_informations_status.peers_connected.length >\n                      0\n                  \"\n                >\n                  {{ $t(\"other_users_connected\") }} =\n                  {{\n                    stream_sharing_informations_status.peers_connected.length\n                  }}\n                </span>\n              </label>\n            </div>\n\n            <div\n              v-else-if=\"\n                stream_access_informations_status &&\n                stream_access_informations_status.enabled &&\n                stream_type === 'RemoteSources'\n              \"\n              :key=\"\n                'stream_share_name-' + stream_access_informations_status.callee\n              \"\n            >\n              <label>\n                <span v-html=\"$t('stream_shown:')\" />\n                <span>\n                  <strong>{{\n                    stream_access_informations_status.callee\n                  }}</strong>\n                </span>\n              </label>\n            </div>\n\n            <div\n              v-if=\"\n                delay_mode_enabled &&\n                !is_recording &&\n                !media_to_validate &&\n                !delay_event\n              \"\n              :key=\"'delay_interval'\"\n              class=\"record_options\"\n            >\n              <label>\n                <span>{{ $t(\"delay\").toLowerCase() }}</span>\n                <input\n                  type=\"number\"\n                  v-model.number=\"delay_seconds\"\n                  min=\"1\"\n                  max=\"60\"\n                />\n                <span>{{ $t(\"seconds\") }}</span>\n              </label>\n            </div>\n          </transition-group>\n\n          <transition name=\"scaleInFade\" mode=\"out-in\" duration=\"100\">\n            <label\n              v-if=\"!!delay_before_picture || !!time_before_next_picture\"\n              :key=\"'time_before_' + delay_before_picture\"\n              mode=\"out-in\"\n              class=\"_delay_timer\"\n              :class=\"{ 'is--timelapse': !!time_before_next_picture }\"\n            >\n              <template v-if=\"!!delay_before_picture\">\n                {{ delay_before_picture }}\n              </template>\n              <template v-else-if=\"!!time_before_next_picture\">\n                {{ time_before_next_picture }}\n              </template>\n              <!-- <template v-else>\n                {{ $t(\"now!\") }}\n              </template> -->\n            </label>\n          </transition>\n\n          <!-- <transition name=\"justCaptured\" duration=\"400\">\n            <div\n              v-if=\"capture_button_pressed\"\n              class=\"_just_captured_overlay\"\n            ></div>\n          </transition> -->\n\n          <transition name=\"scaleInFade\" mode=\"in-out\" duration=\"100\">\n            <!-- <MediaContent\n              v-if=\"\n                selected_mode === 'stopmotion' &&\n                stopmotion.onion_skin_img &&\n                current_stopmotion &&\n                !is_validating_stopmotion_video &&\n                !(show_live_feed && stopmotion.onion_skin_opacity === 0)\n              \"\n              :key=\"\n                show_live_feed ? false : stopmotion.onion_skin_img.metaFileName\n              \"\n              class=\"_onion_skin\"\n              :class=\"{ 'is--onionskin': show_live_feed }\"\n              :context=\"'edit'\"\n              :slugFolderName=\"current_stopmotion\"\n              :media=\"stopmotion.onion_skin_img\"\n              :folderType=\"'stopmotions'\"\n              :style=\"\n                show_live_feed\n                  ? `--onionskin-opacity: ${stopmotion.onion_skin_opacity}`\n                  : ''\n              \"\n            /> -->\n          </transition>\n\n          <div\n            class=\"_video_grid_overlay\"\n            v-if=\"enable_grid && enable_video && !media_to_validate\"\n          >\n            <svg\n              :width=\"actual_camera_resolution.width\"\n              :height=\"actual_camera_resolution.height\"\n              :viewBox=\"`0 0 ${actual_camera_resolution.width} ${actual_camera_resolution.height}`\"\n            >\n              <line\n                v-for=\"([x1, y1, x2, y2], index) in grids[current_grid_type]\"\n                :key=\"index\"\n                :x1=\"x1 + '%'\"\n                :y1=\"y1 + '%'\"\n                :x2=\"x2 + '%'\"\n                :y2=\"y2 + '%'\"\n                vector-effect=\"non-scaling-stroke\"\n              />\n              <!-- <rect\n                x=\"0\"\n                y=\"0\"\n                width=\"100%\"\n                height=\"100%\"\n                vector-effect=\"non-scaling-stroke\"\n              /> -->\n            </svg>\n\n            <!-- <svg\n              xmlns=\"http://www.w3.org/2000/svg\"\n              version=\"1.1\"\n              :width=\"actual_camera_resolution.width\"\n              :height=\"actual_camera_resolution.height\"\n              :viewBox=\"`0 0 ${actual_camera_resolution.width} ${actual_camera_resolution.height}`\"\n            /> -->\n          </div>\n\n          <transition name=\"fade_fast\">\n            <div\n              class=\"_settingsTag\"\n              v-if=\"!(must_validate_media && media_to_validate)\"\n            >\n              <button\n                type=\"button\"\n                class=\"button-nostyle\"\n                @click=\"show_capture_settings = !show_capture_settings\"\n                v-if=\"enable_video\"\n              >\n                {{ actual_camera_resolution.width }}{{\n                  actual_camera_resolution.height\n                }}\n              </button>\n              <!-- <div v-if=\"selected_devices.video_input_device\">\n                {{ selected_devices.video_input_device.label }}\n              </div>\n              <div v-if=\"selected_devices.audio_input_device\">\n                {{ selected_devices.audio_input_device.label }}\n              </div> -->\n              <button\n                type=\"button\"\n                class=\"button-nostyle\"\n                :class=\"{ 'is--active': enable_grid }\"\n                v-if=\"enable_video\"\n                @click=\"enable_grid = !enable_grid\"\n              >\n                {{ $t(\"grid\").toLowerCase() }}\n              </button>\n              <div v-if=\"enable_video && enable_grid\">\n                <button\n                  type=\"button\"\n                  class=\"button-nostyle\"\n                  v-for=\"grid_type in Object.keys(grids)\"\n                  :key=\"grid_type\"\n                  :class=\"{ 'is--active': current_grid_type === grid_type }\"\n                  @click=\"current_grid_type = grid_type\"\n                >\n                  {{ $t(grid_type).toLowerCase() }}\n                </button>\n              </div>\n            </div>\n          </transition>\n\n          <transition name=\"enableMode\" :duration=\"800\">\n            <div\n              v-if=\"mode_just_changed\"\n              class=\"_mode_indicator\"\n              v-html=\"$t(selected_mode)\"\n            />\n          </transition>\n\n          <transition name=\"justCaptured\" :duration=\"200\">\n            <MediaPreviewBeforeValidation\n              v-if=\"media_to_validate && must_validate_media\"\n              :media_to_validate=\"media_to_validate\"\n              :audio_output_deviceId=\"audio_output_deviceId\"\n            />\n          </transition>\n        </div>\n      </div>\n      <!-- <transition name=\"slideup\" :duration=\"150\" mode=\"out-in\">\n        <StopmotionPanel\n          v-if=\"\n            false ||\n            ($root.store.stopmotions &&\n              Object.prototype.hasOwnProperty.call(\n                $root.store.stopmotions,\n                current_stopmotion\n              ))\n          \"\n          :stopmotiondata=\"$root.store.stopmotions[current_stopmotion]\"\n          :type=\"type\"\n          :slugFolderName=\"slugFolderName\"\n          :read_only=\"read_only\"\n          :stream=\"stream\"\n          :can_add_to_fav=\"can_add_to_fav\"\n          :show_live_feed.sync=\"show_live_feed\"\n          :is_validating_stopmotion_video.sync=\"is_validating_stopmotion_video\"\n          @saveMedia=\"(metaFileName) => $emit('insertMedias', [metaFileName])\"\n          @close=\"closeStopmotionPanel\"\n          @new_single_image=\"updateSingleImage\"\n        />\n      </transition> -->\n\n      <transition name=\"slideup\" :duration=\"150\" mode=\"out-in\">\n        <div class=\"m_captureview--videoPane--bottom\">\n          <transition name=\"fade_fast\" :duration=\"150\">\n            <LoaderSpinner v-if=\"is_sending_image\" />\n          </transition>\n\n          <transition name=\"slideup\" :duration=\"150\" mode=\"out-in\">\n            <div\n              class=\"m_captureview--videoPane--bottom--buttons\"\n              :class=\"{\n                'is--recording': is_recording && !video_recording_is_paused,\n                'is--sending_image': is_sending_image,\n              }\"\n              v-if=\"\n                !(media_to_validate && must_validate_media) &&\n                !is_validating_stopmotion_video\n              \"\n            >\n              <div>\n                <template\n                  v-if=\"\n                    !is_recording &&\n                    !is_making_stopmotion &&\n                    !is_recording &&\n                    !delay_event\n                  \"\n                >\n                  <button\n                    type=\"button\"\n                    class=\"bg-rouge button-inline\"\n                    :class=\"{ 'is--active': show_capture_settings }\"\n                    @click=\"show_capture_settings = !show_capture_settings\"\n                    :content=\"$t('settings')\"\n                  >\n                    <!-- v-tippy=\"{\n                      placement: 'right',\n                      delay: [600, 0],\n                    }\" -->\n                    <svg\n                      class=\"inline-svg inline-svg_larger\"\n                      version=\"1.1\"\n                      xmlns=\"http://www.w3.org/2000/svg\"\n                      xmlns:xlink=\"http://www.w3.org/1999/xlink\"\n                      x=\"0px\"\n                      y=\"0px\"\n                      viewBox=\"15 15 140 140\"\n                      xml:space=\"preserve\"\n                    >\n                      <path\n                        style=\"fill: currentColor\"\n                        d=\"M122.7,88.8v-10c0-1.1,0.6-2.1,1.6-2.6l9.6-4.9l-2-5.8l-11,1.6c-1.1,0.2-2.2-0.3-2.9-1.2l-6-8.1\n                  c-0.7-0.9-0.8-2.1-0.3-3l4.8-9.6l-5.2-3.6l-7.7,7.5c-0.8,0.8-2,1-3.1,0.7l-9.9-3c-1.1-0.3-1.9-1.3-2.1-2.4L86.8,34h-6.4l-1.7,10.4\n                  c-0.2,1.1-0.9,2-2,2.4L66.8,50c-1.1,0.3-2.2,0.1-3.1-0.7L55.9,42l-5.1,3.7l4.9,9.4c0.5,1,0.4,2.1-0.2,3l-6,8.2\n                  c-0.6,0.9-1.8,1.4-2.9,1.2L35.8,66L34,71.8l9.7,4.8c1,0.5,1.7,1.5,1.7,2.6v10c0,1.1-0.6,2.1-1.6,2.6l-9.6,4.9l2,5.9l10.9-1.6\n                  c1.1-0.2,2.2,0.3,2.9,1.2l6,8.1c0.7,0.9,0.8,2.1,0.3,3l-4.8,9.6l5.1,3.6l7.7-7.5c0.8-0.8,2-1,3.1-0.7l9.9,3\n                  c1.1,0.3,1.9,1.3,2.1,2.4l1.9,10.4h6.4l1.7-10.4c0.2-1.1,0.9-2,2-2.4l9.9-3.2c1.1-0.3,2.2-0.1,3.1,0.7l7.8,7.3l5.1-3.7l-4.9-9.4\n                  c-0.5-1-0.4-2.1,0.2-3l6-8.1c0.7-0.9,1.8-1.4,2.9-1.2l10.8,1.5l1.8-5.9l-9.7-4.8C123.3,90.9,122.7,89.9,122.7,88.8z M84,104.5\n                  c-11.7,0-21.1-9.2-21.1-20.5c0-11.3,9.5-20.5,21.1-20.5s21.1,9.2,21.1,20.5C105.1,95.3,95.7,104.5,84,104.5z\"\n                      />\n                    </svg>\n                  </button>\n\n                  <button\n                    type=\"button\"\n                    class=\"button-inline bg-bleumarine\"\n                    :class=\"{ 'is--active': show_effects_pane }\"\n                    @click=\"show_effects_pane = !show_effects_pane\"\n                    :content=\"$t('effects')\"\n                  >\n                    <!-- v-tippy=\"{\n                      placement: 'right',\n                      delay: [600, 0],\n                    }\" -->\n                    <svg\n                      xmlns=\"http://www.w3.org/2000/svg\"\n                      viewBox=\"0 0 168 168\"\n                      class=\"inline-svg inline-svg_larger\"\n                    >\n                      <path\n                        d=\"M110.3488,72.0093,114.6377,59.36a4.4236,4.4236,0,0,0-1.07-4.59,4.4946,4.4946,0,0,0-4.59-1.0745L96.3334,57.9846,85.62,50a4.5219,4.5219,0,0,0-4.6965-.4029,4.4316,4.4316,0,0,0-2.4409,4.0388l.1714,13.3577L67.7468,74.7049A4.4686,4.4686,0,0,0,68.9974,82.62L79.2565,85.807,38.1043,126.9546a2.3155,2.3155,0,1,0,3.2745,3.2746L82.5311,89.0769l3.1865,10.2638a4.4571,4.4571,0,0,0,3.5664,3.08c.12.0185.579.0556.704.0556a4.4844,4.4844,0,0,0,3.6451-1.88L101.35,89.6883l13.6078.1621a4.6074,4.6074,0,0,0,3.784-2.4316,4.4328,4.4328,0,0,0-.3983-4.6965ZM100.1869,85.0381a2.5322,2.5322,0,0,0-1.9221.9773L90.039,97.6409,85.8149,84.0423a2.3238,2.3238,0,0,0-1.5192-1.5238l-13.8764-4.03,11.8987-8.42a2.3208,2.3208,0,0,0,.9773-1.9221L82.846,53.71l11.6764,8.7168a2.3569,2.3569,0,0,0,2.1259.3381l13.5986-4.8911L105.56,71.6758a2.3135,2.3135,0,0,0,.3428,2.1259l8.8464,11.417Z\"\n                        style=\"\n                          fill: #fc4b60;\n                          stroke: #fc4b60;\n                          stroke-miterlimit: 10;\n                          stroke-width: 2.8346456692913384px;\n                        \"\n                      />\n                      <path\n                        d=\"M58.9467,42.2277h2.3158v2.3158a2.3159,2.3159,0,1,0,4.6317,0V42.2277H68.21a2.3159,2.3159,0,0,0,0-4.6317H65.8942V35.28a2.3159,2.3159,0,0,0-4.6317,0V37.596H58.9467a2.3159,2.3159,0,0,0,0,4.6317Z\"\n                        style=\"\n                          fill: #fc4b60;\n                          stroke: #fc4b60;\n                          stroke-miterlimit: 10;\n                          stroke-width: 2.8346456692913384px;\n                        \"\n                      />\n                      <path\n                        d=\"M49.6834,65.386h2.3158v2.3158a2.3159,2.3159,0,0,0,4.6317,0V65.386h2.3158a2.3159,2.3159,0,0,0,0-4.6317H56.6309V58.4385a2.3159,2.3159,0,0,0-4.6317,0v2.3158H49.6834a2.3159,2.3159,0,0,0,0,4.6317Z\"\n                        style=\"\n                          fill: #fc4b60;\n                          stroke: #fc4b60;\n                          stroke-miterlimit: 10;\n                          stroke-width: 2.8346456692913384px;\n                        \"\n                      />\n                      <path\n                        d=\"M133.0531,102.4392h-2.3158v-2.3158a2.3159,2.3159,0,0,0-4.6317,0v2.3158H123.79a2.3159,2.3159,0,0,0,0,4.6317h2.3158v2.3158a2.3159,2.3159,0,1,0,4.6317,0v-2.3158h2.3158a2.3159,2.3159,0,0,0,0-4.6317Z\"\n                        style=\"\n                          fill: #fc4b60;\n                          stroke: #fc4b60;\n                          stroke-miterlimit: 10;\n                          stroke-width: 2.8346456692913384px;\n                        \"\n                      />\n                      <path\n                        d=\"M109.8949,111.7026H107.579v-2.3159a2.3158,2.3158,0,1,0-4.6316,0v2.3159h-2.3158a2.3158,2.3158,0,1,0,0,4.6316h2.3158V118.65a2.3158,2.3158,0,1,0,4.6316,0v-2.3158h2.3159a2.3158,2.3158,0,0,0,0-4.6316Z\"\n                        style=\"\n                          fill: #fc4b60;\n                          stroke: #fc4b60;\n                          stroke-miterlimit: 10;\n                          stroke-width: 2.8346456692913384px;\n                        \"\n                      />\n                      <path\n                        d=\"M119.1582,46.8594h2.3158v2.3158a2.3158,2.3158,0,1,0,4.6316,0V46.8594h2.3159a2.3159,2.3159,0,0,0,0-4.6317h-2.3159V39.9119a2.3158,2.3158,0,1,0-4.6316,0v2.3158h-2.3158a2.3159,2.3159,0,1,0,0,4.6317Z\"\n                        style=\"\n                          fill: #fc4b60;\n                          stroke: #fc4b60;\n                          stroke-miterlimit: 10;\n                          stroke-width: 2.8346456692913384px;\n                        \"\n                      />\n                    </svg>\n                  </button>\n                </template>\n\n                <button\n                  type=\"button\"\n                  class=\"bg-orange button-inline _captureButton\"\n                  :key=\"selected_mode + '_pause'\"\n                  v-if=\"selected_mode === 'video' && is_recording\"\n                  @mousedown.stop.prevent=\"pauseOrResumeCapture()\"\n                  @touchstart.stop.prevent=\"pauseOrResumeCapture()\"\n                >\n                  <template v-if=\"!video_recording_is_paused\">\n                    <svg\n                      class=\"inline-svg inline-svg_larger\"\n                      version=\"1.1\"\n                      xmlns=\"http://www.w3.org/2000/svg\"\n                      xmlns:xlink=\"http://www.w3.org/1999/xlink\"\n                      x=\"0px\"\n                      y=\"0px\"\n                      viewBox=\"0 0 168 168\"\n                      style=\"enable-background: new 0 0 168 168\"\n                      xml:space=\"preserve\"\n                    >\n                      <path\n                        id=\"FOND_3_\"\n                        style=\"fill: #ffbe32\"\n                        d=\"M84,0C37.6,0,0,37.6,0,84c0,46.4,37.6,84,84,84c46.4,0,84-37.6,84-84\n\t\t\tC168,37.6,130.4,0,84,0z\"\n                      />\n                      <rect\n                        id=\"CENTRE_3_\"\n                        x=\"35\"\n                        y=\"46.7\"\n                        style=\"fill: #ff3e51\"\n                        width=\"38\"\n                        height=\"76\"\n                      />\n                      <rect\n                        id=\"CENTRE_3_\"\n                        x=\"93\"\n                        y=\"46.7\"\n                        style=\"fill: #ff3e51\"\n                        width=\"38\"\n                        height=\"76\"\n                      />\n                    </svg>\n                    &nbsp;\n                    <span>\n                      {{ $t(\"pause_recording\") }}\n                    </span>\n                  </template>\n                  <template v-else>\n                    <svg\n                      class=\"inline-svg inline-svg_larger\"\n                      version=\"1.1\"\n                      xmlns=\"http://www.w3.org/2000/svg\"\n                      xmlns:xlink=\"http://www.w3.org/1999/xlink\"\n                      x=\"0px\"\n                      y=\"0px\"\n                      viewBox=\"0 0 168 168\"\n                      style=\"enable-background: new 0 0 168 168\"\n                      xml:space=\"preserve\"\n                    >\n                      <path\n                        id=\"FOND_3_\"\n                        style=\"fill: #ffbe32\"\n                        d=\"M84,0C37.6,0,0,37.6,0,84c0,46.4,37.6,84,84,84c46.4,0,84-37.6,84-84\n\t\t\tC168,37.6,130.4,0,84,0z\"\n                      />\n                      <polygon\n                        style=\"fill: #ff3e51\"\n                        points=\"45 40, 130 84.7, 45 128\"\n                      />\n                    </svg>\n                    &nbsp;\n                    <span>\n                      {{ $t(\"unpause_recording\") }}\n                    </span>\n                  </template>\n                </button>\n\n                <button\n                  type=\"button\"\n                  class=\"bg-orange button-inline _captureButton\"\n                  :key=\"selected_mode + '_pause'\"\n                  v-if=\"\n                    selected_mode === 'stopmotion' &&\n                    is_making_stopmotion &&\n                    !timelapse_event\n                  \"\n                  @mousedown.stop.prevent=\"stopStopmotion()\"\n                  @touchstart.stop.prevent=\"stopStopmotion()\"\n                >\n                  {{ $t(\"stop_stopmotion\") }}\n                </button>\n              </div>\n              <div>\n                <transition name=\"fade_fast\" mode=\"out-in\">\n                  <button\n                    type=\"button\"\n                    v-if=\"!is_recording\"\n                    class=\"bg-orange button-inline _captureButton\"\n                    :disabled=\"is_sending_image\"\n                    :key=\"selected_mode + is_recording\"\n                    @mousedown.stop.prevent=\"setCaptureInit()\"\n                    @touchstart.stop.prevent=\"setCaptureInit()\"\n                  >\n                    <span v-if=\"delay_event\">\n                      {{ $t(\"cancel\") }}\n                    </span>\n\n                    <template v-else>\n                      <img\n                        class=\"inline-svg inline-svg_larger\"\n                        :src=\"$root.publicPath + 'images/i_record.svg'\"\n                      />\n                      &nbsp;\n                      <span\n                        v-if=\"\n                          ['photo', 'vecto', 'lines'].includes(selected_mode)\n                        \"\n                        v-html=\"$t('take_picture')\"\n                      />\n                      <span\n                        v-else-if=\"selected_mode === 'video'\"\n                        v-html=\"$t('record_video')\"\n                      />\n                      <span\n                        v-else-if=\"selected_mode === 'audio'\"\n                        v-html=\"$t('record_audio')\"\n                      />\n                      <span\n                        v-else-if=\"selected_mode === 'stopmotion'\"\n                        v-html=\"\n                          !timelapse_mode_enabled\n                            ? $t('take_picture')\n                            : $t('start_timelapse')\n                        \"\n                      />\n                    </template>\n                  </button>\n                  <button\n                    type=\"button\"\n                    v-else-if=\"is_recording\"\n                    class=\"bg-orange button-inline _captureButton\"\n                    :disabled=\"is_sending_image\"\n                    :key=\"selected_mode + is_recording\"\n                    @mousedown.stop.prevent=\"stopRecording()\"\n                    @touchstart.stop.prevent=\"stopRecording()\"\n                  >\n                    <span v-if=\"is_sending_image && false\">\n                      {{ $t(\"loading\") }}\n                    </span>\n\n                    <template v-else>\n                      <img\n                        class=\"inline-svg inline-svg_larger\"\n                        src=\"/images/i_stop.svg\"\n                      />\n                      &nbsp;\n                      <span v-if=\"['video', 'audio'].includes(selected_mode)\">\n                        {{ $t(\"stop_recording\") }}\n                      </span>\n                      <span v-else-if=\"selected_mode === 'stopmotion'\">\n                        <template v-if=\"timelapse_mode_enabled\">\n                          {{ $t(\"stop_timelapse\") }}\n                        </template>\n                      </span>\n                      <span v-else>\n                        {{ $t(\"stop\") }}\n                      </span>\n                    </template>\n                  </button>\n                </transition>\n\n                <transition name=\"fade_fast\" mode=\"out-in\">\n                  <button\n                    type=\"button\"\n                    class=\"_enable_timelapse_button\"\n                    :class=\"{ 'is--active': timelapse_mode_enabled }\"\n                    v-if=\"selected_mode === 'stopmotion' && !timelapse_event\"\n                    :content=\"$t('timelapse')\"\n                    @click=\"timelapse_mode_enabled = !timelapse_mode_enabled\"\n                  >\n                    <!-- v-tippy=\"{\n                      placement: 'top',\n                      delay: [600, 0],\n                    }\" -->\n                    <svg\n                      version=\"1.1\"\n                      class=\"inline-svg margin-right-verysmall\"\n                      xmlns=\"http://www.w3.org/2000/svg\"\n                      xmlns:xlink=\"http://www.w3.org/1999/xlink\"\n                      x=\"0px\"\n                      y=\"0px\"\n                      width=\"81px\"\n                      height=\"81px\"\n                      viewBox=\"0 0 81 81\"\n                      style=\"enable-background: new 0 0 81 81\"\n                      xml:space=\"preserve\"\n                    >\n                      <path\n                        d=\"M69.6,20.8c-0.9,0.6-1.7,1.1-2.6,1.7c-6-8.8-15.9-14-26.5-14c-17.6,0-32,14.4-32,32s14.4,32,32,32\n                  c3.1,0,6.2-0.4,9.1-1.3l-1.7-5.8c-2.4,0.7-4.9,1.1-7.4,1.1c-14.3,0-26-11.7-26-26s11.7-26,26-26c8.6,0,16.6,4.2,21.5,11.4\n                  c-0.8,0.5-1.6,1.1-2.4,1.6c-0.7,0.4-0.9,1.1-0.8,1.7c0,0.7,0.4,1.4,1.2,1.6c0.2,0.1,0.3,0.1,0.5,0.1c2.7,0.5,5.3,1.1,8,1.6\n                  c1,0.2,2-0.4,2.3-1.4c0.6-2.8,1.1-5.5,1.7-8.3C72.8,21.3,71,19.9,69.6,20.8z\"\n                      />\n                      <path\n                        d=\"M23,49.4c-1.3,0-2.4-0.8-2.9-2.1c-0.5-1.6,0.4-3.3,1.9-3.8L39,38.3V27.2c0-1.7,1.3-3,3-3s3,1.3,3,3v13.3\n                  c0,1.3-0.8,2.5-2.1,2.9l-19,5.9C23.6,49.4,23.3,49.4,23,49.4z\"\n                      />\n                    </svg>\n                  </button>\n                </transition>\n\n                <transition name=\"fade_fast\" mode=\"out-in\">\n                  <button\n                    type=\"button\"\n                    class=\"_enable_timelapse_button\"\n                    v-if=\"!is_recording\"\n                    :class=\"{ 'is--active': delay_mode_enabled }\"\n                    :content=\"$t('delay')\"\n                    @click=\"delay_mode_enabled = !delay_mode_enabled\"\n                  >\n                    <!-- v-tippy=\"{\n                      placement: 'top',\n                      delay: [600, 0],\n                    }\" -->\n                    <svg\n                      version=\"1.1\"\n                      class=\"inline-svg margin-right-verysmall\"\n                      xmlns=\"http://www.w3.org/2000/svg\"\n                      xmlns:xlink=\"http://www.w3.org/1999/xlink\"\n                      x=\"0px\"\n                      y=\"0px\"\n                      width=\"81px\"\n                      height=\"81px\"\n                      viewBox=\"0 0 81 81\"\n                      style=\"enable-background: new 0 0 81 81\"\n                      xml:space=\"preserve\"\n                    >\n                      <path\n                        d=\"M40.5,72.3c-15,0-27.1-12.2-27.1-27.1c0-15,12.2-27.1,27.1-27.1s27.1,12.2,27.1,27.1C67.6,60.2,55.5,72.3,40.5,72.3z\n\t M40.5,23.7C28.7,23.7,19,33.4,19,45.2s9.6,21.5,21.5,21.5S62,57,62,45.2S52.3,23.7,40.5,23.7z\"\n                      />\n                      <path\n                        d=\"M40.5,48c-1.6,0-2.8-1.3-2.8-2.8l0-16.8c0-1.6,1.3-2.8,2.8-2.8s2.8,1.3,2.8,2.8l0,16.8C43.3,46.8,42.1,48,40.5,48z\"\n                      />\n                      <rect x=\"32.1\" y=\"10.7\" width=\"16.8\" height=\"5.7\" />\n                      <rect\n                        x=\"57.9\"\n                        y=\"22.4\"\n                        transform=\"matrix(0.7069 -0.7073 0.7073 0.7069 2.864400e-02 50.6141)\"\n                        width=\"6.3\"\n                        height=\"5.7\"\n                      />\n                    </svg>\n                  </button>\n                </transition>\n              </div>\n              <div>\n                <div\n                  v-if=\"selected_mode === 'video'\"\n                  class=\"flex-wrap flex-vertically-centered\"\n                >\n                  <div\n                    v-if=\"enable_audio_recording_in_video\"\n                    class=\"_tiny_equalizer\"\n                  >\n                    <AudioEqualizer\n                      :stream=\"stream\"\n                      :is_recording=\"is_recording\"\n                      :type=\"'Tiny'\"\n                    />\n                  </div>\n\n                  <span class=\"switch switch-xs\" v-if=\"!is_recording\">\n                    <input\n                      class=\"switch\"\n                      id=\"recordVideoWithAudio\"\n                      type=\"checkbox\"\n                      v-model=\"enable_audio_recording_in_video\"\n                      :disabled=\"is_recording\"\n                    />\n                    <label for=\"recordVideoWithAudio\">{{\n                      $t(\"with_sound\")\n                    }}</label>\n                  </span>\n                </div>\n                <div\n                  v-if=\"\n                    selected_mode === 'stopmotion' &&\n                    stopmotion.onion_skin_img &&\n                    show_live_feed &&\n                    is_making_stopmotion &&\n                    !timelapse_event\n                  \"\n                  class=\"_mode_accessory_range\"\n                >\n                  <label>{{ $t(\"onion_skin\") }} </label>\n                  <input\n                    class=\"_rtl\"\n                    type=\"range\"\n                    v-model.number=\"stopmotion.onion_skin_opacity\"\n                    min=\"0\"\n                    max=\".9\"\n                    step=\"0.01\"\n                    :title=\"stopmotion.onion_skin_opacity\"\n                    data-use=\"onionskin\"\n                  />\n                </div>\n\n                <button\n                  type=\"button\"\n                  v-if=\"selected_mode === 'stopmotion' && !is_making_stopmotion\"\n                  @click=\"show_stopmotion_list = !show_stopmotion_list\"\n                  class=\"bg-bleumarine font-small\"\n                >\n                  <span class>{{ $t(\"stopmotion_list\") }}</span>\n                </button>\n\n                <div\n                  v-if=\"selected_mode === 'vecto'\"\n                  class=\"_mode_accessory_range\"\n                >\n                  <label\n                    >{{ $t(\"number_of_colors\") }} =\n                    {{ vecto_number_of_colors }}</label\n                  >\n                  <input\n                    class=\"\"\n                    type=\"range\"\n                    v-model.number=\"vecto_number_of_colors\"\n                    min=\"2\"\n                    max=\"7\"\n                    step=\"1\"\n                  />\n                </div>\n\n                <button\n                  type=\"button\"\n                  class=\"u-buttonLink\"\n                  v-if=\"selected_mode === 'lines'\"\n                  @click=\"show_lines_settings = !show_lines_settings\"\n                  :class=\"{ 'is--active': show_lines_settings }\"\n                >\n                  {{ $t(\"advanced_options\") }}\n                </button>\n\n                <template v-if=\"show_lines_settings\">\n                  <div\n                    v-if=\"selected_mode === 'lines'\"\n                    class=\"_mode_accessory_range\"\n                  >\n                    <label>{{ $t(\"lines_angle\") }} = {{ lines_angle }}</label>\n                    <input\n                      class=\"\"\n                      type=\"range\"\n                      v-model.number=\"lines_angle\"\n                      min=\"0\"\n                      max=\"359\"\n                      step=\"1\"\n                    />\n                  </div>\n                  <div\n                    v-if=\"selected_mode === 'lines'\"\n                    class=\"_mode_accessory_range\"\n                  >\n                    <label\n                      >{{ $t(\"brightness\") }} = {{ lines_brightness }}</label\n                    >\n                    <input\n                      class=\"margin-none\"\n                      type=\"range\"\n                      v-model.number=\"lines_brightness\"\n                      min=\".1\"\n                      max=\"5\"\n                      step=\".1\"\n                    />\n                  </div>\n                  <div\n                    v-if=\"selected_mode === 'lines'\"\n                    class=\"_mode_accessory_range\"\n                  >\n                    <label>{{ $t(\"contrast\") }} = {{ lines_contrast }}</label>\n                    <input\n                      class=\"margin-none\"\n                      type=\"range\"\n                      v-model.number=\"lines_contrast\"\n                      min=\".1\"\n                      max=\"5\"\n                      step=\".1\"\n                    />\n                  </div>\n                  <div\n                    v-if=\"selected_mode === 'lines'\"\n                    class=\"_mode_accessory_range\"\n                  >\n                    <label\n                      >{{ $t(\"lines_density\") }} = {{ lines_density }}</label\n                    >\n                    <input\n                      class=\"margin-none\"\n                      type=\"range\"\n                      v-model.number=\"lines_density\"\n                      min=\"0.2\"\n                      max=\"0.3\"\n                      step=\".01\"\n                    />\n                  </div>\n                </template>\n              </div>\n            </div>\n            <div\n              v-else-if=\"media_to_validate && must_validate_media\"\n              key=\"validation\"\n            >\n              <div class=\"_download_media_without_validation\">\n                <small>\n                  <a\n                    ref=\"\"\n                    :href=\"validated_media_href_blob\"\n                    :download=\"media_to_validate.temp_name\"\n                    target=\"_blank\"\n                  >\n                    {{ $t(\"or_download_media_on_device\") }}\n                    <template v-if=\"media_to_validate.rawData\">\n                       {{ $root.formatBytes(media_to_validate.rawData.size) }}\n                    </template>\n                  </a>\n                </small>\n              </div>\n\n              <MediaValidationButtons\n                :read_only=\"read_only\"\n                :can_add_to_fav=\"can_add_to_fav\"\n                :media_is_being_sent=\"media_is_being_sent\"\n                :media_being_sent_percent=\"media_being_sent_percent\"\n                @cancel=\"cancelValidation()\"\n                @save=\"sendMedia({})\"\n                @save_and_fav=\"sendMedia({ fav: true })\"\n              />\n            </div>\n          </transition>\n        </div>\n      </transition>\n    </div>\n\n    <StopmotionList\n      v-if=\"show_stopmotion_list && !is_making_stopmotion\"\n      :slugFolderName=\"slugFolderName\"\n      @loadStopmotion=\"loadStopmotion\"\n    />\n  </div>\n</template>\n<script>\nimport MediaPreviewBeforeValidation from \"./MediaPreviewBeforeValidation.vue\";\nimport MediaValidationButtons from \"./MediaValidationButtons.vue\";\n// import StopmotionPanel from \"./StopmotionPanel.vue\";\n// import MediaContent from \"../subcomponents/MediaContent.vue\";\n\nimport CaptureSettings from \"./CaptureSettings.vue\";\nimport CaptureEffects from \"./CaptureEffects.vue\";\nimport StopmotionList from \"./StopmotionList.vue\";\nimport AudioEqualizer from \"./AudioEqualizer.vue\";\nimport VectoMode from \"./VectoMode.vue\";\nimport LinesMode from \"./LinesMode.vue\";\n\n// import adapter from \"webrtc-adapter\";\n\nimport RecordRTC from \"recordrtc\";\n\nexport default {\n  props: {\n    slugFolderName: String,\n    type: String,\n    read_only: Boolean,\n    path: String,\n    available_modes: {\n      type: Array,\n      default: () => [\n        \"photo\",\n        \"video\",\n        \"stopmotion\",\n        \"audio\",\n        \"vecto\",\n        \"lines\",\n      ],\n    },\n    return_temp_media: {\n      type: Boolean,\n      default: false,\n    },\n    can_add_to_fav: {\n      type: Boolean,\n      default: true,\n    },\n    must_validate_media: {\n      type: Boolean,\n      default: true,\n    },\n  },\n  components: {\n    MediaPreviewBeforeValidation,\n    MediaValidationButtons,\n    // StopmotionPanel,\n    // MediaContent,\n    CaptureSettings,\n    CaptureEffects,\n    StopmotionList,\n    AudioEqualizer,\n    VectoMode,\n    LinesMode,\n  },\n  data() {\n    return {\n      selected_mode: \"\",\n      is_sending_image: false,\n\n      id: (Math.random().toString(36) + \"00000000000000000\").slice(2, 3 + 5),\n      invisible_canvas: undefined,\n\n      ask_before_leaving_capture: false,\n\n      available_mode_picto: {\n        photo: this.$root.publicPath + \"images/i_icone-dodoc_image.svg\",\n        video: this.$root.publicPath + \"images/i_icone-dodoc_video.svg\",\n        stopmotion: this.$root.publicPath + \"images/i_icone-dodoc_anim.svg\",\n        audio: this.$root.publicPath + \"images/i_icone-dodoc_audio.svg\",\n        vecto: this.$root.publicPath + \"images/i_icone-dodoc_vecto.svg\",\n        lines: this.$root.publicPath + \"images/i_icone-dodoc_lines.svg\",\n      },\n\n      media_to_validate: false,\n      media_is_being_sent: false,\n      media_being_sent_percent: 0,\n      capture_button_pressed: false,\n      mode_just_changed: false,\n      is_validating_stopmotion_video: false,\n      video_recording_is_paused: false,\n\n      current_stopmotion: false,\n\n      collapse_capture_pane: false,\n\n      enable_grid: false,\n      grids: {\n        halfs: [\n          [50, 0, 50, 100],\n          [0, 50, 100, 50],\n        ],\n        thirds: [\n          [33, 0, 33, 100],\n          [66, 0, 66, 100],\n          [0, 33, 100, 33],\n          [0, 66, 100, 66],\n        ],\n        fourths: [\n          [25, 0, 25, 100],\n          [50, 0, 50, 100],\n          [75, 0, 75, 100],\n          [0, 25, 100, 25],\n          [0, 50, 100, 50],\n          [0, 75, 100, 75],\n        ],\n      },\n      current_grid_type: \"thirds\",\n\n      // selected_devices: {\n      //   video_input_device: undefined,\n      //   audio_input_device: undefined,\n      //   audio_output_device: undefined,\n      // },\n\n      stream: undefined,\n      stream_type: undefined,\n\n      audio_output_deviceId: undefined,\n\n      show_capture_settings: false,\n      show_effects_pane: false,\n\n      enable_audio_recording_in_video: true,\n      enable_video: true,\n\n      is_recording: false,\n      timer_recording_in_seconds: false,\n      recording_timer_interval: undefined,\n\n      timelapse_mode_enabled: false,\n      timelapse_interval: 2,\n      timelapse_event: false,\n      timelapse_start_time: false,\n\n      delay_mode_enabled: false,\n      delay_seconds: 5,\n      delay_event: false,\n      delay_start_time: false,\n\n      recorder: null,\n\n      actual_camera_resolution: {\n        width: undefined,\n        height: undefined,\n      },\n      displayed_video_size: {\n        width: undefined,\n        height: undefined,\n      },\n\n      show_live_feed: false,\n      show_stopmotion_list: false,\n      stopmotion: {\n        onion_skin_img: false,\n        onion_skin_opacity: 0,\n      },\n\n      last_frame_from_video: undefined,\n      frameGrabber: undefined,\n\n      show_lines_settings: false,\n      vecto_number_of_colors: 2,\n      lines_angle: 108,\n      lines_brightness: 1,\n      lines_contrast: 1,\n      lines_density: 0.25,\n\n      stream_sharing_informations_status: {},\n      stream_access_informations_status: {},\n\n      enable_effects: false,\n      update_last_video_imageData: undefined,\n    };\n  },\n  created() {},\n  mounted() {\n    // if (\n    //   this.$root.settings.capture_options.selected_mode !== \"\" &&\n    //   this.available_modes.includes(\n    //     this.$root.settings.capture_options.selected_mode\n    //   )\n    // )\n    //   this.selected_mode = this.$root.settings.capture_options.selected_mode;\n    // else\n    this.selected_mode = this.available_modes[0];\n\n    // document.addEventListener(\"keyup\", this.captureKeyListener);\n\n    this.checkCapturePanelSize();\n    this.$eventHub.$on(`activity_panels_resized`, this.checkCapturePanelSize);\n    this.$eventHub.$on(`window.resized`, this.checkCapturePanelSize);\n    this.$eventHub.$on(\n      `stream.newSharingInformations`,\n      this.updateStreamSharing\n    );\n    this.$eventHub.$on(\n      `stream.newDistantAccessInformations`,\n      this.updateDistantStream\n    );\n\n    this.$refs.videoElement.volume = 0;\n    this.$refs.videoElement.addEventListener(\n      \"loadedmetadata\",\n      this.refreshVideoActualSize\n    );\n  },\n  beforeDestroy() {\n    this.$eventHub.$off(`activity_panels_resized`, this.checkCapturePanelSize);\n    this.$eventHub.$off(`window.resized`, this.checkCapturePanelSize);\n    this.$eventHub.$off(\n      `stream.newSharingInformations`,\n      this.updateStreamSharing\n    );\n    this.$eventHub.$off(\n      `stream.newDistantAccessInformations`,\n      this.updateDistantStream\n    );\n\n    // document.removeEventListener(\"keyup\", this.captureKeyListener);\n\n    this.ask_before_leaving_capture = false;\n\n    this.stopFrameGrabber();\n    this.stopTimelapseInterval();\n    this.cancelDelay();\n    this.eraseTimer();\n\n    if (this.update_last_video_imageData)\n      window.cancelAnimationFrame(this.update_last_video_imageData);\n\n    this.$refs.videoElement.removeEventListener(\n      \"loadedmetadata\",\n      this.refreshVideoActualSize\n    ); //turn off the event handler\n  },\n  watch: {\n    selected_mode: function () {\n      this.mode_just_changed = true;\n      window.setTimeout(() => {\n        this.mode_just_changed = false;\n      }, 300);\n\n      // set capture mode as query ?\n      // this.$root.settings.capture_options.selected_mode = this.selected_mode;\n\n      if (this.selected_mode === \"audio\") {\n        this.enable_audio = true;\n        this.enable_video = false;\n      } else {\n        this.enable_video = true;\n      }\n\n      this.stopFrameGrabber();\n      if (this.selected_mode === \"vecto\" || this.selected_mode === \"lines\") {\n        this.startFrameGrabber();\n      }\n\n      if (this.selected_mode !== \"stopmotion\") {\n        this.show_stopmotion_list = false;\n      }\n    },\n    is_validating_stopmotion_video: function () {\n      if (this.is_validating_stopmotion_video) {\n        this.$refs.videoElement.pause();\n      } else {\n        this.$refs.videoElement.play();\n        this.show_live_feed = true;\n      }\n    },\n    audio_output_deviceId: function () {\n      // const audio = document.createElement('audio');\n      // await audio.setSinkId(audioDevices[0].deviceId);\n      // console.log('Audio is being played on ' + audio.sinkId);\n    },\n    media_to_validate: function () {\n      console.log(\n        `WATCH  Capture: media_to_validate = ${!!this.media_to_validate}`\n      );\n\n      if (!this.must_validate_media) {\n        this.sendMedia({});\n        return;\n      }\n\n      if (this.media_to_validate) {\n        if (this.$refs.videoElement) this.$refs.videoElement.pause();\n        if (this.$refs.audioElement) this.$refs.audioElement.pause();\n        this.ask_before_leaving_capture = true;\n      } else {\n        if (this.$refs.videoElement) this.$refs.videoElement.play();\n        if (this.$refs.audioElement) this.$refs.audioElement.play();\n        this.ask_before_leaving_capture = false;\n      }\n    },\n  },\n  computed: {\n    is_making_stopmotion() {\n      const is_making_stopmotion = this.current_stopmotion ? true : false;\n      if (is_making_stopmotion) {\n        // eslint-disable-next-line\n        this.show_capture_settings = false;\n      }\n      return is_making_stopmotion;\n    },\n    validated_media_href_blob() {\n      if (!this.media_to_validate) return false;\n      return window.URL.createObjectURL(this.media_to_validate.rawData);\n    },\n    time_before_next_picture: function () {\n      if (!this.timelapse_start_time) return false;\n\n      const time_since_start = +this.$moment(\n        this.$root.currentTime_millis - this.timelapse_start_time\n      );\n      const time_remaining =\n        (this.timelapse_interval * 1000 - time_since_start) / 1000;\n      return Math.floor(time_remaining + 0.99);\n    },\n    delay_before_picture() {\n      if (!this.delay_start_time) return false;\n      const time_since_start = +this.$moment(\n        this.$root.currentTime_millis - this.delay_start_time\n      );\n      const time_remaining =\n        (this.delay_seconds * 1000 - time_since_start) / 1000;\n      return Math.floor(time_remaining + 0.99);\n      // return this.delay_seconds - seconds_ellapsed_since_click;\n    },\n    show_videos() {\n      return (\n        this.stream &&\n        [\"photo\", \"video\", \"stopmotion\"].includes(this.selected_mode) &&\n        this.show_live_feed &&\n        !(this.must_validate_media && this.media_to_validate)\n      );\n    },\n  },\n  methods: {\n    hasFinishedLoading() {\n      this.show_live_feed = true;\n    },\n    setStream({ stream, type }) {\n      this.stream = stream;\n      this.stream_type = type;\n      this.$refs.videoElement.volume = 0;\n      this.enable_effects = false;\n    },\n    setImageData(imageData) {\n      if (!this.$refs.canvasElement) return;\n      this.$refs.canvasElement.getContext(\"2d\").putImageData(imageData, 0, 0);\n    },\n    previousMode() {\n      console.log(\"METHODS  CaptureView: previousMode\");\n      if (\n        this.is_recording ||\n        this.media_to_validate ||\n        this.mode_just_changed ||\n        this.is_making_stopmotion\n      )\n        return;\n\n      let current_mode_index = this.available_modes.indexOf(this.selected_mode);\n\n      if (current_mode_index > 0) {\n        this.selected_mode = this.available_modes[current_mode_index - 1];\n      } else {\n        this.selected_mode =\n          this.available_modes[this.available_modes.length - 1];\n      }\n    },\n    updateSelectedColor({ e, type }) {\n      if (!this.$refs.canvasElement) return;\n      console.log(\"CaptureView: METHODS  updateSelectedColor\");\n      const px_color = this.getColorInCanvasFromPixelCount(e);\n      this.$eventHub.$emit(\"captureCanvas.pixelColorUnderMouse\", {\n        px_color,\n        type,\n      });\n    },\n    getColorInCanvasFromPixelCount(e) {\n      const getPropsForObjectfitContent = (\n        videoWidth,\n        videoHeight,\n        width,\n        height\n      ) => {\n        let scale, offsetX, offsetY;\n        if (videoHeight / height > videoWidth / width) {\n          (scale = videoHeight / height),\n            (offsetX = (videoWidth - width * scale) / 2),\n            (offsetY = 0);\n        } else {\n          (scale = videoWidth / width),\n            (offsetY = (videoHeight - height * scale) / 2),\n            (offsetX = 0);\n        }\n        return { scale, offsetX, offsetY };\n      };\n\n      const transformed_props = getPropsForObjectfitContent(\n        this.actual_camera_resolution.width,\n        this.actual_camera_resolution.height,\n        this.$refs.canvasElement.getBoundingClientRect().width,\n        this.$refs.canvasElement.getBoundingClientRect().height\n      );\n\n      // because of object-fit, we have to adjust the coordinates we get\n      const mouse_pos_x =\n        e.offsetX * transformed_props.scale + transformed_props.offsetX;\n      const mouse_pos_y =\n        e.offsetY * transformed_props.scale + transformed_props.offsetY;\n      // +\n      // (this.$refs.canvasElement.height -\n      //   this.actual_camera_resolution.height) /\n      //   2;\n      const frame = this.$refs.canvasElement\n        .getContext(\"2d\")\n        .getImageData(mouse_pos_x, mouse_pos_y, 1, 1);\n\n      return {\n        r: frame.data[0],\n        g: frame.data[1],\n        b: frame.data[2],\n      };\n    },\n    nextMode() {\n      console.log(\"CaptureView: METHODS  nextMode\");\n\n      if (\n        this.is_recording ||\n        this.media_to_validate ||\n        this.mode_just_changed ||\n        this.is_making_stopmotion\n      )\n        return;\n\n      let current_mode_index = this.available_modes.indexOf(this.selected_mode);\n      if (current_mode_index < this.available_modes.length - 1) {\n        this.selected_mode = this.available_modes[current_mode_index + 1];\n      } else {\n        this.selected_mode = this.available_modes[0];\n      }\n    },\n    updateStreamSharing(val) {\n      this.stream_sharing_informations_status = val;\n    },\n    updateDistantStream(val) {\n      this.stream_access_informations_status = val;\n    },\n    refreshVideoActualSize() {\n      this.getVideoActualSize()\n        .then(({ width, height }) => {\n          this.actual_camera_resolution.width = width;\n          this.actual_camera_resolution.height = height;\n        })\n        .catch((err) => {\n          if (this.$root.dev_mode === true)\n            console.log(\n              `CaptureView  METHODS : refreshVideoActualSize  couldnt get video size: ` +\n                err\n            );\n          // this.$alertify\n          //   .closeLogOnClick(true)\n          //   .delay(4000)\n          //   .error(\"DEBUG error : failed to get video actual size\");\n        });\n    },\n\n    getVideoActualSize() {\n      return new Promise((resolve, reject) => {\n        //Wait for dimensions if they don't show right away\n        let wait_period_if_necessary = 0;\n        if (!this.$refs.videoElement.videoWidth) {\n          wait_period_if_necessary = 500; //was 500\n        }\n\n        const wait = (ms) =>\n          new Promise((resolve) => window.setTimeout(resolve, ms));\n\n        wait(wait_period_if_necessary).then(() => {\n          if (\n            !this.$refs.videoElement ||\n            this.$refs.videoElement.videoWidth *\n              this.$refs.videoElement.videoHeight >\n              0\n          ) {\n            return resolve({\n              width: this.$refs.videoElement.videoWidth,\n              height: this.$refs.videoElement.videoHeight,\n            });\n          } else {\n            return reject(\"couldnt get video dimensions\");\n          }\n        });\n      });\n    },\n    loadStopmotion(slugFolderName) {\n      this.current_stopmotion = slugFolderName;\n      this.ask_before_leaving_capture = true;\n    },\n    checkCapturePanelSize() {\n      if (this.$el && this.$el.offsetWidth && this.$el.offsetWidth <= 600)\n        this.collapse_capture_pane = true;\n      else this.collapse_capture_pane = false;\n\n      // this.updateVideoDisplayedSize();\n    },\n\n    stopStopmotion() {\n      this.$alertify\n        .okBtn(this.$t(\"yes\"))\n        .cancelBtn(this.$t(\"cancel\"))\n        .confirm(\n          this.$t(\"sure_to_cancel_stopmotion\"),\n          () => {\n            this.closeStopmotionPanel();\n          },\n          () => {}\n        );\n    },\n\n    startFrameGrabber() {\n      const getFrame = () => {\n        if (this.$root.dev_mode === true)\n          console.log(`CaptureView  METHODS : startFrameGrabber`);\n        // this.frameGrabber();\n\n        if (this.media_to_validate) return;\n\n        const ratio =\n          this.actual_camera_resolution.width /\n          this.actual_camera_resolution.height;\n\n        this.getImageDataFromFeed({\n          width: 240 * ratio,\n          height: 240,\n        }).then((image_data) => (this.last_frame_from_video = image_data));\n      };\n      getFrame();\n      this.frameGrabber = window.setInterval(getFrame, 300);\n    },\n    stopFrameGrabber() {\n      if (this.$root.dev_mode === true)\n        console.log(`CaptureView  METHODS : stopFrameGrabber  `);\n\n      if (this.frameGrabber) window.clearInterval(this.frameGrabber);\n      this.last_frame_from_video = undefined;\n    },\n    addStopmotionImage() {\n      const smdata = {\n        name:\n          this.slugFolderName + \"-\" + this.$moment().format(\"YYYYMMDD_HHmmss\"),\n        linked_project: this.slugFolderName,\n        linked_type: this.type,\n        authors: this.$root.current_author\n          ? [{ slugFolderName: this.$root.current_author.slugFolderName }]\n          : \"\",\n      };\n\n      this.$refs.videoElement.pause();\n      this.getImageDataFromFeed().then((imageData) => {\n        if (!this.current_stopmotion) {\n          this.ask_before_leaving_capture = true;\n          // create stopmotion\n          this.$root\n            .createFolder({\n              type: \"stopmotions\",\n              data: smdata,\n            })\n            .then((fdata) => {\n              this.current_stopmotion = fdata.slugFolderName;\n              this.addImageToStopmotion(imageData);\n            });\n        } else {\n          // append to stopmotion\n          this.addImageToStopmotion(imageData);\n        }\n      });\n    },\n    addImageToStopmotion(imageData) {\n      console.log(\"METHODS  CaptureView: addImageToStopmotion\");\n      this.is_sending_image = true;\n\n      this.$root\n        .createMedia({\n          slugFolderName: this.current_stopmotion,\n          type: \"stopmotions\",\n          rawData: imageData,\n          additionalMeta: {\n            type: \"image\",\n          },\n        })\n        .then(() => {\n          this.is_sending_image = false;\n          this.$refs.videoElement.play();\n        })\n        .catch(() => {\n          if (this.is_sending_image && this.$refs.videoElement) {\n            this.is_sending_image = false;\n            this.$refs.videoElement.play();\n            this.$alertify\n              .closeLogOnClick(true)\n              .delay(4000)\n              .error(this.$t(\"notifications.failed_to_save_media\"));\n          }\n        });\n    },\n    closeStopmotionPanel() {\n      this.current_stopmotion = false;\n      this.is_recording = false;\n      this.ask_before_leaving_capture = false;\n      this.show_live_feed = true;\n    },\n\n    captureKeyListener(event) {\n      console.log(\"METHODS  CaptureView: captureKeyListener\");\n\n      // dont register if validating a media\n      if (this.media_to_validate || this.is_validating_stopmotion_video) {\n        return false;\n      }\n\n      // TODO : write captcha to prevent writing to interfere with camera\n      if (\n        (event.target.tagName.toLowerCase() === \"input\" &&\n          (!event.target.dataset ||\n            event.target.dataset.use !== \"onionskin\")) ||\n        event.target.tagName.toLowerCase() === \"textarea\"\n      ) {\n        return false;\n      }\n\n      switch (event.key) {\n        case \"w\":\n        case \"z\":\n        case \"ArrowLeft\":\n          this.previousMode();\n          break;\n        case \"s\":\n        case \"ArrowRight\":\n          this.nextMode();\n          break;\n        case \"a\":\n        case \"q\":\n        case \" \":\n          if (!this.is_recording) this.setCaptureInit();\n          else this.stopRecording();\n          break;\n      }\n    },\n    setCaptureInit() {\n      if (this.$root.dev_mode === true)\n        console.log(`CaptureView / setCaptureInit`);\n\n      this.ask_before_leaving_capture = true;\n\n      if (this.delay_mode_enabled && this.delay_event) {\n        // cancel delay\n\n        this.cancelDelay();\n      } else if (this.delay_mode_enabled) {\n        this.startDelay();\n      } else {\n        this.setCapture();\n      }\n    },\n    startDelay() {\n      this.delay_start_time = this.$root.currentTime_millis;\n      this.delay_event = window.setTimeout(() => {\n        this.setCapture();\n        this.delay_start_time = false;\n        this.delay_event = false;\n      }, this.delay_seconds * 1000);\n    },\n    cancelDelay() {\n      window.clearTimeout(this.delay_event);\n      this.delay_start_time = false;\n      this.delay_event = false;\n    },\n    startTimelapseInterval() {\n      this.timelapse_start_time = this.$root.currentTime_millis;\n      this.timelapse_event = window.setInterval(() => {\n        this.setCapture();\n        this.timelapse_start_time = this.$root.currentTime_millis;\n      }, this.timelapse_interval * 1000);\n    },\n    stopTimelapseInterval() {\n      window.clearInterval(this.timelapse_event);\n      this.timelapse_event = false;\n      this.timelapse_start_time = false;\n    },\n    setCapture() {\n      this.capture_button_pressed = true;\n      window.setTimeout(() => {\n        this.capture_button_pressed = false;\n      }, 400);\n      this.show_capture_settings = false;\n\n      if (this.selected_mode === \"photo\") {\n        this.getImageDataFromFeed().then((rawData) => {\n          this.media_to_validate = {\n            rawData,\n            objectURL: URL.createObjectURL(rawData),\n            temp_name: \"image.jpeg\",\n            type: \"image\",\n          };\n        });\n      } else if (this.selected_mode === \"video\") {\n        this.video_recording_is_paused = false;\n\n        this.startRecordFeed({\n          type: \"video\",\n          videoBitsPerSecond: 4112000,\n          enable_audio_recording_in_video: this.enable_audio_recording_in_video,\n        });\n      } else if (this.selected_mode === \"audio\") {\n        this.startRecordFeed({\n          type: \"audio\",\n        });\n      } else if (this.selected_mode === \"stopmotion\") {\n        this.addStopmotionImage();\n\n        if (this.timelapse_mode_enabled && !this.is_recording) {\n          this.is_recording = true;\n          this.startTimelapseInterval();\n        }\n      } else if (this.selected_mode === \"vecto\") {\n        const svgstr = this.$refs.vectoElement.svgstr;\n        this.media_to_validate = {\n          preview: svgstr,\n          rawData: new Blob([svgstr], { type: \"image/svg+xml\" }),\n          temp_name: \"vecto.svg\",\n          type: \"svg\",\n        };\n      } else if (this.selected_mode === \"lines\") {\n        const svgstr =\n          this.$refs.vectoElement.$el.querySelector(\"svg\").outerHTML;\n        this.media_to_validate = {\n          preview: svgstr,\n          rawData: new Blob([svgstr], { type: \"image/svg+xml\" }),\n          temp_name: \"lines.svg\",\n          type: \"svg\",\n        };\n      }\n    },\n    stopRecording() {\n      if (!this.is_recording) return;\n\n      if (this.selected_mode === \"stopmotion\" && this.timelapse_mode_enabled) {\n        this.is_recording = false;\n        this.stopTimelapseInterval();\n        return;\n      }\n      if (this.selected_mode === \"video\") {\n        this.recorder.stopRecording(() => {\n          this.is_recording = false;\n          this.eraseTimer();\n\n          let video_blob = this.recorder.getBlob();\n\n          // recorder.camera.stop();\n          this.recorder.destroy();\n          this.recorder = null;\n\n          this.media_to_validate = {\n            rawData: video_blob,\n            objectURL: URL.createObjectURL(video_blob),\n            temp_name: \"video.webm\",\n            type: \"video\",\n          };\n        });\n      } else if (this.selected_mode === \"audio\") {\n        this.recorder.stopRecording(() => {\n          this.is_recording = false;\n          this.eraseTimer();\n\n          let audio_blob = this.recorder.getBlob();\n\n          // recorder.camera.stop();\n          this.recorder.destroy();\n          this.recorder = null;\n\n          const preview = this.$refs.equalizerElement.$el\n            .querySelector(\"canvas\")\n            .toDataURL(\"image/png\");\n          this.media_to_validate = {\n            preview,\n            rawData: audio_blob,\n            objectURL: URL.createObjectURL(audio_blob),\n            temp_name: \"audio.wav\",\n            type: \"audio\",\n          };\n        });\n      }\n    },\n\n    pauseOrResumeCapture() {\n      if (this.recorder.state !== \"paused\") {\n        this.video_recording_is_paused = true;\n        this.pauseTimer();\n        this.recorder.pauseRecording();\n      } else {\n        this.video_recording_is_paused = false;\n        this.unpauseTimer();\n        this.recorder.resumeRecording();\n      }\n    },\n\n    startTimer() {\n      this.timer_recording_in_seconds = 0;\n      this.recording_timer_interval = window.setInterval(() => {\n        this.timer_recording_in_seconds = Number(\n          Number(this.timer_recording_in_seconds) + 0.1\n        ).toFixed(1);\n      }, 100);\n    },\n    pauseTimer() {\n      window.clearInterval(this.recording_timer_interval);\n    },\n    unpauseTimer() {\n      this.recording_timer_interval = window.setInterval(() => {\n        this.timer_recording_in_seconds = Number(\n          Number(this.timer_recording_in_seconds) + 0.1\n        ).toFixed(1);\n      }, 100);\n    },\n    eraseTimer() {\n      this.timer_recording_in_seconds = false;\n      window.clearInterval(this.recording_timer_interval);\n    },\n\n    getImageDataFromFeed({ width, height } = {}) {\n      return new Promise((resolve, reject) => {\n        if (this.enable_effects && this.$refs.canvasElement) {\n          this.getStaticImageFromVideoElement({\n            width,\n            height,\n            from_element: this.$refs.canvasElement,\n          })\n            .then(resolve)\n            .catch(reject);\n        } else {\n          this.getStaticImageFromVideoElement({ width, height })\n            .then(resolve)\n            .catch(reject);\n        }\n      });\n    },\n\n    async getStaticImageFromVideoElement({\n      width,\n      height,\n      from_element = this.$refs.videoElement,\n    } = {}) {\n      if (this.$root.dev_mode === true)\n        console.log(`CaptureView  METHODS : getStaticImageFromVideoElement`);\n\n      if (!from_element) throw new Error(\"missing video element\");\n\n      let _canvas = undefined;\n      if (from_element.tagName === \"VIDEO\") {\n        if (!this.invisible_canvas)\n          this.invisible_canvas = document.createElement(\"canvas\");\n\n        _canvas = this.invisible_canvas;\n\n        _canvas.width = width ? width : from_element.videoWidth;\n        _canvas.height = height ? height : from_element.videoHeight;\n\n        let invisible_ctx = _canvas.getContext(\"2d\");\n        invisible_ctx.drawImage(\n          from_element,\n          0,\n          0,\n          _canvas.width,\n          _canvas.height\n        );\n      } else if (from_element.tagName === \"CANVAS\") {\n        _canvas = from_element;\n      }\n\n      const imageBlob = await new Promise(function (resolve) {\n        _canvas.toBlob(resolve, \"image/jpeg\", 0.95);\n      });\n      return imageBlob;\n    },\n\n    startRecordFeed(options) {\n      return new Promise(() => {\n        const finalStream = new MediaStream();\n\n        // ajouter la vido au stream\n\n        const video_source =\n          this.enable_effects && this.$refs.canvasElement\n            ? this.$refs.canvasElement.captureStream()\n            : this.stream;\n        video_source.getVideoTracks().forEach(function (track) {\n          finalStream.addTrack(track);\n        });\n\n        if (options?.enable_audio_recording_in_video === true)\n          this.stream\n            .getAudioTracks()\n            .forEach((track) => finalStream.addTrack(track));\n\n        this.recorder = RecordRTC(finalStream, options);\n\n        try {\n          this.recorder.startRecording();\n          this.is_recording = true;\n          this.startTimer();\n        } catch (err) {\n          this.$alertify\n            .closeLogOnClick(true)\n            .delay(4000)\n            .error(\n              this.$t(\"notifications.failed_to_start_record\") +\n                \"<br>\" +\n                err.message\n            );\n        }\n      });\n    },\n\n    async sendMedia({ fav = false }) {\n      console.log(`METHODS  CaptureView: sendMedia with fav=${fav}`);\n      if (this.$root.dev_mode === true)\n        console.log(`METHODS  CaptureView / sendMedia`);\n\n      if (this.return_temp_media) {\n        this.$emit(\"tempMedia\", this.media_to_validate);\n        return;\n      }\n\n      const timeCreated = +new Date();\n      const randomString = (\n        Math.random().toString(36) + \"00000000000000000\"\n      ).slice(2, 3 + 2);\n\n      const extensions = {\n        image: \"jpeg\",\n        video: \"webm\",\n        audio: \"wav\",\n        svg: \"svg\",\n      };\n      const filename = `${\n        this.media_to_validate.type\n      }-${timeCreated}-${randomString}.${\n        extensions[this.media_to_validate.type]\n      }`;\n\n      const rawData = this.media_to_validate.rawData;\n\n      let formData = new FormData();\n      formData.append(\"file\", rawData, filename);\n\n      const additional_meta = {\n        fav,\n      };\n      formData.append(filename, JSON.stringify(additional_meta));\n\n      this.media_is_being_sent = true;\n      this.media_being_sent_percent = 0;\n\n      // TODO : possibilit de cancel\n      let res = await this.$axios\n        .post(`${this.path}/_upload`, formData, {\n          headers: { \"Content-Type\": \"multipart/form-data\" },\n          onUploadProgress: function (progressEvent) {\n            console.log(\n              `METHODS  CaptureView: onUploadProgress for name = ${filename} / ${parseInt(\n                Math.round((progressEvent.loaded * 100) / progressEvent.total)\n              )}% `\n            );\n            this.media_being_sent_percent = parseInt(\n              Math.round((progressEvent.loaded * 100) / progressEvent.total)\n            );\n            // this.selected_files_meta[filename].upload_percentages = parseInt(Math.round((progressEvent.loaded * 100 ) / progressEvent.total ) );\n          }.bind(this),\n        })\n        .catch((err) => {\n          console.log(\n            `METHODS  sendThisFile: name = ${filename} / failed uploading ${err}`\n          );\n          this.media_is_being_sent = false;\n          this.media_being_sent_percent = 0;\n          this.$alertify\n            .closeLogOnClick(true)\n            .delay(4000)\n            .error(this.$t(\"notifications.media_couldnt_be_sent\"));\n          throw err;\n        });\n\n      this.$alertify\n        .closeLogOnClick(true)\n        .delay(4000)\n        .success(this.$t(\"notifications.media_was_sent\"));\n      this.media_is_being_sent = false;\n      this.media_to_validate = false;\n\n      this.$emit(\"insertMedias\", res.data.meta_filename);\n      return;\n    },\n    cancelValidation() {\n      this.media_to_validate = false;\n    },\n    updateSingleImage($event) {\n      this.stopmotion.onion_skin_img = $event;\n    },\n  },\n};\n</script>\n<style lang=\"scss\" scoped>\n.m_captureview {\n  display: flex;\n  flex-flow: row nowrap;\n  max-height: 100vh;\n  height: 100%;\n\n  // &.is--collapsed {\n  //   .m_captureview--videoPane--bottom--buttons {\n  //     > * {\n  //       padding: 0;\n  //     }\n  //   }\n  // }\n\n  .m_captureview--settingsPaneButton {\n    position: relative;\n    z-index: 1;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    width: 0;\n    background-color: var(--c-rouge);\n\n    > button {\n      transform: rotate(-90deg);\n      transform-origin: center top;\n      border-top-left-radius: 0;\n      border-top-right-radius: 0;\n      margin-left: -1px;\n    }\n  }\n\n  .m_captureview--videoPane {\n    position: relative;\n    overflow-y: auto;\n    flex: 1 1 100px;\n\n    display: flex;\n    flex-flow: column nowrap;\n  }\n\n  .m_captureview--videoPane--top {\n    position: relative;\n    margin: 0 auto;\n    min-height: 300px;\n\n    flex: 1 1 auto;\n    overflow: hidden;\n\n    width: 100%;\n    height: 100%;\n    background-color: var(--c-noir);\n    background-color: black;\n    // padding: calc(var(--spacing) / 2);\n\n    display: flex;\n    flex-flow: column nowrap;\n    justify-content: center;\n    align-items: center;\n\n    &.is--being_streamed {\n      border-bottom: 5px solid var(--c-rouge);\n    }\n  }\n\n  .m_captureview--videoPane--bottom {\n    position: relative;\n    flex: 0 0 auto;\n    box-shadow: 0 -1px 4px rgba(0, 0, 0, 0.1);\n\n    .m_captureview--videoPane--bottom--buttons {\n      display: flex;\n      flex-flow: row wrap;\n      justify-content: space-between;\n      align-items: center;\n\n      button {\n        width: 3em;\n        height: 3em;\n      }\n\n      > * {\n        display: flex;\n        flex: 1 1 100px;\n        padding: calc(var(--spacing) / 2);\n\n        > * {\n          margin-right: calc(var(--spacing) / 2);\n        }\n\n        &:nth-child(2) {\n          flex: 1 1 200px;\n          text-align: center;\n          display: flex;\n          flex-flow: row wrap;\n          align-items: center;\n          justify-content: center;\n        }\n        &:last-child {\n          justify-content: flex-end;\n        }\n      }\n\n      &.is--recording {\n        background-color: var(--c-orange);\n      }\n    }\n  }\n\n  ._settingsTag {\n    position: absolute;\n    bottom: 0;\n    right: 0;\n    color: var(--c-noir);\n    font-size: var(--font-verysmall);\n    margin: 15px;\n    pointer-events: none;\n\n    text-align: right;\n\n    button {\n      display: inline-block;\n      background-color: white;\n      // border: 2px solid #fff;\n      border-radius: 4px;\n      line-height: 1;\n      margin: 2px;\n      padding: 2px 4px;\n      font-weight: 500;\n      pointer-events: auto;\n      cursor: pointer;\n\n      &:hover {\n        font-weight: 600;\n      }\n\n      &.is--active {\n        background-color: var(--c-rouge);\n        color: white;\n      }\n    }\n  }\n\n  .m_captureview--videoPane--top--videoContainer {\n    position: relative;\n    width: 100%;\n    height: 100%;\n\n    video,\n    canvas,\n    .mediaContainer img,\n    .m_audioEqualizer {\n      position: absolute;\n      top: 0;\n      left: 0;\n\n      width: 100%;\n      height: 100%;\n      object-fit: contain;\n    }\n  }\n}\n\n._captureButton {\n  position: relative;\n  // margin: 0 auto;\n  margin: 0 calc(var(--spacing) / 4);\n\n  > img {\n    flex: 0 0 auto;\n  }\n}\n\n._modeSelector {\n  position: absolute;\n  z-index: 1;\n  display: flex;\n  left: 0;\n  right: 0;\n  // width: 100%;\n  flex-flow: row wrap;\n  justify-content: center;\n  align-items: center;\n  padding: calc(var(--spacing) / 2) 0 0;\n  user-select: none;\n  pointer-events: none;\n\n  font-family: \"Fira Code\";\n  color: var(--c-orange);\n\n  input[disabled] + label {\n    filter: grayscale(100%);\n    // opacity: 0.3;\n    cursor: not-allowed;\n  }\n\n  > * {\n    flex: 0 0 auto;\n    display: flex;\n    flex-flow: row wrap;\n    font-family: inherit;\n    pointer-events: auto;\n    // background-color: white;\n  }\n  > ._arrows {\n    padding: calc(var(--spacing) / 4) calc(var(--spacing) / 4);\n\n    button {\n      padding-left: 0;\n      padding-right: 0;\n      min-height: 0;\n    }\n\n    svg {\n      width: 36px;\n      height: 36px;\n      padding: 4px;\n      // padding: calc(var(--spacing) / 4) calc(var(--spacing) / 4);\n    }\n\n    &:hover,\n    &:focus {\n      // background-color: var(--c-gris-fonce);\n    }\n  }\n\n  input {\n    width: 0px;\n    height: 0;\n    visibility: hidden;\n\n    &:not(:checked) + label:not(:hover) {\n      // opacity: 0.3;\n      // background: transparent;\n    }\n  }\n\n  input:checked + label {\n    background-color: var(--c-orange);\n    span {\n      color: white;\n    }\n  }\n\n  input[disabled] + label {\n    filter: grayscale(100%);\n    opacity: 0.3;\n    cursor: not-allowed;\n  }\n\n  label {\n    font-size: inherit;\n    font-family: inherit;\n    display: inline-block;\n    text-decoration: none;\n    text-transform: uppercase;\n    font-weight: 500;\n    letter-spacing: 0.06em;\n    flex-shrink: 0;\n    margin: 0;\n    cursor: pointer;\n    // min-height: 2.43rem;\n    border-radius: 6px;\n    transition: color 0.25s ease-out, opacity 0.5s;\n    display: flex;\n    flex-flow: row nowrap;\n    align-items: center;\n    justify-content: center;\n    background-color: #fff;\n    letter-spacing: 0;\n    // padding: 0 0.405rem;\n    margin: calc(var(--spacing) / 4) calc(var(--spacing) / 4);\n    text-align: center;\n    transition: all 0.4s cubic-bezier(0.19, 1, 0.22, 1);\n  }\n\n  ._picto {\n    border-radius: 50%;\n    overflow: hidden;\n    display: block;\n    width: 36px;\n    height: 36px;\n\n    // margin: calc(var(--spacing) / 8);\n\n    padding: 4px;\n    color: #fff;\n\n    margin-right: 0;\n  }\n\n  span {\n    display: block;\n    font-weight: 400;\n    text-transform: lowercase;\n    margin: 0.405rem;\n    font-size: 0.8rem;\n    font-family: Fira Mono;\n    text-transform: uppercase;\n    font-weight: 500;\n    letter-spacing: 0.05em;\n    color: #666;\n    font-weight: 600;\n  }\n}\n\n._mode_indicator {\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background-color: var(--c-rouge);\n  font-weight: 700;\n  font-family: \"Fira Code\";\n  font-size: var(--font-large);\n  text-transform: uppercase;\n\n  letter-spacing: 0.06em;\n\n  pointer-events: none;\n\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  color: white;\n}\n\n._delay_timer {\n  position: absolute;\n  z-index: 100;\n  width: 100%;\n  height: 100%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  pointer-events: none;\n\n  font-size: 40vmin;\n  color: transparent;\n\n  --c-text-stroke: var(--c-rouge);\n  --c-text-shadow: rgba(0, 0, 0, 0.2);\n  color: var(--c-rouge_fonce);\n\n  -webkit-text-stroke: 1vmin var(--c-text-stroke);\n  // text-shadow: 1vmin 1vmin 0 var(--c-text-shadow),\n  //   -1px -1px 0 var(--c-text-shadow), 1px -1px 0 var(--c-text-shadow),\n  //   -1px 1px 0 var(--c-text-shadow), 1px 1px 0 var(--c-text-shadow);\n\n  &.is--timelapse {\n    font-size: 10vmin;\n    -webkit-text-stroke: 0.2vmin var(--c-text-stroke);\n    height: 50%;\n    bottom: 0;\n  }\n}\n\n._capture_options {\n  position: absolute;\n  bottom: 0;\n  width: 100%;\n  z-index: 100;\n  text-align: center;\n  pointer-events: none;\n\n  display: flex;\n  flex-flow: column nowrap;\n  justify-content: center;\n  margin: calc(var(--spacing) / 4) auto;\n\n  label {\n    display: inline-block;\n    margin: 0 auto;\n    background-color: var(--c-rouge);\n    padding: 0 calc(var(--spacing) / 8);\n\n    margin-bottom: calc(var(--spacing) / 8);\n    color: white;\n    border-radius: 4px;\n    pointer-events: auto;\n  }\n\n  .record_options {\n    max-width: 450px;\n    margin: calc(var(--spacing) / 4) auto;\n    // .padding-verysmall;\n    pointer-events: auto;\n    // .font-small;\n\n    > * {\n      background-color: var(--c-rouge);\n\n      color: white;\n      padding: 0 calc(var(--spacing) / 4);\n      border-radius: 4px;\n      width: auto;\n    }\n\n    input {\n      display: inline-block;\n      min-width: 2em;\n      max-width: 3em;\n      height: 1.4em;\n      margin: 2px;\n      padding: 0 2px;\n      width: auto;\n      width: auto;\n      text-align: center;\n      color: white;\n\n      background-color: var(--c-rouge_clair);\n\n      border-bottom: 0px;\n\n      &:active,\n      &:focus {\n        border-bottom-color: var(--c-rouge_fonce);\n      }\n    }\n\n    .record_options--timer {\n      font-size: 2em;\n    }\n  }\n}\n\n._tiny_equalizer {\n  margin: 0 calc(var(--spacing) / 2);\n\n  .m_audioEqualizer {\n    position: relative;\n    width: 64px;\n    height: 36px;\n    background-color: transparent !important;\n    border-radius: 4px;\n    overflow: hidden;\n  }\n}\n\n._onion_skin {\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n\n  &.is--onionskin {\n    opacity: 0.2;\n    opacity: var(--onionskin-opacity);\n  }\n}\n._mode_accessory_range {\n  max-width: 200px;\n  margin: -5px 0 -5px auto;\n  label {\n    margin: 0;\n  }\n  input._rtl {\n    direction: rtl;\n  }\n  input {\n    margin: 0;\n  }\n}\n._video_grid_overlay {\n  position: absolute;\n  display: block;\n  width: 100%;\n  height: 100%;\n\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  pointer-events: none;\n\n  object-fit: contain;\n\n  --stroke_width: 2px;\n\n  svg {\n    position: absolute;\n    width: 100%;\n    height: 100%;\n    stroke: var(--c-rouge);\n    fill: none;\n    // padding: calc(var(--stroke_width) / 2);\n\n    line {\n      stroke-width: var(--stroke_width);\n    }\n    rect {\n      stroke-width: var(--stroke_width);\n    }\n  }\n}\n\n._enable_timelapse_button {\n  color: #fff;\n  background: var(--c-orange);\n  width: 24px;\n  height: 24px;\n  display: block;\n  min-height: 0;\n  line-height: 0;\n  border-radius: 50%;\n  text-align: center;\n  font-weight: bold;\n  padding: 0;\n  margin: calc(var(--spacing) / 4);\n\n  svg {\n    width: 100%;\n    height: 100%;\n  }\n\n  &.is--active {\n    background: var(--c-rouge);\n    color: white;\n  }\n}\n._just_captured_overlay {\n  background-color: var(--c-rouge);\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  z-index: 100;\n}\n._download_media_without_validation {\n  background-color: var(--c-noir);\n  padding: 0 calc(var(--spacing) / 2) calc(var(--spacing) / 4);\n  // margin-top: calc(-0.5 * var(--spacing));\n  margin-bottom: -0.2em;\n  line-height: 1;\n  text-align: right;\n\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  overflow: hidden;\n\n  a {\n    color: var(--c-gris);\n  }\n}\n</style>\n<style lang=\"scss\">\n._onion_skin img {\n  width: 100%;\n  height: 100%;\n  object-fit: contain;\n}\n</style>\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-37[0].rules[0].use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./CaptureView.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-37[0].rules[0].use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./CaptureView.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./CaptureView.vue?vue&type=template&id=265b2e52&scoped=true&\"\nimport script from \"./CaptureView.vue?vue&type=script&lang=js&\"\nexport * from \"./CaptureView.vue?vue&type=script&lang=js&\"\nimport style0 from \"./CaptureView.vue?vue&type=style&index=0&id=265b2e52&lang=scss&scoped=true&\"\nimport style1 from \"./CaptureView.vue?vue&type=style&index=1&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"265b2e52\",\n  null\n  \n)\n\nexport default component.exports","// Imports\nimport ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/noSourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".m_audioEqualizer[data-v-56c3da71]{width:100%;height:100%;-o-object-fit:scale-down;object-fit:scale-down;display:flex;align-items:center;justify-content:center}.m_audioEqualizer canvas[data-v-56c3da71]{display:block;max-width:100%;max-height:100%;background-color:#fff}\", \"\"]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/noSourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".m_captureEffects[data-v-03babde1]{position:relative;flex:1 0 200px;max-width:280px;background-color:var(--c-bleumarine);padding:calc(var(--spacing)/8);overflow:auto}.m_captureEffects label[data-v-03babde1]{display:block}.m_captureEffects>*[data-v-03babde1]{background-color:#fff;border-radius:4px;margin:calc(var(--spacing)/2);padding:calc(var(--spacing)/8)}.m_captureEffects>*[data-v-03babde1]>:first-child{padding:calc(var(--spacing)/4)}.m_captureEffects>*>:not(:first-child)>*[data-v-03babde1]{padding:calc(var(--spacing)/4);margin:0 calc(var(--spacing)/4) calc(var(--spacing)/2);background-color:var(--c-gris-clair);border-radius:4px}.is--disabled[data-v-03babde1]{filter:grayscale(100%);opacity:.7;cursor:not-allowed;-webkit-user-select:none;-moz-user-select:none;user-select:none}.is--disabled>*[data-v-03babde1]{pointer-events:none}\", \"\"]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/noSourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".m_captureSettings[data-v-75a82b24]{position:relative;flex:1 0 200px;max-width:280px;background-color:var(--c-rouge);color:#fff;display:flex;flex-flow:column nowrap}.m_captureSettings .u-buttonLink[data-v-75a82b24],.m_captureSettings label[data-v-75a82b24],.m_captureSettings small[data-v-75a82b24]{color:inherit}.m_captureSettings--topbar[data-v-75a82b24]{flex:0 0 auto;border-bottom:2px solid var(--c-rouge_fonce);color:#fff;display:flex;align-items:center;justify-content:center}.m_captureSettings--topbar--title[data-v-75a82b24]{padding:calc(var(--spacing)/2) var(--spacing);font-weight:700;font-size:var(--font-large)}.m_captureSettings--settings[data-v-75a82b24]{overflow-y:auto;flex:1 1 auto}.m_captureSettings--settings>div[data-v-75a82b24]{padding:calc(var(--spacing)/2);padding-top:calc(var(--spacing)/4)}.m_captureSettings--settings>div>div[data-v-75a82b24]{background-color:rgba(0,0,0,.1);padding:0 calc(var(--spacing)/2) calc(var(--spacing)/2);border-radius:6px}.m_captureSettings--settings>div>div>div[data-v-75a82b24]{padding-top:calc(var(--spacing)/4);margin-bottom:calc(var(--spacing)/4)}.m_captureSettings--settings>div>div>div[data-v-75a82b24]:last-child{margin-bottom:0}.m_captureSettings--settings>div>label[data-v-75a82b24]{line-height:2}.m_captureSettings--settings--resolutions label[data-v-75a82b24]{padding:calc(var(--spacing)/4) 0;display:flex;align-items:center}.m_captureSettings--settings--resolutions label>input[data-v-75a82b24]{flex:0 0 auto;margin-right:calc(var(--spacing)/3)}.m_captureSettings--updateButton[data-v-75a82b24]{flex:0 0 auto;border-top:2px solid var(--c-rouge_fonce);color:#000;display:flex;flex-flow:column wrap}.m_sideBySideSwitches[data-v-75a82b24]{flex-flow:row nowrap}.m_sideBySideSwitches>*[data-v-75a82b24]{display:block;border-color:var(--c-rouge_fonce);min-width:100px;padding:calc(var(--spacing)/8) 0;display:flex;flex-flow:row wrap;align-items:stretch}.m_sideBySideSwitches>* input[data-v-75a82b24]{margin:calc(var(--spacing)/2)}@media only screen and (max-width:780px){.m_sideBySideSwitches>* input[data-v-75a82b24]{margin:calc(var(--spacing)/4)}}.m_sideBySideSwitches>*>div[data-v-75a82b24]{flex:1 1 0;display:flex;flex-flow:row nowrap;align-items:center}.m_sideBySideSwitches>* small[data-v-75a82b24]{flex:0 0 100%;background-color:var(--c-rouge_fonce);display:block;text-align:center;font-style:normal;display:flex;align-items:center;justify-content:center}.m_captureSettings--updateButton--buttons[data-v-75a82b24]{padding:calc(var(--spacing)/2);display:flex;justify-content:center}.m_captureSettings--updateButton--shareStreamToggle[data-v-75a82b24]{position:relative;background-color:var(--c-rouge_fonce);color:#fff;text-align:center}._close_button[data-v-75a82b24]{position:absolute;top:0;right:0;min-height:0;padding:0;margin:calc(var(--spacing)/4)}\", \"\"]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/noSourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".m_captureview[data-v-265b2e52]{display:flex;flex-flow:row nowrap;max-height:100vh;height:100%}.m_captureview .m_captureview--settingsPaneButton[data-v-265b2e52]{position:relative;z-index:1;display:flex;justify-content:center;align-items:center;width:0;background-color:var(--c-rouge)}.m_captureview .m_captureview--settingsPaneButton>button[data-v-265b2e52]{transform:rotate(-90deg);transform-origin:center top;border-top-left-radius:0;border-top-right-radius:0;margin-left:-1px}.m_captureview .m_captureview--videoPane[data-v-265b2e52]{position:relative;overflow-y:auto;flex:1 1 100px;display:flex;flex-flow:column nowrap}.m_captureview .m_captureview--videoPane--top[data-v-265b2e52]{position:relative;margin:0 auto;min-height:300px;flex:1 1 auto;overflow:hidden;width:100%;height:100%;background-color:var(--c-noir);background-color:#000;display:flex;flex-flow:column nowrap;justify-content:center;align-items:center}.m_captureview .m_captureview--videoPane--top.is--being_streamed[data-v-265b2e52]{border-bottom:5px solid var(--c-rouge)}.m_captureview .m_captureview--videoPane--bottom[data-v-265b2e52]{position:relative;flex:0 0 auto;box-shadow:0 -1px 4px rgba(0,0,0,.1)}.m_captureview .m_captureview--videoPane--bottom .m_captureview--videoPane--bottom--buttons[data-v-265b2e52]{display:flex;flex-flow:row wrap;justify-content:space-between;align-items:center}.m_captureview .m_captureview--videoPane--bottom .m_captureview--videoPane--bottom--buttons button[data-v-265b2e52]{width:3em;height:3em}.m_captureview .m_captureview--videoPane--bottom .m_captureview--videoPane--bottom--buttons>*[data-v-265b2e52]{display:flex;flex:1 1 100px;padding:calc(var(--spacing)/2)}.m_captureview .m_captureview--videoPane--bottom .m_captureview--videoPane--bottom--buttons>*>*[data-v-265b2e52]{margin-right:calc(var(--spacing)/2)}.m_captureview .m_captureview--videoPane--bottom .m_captureview--videoPane--bottom--buttons[data-v-265b2e52]>:nth-child(2){flex:1 1 200px;text-align:center;display:flex;flex-flow:row wrap;align-items:center;justify-content:center}.m_captureview .m_captureview--videoPane--bottom .m_captureview--videoPane--bottom--buttons[data-v-265b2e52]>:last-child{justify-content:flex-end}.m_captureview .m_captureview--videoPane--bottom .m_captureview--videoPane--bottom--buttons.is--recording[data-v-265b2e52]{background-color:var(--c-orange)}.m_captureview ._settingsTag[data-v-265b2e52]{position:absolute;bottom:0;right:0;color:var(--c-noir);font-size:var(--font-verysmall);margin:15px;pointer-events:none;text-align:right}.m_captureview ._settingsTag button[data-v-265b2e52]{display:inline-block;background-color:#fff;border-radius:4px;line-height:1;margin:2px;padding:2px 4px;font-weight:500;pointer-events:auto;cursor:pointer}.m_captureview ._settingsTag button[data-v-265b2e52]:hover{font-weight:600}.m_captureview ._settingsTag button.is--active[data-v-265b2e52]{background-color:var(--c-rouge);color:#fff}.m_captureview .m_captureview--videoPane--top--videoContainer[data-v-265b2e52]{position:relative;width:100%;height:100%}.m_captureview .m_captureview--videoPane--top--videoContainer .m_audioEqualizer[data-v-265b2e52],.m_captureview .m_captureview--videoPane--top--videoContainer .mediaContainer img[data-v-265b2e52],.m_captureview .m_captureview--videoPane--top--videoContainer canvas[data-v-265b2e52],.m_captureview .m_captureview--videoPane--top--videoContainer video[data-v-265b2e52]{position:absolute;top:0;left:0;width:100%;height:100%;-o-object-fit:contain;object-fit:contain}._captureButton[data-v-265b2e52]{position:relative;margin:0 calc(var(--spacing)/4)}._captureButton>img[data-v-265b2e52]{flex:0 0 auto}._modeSelector[data-v-265b2e52]{position:absolute;z-index:1;display:flex;left:0;right:0;flex-flow:row wrap;justify-content:center;align-items:center;padding:calc(var(--spacing)/2) 0 0;-webkit-user-select:none;-moz-user-select:none;user-select:none;pointer-events:none;font-family:Fira Code;color:var(--c-orange)}._modeSelector>*[data-v-265b2e52]{flex:0 0 auto;display:flex;flex-flow:row wrap;font-family:inherit;pointer-events:auto}._modeSelector>._arrows[data-v-265b2e52]{padding:calc(var(--spacing)/4) calc(var(--spacing)/4)}._modeSelector>._arrows button[data-v-265b2e52]{padding-left:0;padding-right:0;min-height:0}._modeSelector>._arrows svg[data-v-265b2e52]{width:36px;height:36px;padding:4px}._modeSelector input[data-v-265b2e52]{width:0;height:0;visibility:hidden}._modeSelector input:checked+label[data-v-265b2e52]{background-color:var(--c-orange)}._modeSelector input:checked+label span[data-v-265b2e52]{color:#fff}._modeSelector input[disabled]+label[data-v-265b2e52]{filter:grayscale(100%);opacity:.3;cursor:not-allowed}._modeSelector label[data-v-265b2e52]{font-size:inherit;font-family:inherit;display:inline-block;text-decoration:none;text-transform:uppercase;font-weight:500;letter-spacing:.06em;flex-shrink:0;margin:0;cursor:pointer;border-radius:6px;transition:color .25s ease-out,opacity .5s;display:flex;flex-flow:row nowrap;align-items:center;justify-content:center;background-color:#fff;letter-spacing:0;margin:calc(var(--spacing)/4) calc(var(--spacing)/4);text-align:center;transition:all .4s cubic-bezier(.19,1,.22,1)}._modeSelector ._picto[data-v-265b2e52]{border-radius:50%;overflow:hidden;display:block;width:36px;height:36px;padding:4px;color:#fff;margin-right:0}._modeSelector span[data-v-265b2e52]{display:block;font-weight:400;text-transform:lowercase;margin:.405rem;font-size:.8rem;font-family:Fira Mono;text-transform:uppercase;font-weight:500;letter-spacing:.05em;color:#666;font-weight:600}._mode_indicator[data-v-265b2e52]{top:0;left:0;right:0;bottom:0;background-color:var(--c-rouge);font-weight:700;font-family:Fira Code;font-size:var(--font-large);text-transform:uppercase;letter-spacing:.06em;color:#fff}._delay_timer[data-v-265b2e52],._mode_indicator[data-v-265b2e52]{position:absolute;pointer-events:none;display:flex;align-items:center;justify-content:center}._delay_timer[data-v-265b2e52]{z-index:100;width:100%;height:100%;font-size:40vmin;color:transparent;--c-text-stroke:var(--c-rouge);--c-text-shadow:rgba(0,0,0,.2);color:var(--c-rouge_fonce);-webkit-text-stroke:1vmin var(--c-text-stroke)}._delay_timer.is--timelapse[data-v-265b2e52]{font-size:10vmin;-webkit-text-stroke:.2vmin var(--c-text-stroke);height:50%;bottom:0}._capture_options[data-v-265b2e52]{position:absolute;bottom:0;width:100%;z-index:100;text-align:center;pointer-events:none;display:flex;flex-flow:column nowrap;justify-content:center;margin:calc(var(--spacing)/4) auto}._capture_options label[data-v-265b2e52]{display:inline-block;margin:0 auto;background-color:var(--c-rouge);padding:0 calc(var(--spacing)/8);margin-bottom:calc(var(--spacing)/8);color:#fff;border-radius:4px;pointer-events:auto}._capture_options .record_options[data-v-265b2e52]{max-width:450px;margin:calc(var(--spacing)/4) auto;pointer-events:auto}._capture_options .record_options>*[data-v-265b2e52]{background-color:var(--c-rouge);color:#fff;padding:0 calc(var(--spacing)/4);border-radius:4px;width:auto}._capture_options .record_options input[data-v-265b2e52]{display:inline-block;min-width:2em;max-width:3em;height:1.4em;margin:2px;padding:0 2px;width:auto;text-align:center;color:#fff;background-color:var(--c-rouge_clair);border-bottom:0}._capture_options .record_options input[data-v-265b2e52]:active,._capture_options .record_options input[data-v-265b2e52]:focus{border-bottom-color:var(--c-rouge_fonce)}._capture_options .record_options .record_options--timer[data-v-265b2e52]{font-size:2em}._tiny_equalizer[data-v-265b2e52]{margin:0 calc(var(--spacing)/2)}._tiny_equalizer .m_audioEqualizer[data-v-265b2e52]{position:relative;width:64px;height:36px;background-color:transparent!important;border-radius:4px;overflow:hidden}._onion_skin[data-v-265b2e52]{position:absolute;top:0;left:0;right:0;bottom:0}._onion_skin.is--onionskin[data-v-265b2e52]{opacity:.2;opacity:var(--onionskin-opacity)}._mode_accessory_range[data-v-265b2e52]{max-width:200px;margin:-5px 0 -5px auto}._mode_accessory_range label[data-v-265b2e52]{margin:0}._mode_accessory_range input._rtl[data-v-265b2e52]{direction:rtl}._mode_accessory_range input[data-v-265b2e52]{margin:0}._video_grid_overlay[data-v-265b2e52]{position:absolute;display:block;width:100%;height:100%;display:flex;align-items:center;justify-content:center;pointer-events:none;-o-object-fit:contain;object-fit:contain;--stroke_width:2px}._video_grid_overlay svg[data-v-265b2e52]{position:absolute;width:100%;height:100%;stroke:var(--c-rouge);fill:none}._video_grid_overlay svg line[data-v-265b2e52],._video_grid_overlay svg rect[data-v-265b2e52]{stroke-width:var(--stroke_width)}._enable_timelapse_button[data-v-265b2e52]{color:#fff;background:var(--c-orange);width:24px;height:24px;display:block;min-height:0;line-height:0;border-radius:50%;text-align:center;font-weight:700;padding:0;margin:calc(var(--spacing)/4)}._enable_timelapse_button svg[data-v-265b2e52]{width:100%;height:100%}._enable_timelapse_button.is--active[data-v-265b2e52]{background:var(--c-rouge);color:#fff}._just_captured_overlay[data-v-265b2e52]{background-color:var(--c-rouge);position:absolute;width:100%;height:100%;z-index:100}._download_media_without_validation[data-v-265b2e52]{background-color:var(--c-noir);padding:0 calc(var(--spacing)/2) calc(var(--spacing)/4);margin-bottom:-.2em;line-height:1;text-align:right;text-overflow:ellipsis;white-space:nowrap;overflow:hidden}._download_media_without_validation a[data-v-265b2e52]{color:var(--c-gris)}\", \"\"]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/noSourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \"._onion_skin img{width:100%;height:100%;-o-object-fit:contain;object-fit:contain}\", \"\"]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/noSourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".m_lines{padding:var(--spacing)}.m_lines,.m_lines svg{width:100%;height:100%}.m_lines svg{pointer-events:none}\", \"\"]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/noSourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".m_previewValidation[data-v-0f193272]{position:absolute;top:0;left:0;display:flex;justify-content:center;align-items:center}.m_previewValidation[data-v-0f193272],.m_previewValidation>*[data-v-0f193272]{width:100%;height:100%;-o-object-fit:contain;object-fit:contain}.m_previewValidation>*[data-v-0f193272]{margin:0}.m_previewValidation .m_previewValidation--audio[data-v-0f193272]{height:100%;width:100%;display:flex;flex-flow:column nowrap}.m_previewValidation .m_previewValidation--audio .plyr .plyr__controls[data-v-0f193272]{color:#fff}.m_previewValidation .m_previewValidation--audio img[data-v-0f193272]{-o-object-fit:contain;object-fit:contain}.m_previewValidation .m_previewValidation--audio>*[data-v-0f193272]{flex:1 1 auto;height:90%}.m_previewValidation .m_previewValidation--audio[data-v-0f193272]>:last-child{height:auto}.play_picto[data-v-0f193272]{position:absolute;top:0;left:0}.play_picto svg[data-v-0f193272]{width:50px;height:50px;padding:10px;border-radius:50%}\", \"\"]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/noSourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".m_previewValidation--svg svg{width:100%;height:100%;max-width:100%;margin:auto}\", \"\"]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/noSourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".m_mediaValidationButtons[data-v-485c2ab5]{position:relative;z-index:105;display:flex;justify-content:space-between;align-items:center;padding:calc(var(--spacing)/2);flex:0 0 auto;text-transform:uppercase;font-weight:500;letter-spacing:.06em;font-size:var(--font-verysmall);height:auto;background-color:var(--c-noir)}.m_mediaValidationButtons>*[data-v-485c2ab5]{flex:0 1 180px;display:flex;align-items:center}.m_mediaValidationButtons .m_mediaValidationButtons--overlay[data-v-485c2ab5]{position:absolute;top:0;left:0;right:0;bottom:0;display:flex;justify-content:center;align-items:center;background-color:#353535;--loader-bg-color:transparent;--loader-border-color:var(--c-rouge)}.m_mediaValidationButtons .m_mediaValidationButtons--overlay ._loader[data-v-485c2ab5]{background-color:transparent}.m_mediaValidationButtons .m_mediaValidationButtons--overlay .m_mediaValidationButtons--overlay--percent[data-v-485c2ab5]{position:absolute;margin-left:8em;z-index:55000;color:#fff;padding:2px;border-radius:4px}.m_mediaValidationButtons button svg[data-v-485c2ab5]{width:36px;height:36px}\", \"\"]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/noSourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".m_stopmotionList[data-v-5e50c66c]{position:relative;flex:0 0 250px;max-width:250px;background-color:var(--c-bleumarine);color:var(--c-bleumarine);padding:calc(var(--spacing)/2);padding-top:calc(var(--spacing)*2);padding-bottom:calc(var(--spacing)*2);overflow-y:auto;height:100%;font-size:var(--font-verysmall)}.m_stopmotionList ul[data-v-5e50c66c]{margin:0;padding:0;list-style:none}.m_stopmotionList li[data-v-5e50c66c]{position:relative;border-radius:4px;background-color:#fff;display:block;width:100%;padding:0;margin:calc(var(--spacing)/2) 0;overflow:hidden}.m_stopmotionList li label[data-v-5e50c66c]{color:#000;margin-top:4px}.m_stopmotionList li[data-v-5e50c66c]>:not(._preview){padding:0 calc(var(--spacing)/4)}.m_stopmotionList li>._preview[data-v-5e50c66c]{position:relative}.m_stopmotionList li .pictures_list[data-v-5e50c66c]{display:flex;flex-flow:row wrap;background-color:var(--c-bleumarine)}.m_stopmotionList li .pictures_list>*[data-v-5e50c66c]{flex:0 0 50px;padding-bottom:calc(var(--spacing)/8)}.m_stopmotionList li .pictures_list[data-v-5e50c66c]>:last-child{padding-right:calc(var(--spacing)/8)}.m_stopmotionList li .pictures_list>* img[data-v-5e50c66c]{max-width:100%;width:auto;height:auto}.m_stopmotionList li[data-v-5e50c66c]:first-child{margin-top:0}._options[data-v-5e50c66c]{display:flex;flex-flow:row wrap;justify-content:center;background-color:var(--c-bleumarine_clair)}\", \"\"]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/noSourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \"._preview .mediaContainer img{max-height:140px;-o-object-fit:contain;object-fit:contain}\", \"\"]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/noSourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".m_vecto{-o-object-fit:scale-down;object-fit:scale-down}.m_vecto,.m_vecto svg{width:100%;height:100%}\", \"\"]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","/*\n\timagetracer.js version 1.2.6\n\tSimple raster image tracer and vectorizer written in JavaScript.\n\tandras@jankovics.net\n*/\n\n/*\n\nThe Unlicense / PUBLIC DOMAIN\n\nThis is free and unencumbered software released into the public domain.\n\nAnyone is free to copy, modify, publish, use, compile, sell, or\ndistribute this software, either in source code form or as a compiled\nbinary, for any purpose, commercial or non-commercial, and by any\nmeans.\n\nIn jurisdictions that recognize copyright laws, the author or authors\nof this software dedicate any and all copyright interest in the\nsoftware to the public domain. We make this dedication for the benefit\nof the public at large and to the detriment of our heirs and\nsuccessors. We intend this dedication to be an overt act of\nrelinquishment in perpetuity of all present and future rights to this\nsoftware under copyright law.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND,\nEXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\nMERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.\nIN NO EVENT SHALL THE AUTHORS BE LIABLE FOR ANY CLAIM, DAMAGES OR\nOTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE,\nARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR\nOTHER DEALINGS IN THE SOFTWARE.\n\nFor more information, please refer to http://unlicense.org/\n\n*/\n\n(function(){ 'use strict';\n\nfunction ImageTracer(){\n\tvar _this = this;\n\n\tthis.versionnumber = '1.2.6',\n\t\n\t////////////////////////////////////////////////////////////\n\t//\n\t//  API\n\t//\n\t////////////////////////////////////////////////////////////\n\t\n\t// Loading an image from a URL, tracing when loaded,\n\t// then executing callback with the scaled svg string as argument\n\tthis.imageToSVG = function( url, callback, options ){\n\t\toptions = _this.checkoptions(options);\n\t\t// loading image, tracing and callback\n\t\t_this.loadImage(\n\t\t\turl,\n\t\t\tfunction(canvas){\n\t\t\t\tcallback(\n\t\t\t\t\t_this.imagedataToSVG( _this.getImgdata(canvas), options )\n\t\t\t\t);\n\t\t\t},\n\t\t\toptions\n\t\t);\n\t},// End of imageToSVG()\n\t\n\t// Tracing imagedata, then returning the scaled svg string\n\tthis.imagedataToSVG = function( imgd, options ){\n\t\toptions = _this.checkoptions(options);\n\t\t// tracing imagedata\n\t\tvar td = _this.imagedataToTracedata( imgd, options );\n\t\t// returning SVG string\n\t\treturn _this.getsvgstring(td, options);\n\t},// End of imagedataToSVG()\n\t\n\t// Loading an image from a URL, tracing when loaded,\n\t// then executing callback with tracedata as argument\n\tthis.imageToTracedata = function( url, callback, options ){\n\t\toptions = _this.checkoptions(options);\n\t\t// loading image, tracing and callback\n\t\t_this.loadImage(\n\t\t\t\turl,\n\t\t\t\tfunction(canvas){\n\t\t\t\t\tcallback(\n\t\t\t\t\t\t_this.imagedataToTracedata( _this.getImgdata(canvas), options )\n\t\t\t\t\t);\n\t\t\t\t},\n\t\t\t\toptions\n\t\t);\n\t},// End of imageToTracedata()\n\t\n\t// Tracing imagedata, then returning tracedata (layers with paths, palette, image size)\n\tthis.imagedataToTracedata = function( imgd, options ){\n\t\toptions = _this.checkoptions(options);\n\t\t\n\t\t// 1. Color quantization\n\t\tvar ii = _this.colorquantization( imgd, options );\n\t\t\n\t\tif(options.layering === 0){// Sequential layering\n\t\t\t\n\t\t\t// create tracedata object\n\t\t\tvar tracedata = {\n\t\t\t\tlayers : [],\n\t\t\t\tpalette : ii.palette,\n\t\t\t\twidth : ii.array[0].length-2,\n\t\t\t\theight : ii.array.length-2\n\t\t\t};\n\t\t\t\n\t\t\t// Loop to trace each color layer\n\t\t\tfor(var colornum=0; colornum<ii.palette.length; colornum++){\n\t\t\t\t\n\t\t\t\t// layeringstep -> pathscan -> internodes -> batchtracepaths\n\t\t\t\tvar tracedlayer =\n\t\t\t\t\t_this.batchtracepaths(\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t_this.internodes(\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t_this.pathscan(\n\t\t\t\t\t\t\t\t_this.layeringstep( ii, colornum ),\n\t\t\t\t\t\t\t\toptions.pathomit\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\toptions\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t),\n\t\t\t\t\t\t\n\t\t\t\t\t\toptions.ltres,\n\t\t\t\t\t\toptions.qtres\n\t\t\t\t\t\t\n\t\t\t\t\t);\n\t\t\t\t\n\t\t\t\t// adding traced layer\n\t\t\t\ttracedata.layers.push(tracedlayer);\n\t\t\t\t\n\t\t\t}// End of color loop\n\t\t\t\n\t\t}else{// Parallel layering\n\t\t\t// 2. Layer separation and edge detection\n\t\t\tvar ls = _this.layering( ii );\n\t\t\t\n\t\t\t// Optional edge node visualization\n\t\t\tif(options.layercontainerid){ _this.drawLayers( ls, _this.specpalette, options.scale, options.layercontainerid ); }\n\t\t\t\n\t\t\t// 3. Batch pathscan\n\t\t\tvar bps = _this.batchpathscan( ls, options.pathomit );\n\t\t\t\n\t\t\t// 4. Batch interpollation\n\t\t\tvar bis = _this.batchinternodes( bps, options );\n\t\t\t\n\t\t\t// 5. Batch tracing and creating tracedata object\n\t\t\tvar tracedata = {\n\t\t\t\tlayers : _this.batchtracelayers( bis, options.ltres, options.qtres ),\n\t\t\t\tpalette : ii.palette,\n\t\t\t\twidth : imgd.width,\n\t\t\t\theight : imgd.height\n\t\t\t};\n\t\t\t\n\t\t}// End of parallel layering\n\t\t\n\t\t// return tracedata\n\t\treturn tracedata;\n\t\t\n\t},// End of imagedataToTracedata()\n\t\n\tthis.optionpresets = {\n\t\t'default': {\n\t\t\t\n\t\t\t// Tracing\n\t\t\tcorsenabled : false,\n\t\t\tltres : 1,\n\t\t\tqtres : 1,\n\t\t\tpathomit : 8,\n\t\t\trightangleenhance : true,\n\t\t\t\n\t\t\t// Color quantization\n\t\t\tcolorsampling : 2,\n\t\t\tnumberofcolors : 16,\n\t\t\tmincolorratio : 0,\n\t\t\tcolorquantcycles : 3,\n\t\t\t\n\t\t\t// Layering method\n\t\t\tlayering : 0,\n\t\t\t\n\t\t\t// SVG rendering\n\t\t\tstrokewidth : 1,\n\t\t\tlinefilter : false,\n\t\t\tscale : 1,\n\t\t\troundcoords : 1,\n\t\t\tviewbox : false,\n\t\t\tdesc : false,\n\t\t\tlcpr : 0,\n\t\t\tqcpr : 0,\n\t\t\t\n\t\t\t// Blur\n\t\t\tblurradius : 0,\n\t\t\tblurdelta : 20\n\t\t\t\n\t\t},\n\t\t'posterized1': { colorsampling:0, numberofcolors:2 },\n\t\t'posterized2': { numberofcolors:4, blurradius:5 },\n\t\t'curvy': { ltres:0.01, linefilter:true, rightangleenhance:false },\n\t\t'sharp': { qtres:0.01, linefilter:false },\n\t\t'detailed': { pathomit:0, roundcoords:2, ltres:0.5, qtres:0.5, numberofcolors:64 },\n\t\t'smoothed': { blurradius:5, blurdelta: 64 },\n\t\t'grayscale': { colorsampling:0, colorquantcycles:1, numberofcolors:7 },\n\t\t'fixedpalette': { colorsampling:0, colorquantcycles:1, numberofcolors:27 },\n\t\t'randomsampling1': { colorsampling:1, numberofcolors:8 },\n\t\t'randomsampling2': { colorsampling:1, numberofcolors:64 },\n\t\t'artistic1': { colorsampling:0, colorquantcycles:1, pathomit:0, blurradius:5, blurdelta: 64, ltres:0.01, linefilter:true, numberofcolors:16, strokewidth:2 },\n\t\t'artistic2': { qtres:0.01, colorsampling:0, colorquantcycles:1, numberofcolors:4, strokewidth:0 },\n\t\t'artistic3': { qtres:10, ltres:10, numberofcolors:8 },\n\t\t'artistic4': { qtres:10, ltres:10, numberofcolors:64, blurradius:5, blurdelta: 256, strokewidth:2 },\n\t\t'posterized3': { ltres: 1, qtres: 1, pathomit: 20, rightangleenhance: true, colorsampling: 0, numberofcolors: 3,\n\t\t\tmincolorratio: 0, colorquantcycles: 3, blurradius: 3, blurdelta: 20, strokewidth: 0, linefilter: false,\n\t\t\troundcoords: 1, pal: [ { r: 0, g: 0, b: 100, a: 255 }, { r: 255, g: 255, b: 255, a: 255 } ] }\n\t},// End of optionpresets\n\t\n\t// creating options object, setting defaults for missing values\n\tthis.checkoptions = function(options){\n\t\toptions = options || {};\n\t\t// Option preset\n\t\tif(typeof options === 'string'){\n\t\t\toptions = options.toLowerCase();\n\t\t\tif( _this.optionpresets[options] ){ options = _this.optionpresets[options]; }else{ options = {}; }\n\t\t}\n\t\t// Defaults\n\t\tvar ok = Object.keys(_this.optionpresets['default']);\n\t\tfor(var k=0; k<ok.length; k++){\n\t\t\tif(!options.hasOwnProperty(ok[k])){ options[ok[k]] = _this.optionpresets['default'][ok[k]]; }\n\t\t}\n\t\t// options.pal is not defined here, the custom palette should be added externally: options.pal = [ { 'r':0, 'g':0, 'b':0, 'a':255 }, {...}, ... ];\n\t\t// options.layercontainerid is not defined here, can be added externally: options.layercontainerid = 'mydiv'; ... <div id=\"mydiv\"></div>\n\t\treturn options;\n\t},// End of checkoptions()\n\t\n\t////////////////////////////////////////////////////////////\n\t//\n\t//  Vectorizing functions\n\t//\n\t////////////////////////////////////////////////////////////\n\t\n\t// 1. Color quantization\n\t// Using a form of k-means clustering repeatead options.colorquantcycles times. http://en.wikipedia.org/wiki/Color_quantization\n\tthis.colorquantization = function( imgd, options ){\n\t\tvar arr = [], idx=0, cd,cdl,ci, paletteacc = [], pixelnum = imgd.width * imgd.height, i, j, k, cnt, palette;\n\t\t\n\t\t// imgd.data must be RGBA, not just RGB\n\t\tif( imgd.data.length < pixelnum * 4 ){\n\t\t\tvar newimgddata = new Uint8ClampedArray(pixelnum * 4);\n\t\t\tfor(var pxcnt = 0; pxcnt < pixelnum ; pxcnt++){\n\t\t\t\tnewimgddata[pxcnt*4  ] = imgd.data[pxcnt*3  ];\n\t\t\t\tnewimgddata[pxcnt*4+1] = imgd.data[pxcnt*3+1];\n\t\t\t\tnewimgddata[pxcnt*4+2] = imgd.data[pxcnt*3+2];\n\t\t\t\tnewimgddata[pxcnt*4+3] = 255;\n\t\t\t}\n\t\t\timgd.data = newimgddata;\n\t\t}// End of RGBA imgd.data check\n\t\t\n\t\t// Filling arr (color index array) with -1\n\t\tfor( j=0; j<imgd.height+2; j++ ){ arr[j]=[]; for(i=0; i<imgd.width+2 ; i++){ arr[j][i] = -1; } }\n\t\t\n\t\t// Use custom palette if pal is defined or sample / generate custom length palette\n\t\tif(options.pal){\n\t\t\tpalette = options.pal;\n\t\t}else if(options.colorsampling === 0){\n\t\t\tpalette = _this.generatepalette(options.numberofcolors);\n\t\t}else if(options.colorsampling === 1){\n\t\t\tpalette = _this.samplepalette( options.numberofcolors, imgd );\n\t\t}else{\n\t\t\tpalette = _this.samplepalette2( options.numberofcolors, imgd );\n\t\t}\n\t\t\n\t\t// Selective Gaussian blur preprocessing\n\t\tif( options.blurradius > 0 ){ imgd = _this.blur( imgd, options.blurradius, options.blurdelta ); }\n\t\t\n\t\t// Repeat clustering step options.colorquantcycles times\n\t\tfor( cnt=0; cnt < options.colorquantcycles; cnt++ ){\n\t\t\t\n\t\t\t// Average colors from the second iteration\n\t\t\tif(cnt>0){\n\t\t\t\t// averaging paletteacc for palette\n\t\t\t\tfor( k=0; k < palette.length; k++ ){\n\t\t\t\t\t\n\t\t\t\t\t// averaging\n\t\t\t\t\tif( paletteacc[k].n > 0 ){\n\t\t\t\t\t\tpalette[k] = {  r: Math.floor( paletteacc[k].r / paletteacc[k].n ),\n\t\t\t\t\t\t\t\t\t\tg: Math.floor( paletteacc[k].g / paletteacc[k].n ),\n\t\t\t\t\t\t\t\t\t\tb: Math.floor( paletteacc[k].b / paletteacc[k].n ),\n\t\t\t\t\t\t\t\t\t\ta:  Math.floor( paletteacc[k].a / paletteacc[k].n ) };\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t// Randomizing a color, if there are too few pixels and there will be a new cycle\n\t\t\t\t\tif( ( paletteacc[k].n/pixelnum < options.mincolorratio ) && ( cnt < options.colorquantcycles-1 ) ){\n\t\t\t\t\t\tpalette[k] = {  r: Math.floor(Math.random()*255),\n\t\t\t\t\t\t\t\t\t\tg: Math.floor(Math.random()*255),\n\t\t\t\t\t\t\t\t\t\tb: Math.floor(Math.random()*255),\n\t\t\t\t\t\t\t\t\t\ta: Math.floor(Math.random()*255) };\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t}// End of palette loop\n\t\t\t}// End of Average colors from the second iteration\n\t\t\t\n\t\t\t// Reseting palette accumulator for averaging\n\t\t\tfor( i=0; i < palette.length; i++ ){ paletteacc[i] = { r:0, g:0, b:0, a:0, n:0 }; }\n\t\t\t\n\t\t\t// loop through all pixels\n\t\t\tfor( j=0; j < imgd.height; j++ ){\n\t\t\t\tfor( i=0; i < imgd.width; i++ ){\n\t\t\t\t\t\n\t\t\t\t\t// pixel index\n\t\t\t\t\tidx = (j*imgd.width+i)*4;\n\t\t\t\t\t\n\t\t\t\t\t// find closest color from palette by measuring (rectilinear) color distance between this pixel and all palette colors\n\t\t\t\t\tci=0; cdl = 1024; // 4 * 256 is the maximum RGBA distance\n\t\t\t\t\tfor( k=0; k<palette.length; k++ ){\n\t\t\t\t\t\t\n\t\t\t\t\t\t// In my experience, https://en.wikipedia.org/wiki/Rectilinear_distance works better than https://en.wikipedia.org/wiki/Euclidean_distance\n\t\t\t\t\t\tcd = Math.abs(palette[k].r-imgd.data[idx]) + Math.abs(palette[k].g-imgd.data[idx+1]) + Math.abs(palette[k].b-imgd.data[idx+2]) + Math.abs(palette[k].a-imgd.data[idx+3]);\n\t\t\t\t\t\t\n\t\t\t\t\t\t// Remember this color if this is the closest yet\n\t\t\t\t\t\tif(cd<cdl){ cdl = cd; ci = k; }\n\t\t\t\t\t\t\n\t\t\t\t\t}// End of palette loop\n\t\t\t\t\t\n\t\t\t\t\t// add to palettacc\n\t\t\t\t\tpaletteacc[ci].r += imgd.data[idx  ];\n\t\t\t\t\tpaletteacc[ci].g += imgd.data[idx+1];\n\t\t\t\t\tpaletteacc[ci].b += imgd.data[idx+2];\n\t\t\t\t\tpaletteacc[ci].a += imgd.data[idx+3];\n\t\t\t\t\tpaletteacc[ci].n++;\n\t\t\t\t\t\n\t\t\t\t\t// update the indexed color array\n\t\t\t\t\tarr[j+1][i+1] = ci;\n\t\t\t\t\t\n\t\t\t\t}// End of i loop\n\t\t\t}// End of j loop\n\t\t\t\n\t\t}// End of Repeat clustering step options.colorquantcycles times\n\t\t\n\t\treturn { array:arr, palette:palette };\n\t\t\n\t},// End of colorquantization()\n\t\n\t// Sampling a palette from imagedata\n\tthis.samplepalette = function( numberofcolors, imgd ){\n\t\tvar idx, palette=[];\n\t\tfor(var i=0; i<numberofcolors; i++){\n\t\t\tidx = Math.floor( Math.random() * imgd.data.length / 4 ) * 4;\n\t\t\tpalette.push({ r:imgd.data[idx  ], g:imgd.data[idx+1], b:imgd.data[idx+2], a:imgd.data[idx+3] });\n\t\t}\n\t\treturn palette;\n\t},// End of samplepalette()\n\t\n\t// Deterministic sampling a palette from imagedata: rectangular grid\n\tthis.samplepalette2 = function( numberofcolors, imgd ){\n\t\tvar idx, palette=[], ni = Math.ceil(Math.sqrt(numberofcolors)), nj = Math.ceil(numberofcolors/ni),\n\t\t\tvx = imgd.width / (ni+1), vy = imgd.height / (nj+1);\n\t\tfor(var j=0; j<nj; j++){\n\t\t\tfor(var i=0; i<ni; i++){\n\t\t\t\tif(palette.length === numberofcolors){\n\t\t\t\t\tbreak;\n\t\t\t\t}else{\n\t\t\t\t\tidx = Math.floor( ((j+1)*vy) * imgd.width + ((i+1)*vx) ) * 4;\n\t\t\t\t\tpalette.push( { r:imgd.data[idx], g:imgd.data[idx+1], b:imgd.data[idx+2], a:imgd.data[idx+3] } );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn palette;\n\t},// End of samplepalette2()\n\t\n\t// Generating a palette with numberofcolors\n\tthis.generatepalette = function(numberofcolors){\n\t\tvar palette = [], rcnt, gcnt, bcnt;\n\t\tif(numberofcolors<8){\n\t\t\t\n\t\t\t// Grayscale\n\t\t\tvar graystep = Math.floor(255/(numberofcolors-1));\n\t\t\tfor(var i=0; i<numberofcolors; i++){ palette.push({ r:i*graystep, g:i*graystep, b:i*graystep, a:255 }); }\n\t\t\t\n\t\t}else{\n\t\t\t\n\t\t\t// RGB color cube\n\t\t\tvar colorqnum = Math.floor(Math.pow(numberofcolors, 1/3)), // Number of points on each edge on the RGB color cube\n\t\t\t\tcolorstep = Math.floor(255/(colorqnum-1)), // distance between points\n\t\t\t\trndnum = numberofcolors - colorqnum*colorqnum*colorqnum; // number of random colors\n\t\t\t\n\t\t\tfor(rcnt=0; rcnt<colorqnum; rcnt++){\n\t\t\t\tfor(gcnt=0; gcnt<colorqnum; gcnt++){\n\t\t\t\t\tfor(bcnt=0; bcnt<colorqnum; bcnt++){\n\t\t\t\t\t\tpalette.push( { r:rcnt*colorstep, g:gcnt*colorstep, b:bcnt*colorstep, a:255 } );\n\t\t\t\t\t}// End of blue loop\n\t\t\t\t}// End of green loop\n\t\t\t}// End of red loop\n\t\t\t\n\t\t\t// Rest is random\n\t\t\tfor(rcnt=0; rcnt<rndnum; rcnt++){ palette.push({ r:Math.floor(Math.random()*255), g:Math.floor(Math.random()*255), b:Math.floor(Math.random()*255), a:Math.floor(Math.random()*255) }); }\n\n\t\t}// End of numberofcolors check\n\t\t\n\t\treturn palette;\n\t},// End of generatepalette()\n\t\t\n\t// 2. Layer separation and edge detection\n\t// Edge node types ( : this layer or 1; : not this layer or 0 )\n\t// 12                                \n\t// 48                                \n\t//     0   1   2   3   4   5   6   7   8   9   10  11  12  13  14  15\n\tthis.layering = function(ii){\n\t\t// Creating layers for each indexed color in arr\n\t\tvar layers = [], val=0, ah = ii.array.length, aw = ii.array[0].length, n1,n2,n3,n4,n5,n6,n7,n8, i, j, k;\n\t\t\n\t\t// Create layers\n\t\tfor(k=0; k<ii.palette.length; k++){\n\t\t\tlayers[k] = [];\n\t\t\tfor(j=0; j<ah; j++){\n\t\t\t\tlayers[k][j] = [];\n\t\t\t\tfor(i=0; i<aw; i++){\n\t\t\t\t\tlayers[k][j][i]=0;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\t// Looping through all pixels and calculating edge node type\n\t\tfor(j=1; j<ah-1; j++){\n\t\t\tfor(i=1; i<aw-1; i++){\n\t\t\t\t\n\t\t\t\t// This pixel's indexed color\n\t\t\t\tval = ii.array[j][i];\n\t\t\t\t\n\t\t\t\t// Are neighbor pixel colors the same?\n\t\t\t\tn1 = ii.array[j-1][i-1]===val ? 1 : 0;\n\t\t\t\tn2 = ii.array[j-1][i  ]===val ? 1 : 0;\n\t\t\t\tn3 = ii.array[j-1][i+1]===val ? 1 : 0;\n\t\t\t\tn4 = ii.array[j  ][i-1]===val ? 1 : 0;\n\t\t\t\tn5 = ii.array[j  ][i+1]===val ? 1 : 0;\n\t\t\t\tn6 = ii.array[j+1][i-1]===val ? 1 : 0;\n\t\t\t\tn7 = ii.array[j+1][i  ]===val ? 1 : 0;\n\t\t\t\tn8 = ii.array[j+1][i+1]===val ? 1 : 0;\n\t\t\t\t\n\t\t\t\t// this pixel's type and looking back on previous pixels\n\t\t\t\tlayers[val][j+1][i+1] = 1 + n5 * 2 + n8 * 4 + n7 * 8 ;\n\t\t\t\tif(!n4){ layers[val][j+1][i  ] = 0 + 2 + n7 * 4 + n6 * 8 ; }\n\t\t\t\tif(!n2){ layers[val][j  ][i+1] = 0 + n3*2 + n5 * 4 + 8 ; }\n\t\t\t\tif(!n1){ layers[val][j  ][i  ] = 0 + n2*2 + 4 + n4 * 8 ; }\n\t\t\t\t\n\t\t\t}// End of i loop\n\t\t}// End of j loop\n\t\t\n\t\treturn layers;\n\t},// End of layering()\n\t\n\t// 2. Layer separation and edge detection\n\t// Edge node types ( : this layer or 1; : not this layer or 0 )\n\t// 12                                \n\t// 48                                \n\t//     0   1   2   3   4   5   6   7   8   9   10  11  12  13  14  15\n\tthis.layeringstep = function(ii,cnum){\n\t\t// Creating layers for each indexed color in arr\n\t\tvar layer = [], val=0, ah = ii.array.length, aw = ii.array[0].length, n1,n2,n3,n4,n5,n6,n7,n8, i, j, k;\n\t\t\n\t\t// Create layer\n\t\tfor(j=0; j<ah; j++){\n\t\t\tlayer[j] = [];\n\t\t\tfor(i=0; i<aw; i++){\n\t\t\t\tlayer[j][i]=0;\n\t\t\t}\n\t\t}\n\t\t\n\t\t// Looping through all pixels and calculating edge node type\n\t\tfor(j=1; j<ah; j++){\n\t\t\tfor(i=1; i<aw; i++){\n\t\t\t\tlayer[j][i] =\n\t\t\t\t\t( ii.array[j-1][i-1]===cnum ? 1 : 0 ) +\n\t\t\t\t\t( ii.array[j-1][i]===cnum ? 2 : 0 ) +\n\t\t\t\t\t( ii.array[j][i-1]===cnum ? 8 : 0 ) +\n\t\t\t\t\t( ii.array[j][i]===cnum ? 4 : 0 )\n\t\t\t\t;\n\t\t\t}// End of i loop\n\t\t}// End of j loop\n\t\t\t\n\t\treturn layer;\n\t},// End of layeringstep()\n\t\n\t// Point in polygon test\n\tthis.pointinpoly = function( p, pa ){\n\t\tvar isin=false;\n\n\t\tfor(var i=0,j=pa.length-1; i<pa.length; j=i++){\n\t\t\tisin =\n\t\t\t\t( ((pa[i].y > p.y) !== (pa[j].y > p.y)) && (p.x < (pa[j].x - pa[i].x) * (p.y - pa[i].y) / (pa[j].y - pa[i].y) + pa[i].x) )\n\t\t\t\t? !isin : isin;\n\t\t}\n\n\t\treturn isin;\n\t},\n\t\n\t// Lookup tables for pathscan\n\t// pathscan_combined_lookup[ arr[py][px] ][ dir ] = [nextarrpypx, nextdir, deltapx, deltapy];\n\tthis.pathscan_combined_lookup = [\n\t\t[[-1,-1,-1,-1], [-1,-1,-1,-1], [-1,-1,-1,-1], [-1,-1,-1,-1]],// arr[py][px]===0 is invalid\n\t\t[[ 0, 1, 0,-1], [-1,-1,-1,-1], [-1,-1,-1,-1], [ 0, 2,-1, 0]],\n\t\t[[-1,-1,-1,-1], [-1,-1,-1,-1], [ 0, 1, 0,-1], [ 0, 0, 1, 0]],\n\t\t[[ 0, 0, 1, 0], [-1,-1,-1,-1], [ 0, 2,-1, 0], [-1,-1,-1,-1]],\n\t\t\n\t\t[[-1,-1,-1,-1], [ 0, 0, 1, 0], [ 0, 3, 0, 1], [-1,-1,-1,-1]],\n\t\t[[13, 3, 0, 1], [13, 2,-1, 0], [ 7, 1, 0,-1], [ 7, 0, 1, 0]],\n\t\t[[-1,-1,-1,-1], [ 0, 1, 0,-1], [-1,-1,-1,-1], [ 0, 3, 0, 1]],\n\t\t[[ 0, 3, 0, 1], [ 0, 2,-1, 0], [-1,-1,-1,-1], [-1,-1,-1,-1]],\n\t\t\n\t\t[[ 0, 3, 0, 1], [ 0, 2,-1, 0], [-1,-1,-1,-1], [-1,-1,-1,-1]],\n\t\t[[-1,-1,-1,-1], [ 0, 1, 0,-1], [-1,-1,-1,-1], [ 0, 3, 0, 1]],\n\t\t[[11, 1, 0,-1], [14, 0, 1, 0], [14, 3, 0, 1], [11, 2,-1, 0]],\n\t\t[[-1,-1,-1,-1], [ 0, 0, 1, 0], [ 0, 3, 0, 1], [-1,-1,-1,-1]],\n\t\t\n\t\t[[ 0, 0, 1, 0], [-1,-1,-1,-1], [ 0, 2,-1, 0], [-1,-1,-1,-1]],\n\t\t[[-1,-1,-1,-1], [-1,-1,-1,-1], [ 0, 1, 0,-1], [ 0, 0, 1, 0]],\n\t\t[[ 0, 1, 0,-1], [-1,-1,-1,-1], [-1,-1,-1,-1], [ 0, 2,-1, 0]],\n\t\t[[-1,-1,-1,-1], [-1,-1,-1,-1], [-1,-1,-1,-1], [-1,-1,-1,-1]]// arr[py][px]===15 is invalid\n\t],\n\n\t// 3. Walking through an edge node array, discarding edge node types 0 and 15 and creating paths from the rest.\n\t// Walk directions (dir): 0 > ; 1 ^ ; 2 < ; 3 v \n\tthis.pathscan = function( arr, pathomit ){\n\t\tvar paths=[], pacnt=0, pcnt=0, px=0, py=0, w = arr[0].length, h = arr.length,\n\t\t\tdir=0, pathfinished=true, holepath=false, lookuprow;\n\t\t\n\t\tfor(var j=0; j<h; j++){\n\t\t\tfor(var i=0; i<w; i++){\n\t\t\t\tif( (arr[j][i] == 4) || ( arr[j][i] == 11) ){ // Other values are not valid\n\t\t\t\t\t\n\t\t\t\t\t// Init\n\t\t\t\t\tpx = i; py = j;\n\t\t\t\t\tpaths[pacnt] = {};\n\t\t\t\t\tpaths[pacnt].points = [];\n\t\t\t\t\tpaths[pacnt].boundingbox = [px,py,px,py];\n\t\t\t\t\tpaths[pacnt].holechildren = [];\n\t\t\t\t\tpathfinished = false;\n\t\t\t\t\tpcnt=0;\n\t\t\t\t\tholepath = (arr[j][i]==11);\n\t\t\t\t\tdir = 1;\n\n\t\t\t\t\t// Path points loop\n\t\t\t\t\twhile(!pathfinished){\n\t\t\t\t\t\t\n\t\t\t\t\t\t// New path point\n\t\t\t\t\t\tpaths[pacnt].points[pcnt] = {};\n\t\t\t\t\t\tpaths[pacnt].points[pcnt].x = px-1;\n\t\t\t\t\t\tpaths[pacnt].points[pcnt].y = py-1;\n\t\t\t\t\t\tpaths[pacnt].points[pcnt].t = arr[py][px];\n\t\t\t\t\t\t\n\t\t\t\t\t\t// Bounding box\n\t\t\t\t\t\tif( (px-1) < paths[pacnt].boundingbox[0] ){ paths[pacnt].boundingbox[0] = px-1; }\n\t\t\t\t\t\tif( (px-1) > paths[pacnt].boundingbox[2] ){ paths[pacnt].boundingbox[2] = px-1; }\n\t\t\t\t\t\tif( (py-1) < paths[pacnt].boundingbox[1] ){ paths[pacnt].boundingbox[1] = py-1; }\n\t\t\t\t\t\tif( (py-1) > paths[pacnt].boundingbox[3] ){ paths[pacnt].boundingbox[3] = py-1; }\n\t\t\t\t\t\t\n\t\t\t\t\t\t// Next: look up the replacement, direction and coordinate changes = clear this cell, turn if required, walk forward\n\t\t\t\t\t\tlookuprow = _this.pathscan_combined_lookup[ arr[py][px] ][ dir ];\n\t\t\t\t\t\tarr[py][px] = lookuprow[0]; dir = lookuprow[1]; px += lookuprow[2]; py += lookuprow[3];\n\n\t\t\t\t\t\t// Close path\n\t\t\t\t\t\tif( (px-1 === paths[pacnt].points[0].x ) && ( py-1 === paths[pacnt].points[0].y ) ){\n\t\t\t\t\t\t\tpathfinished = true;\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t// Discarding paths shorter than pathomit\n\t\t\t\t\t\t\tif( paths[pacnt].points.length < pathomit ){\n\t\t\t\t\t\t\t\tpaths.pop();\n\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tpaths[pacnt].isholepath = holepath ? true : false;\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t// Finding the parent shape for this hole\n\t\t\t\t\t\t\t\tif(holepath){\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\tvar parentidx = 0, parentbbox = [-1,-1,w+1,h+1];\n\t\t\t\t\t\t\t\t\tfor(var parentcnt=0; parentcnt < pacnt; parentcnt++){\n\t\t\t\t\t\t\t\t\t\tif( (!paths[parentcnt].isholepath) &&\n\t\t\t\t\t\t\t\t\t\t\t_this.boundingboxincludes( paths[parentcnt].boundingbox , paths[pacnt].boundingbox ) &&\n\t\t\t\t\t\t\t\t\t\t\t_this.boundingboxincludes( parentbbox , paths[parentcnt].boundingbox ) &&\n\t\t\t\t\t\t\t\t\t\t\t_this.pointinpoly( paths[pacnt].points[0], paths[parentcnt].points )\n\t\t\t\t\t\t\t\t\t\t){\n\t\t\t\t\t\t\t\t\t\t\tparentidx = parentcnt;\n\t\t\t\t\t\t\t\t\t\t\tparentbbox = paths[parentcnt].boundingbox;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\tpaths[parentidx].holechildren.push( pacnt );\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t}// End of holepath parent finding\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tpacnt++;\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t}// End of Close path\n\t\t\t\t\t\t\n\t\t\t\t\t\tpcnt++;\n\t\t\t\t\t\t\n\t\t\t\t\t}// End of Path points loop\n\t\t\t\t\t\n\t\t\t\t}// End of Follow path\n\t\t\t\t\n\t\t\t}// End of i loop\n\t\t}// End of j loop\n\t\t\n\t\treturn paths;\n\t},// End of pathscan()\n\t\n\tthis.boundingboxincludes = function( parentbbox, childbbox ){\n\t\treturn ( ( parentbbox[0] < childbbox[0] ) && ( parentbbox[1] < childbbox[1] ) && ( parentbbox[2] > childbbox[2] ) && ( parentbbox[3] > childbbox[3] ) );\n\t},// End of boundingboxincludes()\n\t\n\t// 3. Batch pathscan\n\tthis.batchpathscan = function( layers, pathomit ){\n\t\tvar bpaths = [];\n\t\tfor(var k in layers){\n\t\t\tif(!layers.hasOwnProperty(k)){ continue; }\n\t\t\tbpaths[k] = _this.pathscan( layers[k], pathomit );\n\t\t}\n\t\treturn bpaths;\n\t},\n\t\n\t// 4. interpollating between path points for nodes with 8 directions ( East, SouthEast, S, SW, W, NW, N, NE )\n\tthis.internodes = function( paths, options ){\n\t\tvar ins = [], palen=0, nextidx=0, nextidx2=0, previdx=0, previdx2=0, pacnt, pcnt;\n\t\t\n\t\t// paths loop\n\t\tfor(pacnt=0; pacnt<paths.length; pacnt++){\n\t\t\t\n\t\t\tins[pacnt] = {};\n\t\t\tins[pacnt].points = [];\n\t\t\tins[pacnt].boundingbox = paths[pacnt].boundingbox;\n\t\t\tins[pacnt].holechildren = paths[pacnt].holechildren;\n\t\t\tins[pacnt].isholepath = paths[pacnt].isholepath;\n\t\t\tpalen = paths[pacnt].points.length;\n\t\t\t\n\t\t\t// pathpoints loop\n\t\t\tfor(pcnt=0; pcnt<palen; pcnt++){\n\t\t\t\n\t\t\t\t// next and previous point indexes\n\t\t\t\tnextidx = (pcnt+1)%palen; nextidx2 = (pcnt+2)%palen; previdx = (pcnt-1+palen)%palen; previdx2 = (pcnt-2+palen)%palen;\n\t\t\t\t\n\t\t\t\t// right angle enhance\n\t\t\t\tif( options.rightangleenhance && _this.testrightangle( paths[pacnt], previdx2, previdx, pcnt, nextidx, nextidx2 ) ){\n\t\t\t\t\t\n\t\t\t\t\t// Fix previous direction\n\t\t\t\t\tif(ins[pacnt].points.length > 0){\n\t\t\t\t\t\tins[pacnt].points[ ins[pacnt].points.length-1 ].linesegment = _this.getdirection(\n\t\t\t\t\t\t\t\tins[pacnt].points[ ins[pacnt].points.length-1 ].x,\n\t\t\t\t\t\t\t\tins[pacnt].points[ ins[pacnt].points.length-1 ].y,\n\t\t\t\t\t\t\t\tpaths[pacnt].points[pcnt].x,\n\t\t\t\t\t\t\t\tpaths[pacnt].points[pcnt].y\n\t\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t// This corner point\n\t\t\t\t\tins[pacnt].points.push({\n\t\t\t\t\t\tx : paths[pacnt].points[pcnt].x,\n\t\t\t\t\t\ty : paths[pacnt].points[pcnt].y,\n\t\t\t\t\t\tlinesegment : _this.getdirection(\n\t\t\t\t\t\t\t\tpaths[pacnt].points[pcnt].x,\n\t\t\t\t\t\t\t\tpaths[pacnt].points[pcnt].y,\n\t\t\t\t\t\t\t\t(( paths[pacnt].points[pcnt].x + paths[pacnt].points[nextidx].x ) /2),\n\t\t\t\t\t\t\t\t(( paths[pacnt].points[pcnt].y + paths[pacnt].points[nextidx].y ) /2)\n\t\t\t\t\t\t\t)\n\t\t\t\t\t});\n\t\t\t\t\t\n\t\t\t\t}// End of right angle enhance\n\t\t\t\t\n\t\t\t\t// interpolate between two path points\n\t\t\t\tins[pacnt].points.push({\n\t\t\t\t\tx : (( paths[pacnt].points[pcnt].x + paths[pacnt].points[nextidx].x ) /2),\n\t\t\t\t\ty : (( paths[pacnt].points[pcnt].y + paths[pacnt].points[nextidx].y ) /2),\n\t\t\t\t\tlinesegment : _this.getdirection(\n\t\t\t\t\t\t\t(( paths[pacnt].points[pcnt].x + paths[pacnt].points[nextidx].x ) /2),\n\t\t\t\t\t\t\t(( paths[pacnt].points[pcnt].y + paths[pacnt].points[nextidx].y ) /2),\n\t\t\t\t\t\t\t(( paths[pacnt].points[nextidx].x + paths[pacnt].points[nextidx2].x ) /2),\n\t\t\t\t\t\t\t(( paths[pacnt].points[nextidx].y + paths[pacnt].points[nextidx2].y ) /2)\n\t\t\t\t\t\t)\n\t\t\t\t});\n\t\t\t\t\n\t\t\t}// End of pathpoints loop\n\t\t\t\t\t\t\n\t\t}// End of paths loop\n\t\t\n\t\treturn ins;\n\t},// End of internodes()\n\t\n\tthis.testrightangle = function( path, idx1, idx2, idx3, idx4, idx5 ){\n\t\treturn ( (( path.points[idx3].x === path.points[idx1].x) &&\n\t\t\t\t  ( path.points[idx3].x === path.points[idx2].x) &&\n\t\t\t\t  ( path.points[idx3].y === path.points[idx4].y) &&\n\t\t\t\t  ( path.points[idx3].y === path.points[idx5].y)\n\t\t\t\t ) ||\n\t\t\t\t (( path.points[idx3].y === path.points[idx1].y) &&\n\t\t\t\t  ( path.points[idx3].y === path.points[idx2].y) &&\n\t\t\t\t  ( path.points[idx3].x === path.points[idx4].x) &&\n\t\t\t\t  ( path.points[idx3].x === path.points[idx5].x)\n\t\t\t\t )\n\t\t);\n\t},// End of testrightangle()\n\t\n\tthis.getdirection = function( x1, y1, x2, y2 ){\n\t\tvar val = 8;\n\t\tif(x1 < x2){\n\t\t\tif     (y1 < y2){ val = 1; }// SouthEast\n\t\t\telse if(y1 > y2){ val = 7; }// NE\n\t\t\telse            { val = 0; }// E\n\t\t}else if(x1 > x2){\n\t\t\tif     (y1 < y2){ val = 3; }// SW\n\t\t\telse if(y1 > y2){ val = 5; }// NW\n\t\t\telse            { val = 4; }// W\n\t\t}else{\n\t\t\tif     (y1 < y2){ val = 2; }// S\n\t\t\telse if(y1 > y2){ val = 6; }// N\n\t\t\telse            { val = 8; }// center, this should not happen\n\t\t}\n\t\treturn val;\n\t},// End of getdirection()\n\t\n\t// 4. Batch interpollation\n\tthis.batchinternodes = function( bpaths, options ){\n\t\tvar binternodes = [];\n\t\tfor (var k in bpaths) {\n\t\t\tif(!bpaths.hasOwnProperty(k)){ continue; }\n\t\t\tbinternodes[k] = _this.internodes(bpaths[k], options);\n\t\t}\n\t\treturn binternodes;\n\t},\n\t\n\t// 5. tracepath() : recursively trying to fit straight and quadratic spline segments on the 8 direction internode path\n\t\n\t// 5.1. Find sequences of points with only 2 segment types\n\t// 5.2. Fit a straight line on the sequence\n\t// 5.3. If the straight line fails (distance error > ltres), find the point with the biggest error\n\t// 5.4. Fit a quadratic spline through errorpoint (project this to get controlpoint), then measure errors on every point in the sequence\n\t// 5.5. If the spline fails (distance error > qtres), find the point with the biggest error, set splitpoint = fitting point\n\t// 5.6. Split sequence and recursively apply 5.2. - 5.6. to startpoint-splitpoint and splitpoint-endpoint sequences\n\t\n\tthis.tracepath = function( path, ltres, qtres ){\n\t\tvar pcnt=0, segtype1, segtype2, seqend, smp = {};\n\t\tsmp.segments = [];\n\t\tsmp.boundingbox = path.boundingbox;\n\t\tsmp.holechildren = path.holechildren;\n\t\tsmp.isholepath = path.isholepath;\n\t\t\n\t\twhile(pcnt < path.points.length){\n\t\t\t// 5.1. Find sequences of points with only 2 segment types\n\t\t\tsegtype1 = path.points[pcnt].linesegment; segtype2 = -1; seqend=pcnt+1;\n\t\t\twhile(\n\t\t\t\t((path.points[seqend].linesegment === segtype1) || (path.points[seqend].linesegment === segtype2) || (segtype2 === -1))\n\t\t\t\t&& (seqend < path.points.length-1) ){\n\t\t\t\t\n\t\t\t\tif((path.points[seqend].linesegment!==segtype1) && (segtype2===-1)){ segtype2 = path.points[seqend].linesegment; }\n\t\t\t\tseqend++;\n\t\t\t\t\n\t\t\t}\n\t\t\tif(seqend === path.points.length-1){ seqend = 0; }\n\n\t\t\t// 5.2. - 5.6. Split sequence and recursively apply 5.2. - 5.6. to startpoint-splitpoint and splitpoint-endpoint sequences\n\t\t\tsmp.segments = smp.segments.concat( _this.fitseq(path, ltres, qtres, pcnt, seqend) );\n\t\t\t\n\t\t\t// forward pcnt;\n\t\t\tif(seqend>0){ pcnt = seqend; }else{ pcnt = path.points.length; }\n\t\t\t\n\t\t}// End of pcnt loop\n\t\t\n\t\treturn smp;\n\t},// End of tracepath()\n\t\t\n\t// 5.2. - 5.6. recursively fitting a straight or quadratic line segment on this sequence of path nodes,\n\t// called from tracepath()\n\tthis.fitseq = function( path, ltres, qtres, seqstart, seqend ){\n\t\t// return if invalid seqend\n\t\tif( (seqend>path.points.length) || (seqend<0) ){ return []; }\n\t\t// variables\n\t\tvar errorpoint=seqstart, errorval=0, curvepass=true, px, py, dist2;\n\t\tvar tl = (seqend-seqstart); if(tl<0){ tl += path.points.length; }\n\t\tvar vx = (path.points[seqend].x-path.points[seqstart].x) / tl,\n\t\t\tvy = (path.points[seqend].y-path.points[seqstart].y) / tl;\n\t\t\n\t\t// 5.2. Fit a straight line on the sequence\n\t\tvar pcnt = (seqstart+1) % path.points.length, pl;\n\t\twhile(pcnt != seqend){\n\t\t\tpl = pcnt-seqstart; if(pl<0){ pl += path.points.length; }\n\t\t\tpx = path.points[seqstart].x + vx * pl; py = path.points[seqstart].y + vy * pl;\n\t\t\tdist2 = (path.points[pcnt].x-px)*(path.points[pcnt].x-px) + (path.points[pcnt].y-py)*(path.points[pcnt].y-py);\n\t\t\tif(dist2>ltres){curvepass=false;}\n\t\t\tif(dist2>errorval){ errorpoint=pcnt; errorval=dist2; }\n\t\t\tpcnt = (pcnt+1)%path.points.length;\n\t\t}\n\t\t// return straight line if fits\n\t\tif(curvepass){ return [{ type:'L', x1:path.points[seqstart].x, y1:path.points[seqstart].y, x2:path.points[seqend].x, y2:path.points[seqend].y }]; }\n\t\t\n\t\t// 5.3. If the straight line fails (distance error>ltres), find the point with the biggest error\n\t\tvar fitpoint = errorpoint; curvepass = true; errorval = 0;\n\t\t\n\t\t// 5.4. Fit a quadratic spline through this point, measure errors on every point in the sequence\n\t\t// helpers and projecting to get control point\n\t\tvar t=(fitpoint-seqstart)/tl, t1=(1-t)*(1-t), t2=2*(1-t)*t, t3=t*t;\n\t\tvar cpx = (t1*path.points[seqstart].x + t3*path.points[seqend].x - path.points[fitpoint].x)/-t2 ,\n\t\t\tcpy = (t1*path.points[seqstart].y + t3*path.points[seqend].y - path.points[fitpoint].y)/-t2 ;\n\t\t\n\t\t// Check every point\n\t\tpcnt = seqstart+1;\n\t\twhile(pcnt != seqend){\n\t\t\tt=(pcnt-seqstart)/tl; t1=(1-t)*(1-t); t2=2*(1-t)*t; t3=t*t;\n\t\t\tpx = t1 * path.points[seqstart].x + t2 * cpx + t3 * path.points[seqend].x;\n\t\t\tpy = t1 * path.points[seqstart].y + t2 * cpy + t3 * path.points[seqend].y;\n\t\t\t\n\t\t\tdist2 = (path.points[pcnt].x-px)*(path.points[pcnt].x-px) + (path.points[pcnt].y-py)*(path.points[pcnt].y-py);\n\t\t\t\n\t\t\tif(dist2>qtres){curvepass=false;}\n\t\t\tif(dist2>errorval){ errorpoint=pcnt; errorval=dist2; }\n\t\t\tpcnt = (pcnt+1)%path.points.length;\n\t\t}\n\t\t// return spline if fits\n\t\tif(curvepass){ return [{ type:'Q', x1:path.points[seqstart].x, y1:path.points[seqstart].y, x2:cpx, y2:cpy, x3:path.points[seqend].x, y3:path.points[seqend].y }]; }\n\t\t// 5.5. If the spline fails (distance error>qtres), find the point with the biggest error\n\t\tvar splitpoint = fitpoint; // Earlier: Math.floor((fitpoint + errorpoint)/2);\n\t\t\n\t\t// 5.6. Split sequence and recursively apply 5.2. - 5.6. to startpoint-splitpoint and splitpoint-endpoint sequences\n\t\treturn _this.fitseq( path, ltres, qtres, seqstart, splitpoint ).concat(\n\t\t\t\t_this.fitseq( path, ltres, qtres, splitpoint, seqend ) );\n\t\t\n\t},// End of fitseq()\n\t\n\t// 5. Batch tracing paths\n\tthis.batchtracepaths = function(internodepaths,ltres,qtres){\n\t\tvar btracedpaths = [];\n\t\tfor(var k in internodepaths){\n\t\t\tif(!internodepaths.hasOwnProperty(k)){ continue; }\n\t\t\tbtracedpaths.push( _this.tracepath(internodepaths[k],ltres,qtres) );\n\t\t}\n\t\treturn btracedpaths;\n\t},\n\t\n\t// 5. Batch tracing layers\n\tthis.batchtracelayers = function(binternodes, ltres, qtres){\n\t\tvar btbis = [];\n\t\tfor(var k in binternodes){\n\t\t\tif(!binternodes.hasOwnProperty(k)){ continue; }\n\t\t\tbtbis[k] = _this.batchtracepaths(binternodes[k], ltres, qtres);\n\t\t}\n\t\treturn btbis;\n\t},\n\t\n\t////////////////////////////////////////////////////////////\n\t//\n\t//  SVG Drawing functions\n\t//\n\t////////////////////////////////////////////////////////////\n\t\n\t// Rounding to given decimals https://stackoverflow.com/questions/11832914/round-to-at-most-2-decimal-places-in-javascript\n\tthis.roundtodec = function(val,places){ return +val.toFixed(places); },\n\t\n\t// Getting SVG path element string from a traced path\n\tthis.svgpathstring = function( tracedata, lnum, pathnum, options ){\n\t\t\n\t\tvar layer = tracedata.layers[lnum], smp = layer[pathnum], str='', pcnt;\n\t\t\n\t\t// Line filter\n\t\tif(options.linefilter && (smp.segments.length < 3)){ return str; }\n\t\t\n\t\t// Starting path element, desc contains layer and path number\n\t\tstr = '<path '+\n\t\t\t( options.desc ? ('desc=\"l '+lnum+' p '+pathnum+'\" ') : '' ) +\n\t\t\t_this.tosvgcolorstr(tracedata.palette[lnum], options) +\n\t\t\t'd=\"';\n\t\t\n\t\t// Creating non-hole path string\n\t\tif( options.roundcoords === -1 ){\n\t\t\tstr += 'M '+ smp.segments[0].x1 * options.scale +' '+ smp.segments[0].y1 * options.scale +' ';\n\t\t\tfor(pcnt=0; pcnt<smp.segments.length; pcnt++){\n\t\t\t\tstr += smp.segments[pcnt].type +' '+ smp.segments[pcnt].x2 * options.scale +' '+ smp.segments[pcnt].y2 * options.scale +' ';\n\t\t\t\tif(smp.segments[pcnt].hasOwnProperty('x3')){\n\t\t\t\t\tstr += smp.segments[pcnt].x3 * options.scale +' '+ smp.segments[pcnt].y3 * options.scale +' ';\n\t\t\t\t}\n\t\t\t}\n\t\t\tstr += 'Z ';\n\t\t}else{\n\t\t\tstr += 'M '+ _this.roundtodec( smp.segments[0].x1 * options.scale, options.roundcoords ) +' '+ _this.roundtodec( smp.segments[0].y1 * options.scale, options.roundcoords ) +' ';\n\t\t\tfor(pcnt=0; pcnt<smp.segments.length; pcnt++){\n\t\t\t\tstr += smp.segments[pcnt].type +' '+ _this.roundtodec( smp.segments[pcnt].x2 * options.scale, options.roundcoords ) +' '+ _this.roundtodec( smp.segments[pcnt].y2 * options.scale, options.roundcoords ) +' ';\n\t\t\t\tif(smp.segments[pcnt].hasOwnProperty('x3')){\n\t\t\t\t\tstr += _this.roundtodec( smp.segments[pcnt].x3 * options.scale, options.roundcoords ) +' '+ _this.roundtodec( smp.segments[pcnt].y3 * options.scale, options.roundcoords ) +' ';\n\t\t\t\t}\n\t\t\t}\n\t\t\tstr += 'Z ';\n\t\t}// End of creating non-hole path string\n\t\t\n\t\t// Hole children\n\t\tfor( var hcnt=0; hcnt < smp.holechildren.length; hcnt++){\n\t\t\tvar hsmp = layer[ smp.holechildren[hcnt] ];\n\t\t\t// Creating hole path string\n\t\t\tif( options.roundcoords === -1 ){\n\t\t\t\t\n\t\t\t\tif(hsmp.segments[ hsmp.segments.length-1 ].hasOwnProperty('x3')){\n\t\t\t\t\tstr += 'M '+ hsmp.segments[ hsmp.segments.length-1 ].x3 * options.scale +' '+ hsmp.segments[ hsmp.segments.length-1 ].y3 * options.scale +' ';\n\t\t\t\t}else{\n\t\t\t\t\tstr += 'M '+ hsmp.segments[ hsmp.segments.length-1 ].x2 * options.scale +' '+ hsmp.segments[ hsmp.segments.length-1 ].y2 * options.scale +' ';\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tfor(pcnt = hsmp.segments.length-1; pcnt >= 0; pcnt--){\n\t\t\t\t\tstr += hsmp.segments[pcnt].type +' ';\n\t\t\t\t\tif(hsmp.segments[pcnt].hasOwnProperty('x3')){\n\t\t\t\t\t\tstr += hsmp.segments[pcnt].x2 * options.scale +' '+ hsmp.segments[pcnt].y2 * options.scale +' ';\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tstr += hsmp.segments[pcnt].x1 * options.scale +' '+ hsmp.segments[pcnt].y1 * options.scale +' ';\n\t\t\t\t}\n\t\t\t\t\n\t\t\t}else{\n\t\t\t\t\n\t\t\t\tif(hsmp.segments[ hsmp.segments.length-1 ].hasOwnProperty('x3')){\n\t\t\t\t\tstr += 'M '+ _this.roundtodec( hsmp.segments[ hsmp.segments.length-1 ].x3 * options.scale ) +' '+ _this.roundtodec( hsmp.segments[ hsmp.segments.length-1 ].y3 * options.scale ) +' ';\n\t\t\t\t}else{\n\t\t\t\t\tstr += 'M '+ _this.roundtodec( hsmp.segments[ hsmp.segments.length-1 ].x2 * options.scale ) +' '+ _this.roundtodec( hsmp.segments[ hsmp.segments.length-1 ].y2 * options.scale ) +' ';\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tfor(pcnt = hsmp.segments.length-1; pcnt >= 0; pcnt--){\n\t\t\t\t\tstr += hsmp.segments[pcnt].type +' ';\n\t\t\t\t\tif(hsmp.segments[pcnt].hasOwnProperty('x3')){\n\t\t\t\t\t\tstr += _this.roundtodec( hsmp.segments[pcnt].x2 * options.scale ) +' '+ _this.roundtodec( hsmp.segments[pcnt].y2 * options.scale ) +' ';\n\t\t\t\t\t}\n\t\t\t\t\tstr += _this.roundtodec( hsmp.segments[pcnt].x1 * options.scale ) +' '+ _this.roundtodec( hsmp.segments[pcnt].y1 * options.scale ) +' ';\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t\n\t\t\t}// End of creating hole path string\n\t\t\t\n\t\t\tstr += 'Z '; // Close path\n\t\t\t\n\t\t}// End of holepath check\n\t\t\n\t\t// Closing path element\n\t\tstr += '\" />';\n\t\t\n\t\t// Rendering control points\n\t\tif(options.lcpr || options.qcpr){\n\t\t\tfor(pcnt=0; pcnt<smp.segments.length; pcnt++){\n\t\t\t\tif( smp.segments[pcnt].hasOwnProperty('x3') && options.qcpr ){\n\t\t\t\t\tstr += '<circle cx=\"'+ smp.segments[pcnt].x2 * options.scale +'\" cy=\"'+ smp.segments[pcnt].y2 * options.scale +'\" r=\"'+ options.qcpr +'\" fill=\"cyan\" stroke-width=\"'+ options.qcpr * 0.2 +'\" stroke=\"black\" />';\n\t\t\t\t\tstr += '<circle cx=\"'+ smp.segments[pcnt].x3 * options.scale +'\" cy=\"'+ smp.segments[pcnt].y3 * options.scale +'\" r=\"'+ options.qcpr +'\" fill=\"white\" stroke-width=\"'+ options.qcpr * 0.2 +'\" stroke=\"black\" />';\n\t\t\t\t\tstr += '<line x1=\"'+ smp.segments[pcnt].x1 * options.scale +'\" y1=\"'+ smp.segments[pcnt].y1 * options.scale +'\" x2=\"'+ smp.segments[pcnt].x2 * options.scale +'\" y2=\"'+ smp.segments[pcnt].y2 * options.scale +'\" stroke-width=\"'+ options.qcpr * 0.2 +'\" stroke=\"cyan\" />';\n\t\t\t\t\tstr += '<line x1=\"'+ smp.segments[pcnt].x2 * options.scale +'\" y1=\"'+ smp.segments[pcnt].y2 * options.scale +'\" x2=\"'+ smp.segments[pcnt].x3 * options.scale +'\" y2=\"'+ smp.segments[pcnt].y3 * options.scale +'\" stroke-width=\"'+ options.qcpr * 0.2 +'\" stroke=\"cyan\" />';\n\t\t\t\t}\n\t\t\t\tif( (!smp.segments[pcnt].hasOwnProperty('x3')) && options.lcpr){\n\t\t\t\t\tstr += '<circle cx=\"'+ smp.segments[pcnt].x2 * options.scale +'\" cy=\"'+ smp.segments[pcnt].y2 * options.scale +'\" r=\"'+ options.lcpr +'\" fill=\"white\" stroke-width=\"'+ options.lcpr * 0.2 +'\" stroke=\"black\" />';\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\t// Hole children control points\n\t\t\tfor( var hcnt=0; hcnt < smp.holechildren.length; hcnt++){\n\t\t\t\tvar hsmp = layer[ smp.holechildren[hcnt] ];\n\t\t\t\tfor(pcnt=0; pcnt<hsmp.segments.length; pcnt++){\n\t\t\t\t\tif( hsmp.segments[pcnt].hasOwnProperty('x3') && options.qcpr ){\n\t\t\t\t\t\tstr += '<circle cx=\"'+ hsmp.segments[pcnt].x2 * options.scale +'\" cy=\"'+ hsmp.segments[pcnt].y2 * options.scale +'\" r=\"'+ options.qcpr +'\" fill=\"cyan\" stroke-width=\"'+ options.qcpr * 0.2 +'\" stroke=\"black\" />';\n\t\t\t\t\t\tstr += '<circle cx=\"'+ hsmp.segments[pcnt].x3 * options.scale +'\" cy=\"'+ hsmp.segments[pcnt].y3 * options.scale +'\" r=\"'+ options.qcpr +'\" fill=\"white\" stroke-width=\"'+ options.qcpr * 0.2 +'\" stroke=\"black\" />';\n\t\t\t\t\t\tstr += '<line x1=\"'+ hsmp.segments[pcnt].x1 * options.scale +'\" y1=\"'+ hsmp.segments[pcnt].y1 * options.scale +'\" x2=\"'+ hsmp.segments[pcnt].x2 * options.scale +'\" y2=\"'+ hsmp.segments[pcnt].y2 * options.scale +'\" stroke-width=\"'+ options.qcpr * 0.2 +'\" stroke=\"cyan\" />';\n\t\t\t\t\t\tstr += '<line x1=\"'+ hsmp.segments[pcnt].x2 * options.scale +'\" y1=\"'+ hsmp.segments[pcnt].y2 * options.scale +'\" x2=\"'+ hsmp.segments[pcnt].x3 * options.scale +'\" y2=\"'+ hsmp.segments[pcnt].y3 * options.scale +'\" stroke-width=\"'+ options.qcpr * 0.2 +'\" stroke=\"cyan\" />';\n\t\t\t\t\t}\n\t\t\t\t\tif( (!hsmp.segments[pcnt].hasOwnProperty('x3')) && options.lcpr){\n\t\t\t\t\t\tstr += '<circle cx=\"'+ hsmp.segments[pcnt].x2 * options.scale +'\" cy=\"'+ hsmp.segments[pcnt].y2 * options.scale +'\" r=\"'+ options.lcpr +'\" fill=\"white\" stroke-width=\"'+ options.lcpr * 0.2 +'\" stroke=\"black\" />';\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}// End of Rendering control points\n\t\t\t\n\t\treturn str;\n\t\t\n\t},// End of svgpathstring()\n\t\n\t// Converting tracedata to an SVG string\n\tthis.getsvgstring = function( tracedata, options ){\n\t\t\n\t\toptions = _this.checkoptions(options);\n\t\t\n\t\tvar w = tracedata.width * options.scale, h = tracedata.height * options.scale;\n\t\t\n\t\t// SVG start\n\t\tvar svgstr = '<svg ' + (options.viewbox ? ('viewBox=\"0 0 '+w+' '+h+'\" ') : ('width=\"'+w+'\" height=\"'+h+'\" ')) +\n\t\t\t'version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" desc=\"Created with imagetracer.js version '+_this.versionnumber+'\" >';\n\n\t\t// Drawing: Layers and Paths loops\n\t\tfor(var lcnt=0; lcnt < tracedata.layers.length; lcnt++){\n\t\t\tfor(var pcnt=0; pcnt < tracedata.layers[lcnt].length; pcnt++){\n\t\t\t\t\n\t\t\t\t// Adding SVG <path> string\n\t\t\t\tif( !tracedata.layers[lcnt][pcnt].isholepath ){\n\t\t\t\t\tsvgstr += _this.svgpathstring( tracedata, lcnt, pcnt, options );\n\t\t\t\t}\n\t\t\t\t\t\n\t\t\t}// End of paths loop\n\t\t}// End of layers loop\n\t\t\n\t\t// SVG End\n\t\tsvgstr+='</svg>';\n\t\t\n\t\treturn svgstr;\n\t\t\n\t},// End of getsvgstring()\n\t\n\t// Comparator for numeric Array.sort\n\tthis.compareNumbers = function(a,b){ return a - b; },\n\t\n\t// Convert color object to rgba string\n\tthis.torgbastr = function(c){ return 'rgba('+c.r+','+c.g+','+c.b+','+c.a+')'; },\n\t\n\t// Convert color object to SVG color string\n\tthis.tosvgcolorstr = function(c, options){\n\t\treturn 'fill=\"rgb('+c.r+','+c.g+','+c.b+')\" stroke=\"rgb('+c.r+','+c.g+','+c.b+')\" stroke-width=\"'+options.strokewidth+'\" opacity=\"'+c.a/255.0+'\" ';\n\t},\n\t\n\t// Helper function: Appending an <svg> element to a container from an svgstring\n\tthis.appendSVGString = function(svgstr,parentid){\n\t\tvar div;\n\t\tif(parentid){\n\t\t\tdiv = document.getElementById(parentid);\n\t\t\tif(!div){\n\t\t\t\tdiv = document.createElement('div');\n\t\t\t\tdiv.id = parentid;\n\t\t\t\tdocument.body.appendChild(div);\n\t\t\t}\n\t\t}else{\n\t\t\tdiv = document.createElement('div');\n\t\t\tdocument.body.appendChild(div);\n\t\t}\n\t\tdiv.innerHTML += svgstr;\n\t},\n\t\n\t////////////////////////////////////////////////////////////\n\t//\n\t//  Canvas functions\n\t//\n\t////////////////////////////////////////////////////////////\n\t\n\t// Gaussian kernels for blur\n\tthis.gks = [ [0.27901,0.44198,0.27901], [0.135336,0.228569,0.272192,0.228569,0.135336], [0.086776,0.136394,0.178908,0.195843,0.178908,0.136394,0.086776],\n\t             [0.063327,0.093095,0.122589,0.144599,0.152781,0.144599,0.122589,0.093095,0.063327], [0.049692,0.069304,0.089767,0.107988,0.120651,0.125194,0.120651,0.107988,0.089767,0.069304,0.049692] ],\n\t\n\t// Selective Gaussian blur for preprocessing\n\tthis.blur = function(imgd,radius,delta){\n\t\tvar i,j,k,d,idx,racc,gacc,bacc,aacc,wacc;\n\t\t\n\t\t// new ImageData\n\t\tvar imgd2 = { width:imgd.width, height:imgd.height, data:[] };\n\t\t\n\t\t// radius and delta limits, this kernel\n\t\tradius = Math.floor(radius); if(radius<1){ return imgd; } if(radius>5){ radius = 5; } delta = Math.abs( delta ); if(delta>1024){ delta = 1024; }\n\t\tvar thisgk = _this.gks[radius-1];\n\t\t\n\t\t// loop through all pixels, horizontal blur\n\t\tfor( j=0; j < imgd.height; j++ ){\n\t\t\tfor( i=0; i < imgd.width; i++ ){\n\n\t\t\t\tracc = 0; gacc = 0; bacc = 0; aacc = 0; wacc = 0;\n\t\t\t\t// gauss kernel loop\n\t\t\t\tfor( k = -radius; k < radius+1; k++){\n\t\t\t\t\t// add weighted color values\n\t\t\t\t\tif( (i+k > 0) && (i+k < imgd.width) ){\n\t\t\t\t\t\tidx = (j*imgd.width+i+k)*4;\n\t\t\t\t\t\tracc += imgd.data[idx  ] * thisgk[k+radius];\n\t\t\t\t\t\tgacc += imgd.data[idx+1] * thisgk[k+radius];\n\t\t\t\t\t\tbacc += imgd.data[idx+2] * thisgk[k+radius];\n\t\t\t\t\t\taacc += imgd.data[idx+3] * thisgk[k+radius];\n\t\t\t\t\t\twacc += thisgk[k+radius];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// The new pixel\n\t\t\t\tidx = (j*imgd.width+i)*4;\n\t\t\t\timgd2.data[idx  ] = Math.floor(racc / wacc);\n\t\t\t\timgd2.data[idx+1] = Math.floor(gacc / wacc);\n\t\t\t\timgd2.data[idx+2] = Math.floor(bacc / wacc);\n\t\t\t\timgd2.data[idx+3] = Math.floor(aacc / wacc);\n\t\t\t\t\n\t\t\t}// End of width loop\n\t\t}// End of horizontal blur\n\t\t\n\t\t// copying the half blurred imgd2\n\t\tvar himgd = new Uint8ClampedArray(imgd2.data);\n\t\t\n\t\t// loop through all pixels, vertical blur\n\t\tfor( j=0; j < imgd.height; j++ ){\n\t\t\tfor( i=0; i < imgd.width; i++ ){\n\n\t\t\t\tracc = 0; gacc = 0; bacc = 0; aacc = 0; wacc = 0;\n\t\t\t\t// gauss kernel loop\n\t\t\t\tfor( k = -radius; k < radius+1; k++){\n\t\t\t\t\t// add weighted color values\n\t\t\t\t\tif( (j+k > 0) && (j+k < imgd.height) ){\n\t\t\t\t\t\tidx = ((j+k)*imgd.width+i)*4;\n\t\t\t\t\t\tracc += himgd[idx  ] * thisgk[k+radius];\n\t\t\t\t\t\tgacc += himgd[idx+1] * thisgk[k+radius];\n\t\t\t\t\t\tbacc += himgd[idx+2] * thisgk[k+radius];\n\t\t\t\t\t\taacc += himgd[idx+3] * thisgk[k+radius];\n\t\t\t\t\t\twacc += thisgk[k+radius];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// The new pixel\n\t\t\t\tidx = (j*imgd.width+i)*4;\n\t\t\t\timgd2.data[idx  ] = Math.floor(racc / wacc);\n\t\t\t\timgd2.data[idx+1] = Math.floor(gacc / wacc);\n\t\t\t\timgd2.data[idx+2] = Math.floor(bacc / wacc);\n\t\t\t\timgd2.data[idx+3] = Math.floor(aacc / wacc);\n\t\t\t\t\n\t\t\t}// End of width loop\n\t\t}// End of vertical blur\n\t\t\n\t\t// Selective blur: loop through all pixels\n\t\tfor( j=0; j < imgd.height; j++ ){\n\t\t\tfor( i=0; i < imgd.width; i++ ){\n\t\t\t\t\n\t\t\t\tidx = (j*imgd.width+i)*4;\n\t\t\t\t// d is the difference between the blurred and the original pixel\n\t\t\t\td = Math.abs(imgd2.data[idx  ] - imgd.data[idx  ]) + Math.abs(imgd2.data[idx+1] - imgd.data[idx+1]) +\n\t\t\t\t\tMath.abs(imgd2.data[idx+2] - imgd.data[idx+2]) + Math.abs(imgd2.data[idx+3] - imgd.data[idx+3]);\n\t\t\t\t// selective blur: if d>delta, put the original pixel back\n\t\t\t\tif(d>delta){\n\t\t\t\t\timgd2.data[idx  ] = imgd.data[idx  ];\n\t\t\t\t\timgd2.data[idx+1] = imgd.data[idx+1];\n\t\t\t\t\timgd2.data[idx+2] = imgd.data[idx+2];\n\t\t\t\t\timgd2.data[idx+3] = imgd.data[idx+3];\n\t\t\t\t}\n\t\t\t}\n\t\t}// End of Selective blur\n\t\t\n\t\treturn imgd2;\n\t\t\n\t},// End of blur()\n\t\n\t// Helper function: loading an image from a URL, then executing callback with canvas as argument\n\tthis.loadImage = function(url,callback,options){\n\t\tvar img = new Image();\n\t\tif(options && options.corsenabled){ img.crossOrigin = 'Anonymous'; }\n\t\timg.onload = function(){\n\t\t\tvar canvas = document.createElement('canvas');\n\t\t\tcanvas.width = img.width;\n\t\t\tcanvas.height = img.height;\n\t\t\tvar context = canvas.getContext('2d');\n\t\t\tcontext.drawImage(img,0,0);\n\t\t\tcallback(canvas);\n\t\t};\n\t\timg.src = url;\n\t},\n\t\n\t// Helper function: getting ImageData from a canvas\n\tthis.getImgdata = function(canvas){\n\t\tvar context = canvas.getContext('2d');\n\t\treturn context.getImageData(0,0,canvas.width,canvas.height);\n\t},\n\t\n\t// Special palette to use with drawlayers()\n\tthis.specpalette = [\n\t\t{r:0,g:0,b:0,a:255}, {r:128,g:128,b:128,a:255}, {r:0,g:0,b:128,a:255}, {r:64,g:64,b:128,a:255},\n\t\t{r:192,g:192,b:192,a:255}, {r:255,g:255,b:255,a:255}, {r:128,g:128,b:192,a:255}, {r:0,g:0,b:192,a:255},\n\t\t{r:128,g:0,b:0,a:255}, {r:128,g:64,b:64,a:255}, {r:128,g:0,b:128,a:255}, {r:168,g:168,b:168,a:255},\n\t\t{r:192,g:128,b:128,a:255}, {r:192,g:0,b:0,a:255}, {r:255,g:255,b:255,a:255}, {r:0,g:128,b:0,a:255}\n\t],\n\t\n\t// Helper function: Drawing all edge node layers into a container\n\tthis.drawLayers = function(layers,palette,scale,parentid){\n\t\tscale = scale||1;\n\t\tvar w,h,i,j,k;\n\t\t\n\t\t// Preparing container\n\t\tvar div;\n\t\tif(parentid){\n\t\t\tdiv = document.getElementById(parentid);\n\t\t\tif(!div){\n\t\t\t\tdiv = document.createElement('div');\n\t\t\t\tdiv.id = parentid;\n\t\t\t\tdocument.body.appendChild(div);\n\t\t\t}\n\t\t}else{\n\t\t\tdiv = document.createElement('div');\n\t\t\tdocument.body.appendChild(div);\n\t\t}\n\t\t\n\t\t// Layers loop\n\t\tfor (k in layers) {\n\t\t\tif(!layers.hasOwnProperty(k)){ continue; }\n\t\t\t\n\t\t\t// width, height\n\t\t\tw=layers[k][0].length; h=layers[k].length;\n\t\t\t\n\t\t\t// Creating new canvas for every layer\n\t\t\tvar canvas = document.createElement('canvas'); canvas.width=w*scale; canvas.height=h*scale;\n\t\t\tvar context = canvas.getContext('2d');\n\t\t\t\n\t\t\t// Drawing\n\t\t\tfor(j=0; j<h; j++){\n\t\t\t\tfor(i=0; i<w; i++){\n\t\t\t\t\tcontext.fillStyle = _this.torgbastr(palette[ layers[k][j][i]%palette.length ]);\n\t\t\t\t\tcontext.fillRect(i*scale,j*scale,scale,scale);\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\t// Appending canvas to container\n\t\t\tdiv.appendChild(canvas);\n\t\t}// End of Layers loop\n\t}// End of drawlayers\n\t\n\t;// End of function list\n\t\n}// End of ImageTracer object\n\n// export as AMD module / Node module / browser or worker variable\nif(typeof define === 'function' && define.amd){\n\tdefine(function() { return new ImageTracer(); });\n}else if(typeof module !== 'undefined'){\n\tmodule.exports = new ImageTracer();\n}else if(typeof self !== 'undefined'){\n\tself.ImageTracer = new ImageTracer();\n}else window.ImageTracer = new ImageTracer();\n\n})();","'use strict';\r\n\r\n// Last time updated: 2021-03-09 3:20:22 AM UTC\r\n\r\n// ________________\r\n// RecordRTC v5.6.2\r\n\r\n// Open-Sourced: https://github.com/muaz-khan/RecordRTC\r\n\r\n// --------------------------------------------------\r\n// Muaz Khan     - www.MuazKhan.com\r\n// MIT License   - www.WebRTC-Experiment.com/licence\r\n// --------------------------------------------------\r\n\r\n// ____________\r\n// RecordRTC.js\r\n\r\n/**\r\n * {@link https://github.com/muaz-khan/RecordRTC|RecordRTC} is a WebRTC JavaScript library for audio/video as well as screen activity recording. It supports Chrome, Firefox, Opera, Android, and Microsoft Edge. Platforms: Linux, Mac and Windows. \r\n * @summary Record audio, video or screen inside the browser.\r\n * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}\r\n * @author {@link https://MuazKhan.com|Muaz Khan}\r\n * @typedef RecordRTC\r\n * @class\r\n * @example\r\n * var recorder = RecordRTC(mediaStream or [arrayOfMediaStream], {\r\n *     type: 'video', // audio or video or gif or canvas\r\n *     recorderType: MediaStreamRecorder || CanvasRecorder || StereoAudioRecorder || Etc\r\n * });\r\n * recorder.startRecording();\r\n * @see For further information:\r\n * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}\r\n * @param {MediaStream} mediaStream - Single media-stream object, array of media-streams, html-canvas-element, etc.\r\n * @param {object} config - {type:\"video\", recorderType: MediaStreamRecorder, disableLogs: true, numberOfAudioChannels: 1, bufferSize: 0, sampleRate: 0, desiredSampRate: 16000, video: HTMLVideoElement, etc.}\r\n */\r\n\r\nfunction RecordRTC(mediaStream, config) {\r\n    if (!mediaStream) {\r\n        throw 'First parameter is required.';\r\n    }\r\n\r\n    config = config || {\r\n        type: 'video'\r\n    };\r\n\r\n    config = new RecordRTCConfiguration(mediaStream, config);\r\n\r\n    // a reference to user's recordRTC object\r\n    var self = this;\r\n\r\n    function startRecording(config2) {\r\n        if (!config.disableLogs) {\r\n            console.log('RecordRTC version: ', self.version);\r\n        }\r\n\r\n        if (!!config2) {\r\n            // allow users to set options using startRecording method\r\n            // config2 is similar to main \"config\" object (second parameter over RecordRTC constructor)\r\n            config = new RecordRTCConfiguration(mediaStream, config2);\r\n        }\r\n\r\n        if (!config.disableLogs) {\r\n            console.log('started recording ' + config.type + ' stream.');\r\n        }\r\n\r\n        if (mediaRecorder) {\r\n            mediaRecorder.clearRecordedData();\r\n            mediaRecorder.record();\r\n\r\n            setState('recording');\r\n\r\n            if (self.recordingDuration) {\r\n                handleRecordingDuration();\r\n            }\r\n            return self;\r\n        }\r\n\r\n        initRecorder(function() {\r\n            if (self.recordingDuration) {\r\n                handleRecordingDuration();\r\n            }\r\n        });\r\n\r\n        return self;\r\n    }\r\n\r\n    function initRecorder(initCallback) {\r\n        if (initCallback) {\r\n            config.initCallback = function() {\r\n                initCallback();\r\n                initCallback = config.initCallback = null; // recorder.initRecorder should be call-backed once.\r\n            };\r\n        }\r\n\r\n        var Recorder = new GetRecorderType(mediaStream, config);\r\n\r\n        mediaRecorder = new Recorder(mediaStream, config);\r\n        mediaRecorder.record();\r\n\r\n        setState('recording');\r\n\r\n        if (!config.disableLogs) {\r\n            console.log('Initialized recorderType:', mediaRecorder.constructor.name, 'for output-type:', config.type);\r\n        }\r\n    }\r\n\r\n    function stopRecording(callback) {\r\n        callback = callback || function() {};\r\n\r\n        if (!mediaRecorder) {\r\n            warningLog();\r\n            return;\r\n        }\r\n\r\n        if (self.state === 'paused') {\r\n            self.resumeRecording();\r\n\r\n            setTimeout(function() {\r\n                stopRecording(callback);\r\n            }, 1);\r\n            return;\r\n        }\r\n\r\n        if (self.state !== 'recording' && !config.disableLogs) {\r\n            console.warn('Recording state should be: \"recording\", however current state is: ', self.state);\r\n        }\r\n\r\n        if (!config.disableLogs) {\r\n            console.log('Stopped recording ' + config.type + ' stream.');\r\n        }\r\n\r\n        if (config.type !== 'gif') {\r\n            mediaRecorder.stop(_callback);\r\n        } else {\r\n            mediaRecorder.stop();\r\n            _callback();\r\n        }\r\n\r\n        setState('stopped');\r\n\r\n        function _callback(__blob) {\r\n            if (!mediaRecorder) {\r\n                if (typeof callback.call === 'function') {\r\n                    callback.call(self, '');\r\n                } else {\r\n                    callback('');\r\n                }\r\n                return;\r\n            }\r\n\r\n            Object.keys(mediaRecorder).forEach(function(key) {\r\n                if (typeof mediaRecorder[key] === 'function') {\r\n                    return;\r\n                }\r\n\r\n                self[key] = mediaRecorder[key];\r\n            });\r\n\r\n            var blob = mediaRecorder.blob;\r\n\r\n            if (!blob) {\r\n                if (__blob) {\r\n                    mediaRecorder.blob = blob = __blob;\r\n                } else {\r\n                    throw 'Recording failed.';\r\n                }\r\n            }\r\n\r\n            if (blob && !config.disableLogs) {\r\n                console.log(blob.type, '->', bytesToSize(blob.size));\r\n            }\r\n\r\n            if (callback) {\r\n                var url;\r\n\r\n                try {\r\n                    url = URL.createObjectURL(blob);\r\n                } catch (e) {}\r\n\r\n                if (typeof callback.call === 'function') {\r\n                    callback.call(self, url);\r\n                } else {\r\n                    callback(url);\r\n                }\r\n            }\r\n\r\n            if (!config.autoWriteToDisk) {\r\n                return;\r\n            }\r\n\r\n            getDataURL(function(dataURL) {\r\n                var parameter = {};\r\n                parameter[config.type + 'Blob'] = dataURL;\r\n                DiskStorage.Store(parameter);\r\n            });\r\n        }\r\n    }\r\n\r\n    function pauseRecording() {\r\n        if (!mediaRecorder) {\r\n            warningLog();\r\n            return;\r\n        }\r\n\r\n        if (self.state !== 'recording') {\r\n            if (!config.disableLogs) {\r\n                console.warn('Unable to pause the recording. Recording state: ', self.state);\r\n            }\r\n            return;\r\n        }\r\n\r\n        setState('paused');\r\n\r\n        mediaRecorder.pause();\r\n\r\n        if (!config.disableLogs) {\r\n            console.log('Paused recording.');\r\n        }\r\n    }\r\n\r\n    function resumeRecording() {\r\n        if (!mediaRecorder) {\r\n            warningLog();\r\n            return;\r\n        }\r\n\r\n        if (self.state !== 'paused') {\r\n            if (!config.disableLogs) {\r\n                console.warn('Unable to resume the recording. Recording state: ', self.state);\r\n            }\r\n            return;\r\n        }\r\n\r\n        setState('recording');\r\n\r\n        // not all libs have this method yet\r\n        mediaRecorder.resume();\r\n\r\n        if (!config.disableLogs) {\r\n            console.log('Resumed recording.');\r\n        }\r\n    }\r\n\r\n    function readFile(_blob) {\r\n        postMessage(new FileReaderSync().readAsDataURL(_blob));\r\n    }\r\n\r\n    function getDataURL(callback, _mediaRecorder) {\r\n        if (!callback) {\r\n            throw 'Pass a callback function over getDataURL.';\r\n        }\r\n\r\n        var blob = _mediaRecorder ? _mediaRecorder.blob : (mediaRecorder || {}).blob;\r\n\r\n        if (!blob) {\r\n            if (!config.disableLogs) {\r\n                console.warn('Blob encoder did not finish its job yet.');\r\n            }\r\n\r\n            setTimeout(function() {\r\n                getDataURL(callback, _mediaRecorder);\r\n            }, 1000);\r\n            return;\r\n        }\r\n\r\n        if (typeof Worker !== 'undefined' && !navigator.mozGetUserMedia) {\r\n            var webWorker = processInWebWorker(readFile);\r\n\r\n            webWorker.onmessage = function(event) {\r\n                callback(event.data);\r\n            };\r\n\r\n            webWorker.postMessage(blob);\r\n        } else {\r\n            var reader = new FileReader();\r\n            reader.readAsDataURL(blob);\r\n            reader.onload = function(event) {\r\n                callback(event.target.result);\r\n            };\r\n        }\r\n\r\n        function processInWebWorker(_function) {\r\n            try {\r\n                var blob = URL.createObjectURL(new Blob([_function.toString(),\r\n                    'this.onmessage =  function (eee) {' + _function.name + '(eee.data);}'\r\n                ], {\r\n                    type: 'application/javascript'\r\n                }));\r\n\r\n                var worker = new Worker(blob);\r\n                URL.revokeObjectURL(blob);\r\n                return worker;\r\n            } catch (e) {}\r\n        }\r\n    }\r\n\r\n    function handleRecordingDuration(counter) {\r\n        counter = counter || 0;\r\n\r\n        if (self.state === 'paused') {\r\n            setTimeout(function() {\r\n                handleRecordingDuration(counter);\r\n            }, 1000);\r\n            return;\r\n        }\r\n\r\n        if (self.state === 'stopped') {\r\n            return;\r\n        }\r\n\r\n        if (counter >= self.recordingDuration) {\r\n            stopRecording(self.onRecordingStopped);\r\n            return;\r\n        }\r\n\r\n        counter += 1000; // 1-second\r\n\r\n        setTimeout(function() {\r\n            handleRecordingDuration(counter);\r\n        }, 1000);\r\n    }\r\n\r\n    function setState(state) {\r\n        if (!self) {\r\n            return;\r\n        }\r\n\r\n        self.state = state;\r\n\r\n        if (typeof self.onStateChanged.call === 'function') {\r\n            self.onStateChanged.call(self, state);\r\n        } else {\r\n            self.onStateChanged(state);\r\n        }\r\n    }\r\n\r\n    var WARNING = 'It seems that recorder is destroyed or \"startRecording\" is not invoked for ' + config.type + ' recorder.';\r\n\r\n    function warningLog() {\r\n        if (config.disableLogs === true) {\r\n            return;\r\n        }\r\n\r\n        console.warn(WARNING);\r\n    }\r\n\r\n    var mediaRecorder;\r\n\r\n    var returnObject = {\r\n        /**\r\n         * This method starts the recording.\r\n         * @method\r\n         * @memberof RecordRTC\r\n         * @instance\r\n         * @example\r\n         * var recorder = RecordRTC(mediaStream, {\r\n         *     type: 'video'\r\n         * });\r\n         * recorder.startRecording();\r\n         */\r\n        startRecording: startRecording,\r\n\r\n        /**\r\n         * This method stops the recording. It is strongly recommended to get \"blob\" or \"URI\" inside the callback to make sure all recorders finished their job.\r\n         * @param {function} callback - Callback to get the recorded blob.\r\n         * @method\r\n         * @memberof RecordRTC\r\n         * @instance\r\n         * @example\r\n         * recorder.stopRecording(function() {\r\n         *     // use either \"this\" or \"recorder\" object; both are identical\r\n         *     video.src = this.toURL();\r\n         *     var blob = this.getBlob();\r\n         * });\r\n         */\r\n        stopRecording: stopRecording,\r\n\r\n        /**\r\n         * This method pauses the recording. You can resume recording using \"resumeRecording\" method.\r\n         * @method\r\n         * @memberof RecordRTC\r\n         * @instance\r\n         * @todo Firefox is unable to pause the recording. Fix it.\r\n         * @example\r\n         * recorder.pauseRecording();  // pause the recording\r\n         * recorder.resumeRecording(); // resume again\r\n         */\r\n        pauseRecording: pauseRecording,\r\n\r\n        /**\r\n         * This method resumes the recording.\r\n         * @method\r\n         * @memberof RecordRTC\r\n         * @instance\r\n         * @example\r\n         * recorder.pauseRecording();  // first of all, pause the recording\r\n         * recorder.resumeRecording(); // now resume it\r\n         */\r\n        resumeRecording: resumeRecording,\r\n\r\n        /**\r\n         * This method initializes the recording.\r\n         * @method\r\n         * @memberof RecordRTC\r\n         * @instance\r\n         * @todo This method should be deprecated.\r\n         * @example\r\n         * recorder.initRecorder();\r\n         */\r\n        initRecorder: initRecorder,\r\n\r\n        /**\r\n         * Ask RecordRTC to auto-stop the recording after 5 minutes.\r\n         * @method\r\n         * @memberof RecordRTC\r\n         * @instance\r\n         * @example\r\n         * var fiveMinutes = 5 * 1000 * 60;\r\n         * recorder.setRecordingDuration(fiveMinutes, function() {\r\n         *    var blob = this.getBlob();\r\n         *    video.src = this.toURL();\r\n         * });\r\n         * \r\n         * // or otherwise\r\n         * recorder.setRecordingDuration(fiveMinutes).onRecordingStopped(function() {\r\n         *    var blob = this.getBlob();\r\n         *    video.src = this.toURL();\r\n         * });\r\n         */\r\n        setRecordingDuration: function(recordingDuration, callback) {\r\n            if (typeof recordingDuration === 'undefined') {\r\n                throw 'recordingDuration is required.';\r\n            }\r\n\r\n            if (typeof recordingDuration !== 'number') {\r\n                throw 'recordingDuration must be a number.';\r\n            }\r\n\r\n            self.recordingDuration = recordingDuration;\r\n            self.onRecordingStopped = callback || function() {};\r\n\r\n            return {\r\n                onRecordingStopped: function(callback) {\r\n                    self.onRecordingStopped = callback;\r\n                }\r\n            };\r\n        },\r\n\r\n        /**\r\n         * This method can be used to clear/reset all the recorded data.\r\n         * @method\r\n         * @memberof RecordRTC\r\n         * @instance\r\n         * @todo Figure out the difference between \"reset\" and \"clearRecordedData\" methods.\r\n         * @example\r\n         * recorder.clearRecordedData();\r\n         */\r\n        clearRecordedData: function() {\r\n            if (!mediaRecorder) {\r\n                warningLog();\r\n                return;\r\n            }\r\n\r\n            mediaRecorder.clearRecordedData();\r\n\r\n            if (!config.disableLogs) {\r\n                console.log('Cleared old recorded data.');\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Get the recorded blob. Use this method inside the \"stopRecording\" callback.\r\n         * @method\r\n         * @memberof RecordRTC\r\n         * @instance\r\n         * @example\r\n         * recorder.stopRecording(function() {\r\n         *     var blob = this.getBlob();\r\n         *\r\n         *     var file = new File([blob], 'filename.webm', {\r\n         *         type: 'video/webm'\r\n         *     });\r\n         *\r\n         *     var formData = new FormData();\r\n         *     formData.append('file', file); // upload \"File\" object rather than a \"Blob\"\r\n         *     uploadToServer(formData);\r\n         * });\r\n         * @returns {Blob} Returns recorded data as \"Blob\" object.\r\n         */\r\n        getBlob: function() {\r\n            if (!mediaRecorder) {\r\n                warningLog();\r\n                return;\r\n            }\r\n\r\n            return mediaRecorder.blob;\r\n        },\r\n\r\n        /**\r\n         * Get data-URI instead of Blob.\r\n         * @param {function} callback - Callback to get the Data-URI.\r\n         * @method\r\n         * @memberof RecordRTC\r\n         * @instance\r\n         * @example\r\n         * recorder.stopRecording(function() {\r\n         *     recorder.getDataURL(function(dataURI) {\r\n         *         video.src = dataURI;\r\n         *     });\r\n         * });\r\n         */\r\n        getDataURL: getDataURL,\r\n\r\n        /**\r\n         * Get virtual/temporary URL. Usage of this URL is limited to current tab.\r\n         * @method\r\n         * @memberof RecordRTC\r\n         * @instance\r\n         * @example\r\n         * recorder.stopRecording(function() {\r\n         *     video.src = this.toURL();\r\n         * });\r\n         * @returns {String} Returns a virtual/temporary URL for the recorded \"Blob\".\r\n         */\r\n        toURL: function() {\r\n            if (!mediaRecorder) {\r\n                warningLog();\r\n                return;\r\n            }\r\n\r\n            return URL.createObjectURL(mediaRecorder.blob);\r\n        },\r\n\r\n        /**\r\n         * Get internal recording object (i.e. internal module) e.g. MutliStreamRecorder, MediaStreamRecorder, StereoAudioRecorder or WhammyRecorder etc.\r\n         * @method\r\n         * @memberof RecordRTC\r\n         * @instance\r\n         * @example\r\n         * var internalRecorder = recorder.getInternalRecorder();\r\n         * if(internalRecorder instanceof MultiStreamRecorder) {\r\n         *     internalRecorder.addStreams([newAudioStream]);\r\n         *     internalRecorder.resetVideoStreams([screenStream]);\r\n         * }\r\n         * @returns {Object} Returns internal recording object.\r\n         */\r\n        getInternalRecorder: function() {\r\n            return mediaRecorder;\r\n        },\r\n\r\n        /**\r\n         * Invoke save-as dialog to save the recorded blob into your disk.\r\n         * @param {string} fileName - Set your own file name.\r\n         * @method\r\n         * @memberof RecordRTC\r\n         * @instance\r\n         * @example\r\n         * recorder.stopRecording(function() {\r\n         *     this.save('file-name');\r\n         *\r\n         *     // or manually:\r\n         *     invokeSaveAsDialog(this.getBlob(), 'filename.webm');\r\n         * });\r\n         */\r\n        save: function(fileName) {\r\n            if (!mediaRecorder) {\r\n                warningLog();\r\n                return;\r\n            }\r\n\r\n            invokeSaveAsDialog(mediaRecorder.blob, fileName);\r\n        },\r\n\r\n        /**\r\n         * This method gets a blob from indexed-DB storage.\r\n         * @param {function} callback - Callback to get the recorded blob.\r\n         * @method\r\n         * @memberof RecordRTC\r\n         * @instance\r\n         * @example\r\n         * recorder.getFromDisk(function(dataURL) {\r\n         *     video.src = dataURL;\r\n         * });\r\n         */\r\n        getFromDisk: function(callback) {\r\n            if (!mediaRecorder) {\r\n                warningLog();\r\n                return;\r\n            }\r\n\r\n            RecordRTC.getFromDisk(config.type, callback);\r\n        },\r\n\r\n        /**\r\n         * This method appends an array of webp images to the recorded video-blob. It takes an \"array\" object.\r\n         * @type {Array.<Array>}\r\n         * @param {Array} arrayOfWebPImages - Array of webp images.\r\n         * @method\r\n         * @memberof RecordRTC\r\n         * @instance\r\n         * @todo This method should be deprecated.\r\n         * @example\r\n         * var arrayOfWebPImages = [];\r\n         * arrayOfWebPImages.push({\r\n         *     duration: index,\r\n         *     image: 'data:image/webp;base64,...'\r\n         * });\r\n         * recorder.setAdvertisementArray(arrayOfWebPImages);\r\n         */\r\n        setAdvertisementArray: function(arrayOfWebPImages) {\r\n            config.advertisement = [];\r\n\r\n            var length = arrayOfWebPImages.length;\r\n            for (var i = 0; i < length; i++) {\r\n                config.advertisement.push({\r\n                    duration: i,\r\n                    image: arrayOfWebPImages[i]\r\n                });\r\n            }\r\n        },\r\n\r\n        /**\r\n         * It is equivalent to <code class=\"str\">\"recorder.getBlob()\"</code> method. Usage of \"getBlob\" is recommended, though.\r\n         * @property {Blob} blob - Recorded Blob can be accessed using this property.\r\n         * @memberof RecordRTC\r\n         * @instance\r\n         * @readonly\r\n         * @example\r\n         * recorder.stopRecording(function() {\r\n         *     var blob = this.blob;\r\n         *\r\n         *     // below one is recommended\r\n         *     var blob = this.getBlob();\r\n         * });\r\n         */\r\n        blob: null,\r\n\r\n        /**\r\n         * This works only with {recorderType:StereoAudioRecorder}. Use this property on \"stopRecording\" to verify the encoder's sample-rates.\r\n         * @property {number} bufferSize - Buffer-size used to encode the WAV container\r\n         * @memberof RecordRTC\r\n         * @instance\r\n         * @readonly\r\n         * @example\r\n         * recorder.stopRecording(function() {\r\n         *     alert('Recorder used this buffer-size: ' + this.bufferSize);\r\n         * });\r\n         */\r\n        bufferSize: 0,\r\n\r\n        /**\r\n         * This works only with {recorderType:StereoAudioRecorder}. Use this property on \"stopRecording\" to verify the encoder's sample-rates.\r\n         * @property {number} sampleRate - Sample-rates used to encode the WAV container\r\n         * @memberof RecordRTC\r\n         * @instance\r\n         * @readonly\r\n         * @example\r\n         * recorder.stopRecording(function() {\r\n         *     alert('Recorder used these sample-rates: ' + this.sampleRate);\r\n         * });\r\n         */\r\n        sampleRate: 0,\r\n\r\n        /**\r\n         * {recorderType:StereoAudioRecorder} returns ArrayBuffer object.\r\n         * @property {ArrayBuffer} buffer - Audio ArrayBuffer, supported only in Chrome.\r\n         * @memberof RecordRTC\r\n         * @instance\r\n         * @readonly\r\n         * @example\r\n         * recorder.stopRecording(function() {\r\n         *     var arrayBuffer = this.buffer;\r\n         *     alert(arrayBuffer.byteLength);\r\n         * });\r\n         */\r\n        buffer: null,\r\n\r\n        /**\r\n         * This method resets the recorder. So that you can reuse single recorder instance many times.\r\n         * @method\r\n         * @memberof RecordRTC\r\n         * @instance\r\n         * @example\r\n         * recorder.reset();\r\n         * recorder.startRecording();\r\n         */\r\n        reset: function() {\r\n            if (self.state === 'recording' && !config.disableLogs) {\r\n                console.warn('Stop an active recorder.');\r\n            }\r\n\r\n            if (mediaRecorder && typeof mediaRecorder.clearRecordedData === 'function') {\r\n                mediaRecorder.clearRecordedData();\r\n            }\r\n            mediaRecorder = null;\r\n            setState('inactive');\r\n            self.blob = null;\r\n        },\r\n\r\n        /**\r\n         * This method is called whenever recorder's state changes. Use this as an \"event\".\r\n         * @property {String} state - A recorder's state can be: recording, paused, stopped or inactive.\r\n         * @method\r\n         * @memberof RecordRTC\r\n         * @instance\r\n         * @example\r\n         * recorder.onStateChanged = function(state) {\r\n         *     console.log('Recorder state: ', state);\r\n         * };\r\n         */\r\n        onStateChanged: function(state) {\r\n            if (!config.disableLogs) {\r\n                console.log('Recorder state changed:', state);\r\n            }\r\n        },\r\n\r\n        /**\r\n         * A recorder can have inactive, recording, paused or stopped states.\r\n         * @property {String} state - A recorder's state can be: recording, paused, stopped or inactive.\r\n         * @memberof RecordRTC\r\n         * @static\r\n         * @readonly\r\n         * @example\r\n         * // this looper function will keep you updated about the recorder's states.\r\n         * (function looper() {\r\n         *     document.querySelector('h1').innerHTML = 'Recorder\\'s state is: ' + recorder.state;\r\n         *     if(recorder.state === 'stopped') return; // ignore+stop\r\n         *     setTimeout(looper, 1000); // update after every 3-seconds\r\n         * })();\r\n         * recorder.startRecording();\r\n         */\r\n        state: 'inactive',\r\n\r\n        /**\r\n         * Get recorder's readonly state.\r\n         * @method\r\n         * @memberof RecordRTC\r\n         * @example\r\n         * var state = recorder.getState();\r\n         * @returns {String} Returns recording state.\r\n         */\r\n        getState: function() {\r\n            return self.state;\r\n        },\r\n\r\n        /**\r\n         * Destroy RecordRTC instance. Clear all recorders and objects.\r\n         * @method\r\n         * @memberof RecordRTC\r\n         * @example\r\n         * recorder.destroy();\r\n         */\r\n        destroy: function() {\r\n            var disableLogsCache = config.disableLogs;\r\n\r\n            config = {\r\n                disableLogs: true\r\n            };\r\n            self.reset();\r\n            setState('destroyed');\r\n            returnObject = self = null;\r\n\r\n            if (Storage.AudioContextConstructor) {\r\n                Storage.AudioContextConstructor.close();\r\n                Storage.AudioContextConstructor = null;\r\n            }\r\n\r\n            config.disableLogs = disableLogsCache;\r\n\r\n            if (!config.disableLogs) {\r\n                console.log('RecordRTC is destroyed.');\r\n            }\r\n        },\r\n\r\n        /**\r\n         * RecordRTC version number\r\n         * @property {String} version - Release version number.\r\n         * @memberof RecordRTC\r\n         * @static\r\n         * @readonly\r\n         * @example\r\n         * alert(recorder.version);\r\n         */\r\n        version: '5.6.2'\r\n    };\r\n\r\n    if (!this) {\r\n        self = returnObject;\r\n        return returnObject;\r\n    }\r\n\r\n    // if someone wants to use RecordRTC with the \"new\" keyword.\r\n    for (var prop in returnObject) {\r\n        this[prop] = returnObject[prop];\r\n    }\r\n\r\n    self = this;\r\n\r\n    return returnObject;\r\n}\r\n\r\nRecordRTC.version = '5.6.2';\r\n\r\nif (typeof module !== 'undefined' /* && !!module.exports*/ ) {\r\n    module.exports = RecordRTC;\r\n}\r\n\r\nif (typeof define === 'function' && define.amd) {\r\n    define('RecordRTC', [], function() {\r\n        return RecordRTC;\r\n    });\r\n}\n\r\nRecordRTC.getFromDisk = function(type, callback) {\r\n    if (!callback) {\r\n        throw 'callback is mandatory.';\r\n    }\r\n\r\n    console.log('Getting recorded ' + (type === 'all' ? 'blobs' : type + ' blob ') + ' from disk!');\r\n    DiskStorage.Fetch(function(dataURL, _type) {\r\n        if (type !== 'all' && _type === type + 'Blob' && callback) {\r\n            callback(dataURL);\r\n        }\r\n\r\n        if (type === 'all' && callback) {\r\n            callback(dataURL, _type.replace('Blob', ''));\r\n        }\r\n    });\r\n};\r\n\r\n/**\r\n * This method can be used to store recorded blobs into IndexedDB storage.\r\n * @param {object} options - {audio: Blob, video: Blob, gif: Blob}\r\n * @method\r\n * @memberof RecordRTC\r\n * @example\r\n * RecordRTC.writeToDisk({\r\n *     audio: audioBlob,\r\n *     video: videoBlob,\r\n *     gif  : gifBlob\r\n * });\r\n */\r\nRecordRTC.writeToDisk = function(options) {\r\n    console.log('Writing recorded blob(s) to disk!');\r\n    options = options || {};\r\n    if (options.audio && options.video && options.gif) {\r\n        options.audio.getDataURL(function(audioDataURL) {\r\n            options.video.getDataURL(function(videoDataURL) {\r\n                options.gif.getDataURL(function(gifDataURL) {\r\n                    DiskStorage.Store({\r\n                        audioBlob: audioDataURL,\r\n                        videoBlob: videoDataURL,\r\n                        gifBlob: gifDataURL\r\n                    });\r\n                });\r\n            });\r\n        });\r\n    } else if (options.audio && options.video) {\r\n        options.audio.getDataURL(function(audioDataURL) {\r\n            options.video.getDataURL(function(videoDataURL) {\r\n                DiskStorage.Store({\r\n                    audioBlob: audioDataURL,\r\n                    videoBlob: videoDataURL\r\n                });\r\n            });\r\n        });\r\n    } else if (options.audio && options.gif) {\r\n        options.audio.getDataURL(function(audioDataURL) {\r\n            options.gif.getDataURL(function(gifDataURL) {\r\n                DiskStorage.Store({\r\n                    audioBlob: audioDataURL,\r\n                    gifBlob: gifDataURL\r\n                });\r\n            });\r\n        });\r\n    } else if (options.video && options.gif) {\r\n        options.video.getDataURL(function(videoDataURL) {\r\n            options.gif.getDataURL(function(gifDataURL) {\r\n                DiskStorage.Store({\r\n                    videoBlob: videoDataURL,\r\n                    gifBlob: gifDataURL\r\n                });\r\n            });\r\n        });\r\n    } else if (options.audio) {\r\n        options.audio.getDataURL(function(audioDataURL) {\r\n            DiskStorage.Store({\r\n                audioBlob: audioDataURL\r\n            });\r\n        });\r\n    } else if (options.video) {\r\n        options.video.getDataURL(function(videoDataURL) {\r\n            DiskStorage.Store({\r\n                videoBlob: videoDataURL\r\n            });\r\n        });\r\n    } else if (options.gif) {\r\n        options.gif.getDataURL(function(gifDataURL) {\r\n            DiskStorage.Store({\r\n                gifBlob: gifDataURL\r\n            });\r\n        });\r\n    }\r\n};\n\r\n// __________________________\r\n// RecordRTC-Configuration.js\r\n\r\n/**\r\n * {@link RecordRTCConfiguration} is an inner/private helper for {@link RecordRTC}.\r\n * @summary It configures the 2nd parameter passed over {@link RecordRTC} and returns a valid \"config\" object.\r\n * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}\r\n * @author {@link https://MuazKhan.com|Muaz Khan}\r\n * @typedef RecordRTCConfiguration\r\n * @class\r\n * @example\r\n * var options = RecordRTCConfiguration(mediaStream, options);\r\n * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}\r\n * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.\r\n * @param {object} config - {type:\"video\", disableLogs: true, numberOfAudioChannels: 1, bufferSize: 0, sampleRate: 0, video: HTMLVideoElement, getNativeBlob:true, etc.}\r\n */\r\n\r\nfunction RecordRTCConfiguration(mediaStream, config) {\r\n    if (!config.recorderType && !config.type) {\r\n        if (!!config.audio && !!config.video) {\r\n            config.type = 'video';\r\n        } else if (!!config.audio && !config.video) {\r\n            config.type = 'audio';\r\n        }\r\n    }\r\n\r\n    if (config.recorderType && !config.type) {\r\n        if (config.recorderType === WhammyRecorder || config.recorderType === CanvasRecorder || (typeof WebAssemblyRecorder !== 'undefined' && config.recorderType === WebAssemblyRecorder)) {\r\n            config.type = 'video';\r\n        } else if (config.recorderType === GifRecorder) {\r\n            config.type = 'gif';\r\n        } else if (config.recorderType === StereoAudioRecorder) {\r\n            config.type = 'audio';\r\n        } else if (config.recorderType === MediaStreamRecorder) {\r\n            if (getTracks(mediaStream, 'audio').length && getTracks(mediaStream, 'video').length) {\r\n                config.type = 'video';\r\n            } else if (!getTracks(mediaStream, 'audio').length && getTracks(mediaStream, 'video').length) {\r\n                config.type = 'video';\r\n            } else if (getTracks(mediaStream, 'audio').length && !getTracks(mediaStream, 'video').length) {\r\n                config.type = 'audio';\r\n            } else {\r\n                // config.type = 'UnKnown';\r\n            }\r\n        }\r\n    }\r\n\r\n    if (typeof MediaStreamRecorder !== 'undefined' && typeof MediaRecorder !== 'undefined' && 'requestData' in MediaRecorder.prototype) {\r\n        if (!config.mimeType) {\r\n            config.mimeType = 'video/webm';\r\n        }\r\n\r\n        if (!config.type) {\r\n            config.type = config.mimeType.split('/')[0];\r\n        }\r\n\r\n        if (!config.bitsPerSecond) {\r\n            // config.bitsPerSecond = 128000;\r\n        }\r\n    }\r\n\r\n    // consider default type=audio\r\n    if (!config.type) {\r\n        if (config.mimeType) {\r\n            config.type = config.mimeType.split('/')[0];\r\n        }\r\n        if (!config.type) {\r\n            config.type = 'audio';\r\n        }\r\n    }\r\n\r\n    return config;\r\n}\n\r\n// __________________\r\n// GetRecorderType.js\r\n\r\n/**\r\n * {@link GetRecorderType} is an inner/private helper for {@link RecordRTC}.\r\n * @summary It returns best recorder-type available for your browser.\r\n * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}\r\n * @author {@link https://MuazKhan.com|Muaz Khan}\r\n * @typedef GetRecorderType\r\n * @class\r\n * @example\r\n * var RecorderType = GetRecorderType(options);\r\n * var recorder = new RecorderType(options);\r\n * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}\r\n * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.\r\n * @param {object} config - {type:\"video\", disableLogs: true, numberOfAudioChannels: 1, bufferSize: 0, sampleRate: 0, video: HTMLVideoElement, etc.}\r\n */\r\n\r\nfunction GetRecorderType(mediaStream, config) {\r\n    var recorder;\r\n\r\n    // StereoAudioRecorder can work with all three: Edge, Firefox and Chrome\r\n    // todo: detect if it is Edge, then auto use: StereoAudioRecorder\r\n    if (isChrome || isEdge || isOpera) {\r\n        // Media Stream Recording API has not been implemented in chrome yet;\r\n        // That's why using WebAudio API to record stereo audio in WAV format\r\n        recorder = StereoAudioRecorder;\r\n    }\r\n\r\n    if (typeof MediaRecorder !== 'undefined' && 'requestData' in MediaRecorder.prototype && !isChrome) {\r\n        recorder = MediaStreamRecorder;\r\n    }\r\n\r\n    // video recorder (in WebM format)\r\n    if (config.type === 'video' && (isChrome || isOpera)) {\r\n        recorder = WhammyRecorder;\r\n\r\n        if (typeof WebAssemblyRecorder !== 'undefined' && typeof ReadableStream !== 'undefined') {\r\n            recorder = WebAssemblyRecorder;\r\n        }\r\n    }\r\n\r\n    // video recorder (in Gif format)\r\n    if (config.type === 'gif') {\r\n        recorder = GifRecorder;\r\n    }\r\n\r\n    // html2canvas recording!\r\n    if (config.type === 'canvas') {\r\n        recorder = CanvasRecorder;\r\n    }\r\n\r\n    if (isMediaRecorderCompatible() && recorder !== CanvasRecorder && recorder !== GifRecorder && typeof MediaRecorder !== 'undefined' && 'requestData' in MediaRecorder.prototype) {\r\n        if (getTracks(mediaStream, 'video').length || getTracks(mediaStream, 'audio').length) {\r\n            // audio-only recording\r\n            if (config.type === 'audio') {\r\n                if (typeof MediaRecorder.isTypeSupported === 'function' && MediaRecorder.isTypeSupported('audio/webm')) {\r\n                    recorder = MediaStreamRecorder;\r\n                }\r\n                // else recorder = StereoAudioRecorder;\r\n            } else {\r\n                // video or screen tracks\r\n                if (typeof MediaRecorder.isTypeSupported === 'function' && MediaRecorder.isTypeSupported('video/webm')) {\r\n                    recorder = MediaStreamRecorder;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    if (mediaStream instanceof Array && mediaStream.length) {\r\n        recorder = MultiStreamRecorder;\r\n    }\r\n\r\n    if (config.recorderType) {\r\n        recorder = config.recorderType;\r\n    }\r\n\r\n    if (!config.disableLogs && !!recorder && !!recorder.name) {\r\n        console.log('Using recorderType:', recorder.name || recorder.constructor.name);\r\n    }\r\n\r\n    if (!recorder && isSafari) {\r\n        recorder = MediaStreamRecorder;\r\n    }\r\n\r\n    return recorder;\r\n}\n\r\n// _____________\r\n// MRecordRTC.js\r\n\r\n/**\r\n * MRecordRTC runs on top of {@link RecordRTC} to bring multiple recordings in a single place, by providing simple API.\r\n * @summary MRecordRTC stands for \"Multiple-RecordRTC\".\r\n * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}\r\n * @author {@link https://MuazKhan.com|Muaz Khan}\r\n * @typedef MRecordRTC\r\n * @class\r\n * @example\r\n * var recorder = new MRecordRTC();\r\n * recorder.addStream(MediaStream);\r\n * recorder.mediaType = {\r\n *     audio: true, // or StereoAudioRecorder or MediaStreamRecorder\r\n *     video: true, // or WhammyRecorder or MediaStreamRecorder or WebAssemblyRecorder or CanvasRecorder\r\n *     gif: true    // or GifRecorder\r\n * };\r\n * // mimeType is optional and should be set only in advance cases.\r\n * recorder.mimeType = {\r\n *     audio: 'audio/wav',\r\n *     video: 'video/webm',\r\n *     gif:   'image/gif'\r\n * };\r\n * recorder.startRecording();\r\n * @see For further information:\r\n * @see {@link https://github.com/muaz-khan/RecordRTC/tree/master/MRecordRTC|MRecordRTC Source Code}\r\n * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.\r\n * @requires {@link RecordRTC}\r\n */\r\n\r\nfunction MRecordRTC(mediaStream) {\r\n\r\n    /**\r\n     * This method attaches MediaStream object to {@link MRecordRTC}.\r\n     * @param {MediaStream} mediaStream - A MediaStream object, either fetched using getUserMedia API, or generated using captureStreamUntilEnded or WebAudio API.\r\n     * @method\r\n     * @memberof MRecordRTC\r\n     * @example\r\n     * recorder.addStream(MediaStream);\r\n     */\r\n    this.addStream = function(_mediaStream) {\r\n        if (_mediaStream) {\r\n            mediaStream = _mediaStream;\r\n        }\r\n    };\r\n\r\n    /**\r\n     * This property can be used to set the recording type e.g. audio, or video, or gif, or canvas.\r\n     * @property {object} mediaType - {audio: true, video: true, gif: true}\r\n     * @memberof MRecordRTC\r\n     * @example\r\n     * var recorder = new MRecordRTC();\r\n     * recorder.mediaType = {\r\n     *     audio: true, // TRUE or StereoAudioRecorder or MediaStreamRecorder\r\n     *     video: true, // TRUE or WhammyRecorder or MediaStreamRecorder or WebAssemblyRecorder or CanvasRecorder\r\n     *     gif  : true  // TRUE or GifRecorder\r\n     * };\r\n     */\r\n    this.mediaType = {\r\n        audio: true,\r\n        video: true\r\n    };\r\n\r\n    /**\r\n     * This method starts recording.\r\n     * @method\r\n     * @memberof MRecordRTC\r\n     * @example\r\n     * recorder.startRecording();\r\n     */\r\n    this.startRecording = function() {\r\n        var mediaType = this.mediaType;\r\n        var recorderType;\r\n        var mimeType = this.mimeType || {\r\n            audio: null,\r\n            video: null,\r\n            gif: null\r\n        };\r\n\r\n        if (typeof mediaType.audio !== 'function' && isMediaRecorderCompatible() && !getTracks(mediaStream, 'audio').length) {\r\n            mediaType.audio = false;\r\n        }\r\n\r\n        if (typeof mediaType.video !== 'function' && isMediaRecorderCompatible() && !getTracks(mediaStream, 'video').length) {\r\n            mediaType.video = false;\r\n        }\r\n\r\n        if (typeof mediaType.gif !== 'function' && isMediaRecorderCompatible() && !getTracks(mediaStream, 'video').length) {\r\n            mediaType.gif = false;\r\n        }\r\n\r\n        if (!mediaType.audio && !mediaType.video && !mediaType.gif) {\r\n            throw 'MediaStream must have either audio or video tracks.';\r\n        }\r\n\r\n        if (!!mediaType.audio) {\r\n            recorderType = null;\r\n            if (typeof mediaType.audio === 'function') {\r\n                recorderType = mediaType.audio;\r\n            }\r\n\r\n            this.audioRecorder = new RecordRTC(mediaStream, {\r\n                type: 'audio',\r\n                bufferSize: this.bufferSize,\r\n                sampleRate: this.sampleRate,\r\n                numberOfAudioChannels: this.numberOfAudioChannels || 2,\r\n                disableLogs: this.disableLogs,\r\n                recorderType: recorderType,\r\n                mimeType: mimeType.audio,\r\n                timeSlice: this.timeSlice,\r\n                onTimeStamp: this.onTimeStamp\r\n            });\r\n\r\n            if (!mediaType.video) {\r\n                this.audioRecorder.startRecording();\r\n            }\r\n        }\r\n\r\n        if (!!mediaType.video) {\r\n            recorderType = null;\r\n            if (typeof mediaType.video === 'function') {\r\n                recorderType = mediaType.video;\r\n            }\r\n\r\n            var newStream = mediaStream;\r\n\r\n            if (isMediaRecorderCompatible() && !!mediaType.audio && typeof mediaType.audio === 'function') {\r\n                var videoTrack = getTracks(mediaStream, 'video')[0];\r\n\r\n                if (isFirefox) {\r\n                    newStream = new MediaStream();\r\n                    newStream.addTrack(videoTrack);\r\n\r\n                    if (recorderType && recorderType === WhammyRecorder) {\r\n                        // Firefox does NOT supports webp-encoding yet\r\n                        // But Firefox do supports WebAssemblyRecorder\r\n                        recorderType = MediaStreamRecorder;\r\n                    }\r\n                } else {\r\n                    newStream = new MediaStream();\r\n                    newStream.addTrack(videoTrack);\r\n                }\r\n            }\r\n\r\n            this.videoRecorder = new RecordRTC(newStream, {\r\n                type: 'video',\r\n                video: this.video,\r\n                canvas: this.canvas,\r\n                frameInterval: this.frameInterval || 10,\r\n                disableLogs: this.disableLogs,\r\n                recorderType: recorderType,\r\n                mimeType: mimeType.video,\r\n                timeSlice: this.timeSlice,\r\n                onTimeStamp: this.onTimeStamp,\r\n                workerPath: this.workerPath,\r\n                webAssemblyPath: this.webAssemblyPath,\r\n                frameRate: this.frameRate, // used by WebAssemblyRecorder; values: usually 30; accepts any.\r\n                bitrate: this.bitrate // used by WebAssemblyRecorder; values: 0 to 1000+\r\n            });\r\n\r\n            if (!mediaType.audio) {\r\n                this.videoRecorder.startRecording();\r\n            }\r\n        }\r\n\r\n        if (!!mediaType.audio && !!mediaType.video) {\r\n            var self = this;\r\n\r\n            var isSingleRecorder = isMediaRecorderCompatible() === true;\r\n\r\n            if (mediaType.audio instanceof StereoAudioRecorder && !!mediaType.video) {\r\n                isSingleRecorder = false;\r\n            } else if (mediaType.audio !== true && mediaType.video !== true && mediaType.audio !== mediaType.video) {\r\n                isSingleRecorder = false;\r\n            }\r\n\r\n            if (isSingleRecorder === true) {\r\n                self.audioRecorder = null;\r\n                self.videoRecorder.startRecording();\r\n            } else {\r\n                self.videoRecorder.initRecorder(function() {\r\n                    self.audioRecorder.initRecorder(function() {\r\n                        // Both recorders are ready to record things accurately\r\n                        self.videoRecorder.startRecording();\r\n                        self.audioRecorder.startRecording();\r\n                    });\r\n                });\r\n            }\r\n        }\r\n\r\n        if (!!mediaType.gif) {\r\n            recorderType = null;\r\n            if (typeof mediaType.gif === 'function') {\r\n                recorderType = mediaType.gif;\r\n            }\r\n            this.gifRecorder = new RecordRTC(mediaStream, {\r\n                type: 'gif',\r\n                frameRate: this.frameRate || 200,\r\n                quality: this.quality || 10,\r\n                disableLogs: this.disableLogs,\r\n                recorderType: recorderType,\r\n                mimeType: mimeType.gif\r\n            });\r\n            this.gifRecorder.startRecording();\r\n        }\r\n    };\r\n\r\n    /**\r\n     * This method stops recording.\r\n     * @param {function} callback - Callback function is invoked when all encoders finished their jobs.\r\n     * @method\r\n     * @memberof MRecordRTC\r\n     * @example\r\n     * recorder.stopRecording(function(recording){\r\n     *     var audioBlob = recording.audio;\r\n     *     var videoBlob = recording.video;\r\n     *     var gifBlob   = recording.gif;\r\n     * });\r\n     */\r\n    this.stopRecording = function(callback) {\r\n        callback = callback || function() {};\r\n\r\n        if (this.audioRecorder) {\r\n            this.audioRecorder.stopRecording(function(blobURL) {\r\n                callback(blobURL, 'audio');\r\n            });\r\n        }\r\n\r\n        if (this.videoRecorder) {\r\n            this.videoRecorder.stopRecording(function(blobURL) {\r\n                callback(blobURL, 'video');\r\n            });\r\n        }\r\n\r\n        if (this.gifRecorder) {\r\n            this.gifRecorder.stopRecording(function(blobURL) {\r\n                callback(blobURL, 'gif');\r\n            });\r\n        }\r\n    };\r\n\r\n    /**\r\n     * This method pauses recording.\r\n     * @method\r\n     * @memberof MRecordRTC\r\n     * @example\r\n     * recorder.pauseRecording();\r\n     */\r\n    this.pauseRecording = function() {\r\n        if (this.audioRecorder) {\r\n            this.audioRecorder.pauseRecording();\r\n        }\r\n\r\n        if (this.videoRecorder) {\r\n            this.videoRecorder.pauseRecording();\r\n        }\r\n\r\n        if (this.gifRecorder) {\r\n            this.gifRecorder.pauseRecording();\r\n        }\r\n    };\r\n\r\n    /**\r\n     * This method resumes recording.\r\n     * @method\r\n     * @memberof MRecordRTC\r\n     * @example\r\n     * recorder.resumeRecording();\r\n     */\r\n    this.resumeRecording = function() {\r\n        if (this.audioRecorder) {\r\n            this.audioRecorder.resumeRecording();\r\n        }\r\n\r\n        if (this.videoRecorder) {\r\n            this.videoRecorder.resumeRecording();\r\n        }\r\n\r\n        if (this.gifRecorder) {\r\n            this.gifRecorder.resumeRecording();\r\n        }\r\n    };\r\n\r\n    /**\r\n     * This method can be used to manually get all recorded blobs.\r\n     * @param {function} callback - All recorded blobs are passed back to the \"callback\" function.\r\n     * @method\r\n     * @memberof MRecordRTC\r\n     * @example\r\n     * recorder.getBlob(function(recording){\r\n     *     var audioBlob = recording.audio;\r\n     *     var videoBlob = recording.video;\r\n     *     var gifBlob   = recording.gif;\r\n     * });\r\n     * // or\r\n     * var audioBlob = recorder.getBlob().audio;\r\n     * var videoBlob = recorder.getBlob().video;\r\n     */\r\n    this.getBlob = function(callback) {\r\n        var output = {};\r\n\r\n        if (this.audioRecorder) {\r\n            output.audio = this.audioRecorder.getBlob();\r\n        }\r\n\r\n        if (this.videoRecorder) {\r\n            output.video = this.videoRecorder.getBlob();\r\n        }\r\n\r\n        if (this.gifRecorder) {\r\n            output.gif = this.gifRecorder.getBlob();\r\n        }\r\n\r\n        if (callback) {\r\n            callback(output);\r\n        }\r\n\r\n        return output;\r\n    };\r\n\r\n    /**\r\n     * Destroy all recorder instances.\r\n     * @method\r\n     * @memberof MRecordRTC\r\n     * @example\r\n     * recorder.destroy();\r\n     */\r\n    this.destroy = function() {\r\n        if (this.audioRecorder) {\r\n            this.audioRecorder.destroy();\r\n            this.audioRecorder = null;\r\n        }\r\n\r\n        if (this.videoRecorder) {\r\n            this.videoRecorder.destroy();\r\n            this.videoRecorder = null;\r\n        }\r\n\r\n        if (this.gifRecorder) {\r\n            this.gifRecorder.destroy();\r\n            this.gifRecorder = null;\r\n        }\r\n    };\r\n\r\n    /**\r\n     * This method can be used to manually get all recorded blobs' DataURLs.\r\n     * @param {function} callback - All recorded blobs' DataURLs are passed back to the \"callback\" function.\r\n     * @method\r\n     * @memberof MRecordRTC\r\n     * @example\r\n     * recorder.getDataURL(function(recording){\r\n     *     var audioDataURL = recording.audio;\r\n     *     var videoDataURL = recording.video;\r\n     *     var gifDataURL   = recording.gif;\r\n     * });\r\n     */\r\n    this.getDataURL = function(callback) {\r\n        this.getBlob(function(blob) {\r\n            if (blob.audio && blob.video) {\r\n                getDataURL(blob.audio, function(_audioDataURL) {\r\n                    getDataURL(blob.video, function(_videoDataURL) {\r\n                        callback({\r\n                            audio: _audioDataURL,\r\n                            video: _videoDataURL\r\n                        });\r\n                    });\r\n                });\r\n            } else if (blob.audio) {\r\n                getDataURL(blob.audio, function(_audioDataURL) {\r\n                    callback({\r\n                        audio: _audioDataURL\r\n                    });\r\n                });\r\n            } else if (blob.video) {\r\n                getDataURL(blob.video, function(_videoDataURL) {\r\n                    callback({\r\n                        video: _videoDataURL\r\n                    });\r\n                });\r\n            }\r\n        });\r\n\r\n        function getDataURL(blob, callback00) {\r\n            if (typeof Worker !== 'undefined') {\r\n                var webWorker = processInWebWorker(function readFile(_blob) {\r\n                    postMessage(new FileReaderSync().readAsDataURL(_blob));\r\n                });\r\n\r\n                webWorker.onmessage = function(event) {\r\n                    callback00(event.data);\r\n                };\r\n\r\n                webWorker.postMessage(blob);\r\n            } else {\r\n                var reader = new FileReader();\r\n                reader.readAsDataURL(blob);\r\n                reader.onload = function(event) {\r\n                    callback00(event.target.result);\r\n                };\r\n            }\r\n        }\r\n\r\n        function processInWebWorker(_function) {\r\n            var blob = URL.createObjectURL(new Blob([_function.toString(),\r\n                'this.onmessage =  function (eee) {' + _function.name + '(eee.data);}'\r\n            ], {\r\n                type: 'application/javascript'\r\n            }));\r\n\r\n            var worker = new Worker(blob);\r\n            var url;\r\n            if (typeof URL !== 'undefined') {\r\n                url = URL;\r\n            } else if (typeof webkitURL !== 'undefined') {\r\n                url = webkitURL;\r\n            } else {\r\n                throw 'Neither URL nor webkitURL detected.';\r\n            }\r\n            url.revokeObjectURL(blob);\r\n            return worker;\r\n        }\r\n    };\r\n\r\n    /**\r\n     * This method can be used to ask {@link MRecordRTC} to write all recorded blobs into IndexedDB storage.\r\n     * @method\r\n     * @memberof MRecordRTC\r\n     * @example\r\n     * recorder.writeToDisk();\r\n     */\r\n    this.writeToDisk = function() {\r\n        RecordRTC.writeToDisk({\r\n            audio: this.audioRecorder,\r\n            video: this.videoRecorder,\r\n            gif: this.gifRecorder\r\n        });\r\n    };\r\n\r\n    /**\r\n     * This method can be used to invoke a save-as dialog for all recorded blobs.\r\n     * @param {object} args - {audio: 'audio-name', video: 'video-name', gif: 'gif-name'}\r\n     * @method\r\n     * @memberof MRecordRTC\r\n     * @example\r\n     * recorder.save({\r\n     *     audio: 'audio-file-name',\r\n     *     video: 'video-file-name',\r\n     *     gif  : 'gif-file-name'\r\n     * });\r\n     */\r\n    this.save = function(args) {\r\n        args = args || {\r\n            audio: true,\r\n            video: true,\r\n            gif: true\r\n        };\r\n\r\n        if (!!args.audio && this.audioRecorder) {\r\n            this.audioRecorder.save(typeof args.audio === 'string' ? args.audio : '');\r\n        }\r\n\r\n        if (!!args.video && this.videoRecorder) {\r\n            this.videoRecorder.save(typeof args.video === 'string' ? args.video : '');\r\n        }\r\n        if (!!args.gif && this.gifRecorder) {\r\n            this.gifRecorder.save(typeof args.gif === 'string' ? args.gif : '');\r\n        }\r\n    };\r\n}\r\n\r\n/**\r\n * This method can be used to get all recorded blobs from IndexedDB storage.\r\n * @param {string} type - 'all' or 'audio' or 'video' or 'gif'\r\n * @param {function} callback - Callback function to get all stored blobs.\r\n * @method\r\n * @memberof MRecordRTC\r\n * @example\r\n * MRecordRTC.getFromDisk('all', function(dataURL, type){\r\n *     if(type === 'audio') { }\r\n *     if(type === 'video') { }\r\n *     if(type === 'gif')   { }\r\n * });\r\n */\r\nMRecordRTC.getFromDisk = RecordRTC.getFromDisk;\r\n\r\n/**\r\n * This method can be used to store recorded blobs into IndexedDB storage.\r\n * @param {object} options - {audio: Blob, video: Blob, gif: Blob}\r\n * @method\r\n * @memberof MRecordRTC\r\n * @example\r\n * MRecordRTC.writeToDisk({\r\n *     audio: audioBlob,\r\n *     video: videoBlob,\r\n *     gif  : gifBlob\r\n * });\r\n */\r\nMRecordRTC.writeToDisk = RecordRTC.writeToDisk;\r\n\r\nif (typeof RecordRTC !== 'undefined') {\r\n    RecordRTC.MRecordRTC = MRecordRTC;\r\n}\n\r\nvar browserFakeUserAgent = 'Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45';\r\n\r\n(function(that) {\r\n    if (!that) {\r\n        return;\r\n    }\r\n\r\n    if (typeof window !== 'undefined') {\r\n        return;\r\n    }\r\n\r\n    if (typeof global === 'undefined') {\r\n        return;\r\n    }\r\n\r\n    global.navigator = {\r\n        userAgent: browserFakeUserAgent,\r\n        getUserMedia: function() {}\r\n    };\r\n\r\n    if (!global.console) {\r\n        global.console = {};\r\n    }\r\n\r\n    if (typeof global.console.log === 'undefined' || typeof global.console.error === 'undefined') {\r\n        global.console.error = global.console.log = global.console.log || function() {\r\n            console.log(arguments);\r\n        };\r\n    }\r\n\r\n    if (typeof document === 'undefined') {\r\n        /*global document:true */\r\n        that.document = {\r\n            documentElement: {\r\n                appendChild: function() {\r\n                    return '';\r\n                }\r\n            }\r\n        };\r\n\r\n        document.createElement = document.captureStream = document.mozCaptureStream = function() {\r\n            var obj = {\r\n                getContext: function() {\r\n                    return obj;\r\n                },\r\n                play: function() {},\r\n                pause: function() {},\r\n                drawImage: function() {},\r\n                toDataURL: function() {\r\n                    return '';\r\n                },\r\n                style: {}\r\n            };\r\n            return obj;\r\n        };\r\n\r\n        that.HTMLVideoElement = function() {};\r\n    }\r\n\r\n    if (typeof location === 'undefined') {\r\n        /*global location:true */\r\n        that.location = {\r\n            protocol: 'file:',\r\n            href: '',\r\n            hash: ''\r\n        };\r\n    }\r\n\r\n    if (typeof screen === 'undefined') {\r\n        /*global screen:true */\r\n        that.screen = {\r\n            width: 0,\r\n            height: 0\r\n        };\r\n    }\r\n\r\n    if (typeof URL === 'undefined') {\r\n        /*global screen:true */\r\n        that.URL = {\r\n            createObjectURL: function() {\r\n                return '';\r\n            },\r\n            revokeObjectURL: function() {\r\n                return '';\r\n            }\r\n        };\r\n    }\r\n\r\n    /*global window:true */\r\n    that.window = global;\r\n})(typeof global !== 'undefined' ? global : null);\n\r\n// _____________________________\r\n// Cross-Browser-Declarations.js\r\n\r\n// animation-frame used in WebM recording\r\n\r\n/*jshint -W079 */\r\nvar requestAnimationFrame = window.requestAnimationFrame;\r\nif (typeof requestAnimationFrame === 'undefined') {\r\n    if (typeof webkitRequestAnimationFrame !== 'undefined') {\r\n        /*global requestAnimationFrame:true */\r\n        requestAnimationFrame = webkitRequestAnimationFrame;\r\n    } else if (typeof mozRequestAnimationFrame !== 'undefined') {\r\n        /*global requestAnimationFrame:true */\r\n        requestAnimationFrame = mozRequestAnimationFrame;\r\n    } else if (typeof msRequestAnimationFrame !== 'undefined') {\r\n        /*global requestAnimationFrame:true */\r\n        requestAnimationFrame = msRequestAnimationFrame;\r\n    } else if (typeof requestAnimationFrame === 'undefined') {\r\n        // via: https://gist.github.com/paulirish/1579671\r\n        var lastTime = 0;\r\n\r\n        /*global requestAnimationFrame:true */\r\n        requestAnimationFrame = function(callback, element) {\r\n            var currTime = new Date().getTime();\r\n            var timeToCall = Math.max(0, 16 - (currTime - lastTime));\r\n            var id = setTimeout(function() {\r\n                callback(currTime + timeToCall);\r\n            }, timeToCall);\r\n            lastTime = currTime + timeToCall;\r\n            return id;\r\n        };\r\n    }\r\n}\r\n\r\n/*jshint -W079 */\r\nvar cancelAnimationFrame = window.cancelAnimationFrame;\r\nif (typeof cancelAnimationFrame === 'undefined') {\r\n    if (typeof webkitCancelAnimationFrame !== 'undefined') {\r\n        /*global cancelAnimationFrame:true */\r\n        cancelAnimationFrame = webkitCancelAnimationFrame;\r\n    } else if (typeof mozCancelAnimationFrame !== 'undefined') {\r\n        /*global cancelAnimationFrame:true */\r\n        cancelAnimationFrame = mozCancelAnimationFrame;\r\n    } else if (typeof msCancelAnimationFrame !== 'undefined') {\r\n        /*global cancelAnimationFrame:true */\r\n        cancelAnimationFrame = msCancelAnimationFrame;\r\n    } else if (typeof cancelAnimationFrame === 'undefined') {\r\n        /*global cancelAnimationFrame:true */\r\n        cancelAnimationFrame = function(id) {\r\n            clearTimeout(id);\r\n        };\r\n    }\r\n}\r\n\r\n// WebAudio API representer\r\nvar AudioContext = window.AudioContext;\r\n\r\nif (typeof AudioContext === 'undefined') {\r\n    if (typeof webkitAudioContext !== 'undefined') {\r\n        /*global AudioContext:true */\r\n        AudioContext = webkitAudioContext;\r\n    }\r\n\r\n    if (typeof mozAudioContext !== 'undefined') {\r\n        /*global AudioContext:true */\r\n        AudioContext = mozAudioContext;\r\n    }\r\n}\r\n\r\n/*jshint -W079 */\r\nvar URL = window.URL;\r\n\r\nif (typeof URL === 'undefined' && typeof webkitURL !== 'undefined') {\r\n    /*global URL:true */\r\n    URL = webkitURL;\r\n}\r\n\r\nif (typeof navigator !== 'undefined' && typeof navigator.getUserMedia === 'undefined') { // maybe window.navigator?\r\n    if (typeof navigator.webkitGetUserMedia !== 'undefined') {\r\n        navigator.getUserMedia = navigator.webkitGetUserMedia;\r\n    }\r\n\r\n    if (typeof navigator.mozGetUserMedia !== 'undefined') {\r\n        navigator.getUserMedia = navigator.mozGetUserMedia;\r\n    }\r\n}\r\n\r\nvar isEdge = navigator.userAgent.indexOf('Edge') !== -1 && (!!navigator.msSaveBlob || !!navigator.msSaveOrOpenBlob);\r\nvar isOpera = !!window.opera || navigator.userAgent.indexOf('OPR/') !== -1;\r\nvar isFirefox = navigator.userAgent.toLowerCase().indexOf('firefox') > -1 && ('netscape' in window) && / rv:/.test(navigator.userAgent);\r\nvar isChrome = (!isOpera && !isEdge && !!navigator.webkitGetUserMedia) || isElectron() || navigator.userAgent.toLowerCase().indexOf('chrome/') !== -1;\r\n\r\nvar isSafari = /^((?!chrome|android).)*safari/i.test(navigator.userAgent);\r\n\r\nif (isSafari && !isChrome && navigator.userAgent.indexOf('CriOS') !== -1) {\r\n    isSafari = false;\r\n    isChrome = true;\r\n}\r\n\r\nvar MediaStream = window.MediaStream;\r\n\r\nif (typeof MediaStream === 'undefined' && typeof webkitMediaStream !== 'undefined') {\r\n    MediaStream = webkitMediaStream;\r\n}\r\n\r\n/*global MediaStream:true */\r\nif (typeof MediaStream !== 'undefined') {\r\n    // override \"stop\" method for all browsers\r\n    if (typeof MediaStream.prototype.stop === 'undefined') {\r\n        MediaStream.prototype.stop = function() {\r\n            this.getTracks().forEach(function(track) {\r\n                track.stop();\r\n            });\r\n        };\r\n    }\r\n}\r\n\r\n// below function via: http://goo.gl/B3ae8c\r\n/**\r\n * Return human-readable file size.\r\n * @param {number} bytes - Pass bytes and get formatted string.\r\n * @returns {string} - formatted string\r\n * @example\r\n * bytesToSize(1024*1024*5) === '5 GB'\r\n * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}\r\n */\r\nfunction bytesToSize(bytes) {\r\n    var k = 1000;\r\n    var sizes = ['Bytes', 'KB', 'MB', 'GB', 'TB'];\r\n    if (bytes === 0) {\r\n        return '0 Bytes';\r\n    }\r\n    var i = parseInt(Math.floor(Math.log(bytes) / Math.log(k)), 10);\r\n    return (bytes / Math.pow(k, i)).toPrecision(3) + ' ' + sizes[i];\r\n}\r\n\r\n/**\r\n * @param {Blob} file - File or Blob object. This parameter is required.\r\n * @param {string} fileName - Optional file name e.g. \"Recorded-Video.webm\"\r\n * @example\r\n * invokeSaveAsDialog(blob or file, [optional] fileName);\r\n * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}\r\n */\r\nfunction invokeSaveAsDialog(file, fileName) {\r\n    if (!file) {\r\n        throw 'Blob object is required.';\r\n    }\r\n\r\n    if (!file.type) {\r\n        try {\r\n            file.type = 'video/webm';\r\n        } catch (e) {}\r\n    }\r\n\r\n    var fileExtension = (file.type || 'video/webm').split('/')[1];\r\n    if (fileExtension.indexOf(';') !== -1) {\r\n        // extended mimetype, e.g. 'video/webm;codecs=vp8,opus'\r\n        fileExtension = fileExtension.split(';')[0];\r\n    }\r\n    if (fileName && fileName.indexOf('.') !== -1) {\r\n        var splitted = fileName.split('.');\r\n        fileName = splitted[0];\r\n        fileExtension = splitted[1];\r\n    }\r\n\r\n    var fileFullName = (fileName || (Math.round(Math.random() * 9999999999) + 888888888)) + '.' + fileExtension;\r\n\r\n    if (typeof navigator.msSaveOrOpenBlob !== 'undefined') {\r\n        return navigator.msSaveOrOpenBlob(file, fileFullName);\r\n    } else if (typeof navigator.msSaveBlob !== 'undefined') {\r\n        return navigator.msSaveBlob(file, fileFullName);\r\n    }\r\n\r\n    var hyperlink = document.createElement('a');\r\n    hyperlink.href = URL.createObjectURL(file);\r\n    hyperlink.download = fileFullName;\r\n\r\n    hyperlink.style = 'display:none;opacity:0;color:transparent;';\r\n    (document.body || document.documentElement).appendChild(hyperlink);\r\n\r\n    if (typeof hyperlink.click === 'function') {\r\n        hyperlink.click();\r\n    } else {\r\n        hyperlink.target = '_blank';\r\n        hyperlink.dispatchEvent(new MouseEvent('click', {\r\n            view: window,\r\n            bubbles: true,\r\n            cancelable: true\r\n        }));\r\n    }\r\n\r\n    URL.revokeObjectURL(hyperlink.href);\r\n}\r\n\r\n/**\r\n * from: https://github.com/cheton/is-electron/blob/master/index.js\r\n **/\r\nfunction isElectron() {\r\n    // Renderer process\r\n    if (typeof window !== 'undefined' && typeof window.process === 'object' && window.process.type === 'renderer') {\r\n        return true;\r\n    }\r\n\r\n    // Main process\r\n    if (typeof process !== 'undefined' && typeof process.versions === 'object' && !!process.versions.electron) {\r\n        return true;\r\n    }\r\n\r\n    // Detect the user agent when the `nodeIntegration` option is set to true\r\n    if (typeof navigator === 'object' && typeof navigator.userAgent === 'string' && navigator.userAgent.indexOf('Electron') >= 0) {\r\n        return true;\r\n    }\r\n\r\n    return false;\r\n}\r\n\r\nfunction getTracks(stream, kind) {\r\n    if (!stream || !stream.getTracks) {\r\n        return [];\r\n    }\r\n\r\n    return stream.getTracks().filter(function(t) {\r\n        return t.kind === (kind || 'audio');\r\n    });\r\n}\r\n\r\nfunction setSrcObject(stream, element) {\r\n    if ('srcObject' in element) {\r\n        element.srcObject = stream;\r\n    } else if ('mozSrcObject' in element) {\r\n        element.mozSrcObject = stream;\r\n    } else {\r\n        element.srcObject = stream;\r\n    }\r\n}\r\n\r\n/**\r\n * @param {Blob} file - File or Blob object.\r\n * @param {function} callback - Callback function.\r\n * @example\r\n * getSeekableBlob(blob or file, callback);\r\n * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}\r\n */\r\nfunction getSeekableBlob(inputBlob, callback) {\r\n    // EBML.js copyrights goes to: https://github.com/legokichi/ts-ebml\r\n    if (typeof EBML === 'undefined') {\r\n        throw new Error('Please link: https://www.webrtc-experiment.com/EBML.js');\r\n    }\r\n\r\n    var reader = new EBML.Reader();\r\n    var decoder = new EBML.Decoder();\r\n    var tools = EBML.tools;\r\n\r\n    var fileReader = new FileReader();\r\n    fileReader.onload = function(e) {\r\n        var ebmlElms = decoder.decode(this.result);\r\n        ebmlElms.forEach(function(element) {\r\n            reader.read(element);\r\n        });\r\n        reader.stop();\r\n        var refinedMetadataBuf = tools.makeMetadataSeekable(reader.metadatas, reader.duration, reader.cues);\r\n        var body = this.result.slice(reader.metadataSize);\r\n        var newBlob = new Blob([refinedMetadataBuf, body], {\r\n            type: 'video/webm'\r\n        });\r\n\r\n        callback(newBlob);\r\n    };\r\n    fileReader.readAsArrayBuffer(inputBlob);\r\n}\r\n\r\nif (typeof RecordRTC !== 'undefined') {\r\n    RecordRTC.invokeSaveAsDialog = invokeSaveAsDialog;\r\n    RecordRTC.getTracks = getTracks;\r\n    RecordRTC.getSeekableBlob = getSeekableBlob;\r\n    RecordRTC.bytesToSize = bytesToSize;\r\n    RecordRTC.isElectron = isElectron;\r\n}\r\n\r\n// __________ (used to handle stuff like http://goo.gl/xmE5eg) issue #129\r\n// Storage.js\r\n\r\n/**\r\n * Storage is a standalone object used by {@link RecordRTC} to store reusable objects e.g. \"new AudioContext\".\r\n * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}\r\n * @author {@link https://MuazKhan.com|Muaz Khan}\r\n * @example\r\n * Storage.AudioContext === webkitAudioContext\r\n * @property {webkitAudioContext} AudioContext - Keeps a reference to AudioContext object.\r\n * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}\r\n */\r\n\r\nvar Storage = {};\r\n\r\nif (typeof AudioContext !== 'undefined') {\r\n    Storage.AudioContext = AudioContext;\r\n} else if (typeof webkitAudioContext !== 'undefined') {\r\n    Storage.AudioContext = webkitAudioContext;\r\n}\r\n\r\nif (typeof RecordRTC !== 'undefined') {\r\n    RecordRTC.Storage = Storage;\r\n}\n\r\nfunction isMediaRecorderCompatible() {\r\n    if (isFirefox || isSafari || isEdge) {\r\n        return true;\r\n    }\r\n\r\n    var nVer = navigator.appVersion;\r\n    var nAgt = navigator.userAgent;\r\n    var fullVersion = '' + parseFloat(navigator.appVersion);\r\n    var majorVersion = parseInt(navigator.appVersion, 10);\r\n    var nameOffset, verOffset, ix;\r\n\r\n    if (isChrome || isOpera) {\r\n        verOffset = nAgt.indexOf('Chrome');\r\n        fullVersion = nAgt.substring(verOffset + 7);\r\n    }\r\n\r\n    // trim the fullVersion string at semicolon/space if present\r\n    if ((ix = fullVersion.indexOf(';')) !== -1) {\r\n        fullVersion = fullVersion.substring(0, ix);\r\n    }\r\n\r\n    if ((ix = fullVersion.indexOf(' ')) !== -1) {\r\n        fullVersion = fullVersion.substring(0, ix);\r\n    }\r\n\r\n    majorVersion = parseInt('' + fullVersion, 10);\r\n\r\n    if (isNaN(majorVersion)) {\r\n        fullVersion = '' + parseFloat(navigator.appVersion);\r\n        majorVersion = parseInt(navigator.appVersion, 10);\r\n    }\r\n\r\n    return majorVersion >= 49;\r\n}\n\r\n// ______________________\r\n// MediaStreamRecorder.js\r\n\r\n/**\r\n * MediaStreamRecorder is an abstraction layer for {@link https://w3c.github.io/mediacapture-record/MediaRecorder.html|MediaRecorder API}. It is used by {@link RecordRTC} to record MediaStream(s) in both Chrome and Firefox.\r\n * @summary Runs top over {@link https://w3c.github.io/mediacapture-record/MediaRecorder.html|MediaRecorder API}.\r\n * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}\r\n * @author {@link https://github.com/muaz-khan|Muaz Khan}\r\n * @typedef MediaStreamRecorder\r\n * @class\r\n * @example\r\n * var config = {\r\n *     mimeType: 'video/webm', // vp8, vp9, h264, mkv, opus/vorbis\r\n *     audioBitsPerSecond : 256 * 8 * 1024,\r\n *     videoBitsPerSecond : 256 * 8 * 1024,\r\n *     bitsPerSecond: 256 * 8 * 1024,  // if this is provided, skip above two\r\n *     checkForInactiveTracks: true,\r\n *     timeSlice: 1000, // concatenate intervals based blobs\r\n *     ondataavailable: function() {} // get intervals based blobs\r\n * }\r\n * var recorder = new MediaStreamRecorder(mediaStream, config);\r\n * recorder.record();\r\n * recorder.stop(function(blob) {\r\n *     video.src = URL.createObjectURL(blob);\r\n *\r\n *     // or\r\n *     var blob = recorder.blob;\r\n * });\r\n * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}\r\n * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.\r\n * @param {object} config - {disableLogs:true, initCallback: function, mimeType: \"video/webm\", timeSlice: 1000}\r\n * @throws Will throw an error if first argument \"MediaStream\" is missing. Also throws error if \"MediaRecorder API\" are not supported by the browser.\r\n */\r\n\r\nfunction MediaStreamRecorder(mediaStream, config) {\r\n    var self = this;\r\n\r\n    if (typeof mediaStream === 'undefined') {\r\n        throw 'First argument \"MediaStream\" is required.';\r\n    }\r\n\r\n    if (typeof MediaRecorder === 'undefined') {\r\n        throw 'Your browser does not support the Media Recorder API. Please try other modules e.g. WhammyRecorder or StereoAudioRecorder.';\r\n    }\r\n\r\n    config = config || {\r\n        // bitsPerSecond: 256 * 8 * 1024,\r\n        mimeType: 'video/webm'\r\n    };\r\n\r\n    if (config.type === 'audio') {\r\n        if (getTracks(mediaStream, 'video').length && getTracks(mediaStream, 'audio').length) {\r\n            var stream;\r\n            if (!!navigator.mozGetUserMedia) {\r\n                stream = new MediaStream();\r\n                stream.addTrack(getTracks(mediaStream, 'audio')[0]);\r\n            } else {\r\n                // webkitMediaStream\r\n                stream = new MediaStream(getTracks(mediaStream, 'audio'));\r\n            }\r\n            mediaStream = stream;\r\n        }\r\n\r\n        if (!config.mimeType || config.mimeType.toString().toLowerCase().indexOf('audio') === -1) {\r\n            config.mimeType = isChrome ? 'audio/webm' : 'audio/ogg';\r\n        }\r\n\r\n        if (config.mimeType && config.mimeType.toString().toLowerCase() !== 'audio/ogg' && !!navigator.mozGetUserMedia) {\r\n            // forcing better codecs on Firefox (via #166)\r\n            config.mimeType = 'audio/ogg';\r\n        }\r\n    }\r\n\r\n    var arrayOfBlobs = [];\r\n\r\n    /**\r\n     * This method returns array of blobs. Use only with \"timeSlice\". Its useful to preview recording anytime, without using the \"stop\" method.\r\n     * @method\r\n     * @memberof MediaStreamRecorder\r\n     * @example\r\n     * var arrayOfBlobs = recorder.getArrayOfBlobs();\r\n     * @returns {Array} Returns array of recorded blobs.\r\n     */\r\n    this.getArrayOfBlobs = function() {\r\n        return arrayOfBlobs;\r\n    };\r\n\r\n    /**\r\n     * This method records MediaStream.\r\n     * @method\r\n     * @memberof MediaStreamRecorder\r\n     * @example\r\n     * recorder.record();\r\n     */\r\n    this.record = function() {\r\n        // set defaults\r\n        self.blob = null;\r\n        self.clearRecordedData();\r\n        self.timestamps = [];\r\n        allStates = [];\r\n        arrayOfBlobs = [];\r\n\r\n        var recorderHints = config;\r\n\r\n        if (!config.disableLogs) {\r\n            console.log('Passing following config over MediaRecorder API.', recorderHints);\r\n        }\r\n\r\n        if (mediaRecorder) {\r\n            // mandatory to make sure Firefox doesn't fails to record streams 3-4 times without reloading the page.\r\n            mediaRecorder = null;\r\n        }\r\n\r\n        if (isChrome && !isMediaRecorderCompatible()) {\r\n            // to support video-only recording on stable\r\n            recorderHints = 'video/vp8';\r\n        }\r\n\r\n        if (typeof MediaRecorder.isTypeSupported === 'function' && recorderHints.mimeType) {\r\n            if (!MediaRecorder.isTypeSupported(recorderHints.mimeType)) {\r\n                if (!config.disableLogs) {\r\n                    console.warn('MediaRecorder API seems unable to record mimeType:', recorderHints.mimeType);\r\n                }\r\n\r\n                recorderHints.mimeType = config.type === 'audio' ? 'audio/webm' : 'video/webm';\r\n            }\r\n        }\r\n\r\n        // using MediaRecorder API here\r\n        try {\r\n            mediaRecorder = new MediaRecorder(mediaStream, recorderHints);\r\n\r\n            // reset\r\n            config.mimeType = recorderHints.mimeType;\r\n        } catch (e) {\r\n            // chrome-based fallback\r\n            mediaRecorder = new MediaRecorder(mediaStream);\r\n        }\r\n\r\n        // old hack?\r\n        if (recorderHints.mimeType && !MediaRecorder.isTypeSupported && 'canRecordMimeType' in mediaRecorder && mediaRecorder.canRecordMimeType(recorderHints.mimeType) === false) {\r\n            if (!config.disableLogs) {\r\n                console.warn('MediaRecorder API seems unable to record mimeType:', recorderHints.mimeType);\r\n            }\r\n        }\r\n\r\n        // Dispatching OnDataAvailable Handler\r\n        mediaRecorder.ondataavailable = function(e) {\r\n            if (e.data) {\r\n                allStates.push('ondataavailable: ' + bytesToSize(e.data.size));\r\n            }\r\n\r\n            if (typeof config.timeSlice === 'number') {\r\n                if (e.data && e.data.size) {\r\n                    arrayOfBlobs.push(e.data);\r\n                    updateTimeStamp();\r\n\r\n                    if (typeof config.ondataavailable === 'function') {\r\n                        // intervals based blobs\r\n                        var blob = config.getNativeBlob ? e.data : new Blob([e.data], {\r\n                            type: getMimeType(recorderHints)\r\n                        });\r\n                        config.ondataavailable(blob);\r\n                    }\r\n                }\r\n                return;\r\n            }\r\n\r\n            if (!e.data || !e.data.size || e.data.size < 100 || self.blob) {\r\n                // make sure that stopRecording always getting fired\r\n                // even if there is invalid data\r\n                if (self.recordingCallback) {\r\n                    self.recordingCallback(new Blob([], {\r\n                        type: getMimeType(recorderHints)\r\n                    }));\r\n                    self.recordingCallback = null;\r\n                }\r\n                return;\r\n            }\r\n\r\n            self.blob = config.getNativeBlob ? e.data : new Blob([e.data], {\r\n                type: getMimeType(recorderHints)\r\n            });\r\n\r\n            if (self.recordingCallback) {\r\n                self.recordingCallback(self.blob);\r\n                self.recordingCallback = null;\r\n            }\r\n        };\r\n\r\n        mediaRecorder.onstart = function() {\r\n            allStates.push('started');\r\n        };\r\n\r\n        mediaRecorder.onpause = function() {\r\n            allStates.push('paused');\r\n        };\r\n\r\n        mediaRecorder.onresume = function() {\r\n            allStates.push('resumed');\r\n        };\r\n\r\n        mediaRecorder.onstop = function() {\r\n            allStates.push('stopped');\r\n        };\r\n\r\n        mediaRecorder.onerror = function(error) {\r\n            if (!error) {\r\n                return;\r\n            }\r\n\r\n            if (!error.name) {\r\n                error.name = 'UnknownError';\r\n            }\r\n\r\n            allStates.push('error: ' + error);\r\n\r\n            if (!config.disableLogs) {\r\n                // via: https://w3c.github.io/mediacapture-record/MediaRecorder.html#exception-summary\r\n                if (error.name.toString().toLowerCase().indexOf('invalidstate') !== -1) {\r\n                    console.error('The MediaRecorder is not in a state in which the proposed operation is allowed to be executed.', error);\r\n                } else if (error.name.toString().toLowerCase().indexOf('notsupported') !== -1) {\r\n                    console.error('MIME type (', recorderHints.mimeType, ') is not supported.', error);\r\n                } else if (error.name.toString().toLowerCase().indexOf('security') !== -1) {\r\n                    console.error('MediaRecorder security error', error);\r\n                }\r\n\r\n                // older code below\r\n                else if (error.name === 'OutOfMemory') {\r\n                    console.error('The UA has exhaused the available memory. User agents SHOULD provide as much additional information as possible in the message attribute.', error);\r\n                } else if (error.name === 'IllegalStreamModification') {\r\n                    console.error('A modification to the stream has occurred that makes it impossible to continue recording. An example would be the addition of a Track while recording is occurring. User agents SHOULD provide as much additional information as possible in the message attribute.', error);\r\n                } else if (error.name === 'OtherRecordingError') {\r\n                    console.error('Used for an fatal error other than those listed above. User agents SHOULD provide as much additional information as possible in the message attribute.', error);\r\n                } else if (error.name === 'GenericError') {\r\n                    console.error('The UA cannot provide the codec or recording option that has been requested.', error);\r\n                } else {\r\n                    console.error('MediaRecorder Error', error);\r\n                }\r\n            }\r\n\r\n            (function(looper) {\r\n                if (!self.manuallyStopped && mediaRecorder && mediaRecorder.state === 'inactive') {\r\n                    delete config.timeslice;\r\n\r\n                    // 10 minutes, enough?\r\n                    mediaRecorder.start(10 * 60 * 1000);\r\n                    return;\r\n                }\r\n\r\n                setTimeout(looper, 1000);\r\n            })();\r\n\r\n            if (mediaRecorder.state !== 'inactive' && mediaRecorder.state !== 'stopped') {\r\n                mediaRecorder.stop();\r\n            }\r\n        };\r\n\r\n        if (typeof config.timeSlice === 'number') {\r\n            updateTimeStamp();\r\n            mediaRecorder.start(config.timeSlice);\r\n        } else {\r\n            // default is 60 minutes; enough?\r\n            // use config => {timeSlice: 1000} otherwise\r\n\r\n            mediaRecorder.start(3.6e+6);\r\n        }\r\n\r\n        if (config.initCallback) {\r\n            config.initCallback(); // old code\r\n        }\r\n    };\r\n\r\n    /**\r\n     * @property {Array} timestamps - Array of time stamps\r\n     * @memberof MediaStreamRecorder\r\n     * @example\r\n     * console.log(recorder.timestamps);\r\n     */\r\n    this.timestamps = [];\r\n\r\n    function updateTimeStamp() {\r\n        self.timestamps.push(new Date().getTime());\r\n\r\n        if (typeof config.onTimeStamp === 'function') {\r\n            config.onTimeStamp(self.timestamps[self.timestamps.length - 1], self.timestamps);\r\n        }\r\n    }\r\n\r\n    function getMimeType(secondObject) {\r\n        if (mediaRecorder && mediaRecorder.mimeType) {\r\n            return mediaRecorder.mimeType;\r\n        }\r\n\r\n        return secondObject.mimeType || 'video/webm';\r\n    }\r\n\r\n    /**\r\n     * This method stops recording MediaStream.\r\n     * @param {function} callback - Callback function, that is used to pass recorded blob back to the callee.\r\n     * @method\r\n     * @memberof MediaStreamRecorder\r\n     * @example\r\n     * recorder.stop(function(blob) {\r\n     *     video.src = URL.createObjectURL(blob);\r\n     * });\r\n     */\r\n    this.stop = function(callback) {\r\n        callback = callback || function() {};\r\n\r\n        self.manuallyStopped = true; // used inside the mediaRecorder.onerror\r\n\r\n        if (!mediaRecorder) {\r\n            return;\r\n        }\r\n\r\n        this.recordingCallback = callback;\r\n\r\n        if (mediaRecorder.state === 'recording') {\r\n            mediaRecorder.stop();\r\n        }\r\n\r\n        if (typeof config.timeSlice === 'number') {\r\n            setTimeout(function() {\r\n                self.blob = new Blob(arrayOfBlobs, {\r\n                    type: getMimeType(config)\r\n                });\r\n\r\n                self.recordingCallback(self.blob);\r\n            }, 100);\r\n        }\r\n    };\r\n\r\n    /**\r\n     * This method pauses the recording process.\r\n     * @method\r\n     * @memberof MediaStreamRecorder\r\n     * @example\r\n     * recorder.pause();\r\n     */\r\n    this.pause = function() {\r\n        if (!mediaRecorder) {\r\n            return;\r\n        }\r\n\r\n        if (mediaRecorder.state === 'recording') {\r\n            mediaRecorder.pause();\r\n        }\r\n    };\r\n\r\n    /**\r\n     * This method resumes the recording process.\r\n     * @method\r\n     * @memberof MediaStreamRecorder\r\n     * @example\r\n     * recorder.resume();\r\n     */\r\n    this.resume = function() {\r\n        if (!mediaRecorder) {\r\n            return;\r\n        }\r\n\r\n        if (mediaRecorder.state === 'paused') {\r\n            mediaRecorder.resume();\r\n        }\r\n    };\r\n\r\n    /**\r\n     * This method resets currently recorded data.\r\n     * @method\r\n     * @memberof MediaStreamRecorder\r\n     * @example\r\n     * recorder.clearRecordedData();\r\n     */\r\n    this.clearRecordedData = function() {\r\n        if (mediaRecorder && mediaRecorder.state === 'recording') {\r\n            self.stop(clearRecordedDataCB);\r\n        }\r\n\r\n        clearRecordedDataCB();\r\n    };\r\n\r\n    function clearRecordedDataCB() {\r\n        arrayOfBlobs = [];\r\n        mediaRecorder = null;\r\n        self.timestamps = [];\r\n    }\r\n\r\n    // Reference to \"MediaRecorder\" object\r\n    var mediaRecorder;\r\n\r\n    /**\r\n     * Access to native MediaRecorder API\r\n     * @method\r\n     * @memberof MediaStreamRecorder\r\n     * @instance\r\n     * @example\r\n     * var internal = recorder.getInternalRecorder();\r\n     * internal.ondataavailable = function() {}; // override\r\n     * internal.stream, internal.onpause, internal.onstop, etc.\r\n     * @returns {Object} Returns internal recording object.\r\n     */\r\n    this.getInternalRecorder = function() {\r\n        return mediaRecorder;\r\n    };\r\n\r\n    function isMediaStreamActive() {\r\n        if ('active' in mediaStream) {\r\n            if (!mediaStream.active) {\r\n                return false;\r\n            }\r\n        } else if ('ended' in mediaStream) { // old hack\r\n            if (mediaStream.ended) {\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * @property {Blob} blob - Recorded data as \"Blob\" object.\r\n     * @memberof MediaStreamRecorder\r\n     * @example\r\n     * recorder.stop(function() {\r\n     *     var blob = recorder.blob;\r\n     * });\r\n     */\r\n    this.blob = null;\r\n\r\n\r\n    /**\r\n     * Get MediaRecorder readonly state.\r\n     * @method\r\n     * @memberof MediaStreamRecorder\r\n     * @example\r\n     * var state = recorder.getState();\r\n     * @returns {String} Returns recording state.\r\n     */\r\n    this.getState = function() {\r\n        if (!mediaRecorder) {\r\n            return 'inactive';\r\n        }\r\n\r\n        return mediaRecorder.state || 'inactive';\r\n    };\r\n\r\n    // list of all recording states\r\n    var allStates = [];\r\n\r\n    /**\r\n     * Get MediaRecorder all recording states.\r\n     * @method\r\n     * @memberof MediaStreamRecorder\r\n     * @example\r\n     * var state = recorder.getAllStates();\r\n     * @returns {Array} Returns all recording states\r\n     */\r\n    this.getAllStates = function() {\r\n        return allStates;\r\n    };\r\n\r\n    // if any Track within the MediaStream is muted or not enabled at any time, \r\n    // the browser will only record black frames \r\n    // or silence since that is the content produced by the Track\r\n    // so we need to stopRecording as soon as any single track ends.\r\n    if (typeof config.checkForInactiveTracks === 'undefined') {\r\n        config.checkForInactiveTracks = false; // disable to minimize CPU usage\r\n    }\r\n\r\n    var self = this;\r\n\r\n    // this method checks if media stream is stopped\r\n    // or if any track is ended.\r\n    (function looper() {\r\n        if (!mediaRecorder || config.checkForInactiveTracks === false) {\r\n            return;\r\n        }\r\n\r\n        if (isMediaStreamActive() === false) {\r\n            if (!config.disableLogs) {\r\n                console.log('MediaStream seems stopped.');\r\n            }\r\n            self.stop();\r\n            return;\r\n        }\r\n\r\n        setTimeout(looper, 1000); // check every second\r\n    })();\r\n\r\n    // for debugging\r\n    this.name = 'MediaStreamRecorder';\r\n    this.toString = function() {\r\n        return this.name;\r\n    };\r\n}\r\n\r\nif (typeof RecordRTC !== 'undefined') {\r\n    RecordRTC.MediaStreamRecorder = MediaStreamRecorder;\r\n}\r\n\r\n// source code from: http://typedarray.org/wp-content/projects/WebAudioRecorder/script.js\r\n// https://github.com/mattdiamond/Recorderjs#license-mit\r\n// ______________________\r\n// StereoAudioRecorder.js\r\n\r\n/**\r\n * StereoAudioRecorder is a standalone class used by {@link RecordRTC} to bring \"stereo\" audio-recording in chrome.\r\n * @summary JavaScript standalone object for stereo audio recording.\r\n * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}\r\n * @author {@link https://MuazKhan.com|Muaz Khan}\r\n * @typedef StereoAudioRecorder\r\n * @class\r\n * @example\r\n * var recorder = new StereoAudioRecorder(MediaStream, {\r\n *     sampleRate: 44100,\r\n *     bufferSize: 4096\r\n * });\r\n * recorder.record();\r\n * recorder.stop(function(blob) {\r\n *     video.src = URL.createObjectURL(blob);\r\n * });\r\n * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}\r\n * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.\r\n * @param {object} config - {sampleRate: 44100, bufferSize: 4096, numberOfAudioChannels: 1, etc.}\r\n */\r\n\r\nfunction StereoAudioRecorder(mediaStream, config) {\r\n    if (!getTracks(mediaStream, 'audio').length) {\r\n        throw 'Your stream has no audio tracks.';\r\n    }\r\n\r\n    config = config || {};\r\n\r\n    var self = this;\r\n\r\n    // variables\r\n    var leftchannel = [];\r\n    var rightchannel = [];\r\n    var recording = false;\r\n    var recordingLength = 0;\r\n    var jsAudioNode;\r\n\r\n    var numberOfAudioChannels = 2;\r\n\r\n    /**\r\n     * Set sample rates such as 8K or 16K. Reference: http://stackoverflow.com/a/28977136/552182\r\n     * @property {number} desiredSampRate - Desired Bits per sample * 1000\r\n     * @memberof StereoAudioRecorder\r\n     * @instance\r\n     * @example\r\n     * var recorder = StereoAudioRecorder(mediaStream, {\r\n     *   desiredSampRate: 16 * 1000 // bits-per-sample * 1000\r\n     * });\r\n     */\r\n    var desiredSampRate = config.desiredSampRate;\r\n\r\n    // backward compatibility\r\n    if (config.leftChannel === true) {\r\n        numberOfAudioChannels = 1;\r\n    }\r\n\r\n    if (config.numberOfAudioChannels === 1) {\r\n        numberOfAudioChannels = 1;\r\n    }\r\n\r\n    if (!numberOfAudioChannels || numberOfAudioChannels < 1) {\r\n        numberOfAudioChannels = 2;\r\n    }\r\n\r\n    if (!config.disableLogs) {\r\n        console.log('StereoAudioRecorder is set to record number of channels: ' + numberOfAudioChannels);\r\n    }\r\n\r\n    // if any Track within the MediaStream is muted or not enabled at any time, \r\n    // the browser will only record black frames \r\n    // or silence since that is the content produced by the Track\r\n    // so we need to stopRecording as soon as any single track ends.\r\n    if (typeof config.checkForInactiveTracks === 'undefined') {\r\n        config.checkForInactiveTracks = true;\r\n    }\r\n\r\n    function isMediaStreamActive() {\r\n        if (config.checkForInactiveTracks === false) {\r\n            // always return \"true\"\r\n            return true;\r\n        }\r\n\r\n        if ('active' in mediaStream) {\r\n            if (!mediaStream.active) {\r\n                return false;\r\n            }\r\n        } else if ('ended' in mediaStream) { // old hack\r\n            if (mediaStream.ended) {\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * This method records MediaStream.\r\n     * @method\r\n     * @memberof StereoAudioRecorder\r\n     * @example\r\n     * recorder.record();\r\n     */\r\n    this.record = function() {\r\n        if (isMediaStreamActive() === false) {\r\n            throw 'Please make sure MediaStream is active.';\r\n        }\r\n\r\n        resetVariables();\r\n\r\n        isAudioProcessStarted = isPaused = false;\r\n        recording = true;\r\n\r\n        if (typeof config.timeSlice !== 'undefined') {\r\n            looper();\r\n        }\r\n    };\r\n\r\n    function mergeLeftRightBuffers(config, callback) {\r\n        function mergeAudioBuffers(config, cb) {\r\n            var numberOfAudioChannels = config.numberOfAudioChannels;\r\n\r\n            // todo: \"slice(0)\" --- is it causes loop? Should be removed?\r\n            var leftBuffers = config.leftBuffers.slice(0);\r\n            var rightBuffers = config.rightBuffers.slice(0);\r\n            var sampleRate = config.sampleRate;\r\n            var internalInterleavedLength = config.internalInterleavedLength;\r\n            var desiredSampRate = config.desiredSampRate;\r\n\r\n            if (numberOfAudioChannels === 2) {\r\n                leftBuffers = mergeBuffers(leftBuffers, internalInterleavedLength);\r\n                rightBuffers = mergeBuffers(rightBuffers, internalInterleavedLength);\r\n\r\n                if (desiredSampRate) {\r\n                    leftBuffers = interpolateArray(leftBuffers, desiredSampRate, sampleRate);\r\n                    rightBuffers = interpolateArray(rightBuffers, desiredSampRate, sampleRate);\r\n                }\r\n            }\r\n\r\n            if (numberOfAudioChannels === 1) {\r\n                leftBuffers = mergeBuffers(leftBuffers, internalInterleavedLength);\r\n\r\n                if (desiredSampRate) {\r\n                    leftBuffers = interpolateArray(leftBuffers, desiredSampRate, sampleRate);\r\n                }\r\n            }\r\n\r\n            // set sample rate as desired sample rate\r\n            if (desiredSampRate) {\r\n                sampleRate = desiredSampRate;\r\n            }\r\n\r\n            // for changing the sampling rate, reference:\r\n            // http://stackoverflow.com/a/28977136/552182\r\n            function interpolateArray(data, newSampleRate, oldSampleRate) {\r\n                var fitCount = Math.round(data.length * (newSampleRate / oldSampleRate));\r\n                var newData = [];\r\n                var springFactor = Number((data.length - 1) / (fitCount - 1));\r\n                newData[0] = data[0];\r\n                for (var i = 1; i < fitCount - 1; i++) {\r\n                    var tmp = i * springFactor;\r\n                    var before = Number(Math.floor(tmp)).toFixed();\r\n                    var after = Number(Math.ceil(tmp)).toFixed();\r\n                    var atPoint = tmp - before;\r\n                    newData[i] = linearInterpolate(data[before], data[after], atPoint);\r\n                }\r\n                newData[fitCount - 1] = data[data.length - 1];\r\n                return newData;\r\n            }\r\n\r\n            function linearInterpolate(before, after, atPoint) {\r\n                return before + (after - before) * atPoint;\r\n            }\r\n\r\n            function mergeBuffers(channelBuffer, rLength) {\r\n                var result = new Float64Array(rLength);\r\n                var offset = 0;\r\n                var lng = channelBuffer.length;\r\n\r\n                for (var i = 0; i < lng; i++) {\r\n                    var buffer = channelBuffer[i];\r\n                    result.set(buffer, offset);\r\n                    offset += buffer.length;\r\n                }\r\n\r\n                return result;\r\n            }\r\n\r\n            function interleave(leftChannel, rightChannel) {\r\n                var length = leftChannel.length + rightChannel.length;\r\n\r\n                var result = new Float64Array(length);\r\n\r\n                var inputIndex = 0;\r\n\r\n                for (var index = 0; index < length;) {\r\n                    result[index++] = leftChannel[inputIndex];\r\n                    result[index++] = rightChannel[inputIndex];\r\n                    inputIndex++;\r\n                }\r\n                return result;\r\n            }\r\n\r\n            function writeUTFBytes(view, offset, string) {\r\n                var lng = string.length;\r\n                for (var i = 0; i < lng; i++) {\r\n                    view.setUint8(offset + i, string.charCodeAt(i));\r\n                }\r\n            }\r\n\r\n            // interleave both channels together\r\n            var interleaved;\r\n\r\n            if (numberOfAudioChannels === 2) {\r\n                interleaved = interleave(leftBuffers, rightBuffers);\r\n            }\r\n\r\n            if (numberOfAudioChannels === 1) {\r\n                interleaved = leftBuffers;\r\n            }\r\n\r\n            var interleavedLength = interleaved.length;\r\n\r\n            // create wav file\r\n            var resultingBufferLength = 44 + interleavedLength * 2;\r\n\r\n            var buffer = new ArrayBuffer(resultingBufferLength);\r\n\r\n            var view = new DataView(buffer);\r\n\r\n            // RIFF chunk descriptor/identifier \r\n            writeUTFBytes(view, 0, 'RIFF');\r\n\r\n            // RIFF chunk length\r\n            // changed \"44\" to \"36\" via #401\r\n            view.setUint32(4, 36 + interleavedLength * 2, true);\r\n\r\n            // RIFF type \r\n            writeUTFBytes(view, 8, 'WAVE');\r\n\r\n            // format chunk identifier \r\n            // FMT sub-chunk\r\n            writeUTFBytes(view, 12, 'fmt ');\r\n\r\n            // format chunk length \r\n            view.setUint32(16, 16, true);\r\n\r\n            // sample format (raw)\r\n            view.setUint16(20, 1, true);\r\n\r\n            // stereo (2 channels)\r\n            view.setUint16(22, numberOfAudioChannels, true);\r\n\r\n            // sample rate \r\n            view.setUint32(24, sampleRate, true);\r\n\r\n            // byte rate (sample rate * block align)\r\n            view.setUint32(28, sampleRate * numberOfAudioChannels * 2, true);\r\n\r\n            // block align (channel count * bytes per sample) \r\n            view.setUint16(32, numberOfAudioChannels * 2, true);\r\n\r\n            // bits per sample \r\n            view.setUint16(34, 16, true);\r\n\r\n            // data sub-chunk\r\n            // data chunk identifier \r\n            writeUTFBytes(view, 36, 'data');\r\n\r\n            // data chunk length \r\n            view.setUint32(40, interleavedLength * 2, true);\r\n\r\n            // write the PCM samples\r\n            var lng = interleavedLength;\r\n            var index = 44;\r\n            var volume = 1;\r\n            for (var i = 0; i < lng; i++) {\r\n                view.setInt16(index, interleaved[i] * (0x7FFF * volume), true);\r\n                index += 2;\r\n            }\r\n\r\n            if (cb) {\r\n                return cb({\r\n                    buffer: buffer,\r\n                    view: view\r\n                });\r\n            }\r\n\r\n            postMessage({\r\n                buffer: buffer,\r\n                view: view\r\n            });\r\n        }\r\n\r\n        if (config.noWorker) {\r\n            mergeAudioBuffers(config, function(data) {\r\n                callback(data.buffer, data.view);\r\n            });\r\n            return;\r\n        }\r\n\r\n\r\n        var webWorker = processInWebWorker(mergeAudioBuffers);\r\n\r\n        webWorker.onmessage = function(event) {\r\n            callback(event.data.buffer, event.data.view);\r\n\r\n            // release memory\r\n            URL.revokeObjectURL(webWorker.workerURL);\r\n\r\n            // kill webworker (or Chrome will kill your page after ~25 calls)\r\n            webWorker.terminate();\r\n        };\r\n\r\n        webWorker.postMessage(config);\r\n    }\r\n\r\n    function processInWebWorker(_function) {\r\n        var workerURL = URL.createObjectURL(new Blob([_function.toString(),\r\n            ';this.onmessage =  function (eee) {' + _function.name + '(eee.data);}'\r\n        ], {\r\n            type: 'application/javascript'\r\n        }));\r\n\r\n        var worker = new Worker(workerURL);\r\n        worker.workerURL = workerURL;\r\n        return worker;\r\n    }\r\n\r\n    /**\r\n     * This method stops recording MediaStream.\r\n     * @param {function} callback - Callback function, that is used to pass recorded blob back to the callee.\r\n     * @method\r\n     * @memberof StereoAudioRecorder\r\n     * @example\r\n     * recorder.stop(function(blob) {\r\n     *     video.src = URL.createObjectURL(blob);\r\n     * });\r\n     */\r\n    this.stop = function(callback) {\r\n        callback = callback || function() {};\r\n\r\n        // stop recording\r\n        recording = false;\r\n\r\n        mergeLeftRightBuffers({\r\n            desiredSampRate: desiredSampRate,\r\n            sampleRate: sampleRate,\r\n            numberOfAudioChannels: numberOfAudioChannels,\r\n            internalInterleavedLength: recordingLength,\r\n            leftBuffers: leftchannel,\r\n            rightBuffers: numberOfAudioChannels === 1 ? [] : rightchannel,\r\n            noWorker: config.noWorker\r\n        }, function(buffer, view) {\r\n            /**\r\n             * @property {Blob} blob - The recorded blob object.\r\n             * @memberof StereoAudioRecorder\r\n             * @example\r\n             * recorder.stop(function(){\r\n             *     var blob = recorder.blob;\r\n             * });\r\n             */\r\n            self.blob = new Blob([view], {\r\n                type: 'audio/wav'\r\n            });\r\n\r\n            /**\r\n             * @property {ArrayBuffer} buffer - The recorded buffer object.\r\n             * @memberof StereoAudioRecorder\r\n             * @example\r\n             * recorder.stop(function(){\r\n             *     var buffer = recorder.buffer;\r\n             * });\r\n             */\r\n            self.buffer = new ArrayBuffer(view.buffer.byteLength);\r\n\r\n            /**\r\n             * @property {DataView} view - The recorded data-view object.\r\n             * @memberof StereoAudioRecorder\r\n             * @example\r\n             * recorder.stop(function(){\r\n             *     var view = recorder.view;\r\n             * });\r\n             */\r\n            self.view = view;\r\n\r\n            self.sampleRate = desiredSampRate || sampleRate;\r\n            self.bufferSize = bufferSize;\r\n\r\n            // recorded audio length\r\n            self.length = recordingLength;\r\n\r\n            isAudioProcessStarted = false;\r\n\r\n            if (callback) {\r\n                callback(self.blob);\r\n            }\r\n        });\r\n    };\r\n\r\n    if (typeof RecordRTC.Storage === 'undefined') {\r\n        RecordRTC.Storage = {\r\n            AudioContextConstructor: null,\r\n            AudioContext: window.AudioContext || window.webkitAudioContext\r\n        };\r\n    }\r\n\r\n    if (!RecordRTC.Storage.AudioContextConstructor || RecordRTC.Storage.AudioContextConstructor.state === 'closed') {\r\n        RecordRTC.Storage.AudioContextConstructor = new RecordRTC.Storage.AudioContext();\r\n    }\r\n\r\n    var context = RecordRTC.Storage.AudioContextConstructor;\r\n\r\n    // creates an audio node from the microphone incoming stream\r\n    var audioInput = context.createMediaStreamSource(mediaStream);\r\n\r\n    var legalBufferValues = [0, 256, 512, 1024, 2048, 4096, 8192, 16384];\r\n\r\n    /**\r\n     * From the spec: This value controls how frequently the audioprocess event is\r\n     * dispatched and how many sample-frames need to be processed each call.\r\n     * Lower values for buffer size will result in a lower (better) latency.\r\n     * Higher values will be necessary to avoid audio breakup and glitches\r\n     * The size of the buffer (in sample-frames) which needs to\r\n     * be processed each time onprocessaudio is called.\r\n     * Legal values are (256, 512, 1024, 2048, 4096, 8192, 16384).\r\n     * @property {number} bufferSize - Buffer-size for how frequently the audioprocess event is dispatched.\r\n     * @memberof StereoAudioRecorder\r\n     * @example\r\n     * recorder = new StereoAudioRecorder(mediaStream, {\r\n     *     bufferSize: 4096\r\n     * });\r\n     */\r\n\r\n    // \"0\" means, let chrome decide the most accurate buffer-size for current platform.\r\n    var bufferSize = typeof config.bufferSize === 'undefined' ? 4096 : config.bufferSize;\r\n\r\n    if (legalBufferValues.indexOf(bufferSize) === -1) {\r\n        if (!config.disableLogs) {\r\n            console.log('Legal values for buffer-size are ' + JSON.stringify(legalBufferValues, null, '\\t'));\r\n        }\r\n    }\r\n\r\n    if (context.createJavaScriptNode) {\r\n        jsAudioNode = context.createJavaScriptNode(bufferSize, numberOfAudioChannels, numberOfAudioChannels);\r\n    } else if (context.createScriptProcessor) {\r\n        jsAudioNode = context.createScriptProcessor(bufferSize, numberOfAudioChannels, numberOfAudioChannels);\r\n    } else {\r\n        throw 'WebAudio API has no support on this browser.';\r\n    }\r\n\r\n    // connect the stream to the script processor\r\n    audioInput.connect(jsAudioNode);\r\n\r\n    if (!config.bufferSize) {\r\n        bufferSize = jsAudioNode.bufferSize; // device buffer-size\r\n    }\r\n\r\n    /**\r\n     * The sample rate (in sample-frames per second) at which the\r\n     * AudioContext handles audio. It is assumed that all AudioNodes\r\n     * in the context run at this rate. In making this assumption,\r\n     * sample-rate converters or \"varispeed\" processors are not supported\r\n     * in real-time processing.\r\n     * The sampleRate parameter describes the sample-rate of the\r\n     * linear PCM audio data in the buffer in sample-frames per second.\r\n     * An implementation must support sample-rates in at least\r\n     * the range 22050 to 96000.\r\n     * @property {number} sampleRate - Buffer-size for how frequently the audioprocess event is dispatched.\r\n     * @memberof StereoAudioRecorder\r\n     * @example\r\n     * recorder = new StereoAudioRecorder(mediaStream, {\r\n     *     sampleRate: 44100\r\n     * });\r\n     */\r\n    var sampleRate = typeof config.sampleRate !== 'undefined' ? config.sampleRate : context.sampleRate || 44100;\r\n\r\n    if (sampleRate < 22050 || sampleRate > 96000) {\r\n        // Ref: http://stackoverflow.com/a/26303918/552182\r\n        if (!config.disableLogs) {\r\n            console.log('sample-rate must be under range 22050 and 96000.');\r\n        }\r\n    }\r\n\r\n    if (!config.disableLogs) {\r\n        if (config.desiredSampRate) {\r\n            console.log('Desired sample-rate: ' + config.desiredSampRate);\r\n        }\r\n    }\r\n\r\n    var isPaused = false;\r\n    /**\r\n     * This method pauses the recording process.\r\n     * @method\r\n     * @memberof StereoAudioRecorder\r\n     * @example\r\n     * recorder.pause();\r\n     */\r\n    this.pause = function() {\r\n        isPaused = true;\r\n    };\r\n\r\n    /**\r\n     * This method resumes the recording process.\r\n     * @method\r\n     * @memberof StereoAudioRecorder\r\n     * @example\r\n     * recorder.resume();\r\n     */\r\n    this.resume = function() {\r\n        if (isMediaStreamActive() === false) {\r\n            throw 'Please make sure MediaStream is active.';\r\n        }\r\n\r\n        if (!recording) {\r\n            if (!config.disableLogs) {\r\n                console.log('Seems recording has been restarted.');\r\n            }\r\n            this.record();\r\n            return;\r\n        }\r\n\r\n        isPaused = false;\r\n    };\r\n\r\n    /**\r\n     * This method resets currently recorded data.\r\n     * @method\r\n     * @memberof StereoAudioRecorder\r\n     * @example\r\n     * recorder.clearRecordedData();\r\n     */\r\n    this.clearRecordedData = function() {\r\n        config.checkForInactiveTracks = false;\r\n\r\n        if (recording) {\r\n            this.stop(clearRecordedDataCB);\r\n        }\r\n\r\n        clearRecordedDataCB();\r\n    };\r\n\r\n    function resetVariables() {\r\n        leftchannel = [];\r\n        rightchannel = [];\r\n        recordingLength = 0;\r\n        isAudioProcessStarted = false;\r\n        recording = false;\r\n        isPaused = false;\r\n        context = null;\r\n\r\n        self.leftchannel = leftchannel;\r\n        self.rightchannel = rightchannel;\r\n        self.numberOfAudioChannels = numberOfAudioChannels;\r\n        self.desiredSampRate = desiredSampRate;\r\n        self.sampleRate = sampleRate;\r\n        self.recordingLength = recordingLength;\r\n\r\n        intervalsBasedBuffers = {\r\n            left: [],\r\n            right: [],\r\n            recordingLength: 0\r\n        };\r\n    }\r\n\r\n    function clearRecordedDataCB() {\r\n        if (jsAudioNode) {\r\n            jsAudioNode.onaudioprocess = null;\r\n            jsAudioNode.disconnect();\r\n            jsAudioNode = null;\r\n        }\r\n\r\n        if (audioInput) {\r\n            audioInput.disconnect();\r\n            audioInput = null;\r\n        }\r\n\r\n        resetVariables();\r\n    }\r\n\r\n    // for debugging\r\n    this.name = 'StereoAudioRecorder';\r\n    this.toString = function() {\r\n        return this.name;\r\n    };\r\n\r\n    var isAudioProcessStarted = false;\r\n\r\n    function onAudioProcessDataAvailable(e) {\r\n        if (isPaused) {\r\n            return;\r\n        }\r\n\r\n        if (isMediaStreamActive() === false) {\r\n            if (!config.disableLogs) {\r\n                console.log('MediaStream seems stopped.');\r\n            }\r\n            jsAudioNode.disconnect();\r\n            recording = false;\r\n        }\r\n\r\n        if (!recording) {\r\n            if (audioInput) {\r\n                audioInput.disconnect();\r\n                audioInput = null;\r\n            }\r\n            return;\r\n        }\r\n\r\n        /**\r\n         * This method is called on \"onaudioprocess\" event's first invocation.\r\n         * @method {function} onAudioProcessStarted\r\n         * @memberof StereoAudioRecorder\r\n         * @example\r\n         * recorder.onAudioProcessStarted: function() { };\r\n         */\r\n        if (!isAudioProcessStarted) {\r\n            isAudioProcessStarted = true;\r\n            if (config.onAudioProcessStarted) {\r\n                config.onAudioProcessStarted();\r\n            }\r\n\r\n            if (config.initCallback) {\r\n                config.initCallback();\r\n            }\r\n        }\r\n\r\n        var left = e.inputBuffer.getChannelData(0);\r\n\r\n        // we clone the samples\r\n        var chLeft = new Float32Array(left);\r\n        leftchannel.push(chLeft);\r\n\r\n        if (numberOfAudioChannels === 2) {\r\n            var right = e.inputBuffer.getChannelData(1);\r\n            var chRight = new Float32Array(right);\r\n            rightchannel.push(chRight);\r\n        }\r\n\r\n        recordingLength += bufferSize;\r\n\r\n        // export raw PCM\r\n        self.recordingLength = recordingLength;\r\n\r\n        if (typeof config.timeSlice !== 'undefined') {\r\n            intervalsBasedBuffers.recordingLength += bufferSize;\r\n            intervalsBasedBuffers.left.push(chLeft);\r\n\r\n            if (numberOfAudioChannels === 2) {\r\n                intervalsBasedBuffers.right.push(chRight);\r\n            }\r\n        }\r\n    }\r\n\r\n    jsAudioNode.onaudioprocess = onAudioProcessDataAvailable;\r\n\r\n    // to prevent self audio to be connected with speakers\r\n    if (context.createMediaStreamDestination) {\r\n        jsAudioNode.connect(context.createMediaStreamDestination());\r\n    } else {\r\n        jsAudioNode.connect(context.destination);\r\n    }\r\n\r\n    // export raw PCM\r\n    this.leftchannel = leftchannel;\r\n    this.rightchannel = rightchannel;\r\n    this.numberOfAudioChannels = numberOfAudioChannels;\r\n    this.desiredSampRate = desiredSampRate;\r\n    this.sampleRate = sampleRate;\r\n    self.recordingLength = recordingLength;\r\n\r\n    // helper for intervals based blobs\r\n    var intervalsBasedBuffers = {\r\n        left: [],\r\n        right: [],\r\n        recordingLength: 0\r\n    };\r\n\r\n    // this looper is used to support intervals based blobs (via timeSlice+ondataavailable)\r\n    function looper() {\r\n        if (!recording || typeof config.ondataavailable !== 'function' || typeof config.timeSlice === 'undefined') {\r\n            return;\r\n        }\r\n\r\n        if (intervalsBasedBuffers.left.length) {\r\n            mergeLeftRightBuffers({\r\n                desiredSampRate: desiredSampRate,\r\n                sampleRate: sampleRate,\r\n                numberOfAudioChannels: numberOfAudioChannels,\r\n                internalInterleavedLength: intervalsBasedBuffers.recordingLength,\r\n                leftBuffers: intervalsBasedBuffers.left,\r\n                rightBuffers: numberOfAudioChannels === 1 ? [] : intervalsBasedBuffers.right\r\n            }, function(buffer, view) {\r\n                var blob = new Blob([view], {\r\n                    type: 'audio/wav'\r\n                });\r\n                config.ondataavailable(blob);\r\n\r\n                setTimeout(looper, config.timeSlice);\r\n            });\r\n\r\n            intervalsBasedBuffers = {\r\n                left: [],\r\n                right: [],\r\n                recordingLength: 0\r\n            };\r\n        } else {\r\n            setTimeout(looper, config.timeSlice);\r\n        }\r\n    }\r\n}\r\n\r\nif (typeof RecordRTC !== 'undefined') {\r\n    RecordRTC.StereoAudioRecorder = StereoAudioRecorder;\r\n}\r\n\r\n// _________________\r\n// CanvasRecorder.js\r\n\r\n/**\r\n * CanvasRecorder is a standalone class used by {@link RecordRTC} to bring HTML5-Canvas recording into video WebM. It uses HTML2Canvas library and runs top over {@link Whammy}.\r\n * @summary HTML2Canvas recording into video WebM.\r\n * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}\r\n * @author {@link https://MuazKhan.com|Muaz Khan}\r\n * @typedef CanvasRecorder\r\n * @class\r\n * @example\r\n * var recorder = new CanvasRecorder(htmlElement, { disableLogs: true, useWhammyRecorder: true });\r\n * recorder.record();\r\n * recorder.stop(function(blob) {\r\n *     video.src = URL.createObjectURL(blob);\r\n * });\r\n * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}\r\n * @param {HTMLElement} htmlElement - querySelector/getElementById/getElementsByTagName[0]/etc.\r\n * @param {object} config - {disableLogs:true, initCallback: function}\r\n */\r\n\r\nfunction CanvasRecorder(htmlElement, config) {\r\n    if (typeof html2canvas === 'undefined') {\r\n        throw 'Please link: https://www.webrtc-experiment.com/screenshot.js';\r\n    }\r\n\r\n    config = config || {};\r\n    if (!config.frameInterval) {\r\n        config.frameInterval = 10;\r\n    }\r\n\r\n    // via DetectRTC.js\r\n    var isCanvasSupportsStreamCapturing = false;\r\n    ['captureStream', 'mozCaptureStream', 'webkitCaptureStream'].forEach(function(item) {\r\n        if (item in document.createElement('canvas')) {\r\n            isCanvasSupportsStreamCapturing = true;\r\n        }\r\n    });\r\n\r\n    var _isChrome = (!!window.webkitRTCPeerConnection || !!window.webkitGetUserMedia) && !!window.chrome;\r\n\r\n    var chromeVersion = 50;\r\n    var matchArray = navigator.userAgent.match(/Chrom(e|ium)\\/([0-9]+)\\./);\r\n    if (_isChrome && matchArray && matchArray[2]) {\r\n        chromeVersion = parseInt(matchArray[2], 10);\r\n    }\r\n\r\n    if (_isChrome && chromeVersion < 52) {\r\n        isCanvasSupportsStreamCapturing = false;\r\n    }\r\n\r\n    if (config.useWhammyRecorder) {\r\n        isCanvasSupportsStreamCapturing = false;\r\n    }\r\n\r\n    var globalCanvas, mediaStreamRecorder;\r\n\r\n    if (isCanvasSupportsStreamCapturing) {\r\n        if (!config.disableLogs) {\r\n            console.log('Your browser supports both MediRecorder API and canvas.captureStream!');\r\n        }\r\n\r\n        if (htmlElement instanceof HTMLCanvasElement) {\r\n            globalCanvas = htmlElement;\r\n        } else if (htmlElement instanceof CanvasRenderingContext2D) {\r\n            globalCanvas = htmlElement.canvas;\r\n        } else {\r\n            throw 'Please pass either HTMLCanvasElement or CanvasRenderingContext2D.';\r\n        }\r\n    } else if (!!navigator.mozGetUserMedia) {\r\n        if (!config.disableLogs) {\r\n            console.error('Canvas recording is NOT supported in Firefox.');\r\n        }\r\n    }\r\n\r\n    var isRecording;\r\n\r\n    /**\r\n     * This method records Canvas.\r\n     * @method\r\n     * @memberof CanvasRecorder\r\n     * @example\r\n     * recorder.record();\r\n     */\r\n    this.record = function() {\r\n        isRecording = true;\r\n\r\n        if (isCanvasSupportsStreamCapturing && !config.useWhammyRecorder) {\r\n            // CanvasCaptureMediaStream\r\n            var canvasMediaStream;\r\n            if ('captureStream' in globalCanvas) {\r\n                canvasMediaStream = globalCanvas.captureStream(25); // 25 FPS\r\n            } else if ('mozCaptureStream' in globalCanvas) {\r\n                canvasMediaStream = globalCanvas.mozCaptureStream(25);\r\n            } else if ('webkitCaptureStream' in globalCanvas) {\r\n                canvasMediaStream = globalCanvas.webkitCaptureStream(25);\r\n            }\r\n\r\n            try {\r\n                var mdStream = new MediaStream();\r\n                mdStream.addTrack(getTracks(canvasMediaStream, 'video')[0]);\r\n                canvasMediaStream = mdStream;\r\n            } catch (e) {}\r\n\r\n            if (!canvasMediaStream) {\r\n                throw 'captureStream API are NOT available.';\r\n            }\r\n\r\n            // Note: Jan 18, 2016 status is that, \r\n            // Firefox MediaRecorder API can't record CanvasCaptureMediaStream object.\r\n            mediaStreamRecorder = new MediaStreamRecorder(canvasMediaStream, {\r\n                mimeType: config.mimeType || 'video/webm'\r\n            });\r\n            mediaStreamRecorder.record();\r\n        } else {\r\n            whammy.frames = [];\r\n            lastTime = new Date().getTime();\r\n            drawCanvasFrame();\r\n        }\r\n\r\n        if (config.initCallback) {\r\n            config.initCallback();\r\n        }\r\n    };\r\n\r\n    this.getWebPImages = function(callback) {\r\n        if (htmlElement.nodeName.toLowerCase() !== 'canvas') {\r\n            callback();\r\n            return;\r\n        }\r\n\r\n        var framesLength = whammy.frames.length;\r\n        whammy.frames.forEach(function(frame, idx) {\r\n            var framesRemaining = framesLength - idx;\r\n            if (!config.disableLogs) {\r\n                console.log(framesRemaining + '/' + framesLength + ' frames remaining');\r\n            }\r\n\r\n            if (config.onEncodingCallback) {\r\n                config.onEncodingCallback(framesRemaining, framesLength);\r\n            }\r\n\r\n            var webp = frame.image.toDataURL('image/webp', 1);\r\n            whammy.frames[idx].image = webp;\r\n        });\r\n\r\n        if (!config.disableLogs) {\r\n            console.log('Generating WebM');\r\n        }\r\n\r\n        callback();\r\n    };\r\n\r\n    /**\r\n     * This method stops recording Canvas.\r\n     * @param {function} callback - Callback function, that is used to pass recorded blob back to the callee.\r\n     * @method\r\n     * @memberof CanvasRecorder\r\n     * @example\r\n     * recorder.stop(function(blob) {\r\n     *     video.src = URL.createObjectURL(blob);\r\n     * });\r\n     */\r\n    this.stop = function(callback) {\r\n        isRecording = false;\r\n\r\n        var that = this;\r\n\r\n        if (isCanvasSupportsStreamCapturing && mediaStreamRecorder) {\r\n            mediaStreamRecorder.stop(callback);\r\n            return;\r\n        }\r\n\r\n        this.getWebPImages(function() {\r\n            /**\r\n             * @property {Blob} blob - Recorded frames in video/webm blob.\r\n             * @memberof CanvasRecorder\r\n             * @example\r\n             * recorder.stop(function() {\r\n             *     var blob = recorder.blob;\r\n             * });\r\n             */\r\n            whammy.compile(function(blob) {\r\n                if (!config.disableLogs) {\r\n                    console.log('Recording finished!');\r\n                }\r\n\r\n                that.blob = blob;\r\n\r\n                if (that.blob.forEach) {\r\n                    that.blob = new Blob([], {\r\n                        type: 'video/webm'\r\n                    });\r\n                }\r\n\r\n                if (callback) {\r\n                    callback(that.blob);\r\n                }\r\n\r\n                whammy.frames = [];\r\n            });\r\n        });\r\n    };\r\n\r\n    var isPausedRecording = false;\r\n\r\n    /**\r\n     * This method pauses the recording process.\r\n     * @method\r\n     * @memberof CanvasRecorder\r\n     * @example\r\n     * recorder.pause();\r\n     */\r\n    this.pause = function() {\r\n        isPausedRecording = true;\r\n\r\n        if (mediaStreamRecorder instanceof MediaStreamRecorder) {\r\n            mediaStreamRecorder.pause();\r\n            return;\r\n        }\r\n    };\r\n\r\n    /**\r\n     * This method resumes the recording process.\r\n     * @method\r\n     * @memberof CanvasRecorder\r\n     * @example\r\n     * recorder.resume();\r\n     */\r\n    this.resume = function() {\r\n        isPausedRecording = false;\r\n\r\n        if (mediaStreamRecorder instanceof MediaStreamRecorder) {\r\n            mediaStreamRecorder.resume();\r\n            return;\r\n        }\r\n\r\n        if (!isRecording) {\r\n            this.record();\r\n        }\r\n    };\r\n\r\n    /**\r\n     * This method resets currently recorded data.\r\n     * @method\r\n     * @memberof CanvasRecorder\r\n     * @example\r\n     * recorder.clearRecordedData();\r\n     */\r\n    this.clearRecordedData = function() {\r\n        if (isRecording) {\r\n            this.stop(clearRecordedDataCB);\r\n        }\r\n        clearRecordedDataCB();\r\n    };\r\n\r\n    function clearRecordedDataCB() {\r\n        whammy.frames = [];\r\n        isRecording = false;\r\n        isPausedRecording = false;\r\n    }\r\n\r\n    // for debugging\r\n    this.name = 'CanvasRecorder';\r\n    this.toString = function() {\r\n        return this.name;\r\n    };\r\n\r\n    function cloneCanvas() {\r\n        //create a new canvas\r\n        var newCanvas = document.createElement('canvas');\r\n        var context = newCanvas.getContext('2d');\r\n\r\n        //set dimensions\r\n        newCanvas.width = htmlElement.width;\r\n        newCanvas.height = htmlElement.height;\r\n\r\n        //apply the old canvas to the new one\r\n        context.drawImage(htmlElement, 0, 0);\r\n\r\n        //return the new canvas\r\n        return newCanvas;\r\n    }\r\n\r\n    function drawCanvasFrame() {\r\n        if (isPausedRecording) {\r\n            lastTime = new Date().getTime();\r\n            return setTimeout(drawCanvasFrame, 500);\r\n        }\r\n\r\n        if (htmlElement.nodeName.toLowerCase() === 'canvas') {\r\n            var duration = new Date().getTime() - lastTime;\r\n            // via #206, by Jack i.e. @Seymourr\r\n            lastTime = new Date().getTime();\r\n\r\n            whammy.frames.push({\r\n                image: cloneCanvas(),\r\n                duration: duration\r\n            });\r\n\r\n            if (isRecording) {\r\n                setTimeout(drawCanvasFrame, config.frameInterval);\r\n            }\r\n            return;\r\n        }\r\n\r\n        html2canvas(htmlElement, {\r\n            grabMouse: typeof config.showMousePointer === 'undefined' || config.showMousePointer,\r\n            onrendered: function(canvas) {\r\n                var duration = new Date().getTime() - lastTime;\r\n                if (!duration) {\r\n                    return setTimeout(drawCanvasFrame, config.frameInterval);\r\n                }\r\n\r\n                // via #206, by Jack i.e. @Seymourr\r\n                lastTime = new Date().getTime();\r\n\r\n                whammy.frames.push({\r\n                    image: canvas.toDataURL('image/webp', 1),\r\n                    duration: duration\r\n                });\r\n\r\n                if (isRecording) {\r\n                    setTimeout(drawCanvasFrame, config.frameInterval);\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    var lastTime = new Date().getTime();\r\n\r\n    var whammy = new Whammy.Video(100);\r\n}\r\n\r\nif (typeof RecordRTC !== 'undefined') {\r\n    RecordRTC.CanvasRecorder = CanvasRecorder;\r\n}\n\r\n// _________________\r\n// WhammyRecorder.js\r\n\r\n/**\r\n * WhammyRecorder is a standalone class used by {@link RecordRTC} to bring video recording in Chrome. It runs top over {@link Whammy}.\r\n * @summary Video recording feature in Chrome.\r\n * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}\r\n * @author {@link https://MuazKhan.com|Muaz Khan}\r\n * @typedef WhammyRecorder\r\n * @class\r\n * @example\r\n * var recorder = new WhammyRecorder(mediaStream);\r\n * recorder.record();\r\n * recorder.stop(function(blob) {\r\n *     video.src = URL.createObjectURL(blob);\r\n * });\r\n * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}\r\n * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.\r\n * @param {object} config - {disableLogs: true, initCallback: function, video: HTMLVideoElement, etc.}\r\n */\r\n\r\nfunction WhammyRecorder(mediaStream, config) {\r\n\r\n    config = config || {};\r\n\r\n    if (!config.frameInterval) {\r\n        config.frameInterval = 10;\r\n    }\r\n\r\n    if (!config.disableLogs) {\r\n        console.log('Using frames-interval:', config.frameInterval);\r\n    }\r\n\r\n    /**\r\n     * This method records video.\r\n     * @method\r\n     * @memberof WhammyRecorder\r\n     * @example\r\n     * recorder.record();\r\n     */\r\n    this.record = function() {\r\n        if (!config.width) {\r\n            config.width = 320;\r\n        }\r\n\r\n        if (!config.height) {\r\n            config.height = 240;\r\n        }\r\n\r\n        if (!config.video) {\r\n            config.video = {\r\n                width: config.width,\r\n                height: config.height\r\n            };\r\n        }\r\n\r\n        if (!config.canvas) {\r\n            config.canvas = {\r\n                width: config.width,\r\n                height: config.height\r\n            };\r\n        }\r\n\r\n        canvas.width = config.canvas.width || 320;\r\n        canvas.height = config.canvas.height || 240;\r\n\r\n        context = canvas.getContext('2d');\r\n\r\n        // setting defaults\r\n        if (config.video && config.video instanceof HTMLVideoElement) {\r\n            video = config.video.cloneNode();\r\n\r\n            if (config.initCallback) {\r\n                config.initCallback();\r\n            }\r\n        } else {\r\n            video = document.createElement('video');\r\n\r\n            setSrcObject(mediaStream, video);\r\n\r\n            video.onloadedmetadata = function() { // \"onloadedmetadata\" may NOT work in FF?\r\n                if (config.initCallback) {\r\n                    config.initCallback();\r\n                }\r\n            };\r\n\r\n            video.width = config.video.width;\r\n            video.height = config.video.height;\r\n        }\r\n\r\n        video.muted = true;\r\n        video.play();\r\n\r\n        lastTime = new Date().getTime();\r\n        whammy = new Whammy.Video();\r\n\r\n        if (!config.disableLogs) {\r\n            console.log('canvas resolutions', canvas.width, '*', canvas.height);\r\n            console.log('video width/height', video.width || canvas.width, '*', video.height || canvas.height);\r\n        }\r\n\r\n        drawFrames(config.frameInterval);\r\n    };\r\n\r\n    /**\r\n     * Draw and push frames to Whammy\r\n     * @param {integer} frameInterval - set minimum interval (in milliseconds) between each time we push a frame to Whammy\r\n     */\r\n    function drawFrames(frameInterval) {\r\n        frameInterval = typeof frameInterval !== 'undefined' ? frameInterval : 10;\r\n\r\n        var duration = new Date().getTime() - lastTime;\r\n        if (!duration) {\r\n            return setTimeout(drawFrames, frameInterval, frameInterval);\r\n        }\r\n\r\n        if (isPausedRecording) {\r\n            lastTime = new Date().getTime();\r\n            return setTimeout(drawFrames, 100);\r\n        }\r\n\r\n        // via #206, by Jack i.e. @Seymourr\r\n        lastTime = new Date().getTime();\r\n\r\n        if (video.paused) {\r\n            // via: https://github.com/muaz-khan/WebRTC-Experiment/pull/316\r\n            // Tweak for Android Chrome\r\n            video.play();\r\n        }\r\n\r\n        context.drawImage(video, 0, 0, canvas.width, canvas.height);\r\n        whammy.frames.push({\r\n            duration: duration,\r\n            image: canvas.toDataURL('image/webp')\r\n        });\r\n\r\n        if (!isStopDrawing) {\r\n            setTimeout(drawFrames, frameInterval, frameInterval);\r\n        }\r\n    }\r\n\r\n    function asyncLoop(o) {\r\n        var i = -1,\r\n            length = o.length;\r\n\r\n        (function loop() {\r\n            i++;\r\n            if (i === length) {\r\n                o.callback();\r\n                return;\r\n            }\r\n\r\n            // \"setTimeout\" added by Jim McLeod\r\n            setTimeout(function() {\r\n                o.functionToLoop(loop, i);\r\n            }, 1);\r\n        })();\r\n    }\r\n\r\n\r\n    /**\r\n     * remove black frames from the beginning to the specified frame\r\n     * @param {Array} _frames - array of frames to be checked\r\n     * @param {number} _framesToCheck - number of frame until check will be executed (-1 - will drop all frames until frame not matched will be found)\r\n     * @param {number} _pixTolerance - 0 - very strict (only black pixel color) ; 1 - all\r\n     * @param {number} _frameTolerance - 0 - very strict (only black frame color) ; 1 - all\r\n     * @returns {Array} - array of frames\r\n     */\r\n    // pull#293 by @volodalexey\r\n    function dropBlackFrames(_frames, _framesToCheck, _pixTolerance, _frameTolerance, callback) {\r\n        var localCanvas = document.createElement('canvas');\r\n        localCanvas.width = canvas.width;\r\n        localCanvas.height = canvas.height;\r\n        var context2d = localCanvas.getContext('2d');\r\n        var resultFrames = [];\r\n\r\n        var checkUntilNotBlack = _framesToCheck === -1;\r\n        var endCheckFrame = (_framesToCheck && _framesToCheck > 0 && _framesToCheck <= _frames.length) ?\r\n            _framesToCheck : _frames.length;\r\n        var sampleColor = {\r\n            r: 0,\r\n            g: 0,\r\n            b: 0\r\n        };\r\n        var maxColorDifference = Math.sqrt(\r\n            Math.pow(255, 2) +\r\n            Math.pow(255, 2) +\r\n            Math.pow(255, 2)\r\n        );\r\n        var pixTolerance = _pixTolerance && _pixTolerance >= 0 && _pixTolerance <= 1 ? _pixTolerance : 0;\r\n        var frameTolerance = _frameTolerance && _frameTolerance >= 0 && _frameTolerance <= 1 ? _frameTolerance : 0;\r\n        var doNotCheckNext = false;\r\n\r\n        asyncLoop({\r\n            length: endCheckFrame,\r\n            functionToLoop: function(loop, f) {\r\n                var matchPixCount, endPixCheck, maxPixCount;\r\n\r\n                var finishImage = function() {\r\n                    if (!doNotCheckNext && maxPixCount - matchPixCount <= maxPixCount * frameTolerance) {\r\n                        // console.log('removed black frame : ' + f + ' ; frame duration ' + _frames[f].duration);\r\n                    } else {\r\n                        // console.log('frame is passed : ' + f);\r\n                        if (checkUntilNotBlack) {\r\n                            doNotCheckNext = true;\r\n                        }\r\n                        resultFrames.push(_frames[f]);\r\n                    }\r\n                    loop();\r\n                };\r\n\r\n                if (!doNotCheckNext) {\r\n                    var image = new Image();\r\n                    image.onload = function() {\r\n                        context2d.drawImage(image, 0, 0, canvas.width, canvas.height);\r\n                        var imageData = context2d.getImageData(0, 0, canvas.width, canvas.height);\r\n                        matchPixCount = 0;\r\n                        endPixCheck = imageData.data.length;\r\n                        maxPixCount = imageData.data.length / 4;\r\n\r\n                        for (var pix = 0; pix < endPixCheck; pix += 4) {\r\n                            var currentColor = {\r\n                                r: imageData.data[pix],\r\n                                g: imageData.data[pix + 1],\r\n                                b: imageData.data[pix + 2]\r\n                            };\r\n                            var colorDifference = Math.sqrt(\r\n                                Math.pow(currentColor.r - sampleColor.r, 2) +\r\n                                Math.pow(currentColor.g - sampleColor.g, 2) +\r\n                                Math.pow(currentColor.b - sampleColor.b, 2)\r\n                            );\r\n                            // difference in color it is difference in color vectors (r1,g1,b1) <=> (r2,g2,b2)\r\n                            if (colorDifference <= maxColorDifference * pixTolerance) {\r\n                                matchPixCount++;\r\n                            }\r\n                        }\r\n                        finishImage();\r\n                    };\r\n                    image.src = _frames[f].image;\r\n                } else {\r\n                    finishImage();\r\n                }\r\n            },\r\n            callback: function() {\r\n                resultFrames = resultFrames.concat(_frames.slice(endCheckFrame));\r\n\r\n                if (resultFrames.length <= 0) {\r\n                    // at least one last frame should be available for next manipulation\r\n                    // if total duration of all frames will be < 1000 than ffmpeg doesn't work well...\r\n                    resultFrames.push(_frames[_frames.length - 1]);\r\n                }\r\n                callback(resultFrames);\r\n            }\r\n        });\r\n    }\r\n\r\n    var isStopDrawing = false;\r\n\r\n    /**\r\n     * This method stops recording video.\r\n     * @param {function} callback - Callback function, that is used to pass recorded blob back to the callee.\r\n     * @method\r\n     * @memberof WhammyRecorder\r\n     * @example\r\n     * recorder.stop(function(blob) {\r\n     *     video.src = URL.createObjectURL(blob);\r\n     * });\r\n     */\r\n    this.stop = function(callback) {\r\n        callback = callback || function() {};\r\n\r\n        isStopDrawing = true;\r\n\r\n        var _this = this;\r\n        // analyse of all frames takes some time!\r\n        setTimeout(function() {\r\n            // e.g. dropBlackFrames(frames, 10, 1, 1) - will cut all 10 frames\r\n            // e.g. dropBlackFrames(frames, 10, 0.5, 0.5) - will analyse 10 frames\r\n            // e.g. dropBlackFrames(frames, 10) === dropBlackFrames(frames, 10, 0, 0) - will analyse 10 frames with strict black color\r\n            dropBlackFrames(whammy.frames, -1, null, null, function(frames) {\r\n                whammy.frames = frames;\r\n\r\n                // to display advertisement images!\r\n                if (config.advertisement && config.advertisement.length) {\r\n                    whammy.frames = config.advertisement.concat(whammy.frames);\r\n                }\r\n\r\n                /**\r\n                 * @property {Blob} blob - Recorded frames in video/webm blob.\r\n                 * @memberof WhammyRecorder\r\n                 * @example\r\n                 * recorder.stop(function() {\r\n                 *     var blob = recorder.blob;\r\n                 * });\r\n                 */\r\n                whammy.compile(function(blob) {\r\n                    _this.blob = blob;\r\n\r\n                    if (_this.blob.forEach) {\r\n                        _this.blob = new Blob([], {\r\n                            type: 'video/webm'\r\n                        });\r\n                    }\r\n\r\n                    if (callback) {\r\n                        callback(_this.blob);\r\n                    }\r\n                });\r\n            });\r\n        }, 10);\r\n    };\r\n\r\n    var isPausedRecording = false;\r\n\r\n    /**\r\n     * This method pauses the recording process.\r\n     * @method\r\n     * @memberof WhammyRecorder\r\n     * @example\r\n     * recorder.pause();\r\n     */\r\n    this.pause = function() {\r\n        isPausedRecording = true;\r\n    };\r\n\r\n    /**\r\n     * This method resumes the recording process.\r\n     * @method\r\n     * @memberof WhammyRecorder\r\n     * @example\r\n     * recorder.resume();\r\n     */\r\n    this.resume = function() {\r\n        isPausedRecording = false;\r\n\r\n        if (isStopDrawing) {\r\n            this.record();\r\n        }\r\n    };\r\n\r\n    /**\r\n     * This method resets currently recorded data.\r\n     * @method\r\n     * @memberof WhammyRecorder\r\n     * @example\r\n     * recorder.clearRecordedData();\r\n     */\r\n    this.clearRecordedData = function() {\r\n        if (!isStopDrawing) {\r\n            this.stop(clearRecordedDataCB);\r\n        }\r\n        clearRecordedDataCB();\r\n    };\r\n\r\n    function clearRecordedDataCB() {\r\n        whammy.frames = [];\r\n        isStopDrawing = true;\r\n        isPausedRecording = false;\r\n    }\r\n\r\n    // for debugging\r\n    this.name = 'WhammyRecorder';\r\n    this.toString = function() {\r\n        return this.name;\r\n    };\r\n\r\n    var canvas = document.createElement('canvas');\r\n    var context = canvas.getContext('2d');\r\n\r\n    var video;\r\n    var lastTime;\r\n    var whammy;\r\n}\r\n\r\nif (typeof RecordRTC !== 'undefined') {\r\n    RecordRTC.WhammyRecorder = WhammyRecorder;\r\n}\n\r\n// https://github.com/antimatter15/whammy/blob/master/LICENSE\r\n// _________\r\n// Whammy.js\r\n\r\n// todo: Firefox now supports webp for webm containers!\r\n// their MediaRecorder implementation works well!\r\n// should we provide an option to record via Whammy.js or MediaRecorder API is a better solution?\r\n\r\n/**\r\n * Whammy is a standalone class used by {@link RecordRTC} to bring video recording in Chrome. It is written by {@link https://github.com/antimatter15|antimatter15}\r\n * @summary A real time javascript webm encoder based on a canvas hack.\r\n * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}\r\n * @author {@link https://MuazKhan.com|Muaz Khan}\r\n * @typedef Whammy\r\n * @class\r\n * @example\r\n * var recorder = new Whammy().Video(15);\r\n * recorder.add(context || canvas || dataURL);\r\n * var output = recorder.compile();\r\n * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}\r\n */\r\n\r\nvar Whammy = (function() {\r\n    // a more abstract-ish API\r\n\r\n    function WhammyVideo(duration) {\r\n        this.frames = [];\r\n        this.duration = duration || 1;\r\n        this.quality = 0.8;\r\n    }\r\n\r\n    /**\r\n     * Pass Canvas or Context or image/webp(string) to {@link Whammy} encoder.\r\n     * @method\r\n     * @memberof Whammy\r\n     * @example\r\n     * recorder = new Whammy().Video(0.8, 100);\r\n     * recorder.add(canvas || context || 'image/webp');\r\n     * @param {string} frame - Canvas || Context || image/webp\r\n     * @param {number} duration - Stick a duration (in milliseconds)\r\n     */\r\n    WhammyVideo.prototype.add = function(frame, duration) {\r\n        if ('canvas' in frame) { //CanvasRenderingContext2D\r\n            frame = frame.canvas;\r\n        }\r\n\r\n        if ('toDataURL' in frame) {\r\n            frame = frame.toDataURL('image/webp', this.quality);\r\n        }\r\n\r\n        if (!(/^data:image\\/webp;base64,/ig).test(frame)) {\r\n            throw 'Input must be formatted properly as a base64 encoded DataURI of type image/webp';\r\n        }\r\n        this.frames.push({\r\n            image: frame,\r\n            duration: duration || this.duration\r\n        });\r\n    };\r\n\r\n    function processInWebWorker(_function) {\r\n        var blob = URL.createObjectURL(new Blob([_function.toString(),\r\n            'this.onmessage =  function (eee) {' + _function.name + '(eee.data);}'\r\n        ], {\r\n            type: 'application/javascript'\r\n        }));\r\n\r\n        var worker = new Worker(blob);\r\n        URL.revokeObjectURL(blob);\r\n        return worker;\r\n    }\r\n\r\n    function whammyInWebWorker(frames) {\r\n        function ArrayToWebM(frames) {\r\n            var info = checkFrames(frames);\r\n            if (!info) {\r\n                return [];\r\n            }\r\n\r\n            var clusterMaxDuration = 30000;\r\n\r\n            var EBML = [{\r\n                'id': 0x1a45dfa3, // EBML\r\n                'data': [{\r\n                    'data': 1,\r\n                    'id': 0x4286 // EBMLVersion\r\n                }, {\r\n                    'data': 1,\r\n                    'id': 0x42f7 // EBMLReadVersion\r\n                }, {\r\n                    'data': 4,\r\n                    'id': 0x42f2 // EBMLMaxIDLength\r\n                }, {\r\n                    'data': 8,\r\n                    'id': 0x42f3 // EBMLMaxSizeLength\r\n                }, {\r\n                    'data': 'webm',\r\n                    'id': 0x4282 // DocType\r\n                }, {\r\n                    'data': 2,\r\n                    'id': 0x4287 // DocTypeVersion\r\n                }, {\r\n                    'data': 2,\r\n                    'id': 0x4285 // DocTypeReadVersion\r\n                }]\r\n            }, {\r\n                'id': 0x18538067, // Segment\r\n                'data': [{\r\n                    'id': 0x1549a966, // Info\r\n                    'data': [{\r\n                        'data': 1e6, //do things in millisecs (num of nanosecs for duration scale)\r\n                        'id': 0x2ad7b1 // TimecodeScale\r\n                    }, {\r\n                        'data': 'whammy',\r\n                        'id': 0x4d80 // MuxingApp\r\n                    }, {\r\n                        'data': 'whammy',\r\n                        'id': 0x5741 // WritingApp\r\n                    }, {\r\n                        'data': doubleToString(info.duration),\r\n                        'id': 0x4489 // Duration\r\n                    }]\r\n                }, {\r\n                    'id': 0x1654ae6b, // Tracks\r\n                    'data': [{\r\n                        'id': 0xae, // TrackEntry\r\n                        'data': [{\r\n                            'data': 1,\r\n                            'id': 0xd7 // TrackNumber\r\n                        }, {\r\n                            'data': 1,\r\n                            'id': 0x73c5 // TrackUID\r\n                        }, {\r\n                            'data': 0,\r\n                            'id': 0x9c // FlagLacing\r\n                        }, {\r\n                            'data': 'und',\r\n                            'id': 0x22b59c // Language\r\n                        }, {\r\n                            'data': 'V_VP8',\r\n                            'id': 0x86 // CodecID\r\n                        }, {\r\n                            'data': 'VP8',\r\n                            'id': 0x258688 // CodecName\r\n                        }, {\r\n                            'data': 1,\r\n                            'id': 0x83 // TrackType\r\n                        }, {\r\n                            'id': 0xe0, // Video\r\n                            'data': [{\r\n                                'data': info.width,\r\n                                'id': 0xb0 // PixelWidth\r\n                            }, {\r\n                                'data': info.height,\r\n                                'id': 0xba // PixelHeight\r\n                            }]\r\n                        }]\r\n                    }]\r\n                }]\r\n            }];\r\n\r\n            //Generate clusters (max duration)\r\n            var frameNumber = 0;\r\n            var clusterTimecode = 0;\r\n            while (frameNumber < frames.length) {\r\n\r\n                var clusterFrames = [];\r\n                var clusterDuration = 0;\r\n                do {\r\n                    clusterFrames.push(frames[frameNumber]);\r\n                    clusterDuration += frames[frameNumber].duration;\r\n                    frameNumber++;\r\n                } while (frameNumber < frames.length && clusterDuration < clusterMaxDuration);\r\n\r\n                var clusterCounter = 0;\r\n                var cluster = {\r\n                    'id': 0x1f43b675, // Cluster\r\n                    'data': getClusterData(clusterTimecode, clusterCounter, clusterFrames)\r\n                }; //Add cluster to segment\r\n                EBML[1].data.push(cluster);\r\n                clusterTimecode += clusterDuration;\r\n            }\r\n\r\n            return generateEBML(EBML);\r\n        }\r\n\r\n        function getClusterData(clusterTimecode, clusterCounter, clusterFrames) {\r\n            return [{\r\n                'data': clusterTimecode,\r\n                'id': 0xe7 // Timecode\r\n            }].concat(clusterFrames.map(function(webp) {\r\n                var block = makeSimpleBlock({\r\n                    discardable: 0,\r\n                    frame: webp.data.slice(4),\r\n                    invisible: 0,\r\n                    keyframe: 1,\r\n                    lacing: 0,\r\n                    trackNum: 1,\r\n                    timecode: Math.round(clusterCounter)\r\n                });\r\n                clusterCounter += webp.duration;\r\n                return {\r\n                    data: block,\r\n                    id: 0xa3\r\n                };\r\n            }));\r\n        }\r\n\r\n        // sums the lengths of all the frames and gets the duration\r\n\r\n        function checkFrames(frames) {\r\n            if (!frames[0]) {\r\n                postMessage({\r\n                    error: 'Something went wrong. Maybe WebP format is not supported in the current browser.'\r\n                });\r\n                return;\r\n            }\r\n\r\n            var width = frames[0].width,\r\n                height = frames[0].height,\r\n                duration = frames[0].duration;\r\n\r\n            for (var i = 1; i < frames.length; i++) {\r\n                duration += frames[i].duration;\r\n            }\r\n            return {\r\n                duration: duration,\r\n                width: width,\r\n                height: height\r\n            };\r\n        }\r\n\r\n        function numToBuffer(num) {\r\n            var parts = [];\r\n            while (num > 0) {\r\n                parts.push(num & 0xff);\r\n                num = num >> 8;\r\n            }\r\n            return new Uint8Array(parts.reverse());\r\n        }\r\n\r\n        function strToBuffer(str) {\r\n            return new Uint8Array(str.split('').map(function(e) {\r\n                return e.charCodeAt(0);\r\n            }));\r\n        }\r\n\r\n        function bitsToBuffer(bits) {\r\n            var data = [];\r\n            var pad = (bits.length % 8) ? (new Array(1 + 8 - (bits.length % 8))).join('0') : '';\r\n            bits = pad + bits;\r\n            for (var i = 0; i < bits.length; i += 8) {\r\n                data.push(parseInt(bits.substr(i, 8), 2));\r\n            }\r\n            return new Uint8Array(data);\r\n        }\r\n\r\n        function generateEBML(json) {\r\n            var ebml = [];\r\n            for (var i = 0; i < json.length; i++) {\r\n                var data = json[i].data;\r\n\r\n                if (typeof data === 'object') {\r\n                    data = generateEBML(data);\r\n                }\r\n\r\n                if (typeof data === 'number') {\r\n                    data = bitsToBuffer(data.toString(2));\r\n                }\r\n\r\n                if (typeof data === 'string') {\r\n                    data = strToBuffer(data);\r\n                }\r\n\r\n                var len = data.size || data.byteLength || data.length;\r\n                var zeroes = Math.ceil(Math.ceil(Math.log(len) / Math.log(2)) / 8);\r\n                var sizeToString = len.toString(2);\r\n                var padded = (new Array((zeroes * 7 + 7 + 1) - sizeToString.length)).join('0') + sizeToString;\r\n                var size = (new Array(zeroes)).join('0') + '1' + padded;\r\n\r\n                ebml.push(numToBuffer(json[i].id));\r\n                ebml.push(bitsToBuffer(size));\r\n                ebml.push(data);\r\n            }\r\n\r\n            return new Blob(ebml, {\r\n                type: 'video/webm'\r\n            });\r\n        }\r\n\r\n        function toBinStrOld(bits) {\r\n            var data = '';\r\n            var pad = (bits.length % 8) ? (new Array(1 + 8 - (bits.length % 8))).join('0') : '';\r\n            bits = pad + bits;\r\n            for (var i = 0; i < bits.length; i += 8) {\r\n                data += String.fromCharCode(parseInt(bits.substr(i, 8), 2));\r\n            }\r\n            return data;\r\n        }\r\n\r\n        function makeSimpleBlock(data) {\r\n            var flags = 0;\r\n\r\n            if (data.keyframe) {\r\n                flags |= 128;\r\n            }\r\n\r\n            if (data.invisible) {\r\n                flags |= 8;\r\n            }\r\n\r\n            if (data.lacing) {\r\n                flags |= (data.lacing << 1);\r\n            }\r\n\r\n            if (data.discardable) {\r\n                flags |= 1;\r\n            }\r\n\r\n            if (data.trackNum > 127) {\r\n                throw 'TrackNumber > 127 not supported';\r\n            }\r\n\r\n            var out = [data.trackNum | 0x80, data.timecode >> 8, data.timecode & 0xff, flags].map(function(e) {\r\n                return String.fromCharCode(e);\r\n            }).join('') + data.frame;\r\n\r\n            return out;\r\n        }\r\n\r\n        function parseWebP(riff) {\r\n            var VP8 = riff.RIFF[0].WEBP[0];\r\n\r\n            var frameStart = VP8.indexOf('\\x9d\\x01\\x2a'); // A VP8 keyframe starts with the 0x9d012a header\r\n            for (var i = 0, c = []; i < 4; i++) {\r\n                c[i] = VP8.charCodeAt(frameStart + 3 + i);\r\n            }\r\n\r\n            var width, height, tmp;\r\n\r\n            //the code below is literally copied verbatim from the bitstream spec\r\n            tmp = (c[1] << 8) | c[0];\r\n            width = tmp & 0x3FFF;\r\n            tmp = (c[3] << 8) | c[2];\r\n            height = tmp & 0x3FFF;\r\n            return {\r\n                width: width,\r\n                height: height,\r\n                data: VP8,\r\n                riff: riff\r\n            };\r\n        }\r\n\r\n        function getStrLength(string, offset) {\r\n            return parseInt(string.substr(offset + 4, 4).split('').map(function(i) {\r\n                var unpadded = i.charCodeAt(0).toString(2);\r\n                return (new Array(8 - unpadded.length + 1)).join('0') + unpadded;\r\n            }).join(''), 2);\r\n        }\r\n\r\n        function parseRIFF(string) {\r\n            var offset = 0;\r\n            var chunks = {};\r\n\r\n            while (offset < string.length) {\r\n                var id = string.substr(offset, 4);\r\n                var len = getStrLength(string, offset);\r\n                var data = string.substr(offset + 4 + 4, len);\r\n                offset += 4 + 4 + len;\r\n                chunks[id] = chunks[id] || [];\r\n\r\n                if (id === 'RIFF' || id === 'LIST') {\r\n                    chunks[id].push(parseRIFF(data));\r\n                } else {\r\n                    chunks[id].push(data);\r\n                }\r\n            }\r\n            return chunks;\r\n        }\r\n\r\n        function doubleToString(num) {\r\n            return [].slice.call(\r\n                new Uint8Array((new Float64Array([num])).buffer), 0).map(function(e) {\r\n                return String.fromCharCode(e);\r\n            }).reverse().join('');\r\n        }\r\n\r\n        var webm = new ArrayToWebM(frames.map(function(frame) {\r\n            var webp = parseWebP(parseRIFF(atob(frame.image.slice(23))));\r\n            webp.duration = frame.duration;\r\n            return webp;\r\n        }));\r\n\r\n        postMessage(webm);\r\n    }\r\n\r\n    /**\r\n     * Encodes frames in WebM container. It uses WebWorkinvoke to invoke 'ArrayToWebM' method.\r\n     * @param {function} callback - Callback function, that is used to pass recorded blob back to the callee.\r\n     * @method\r\n     * @memberof Whammy\r\n     * @example\r\n     * recorder = new Whammy().Video(0.8, 100);\r\n     * recorder.compile(function(blob) {\r\n     *    // blob.size - blob.type\r\n     * });\r\n     */\r\n    WhammyVideo.prototype.compile = function(callback) {\r\n        var webWorker = processInWebWorker(whammyInWebWorker);\r\n\r\n        webWorker.onmessage = function(event) {\r\n            if (event.data.error) {\r\n                console.error(event.data.error);\r\n                return;\r\n            }\r\n            callback(event.data);\r\n        };\r\n\r\n        webWorker.postMessage(this.frames);\r\n    };\r\n\r\n    return {\r\n        /**\r\n         * A more abstract-ish API.\r\n         * @method\r\n         * @memberof Whammy\r\n         * @example\r\n         * recorder = new Whammy().Video(0.8, 100);\r\n         * @param {?number} speed - 0.8\r\n         * @param {?number} quality - 100\r\n         */\r\n        Video: WhammyVideo\r\n    };\r\n})();\r\n\r\nif (typeof RecordRTC !== 'undefined') {\r\n    RecordRTC.Whammy = Whammy;\r\n}\n\r\n// ______________ (indexed-db)\r\n// DiskStorage.js\r\n\r\n/**\r\n * DiskStorage is a standalone object used by {@link RecordRTC} to store recorded blobs in IndexedDB storage.\r\n * @summary Writing blobs into IndexedDB.\r\n * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}\r\n * @author {@link https://MuazKhan.com|Muaz Khan}\r\n * @example\r\n * DiskStorage.Store({\r\n *     audioBlob: yourAudioBlob,\r\n *     videoBlob: yourVideoBlob,\r\n *     gifBlob  : yourGifBlob\r\n * });\r\n * DiskStorage.Fetch(function(dataURL, type) {\r\n *     if(type === 'audioBlob') { }\r\n *     if(type === 'videoBlob') { }\r\n *     if(type === 'gifBlob')   { }\r\n * });\r\n * // DiskStorage.dataStoreName = 'recordRTC';\r\n * // DiskStorage.onError = function(error) { };\r\n * @property {function} init - This method must be called once to initialize IndexedDB ObjectStore. Though, it is auto-used internally.\r\n * @property {function} Fetch - This method fetches stored blobs from IndexedDB.\r\n * @property {function} Store - This method stores blobs in IndexedDB.\r\n * @property {function} onError - This function is invoked for any known/unknown error.\r\n * @property {string} dataStoreName - Name of the ObjectStore created in IndexedDB storage.\r\n * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}\r\n */\r\n\r\n\r\nvar DiskStorage = {\r\n    /**\r\n     * This method must be called once to initialize IndexedDB ObjectStore. Though, it is auto-used internally.\r\n     * @method\r\n     * @memberof DiskStorage\r\n     * @internal\r\n     * @example\r\n     * DiskStorage.init();\r\n     */\r\n    init: function() {\r\n        var self = this;\r\n\r\n        if (typeof indexedDB === 'undefined' || typeof indexedDB.open === 'undefined') {\r\n            console.error('IndexedDB API are not available in this browser.');\r\n            return;\r\n        }\r\n\r\n        var dbVersion = 1;\r\n        var dbName = this.dbName || location.href.replace(/\\/|:|#|%|\\.|\\[|\\]/g, ''),\r\n            db;\r\n        var request = indexedDB.open(dbName, dbVersion);\r\n\r\n        function createObjectStore(dataBase) {\r\n            dataBase.createObjectStore(self.dataStoreName);\r\n        }\r\n\r\n        function putInDB() {\r\n            var transaction = db.transaction([self.dataStoreName], 'readwrite');\r\n\r\n            if (self.videoBlob) {\r\n                transaction.objectStore(self.dataStoreName).put(self.videoBlob, 'videoBlob');\r\n            }\r\n\r\n            if (self.gifBlob) {\r\n                transaction.objectStore(self.dataStoreName).put(self.gifBlob, 'gifBlob');\r\n            }\r\n\r\n            if (self.audioBlob) {\r\n                transaction.objectStore(self.dataStoreName).put(self.audioBlob, 'audioBlob');\r\n            }\r\n\r\n            function getFromStore(portionName) {\r\n                transaction.objectStore(self.dataStoreName).get(portionName).onsuccess = function(event) {\r\n                    if (self.callback) {\r\n                        self.callback(event.target.result, portionName);\r\n                    }\r\n                };\r\n            }\r\n\r\n            getFromStore('audioBlob');\r\n            getFromStore('videoBlob');\r\n            getFromStore('gifBlob');\r\n        }\r\n\r\n        request.onerror = self.onError;\r\n\r\n        request.onsuccess = function() {\r\n            db = request.result;\r\n            db.onerror = self.onError;\r\n\r\n            if (db.setVersion) {\r\n                if (db.version !== dbVersion) {\r\n                    var setVersion = db.setVersion(dbVersion);\r\n                    setVersion.onsuccess = function() {\r\n                        createObjectStore(db);\r\n                        putInDB();\r\n                    };\r\n                } else {\r\n                    putInDB();\r\n                }\r\n            } else {\r\n                putInDB();\r\n            }\r\n        };\r\n        request.onupgradeneeded = function(event) {\r\n            createObjectStore(event.target.result);\r\n        };\r\n    },\r\n    /**\r\n     * This method fetches stored blobs from IndexedDB.\r\n     * @method\r\n     * @memberof DiskStorage\r\n     * @internal\r\n     * @example\r\n     * DiskStorage.Fetch(function(dataURL, type) {\r\n     *     if(type === 'audioBlob') { }\r\n     *     if(type === 'videoBlob') { }\r\n     *     if(type === 'gifBlob')   { }\r\n     * });\r\n     */\r\n    Fetch: function(callback) {\r\n        this.callback = callback;\r\n        this.init();\r\n\r\n        return this;\r\n    },\r\n    /**\r\n     * This method stores blobs in IndexedDB.\r\n     * @method\r\n     * @memberof DiskStorage\r\n     * @internal\r\n     * @example\r\n     * DiskStorage.Store({\r\n     *     audioBlob: yourAudioBlob,\r\n     *     videoBlob: yourVideoBlob,\r\n     *     gifBlob  : yourGifBlob\r\n     * });\r\n     */\r\n    Store: function(config) {\r\n        this.audioBlob = config.audioBlob;\r\n        this.videoBlob = config.videoBlob;\r\n        this.gifBlob = config.gifBlob;\r\n\r\n        this.init();\r\n\r\n        return this;\r\n    },\r\n    /**\r\n     * This function is invoked for any known/unknown error.\r\n     * @method\r\n     * @memberof DiskStorage\r\n     * @internal\r\n     * @example\r\n     * DiskStorage.onError = function(error){\r\n     *     alerot( JSON.stringify(error) );\r\n     * };\r\n     */\r\n    onError: function(error) {\r\n        console.error(JSON.stringify(error, null, '\\t'));\r\n    },\r\n\r\n    /**\r\n     * @property {string} dataStoreName - Name of the ObjectStore created in IndexedDB storage.\r\n     * @memberof DiskStorage\r\n     * @internal\r\n     * @example\r\n     * DiskStorage.dataStoreName = 'recordRTC';\r\n     */\r\n    dataStoreName: 'recordRTC',\r\n    dbName: null\r\n};\r\n\r\nif (typeof RecordRTC !== 'undefined') {\r\n    RecordRTC.DiskStorage = DiskStorage;\r\n}\n\r\n// ______________\r\n// GifRecorder.js\r\n\r\n/**\r\n * GifRecorder is standalone calss used by {@link RecordRTC} to record video or canvas into animated gif.\r\n * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}\r\n * @author {@link https://MuazKhan.com|Muaz Khan}\r\n * @typedef GifRecorder\r\n * @class\r\n * @example\r\n * var recorder = new GifRecorder(mediaStream || canvas || context, { onGifPreview: function, onGifRecordingStarted: function, width: 1280, height: 720, frameRate: 200, quality: 10 });\r\n * recorder.record();\r\n * recorder.stop(function(blob) {\r\n *     img.src = URL.createObjectURL(blob);\r\n * });\r\n * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}\r\n * @param {MediaStream} mediaStream - MediaStream object or HTMLCanvasElement or CanvasRenderingContext2D.\r\n * @param {object} config - {disableLogs:true, initCallback: function, width: 320, height: 240, frameRate: 200, quality: 10}\r\n */\r\n\r\nfunction GifRecorder(mediaStream, config) {\r\n    if (typeof GIFEncoder === 'undefined') {\r\n        var script = document.createElement('script');\r\n        script.src = 'https://www.webrtc-experiment.com/gif-recorder.js';\r\n        (document.body || document.documentElement).appendChild(script);\r\n    }\r\n\r\n    config = config || {};\r\n\r\n    var isHTMLObject = mediaStream instanceof CanvasRenderingContext2D || mediaStream instanceof HTMLCanvasElement;\r\n\r\n    /**\r\n     * This method records MediaStream.\r\n     * @method\r\n     * @memberof GifRecorder\r\n     * @example\r\n     * recorder.record();\r\n     */\r\n    this.record = function() {\r\n        if (typeof GIFEncoder === 'undefined') {\r\n            setTimeout(self.record, 1000);\r\n            return;\r\n        }\r\n\r\n        if (!isLoadedMetaData) {\r\n            setTimeout(self.record, 1000);\r\n            return;\r\n        }\r\n\r\n        if (!isHTMLObject) {\r\n            if (!config.width) {\r\n                config.width = video.offsetWidth || 320;\r\n            }\r\n\r\n            if (!config.height) {\r\n                config.height = video.offsetHeight || 240;\r\n            }\r\n\r\n            if (!config.video) {\r\n                config.video = {\r\n                    width: config.width,\r\n                    height: config.height\r\n                };\r\n            }\r\n\r\n            if (!config.canvas) {\r\n                config.canvas = {\r\n                    width: config.width,\r\n                    height: config.height\r\n                };\r\n            }\r\n\r\n            canvas.width = config.canvas.width || 320;\r\n            canvas.height = config.canvas.height || 240;\r\n\r\n            video.width = config.video.width || 320;\r\n            video.height = config.video.height || 240;\r\n        }\r\n\r\n        // external library to record as GIF images\r\n        gifEncoder = new GIFEncoder();\r\n\r\n        // void setRepeat(int iter) \r\n        // Sets the number of times the set of GIF frames should be played. \r\n        // Default is 1; 0 means play indefinitely.\r\n        gifEncoder.setRepeat(0);\r\n\r\n        // void setFrameRate(Number fps) \r\n        // Sets frame rate in frames per second. \r\n        // Equivalent to setDelay(1000/fps).\r\n        // Using \"setDelay\" instead of \"setFrameRate\"\r\n        gifEncoder.setDelay(config.frameRate || 200);\r\n\r\n        // void setQuality(int quality) \r\n        // Sets quality of color quantization (conversion of images to the \r\n        // maximum 256 colors allowed by the GIF specification). \r\n        // Lower values (minimum = 1) produce better colors, \r\n        // but slow processing significantly. 10 is the default, \r\n        // and produces good color mapping at reasonable speeds. \r\n        // Values greater than 20 do not yield significant improvements in speed.\r\n        gifEncoder.setQuality(config.quality || 10);\r\n\r\n        // Boolean start() \r\n        // This writes the GIF Header and returns false if it fails.\r\n        gifEncoder.start();\r\n\r\n        if (typeof config.onGifRecordingStarted === 'function') {\r\n            config.onGifRecordingStarted();\r\n        }\r\n\r\n        startTime = Date.now();\r\n\r\n        function drawVideoFrame(time) {\r\n            if (self.clearedRecordedData === true) {\r\n                return;\r\n            }\r\n\r\n            if (isPausedRecording) {\r\n                return setTimeout(function() {\r\n                    drawVideoFrame(time);\r\n                }, 100);\r\n            }\r\n\r\n            lastAnimationFrame = requestAnimationFrame(drawVideoFrame);\r\n\r\n            if (typeof lastFrameTime === undefined) {\r\n                lastFrameTime = time;\r\n            }\r\n\r\n            // ~10 fps\r\n            if (time - lastFrameTime < 90) {\r\n                return;\r\n            }\r\n\r\n            if (!isHTMLObject && video.paused) {\r\n                // via: https://github.com/muaz-khan/WebRTC-Experiment/pull/316\r\n                // Tweak for Android Chrome\r\n                video.play();\r\n            }\r\n\r\n            if (!isHTMLObject) {\r\n                context.drawImage(video, 0, 0, canvas.width, canvas.height);\r\n            }\r\n\r\n            if (config.onGifPreview) {\r\n                config.onGifPreview(canvas.toDataURL('image/png'));\r\n            }\r\n\r\n            gifEncoder.addFrame(context);\r\n            lastFrameTime = time;\r\n        }\r\n\r\n        lastAnimationFrame = requestAnimationFrame(drawVideoFrame);\r\n\r\n        if (config.initCallback) {\r\n            config.initCallback();\r\n        }\r\n    };\r\n\r\n    /**\r\n     * This method stops recording MediaStream.\r\n     * @param {function} callback - Callback function, that is used to pass recorded blob back to the callee.\r\n     * @method\r\n     * @memberof GifRecorder\r\n     * @example\r\n     * recorder.stop(function(blob) {\r\n     *     img.src = URL.createObjectURL(blob);\r\n     * });\r\n     */\r\n    this.stop = function(callback) {\r\n        callback = callback || function() {};\r\n\r\n        if (lastAnimationFrame) {\r\n            cancelAnimationFrame(lastAnimationFrame);\r\n        }\r\n\r\n        endTime = Date.now();\r\n\r\n        /**\r\n         * @property {Blob} blob - The recorded blob object.\r\n         * @memberof GifRecorder\r\n         * @example\r\n         * recorder.stop(function(){\r\n         *     var blob = recorder.blob;\r\n         * });\r\n         */\r\n        this.blob = new Blob([new Uint8Array(gifEncoder.stream().bin)], {\r\n            type: 'image/gif'\r\n        });\r\n\r\n        callback(this.blob);\r\n\r\n        // bug: find a way to clear old recorded blobs\r\n        gifEncoder.stream().bin = [];\r\n    };\r\n\r\n    var isPausedRecording = false;\r\n\r\n    /**\r\n     * This method pauses the recording process.\r\n     * @method\r\n     * @memberof GifRecorder\r\n     * @example\r\n     * recorder.pause();\r\n     */\r\n    this.pause = function() {\r\n        isPausedRecording = true;\r\n    };\r\n\r\n    /**\r\n     * This method resumes the recording process.\r\n     * @method\r\n     * @memberof GifRecorder\r\n     * @example\r\n     * recorder.resume();\r\n     */\r\n    this.resume = function() {\r\n        isPausedRecording = false;\r\n    };\r\n\r\n    /**\r\n     * This method resets currently recorded data.\r\n     * @method\r\n     * @memberof GifRecorder\r\n     * @example\r\n     * recorder.clearRecordedData();\r\n     */\r\n    this.clearRecordedData = function() {\r\n        self.clearedRecordedData = true;\r\n        clearRecordedDataCB();\r\n    };\r\n\r\n    function clearRecordedDataCB() {\r\n        if (gifEncoder) {\r\n            gifEncoder.stream().bin = [];\r\n        }\r\n    }\r\n\r\n    // for debugging\r\n    this.name = 'GifRecorder';\r\n    this.toString = function() {\r\n        return this.name;\r\n    };\r\n\r\n    var canvas = document.createElement('canvas');\r\n    var context = canvas.getContext('2d');\r\n\r\n    if (isHTMLObject) {\r\n        if (mediaStream instanceof CanvasRenderingContext2D) {\r\n            context = mediaStream;\r\n            canvas = context.canvas;\r\n        } else if (mediaStream instanceof HTMLCanvasElement) {\r\n            context = mediaStream.getContext('2d');\r\n            canvas = mediaStream;\r\n        }\r\n    }\r\n\r\n    var isLoadedMetaData = true;\r\n\r\n    if (!isHTMLObject) {\r\n        var video = document.createElement('video');\r\n        video.muted = true;\r\n        video.autoplay = true;\r\n        video.playsInline = true;\r\n\r\n        isLoadedMetaData = false;\r\n        video.onloadedmetadata = function() {\r\n            isLoadedMetaData = true;\r\n        };\r\n\r\n        setSrcObject(mediaStream, video);\r\n\r\n        video.play();\r\n    }\r\n\r\n    var lastAnimationFrame = null;\r\n    var startTime, endTime, lastFrameTime;\r\n\r\n    var gifEncoder;\r\n\r\n    var self = this;\r\n}\r\n\r\nif (typeof RecordRTC !== 'undefined') {\r\n    RecordRTC.GifRecorder = GifRecorder;\r\n}\n\r\n// Last time updated: 2019-06-21 4:09:42 AM UTC\r\n\r\n// ________________________\r\n// MultiStreamsMixer v1.2.2\r\n\r\n// Open-Sourced: https://github.com/muaz-khan/MultiStreamsMixer\r\n\r\n// --------------------------------------------------\r\n// Muaz Khan     - www.MuazKhan.com\r\n// MIT License   - www.WebRTC-Experiment.com/licence\r\n// --------------------------------------------------\r\n\r\nfunction MultiStreamsMixer(arrayOfMediaStreams, elementClass) {\r\n\r\n    var browserFakeUserAgent = 'Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45';\r\n\r\n    (function(that) {\r\n        if (typeof RecordRTC !== 'undefined') {\r\n            return;\r\n        }\r\n\r\n        if (!that) {\r\n            return;\r\n        }\r\n\r\n        if (typeof window !== 'undefined') {\r\n            return;\r\n        }\r\n\r\n        if (typeof global === 'undefined') {\r\n            return;\r\n        }\r\n\r\n        global.navigator = {\r\n            userAgent: browserFakeUserAgent,\r\n            getUserMedia: function() {}\r\n        };\r\n\r\n        if (!global.console) {\r\n            global.console = {};\r\n        }\r\n\r\n        if (typeof global.console.log === 'undefined' || typeof global.console.error === 'undefined') {\r\n            global.console.error = global.console.log = global.console.log || function() {\r\n                console.log(arguments);\r\n            };\r\n        }\r\n\r\n        if (typeof document === 'undefined') {\r\n            /*global document:true */\r\n            that.document = {\r\n                documentElement: {\r\n                    appendChild: function() {\r\n                        return '';\r\n                    }\r\n                }\r\n            };\r\n\r\n            document.createElement = document.captureStream = document.mozCaptureStream = function() {\r\n                var obj = {\r\n                    getContext: function() {\r\n                        return obj;\r\n                    },\r\n                    play: function() {},\r\n                    pause: function() {},\r\n                    drawImage: function() {},\r\n                    toDataURL: function() {\r\n                        return '';\r\n                    },\r\n                    style: {}\r\n                };\r\n                return obj;\r\n            };\r\n\r\n            that.HTMLVideoElement = function() {};\r\n        }\r\n\r\n        if (typeof location === 'undefined') {\r\n            /*global location:true */\r\n            that.location = {\r\n                protocol: 'file:',\r\n                href: '',\r\n                hash: ''\r\n            };\r\n        }\r\n\r\n        if (typeof screen === 'undefined') {\r\n            /*global screen:true */\r\n            that.screen = {\r\n                width: 0,\r\n                height: 0\r\n            };\r\n        }\r\n\r\n        if (typeof URL === 'undefined') {\r\n            /*global screen:true */\r\n            that.URL = {\r\n                createObjectURL: function() {\r\n                    return '';\r\n                },\r\n                revokeObjectURL: function() {\r\n                    return '';\r\n                }\r\n            };\r\n        }\r\n\r\n        /*global window:true */\r\n        that.window = global;\r\n    })(typeof global !== 'undefined' ? global : null);\r\n\r\n    // requires: chrome://flags/#enable-experimental-web-platform-features\r\n\r\n    elementClass = elementClass || 'multi-streams-mixer';\r\n\r\n    var videos = [];\r\n    var isStopDrawingFrames = false;\r\n\r\n    var canvas = document.createElement('canvas');\r\n    var context = canvas.getContext('2d');\r\n    canvas.style.opacity = 0;\r\n    canvas.style.position = 'absolute';\r\n    canvas.style.zIndex = -1;\r\n    canvas.style.top = '-1000em';\r\n    canvas.style.left = '-1000em';\r\n    canvas.className = elementClass;\r\n    (document.body || document.documentElement).appendChild(canvas);\r\n\r\n    this.disableLogs = false;\r\n    this.frameInterval = 10;\r\n\r\n    this.width = 360;\r\n    this.height = 240;\r\n\r\n    // use gain node to prevent echo\r\n    this.useGainNode = true;\r\n\r\n    var self = this;\r\n\r\n    // _____________________________\r\n    // Cross-Browser-Declarations.js\r\n\r\n    // WebAudio API representer\r\n    var AudioContext = window.AudioContext;\r\n\r\n    if (typeof AudioContext === 'undefined') {\r\n        if (typeof webkitAudioContext !== 'undefined') {\r\n            /*global AudioContext:true */\r\n            AudioContext = webkitAudioContext;\r\n        }\r\n\r\n        if (typeof mozAudioContext !== 'undefined') {\r\n            /*global AudioContext:true */\r\n            AudioContext = mozAudioContext;\r\n        }\r\n    }\r\n\r\n    /*jshint -W079 */\r\n    var URL = window.URL;\r\n\r\n    if (typeof URL === 'undefined' && typeof webkitURL !== 'undefined') {\r\n        /*global URL:true */\r\n        URL = webkitURL;\r\n    }\r\n\r\n    if (typeof navigator !== 'undefined' && typeof navigator.getUserMedia === 'undefined') { // maybe window.navigator?\r\n        if (typeof navigator.webkitGetUserMedia !== 'undefined') {\r\n            navigator.getUserMedia = navigator.webkitGetUserMedia;\r\n        }\r\n\r\n        if (typeof navigator.mozGetUserMedia !== 'undefined') {\r\n            navigator.getUserMedia = navigator.mozGetUserMedia;\r\n        }\r\n    }\r\n\r\n    var MediaStream = window.MediaStream;\r\n\r\n    if (typeof MediaStream === 'undefined' && typeof webkitMediaStream !== 'undefined') {\r\n        MediaStream = webkitMediaStream;\r\n    }\r\n\r\n    /*global MediaStream:true */\r\n    if (typeof MediaStream !== 'undefined') {\r\n        // override \"stop\" method for all browsers\r\n        if (typeof MediaStream.prototype.stop === 'undefined') {\r\n            MediaStream.prototype.stop = function() {\r\n                this.getTracks().forEach(function(track) {\r\n                    track.stop();\r\n                });\r\n            };\r\n        }\r\n    }\r\n\r\n    var Storage = {};\r\n\r\n    if (typeof AudioContext !== 'undefined') {\r\n        Storage.AudioContext = AudioContext;\r\n    } else if (typeof webkitAudioContext !== 'undefined') {\r\n        Storage.AudioContext = webkitAudioContext;\r\n    }\r\n\r\n    function setSrcObject(stream, element) {\r\n        if ('srcObject' in element) {\r\n            element.srcObject = stream;\r\n        } else if ('mozSrcObject' in element) {\r\n            element.mozSrcObject = stream;\r\n        } else {\r\n            element.srcObject = stream;\r\n        }\r\n    }\r\n\r\n    this.startDrawingFrames = function() {\r\n        drawVideosToCanvas();\r\n    };\r\n\r\n    function drawVideosToCanvas() {\r\n        if (isStopDrawingFrames) {\r\n            return;\r\n        }\r\n\r\n        var videosLength = videos.length;\r\n\r\n        var fullcanvas = false;\r\n        var remaining = [];\r\n        videos.forEach(function(video) {\r\n            if (!video.stream) {\r\n                video.stream = {};\r\n            }\r\n\r\n            if (video.stream.fullcanvas) {\r\n                fullcanvas = video;\r\n            } else {\r\n                // todo: video.stream.active or video.stream.live to fix blank frames issues?\r\n                remaining.push(video);\r\n            }\r\n        });\r\n\r\n        if (fullcanvas) {\r\n            canvas.width = fullcanvas.stream.width;\r\n            canvas.height = fullcanvas.stream.height;\r\n        } else if (remaining.length) {\r\n            canvas.width = videosLength > 1 ? remaining[0].width * 2 : remaining[0].width;\r\n\r\n            var height = 1;\r\n            if (videosLength === 3 || videosLength === 4) {\r\n                height = 2;\r\n            }\r\n            if (videosLength === 5 || videosLength === 6) {\r\n                height = 3;\r\n            }\r\n            if (videosLength === 7 || videosLength === 8) {\r\n                height = 4;\r\n            }\r\n            if (videosLength === 9 || videosLength === 10) {\r\n                height = 5;\r\n            }\r\n            canvas.height = remaining[0].height * height;\r\n        } else {\r\n            canvas.width = self.width || 360;\r\n            canvas.height = self.height || 240;\r\n        }\r\n\r\n        if (fullcanvas && fullcanvas instanceof HTMLVideoElement) {\r\n            drawImage(fullcanvas);\r\n        }\r\n\r\n        remaining.forEach(function(video, idx) {\r\n            drawImage(video, idx);\r\n        });\r\n\r\n        setTimeout(drawVideosToCanvas, self.frameInterval);\r\n    }\r\n\r\n    function drawImage(video, idx) {\r\n        if (isStopDrawingFrames) {\r\n            return;\r\n        }\r\n\r\n        var x = 0;\r\n        var y = 0;\r\n        var width = video.width;\r\n        var height = video.height;\r\n\r\n        if (idx === 1) {\r\n            x = video.width;\r\n        }\r\n\r\n        if (idx === 2) {\r\n            y = video.height;\r\n        }\r\n\r\n        if (idx === 3) {\r\n            x = video.width;\r\n            y = video.height;\r\n        }\r\n\r\n        if (idx === 4) {\r\n            y = video.height * 2;\r\n        }\r\n\r\n        if (idx === 5) {\r\n            x = video.width;\r\n            y = video.height * 2;\r\n        }\r\n\r\n        if (idx === 6) {\r\n            y = video.height * 3;\r\n        }\r\n\r\n        if (idx === 7) {\r\n            x = video.width;\r\n            y = video.height * 3;\r\n        }\r\n\r\n        if (typeof video.stream.left !== 'undefined') {\r\n            x = video.stream.left;\r\n        }\r\n\r\n        if (typeof video.stream.top !== 'undefined') {\r\n            y = video.stream.top;\r\n        }\r\n\r\n        if (typeof video.stream.width !== 'undefined') {\r\n            width = video.stream.width;\r\n        }\r\n\r\n        if (typeof video.stream.height !== 'undefined') {\r\n            height = video.stream.height;\r\n        }\r\n\r\n        context.drawImage(video, x, y, width, height);\r\n\r\n        if (typeof video.stream.onRender === 'function') {\r\n            video.stream.onRender(context, x, y, width, height, idx);\r\n        }\r\n    }\r\n\r\n    function getMixedStream() {\r\n        isStopDrawingFrames = false;\r\n        var mixedVideoStream = getMixedVideoStream();\r\n\r\n        var mixedAudioStream = getMixedAudioStream();\r\n        if (mixedAudioStream) {\r\n            mixedAudioStream.getTracks().filter(function(t) {\r\n                return t.kind === 'audio';\r\n            }).forEach(function(track) {\r\n                mixedVideoStream.addTrack(track);\r\n            });\r\n        }\r\n\r\n        var fullcanvas;\r\n        arrayOfMediaStreams.forEach(function(stream) {\r\n            if (stream.fullcanvas) {\r\n                fullcanvas = true;\r\n            }\r\n        });\r\n\r\n        // mixedVideoStream.prototype.appendStreams = appendStreams;\r\n        // mixedVideoStream.prototype.resetVideoStreams = resetVideoStreams;\r\n        // mixedVideoStream.prototype.clearRecordedData = clearRecordedData;\r\n\r\n        return mixedVideoStream;\r\n    }\r\n\r\n    function getMixedVideoStream() {\r\n        resetVideoStreams();\r\n\r\n        var capturedStream;\r\n\r\n        if ('captureStream' in canvas) {\r\n            capturedStream = canvas.captureStream();\r\n        } else if ('mozCaptureStream' in canvas) {\r\n            capturedStream = canvas.mozCaptureStream();\r\n        } else if (!self.disableLogs) {\r\n            console.error('Upgrade to latest Chrome or otherwise enable this flag: chrome://flags/#enable-experimental-web-platform-features');\r\n        }\r\n\r\n        var videoStream = new MediaStream();\r\n\r\n        capturedStream.getTracks().filter(function(t) {\r\n            return t.kind === 'video';\r\n        }).forEach(function(track) {\r\n            videoStream.addTrack(track);\r\n        });\r\n\r\n        canvas.stream = videoStream;\r\n\r\n        return videoStream;\r\n    }\r\n\r\n    function getMixedAudioStream() {\r\n        // via: @pehrsons\r\n        if (!Storage.AudioContextConstructor) {\r\n            Storage.AudioContextConstructor = new Storage.AudioContext();\r\n        }\r\n\r\n        self.audioContext = Storage.AudioContextConstructor;\r\n\r\n        self.audioSources = [];\r\n\r\n        if (self.useGainNode === true) {\r\n            self.gainNode = self.audioContext.createGain();\r\n            self.gainNode.connect(self.audioContext.destination);\r\n            self.gainNode.gain.value = 0; // don't hear self\r\n        }\r\n\r\n        var audioTracksLength = 0;\r\n        arrayOfMediaStreams.forEach(function(stream) {\r\n            if (!stream.getTracks().filter(function(t) {\r\n                    return t.kind === 'audio';\r\n                }).length) {\r\n                return;\r\n            }\r\n\r\n            audioTracksLength++;\r\n\r\n            var audioSource = self.audioContext.createMediaStreamSource(stream);\r\n\r\n            if (self.useGainNode === true) {\r\n                audioSource.connect(self.gainNode);\r\n            }\r\n\r\n            self.audioSources.push(audioSource);\r\n        });\r\n\r\n        if (!audioTracksLength) {\r\n            // because \"self.audioContext\" is not initialized\r\n            // that's why we've to ignore rest of the code\r\n            return;\r\n        }\r\n\r\n        self.audioDestination = self.audioContext.createMediaStreamDestination();\r\n        self.audioSources.forEach(function(audioSource) {\r\n            audioSource.connect(self.audioDestination);\r\n        });\r\n        return self.audioDestination.stream;\r\n    }\r\n\r\n    function getVideo(stream) {\r\n        var video = document.createElement('video');\r\n\r\n        setSrcObject(stream, video);\r\n\r\n        video.className = elementClass;\r\n\r\n        video.muted = true;\r\n        video.volume = 0;\r\n\r\n        video.width = stream.width || self.width || 360;\r\n        video.height = stream.height || self.height || 240;\r\n\r\n        video.play();\r\n\r\n        return video;\r\n    }\r\n\r\n    this.appendStreams = function(streams) {\r\n        if (!streams) {\r\n            throw 'First parameter is required.';\r\n        }\r\n\r\n        if (!(streams instanceof Array)) {\r\n            streams = [streams];\r\n        }\r\n\r\n        streams.forEach(function(stream) {\r\n            var newStream = new MediaStream();\r\n\r\n            if (stream.getTracks().filter(function(t) {\r\n                    return t.kind === 'video';\r\n                }).length) {\r\n                var video = getVideo(stream);\r\n                video.stream = stream;\r\n                videos.push(video);\r\n\r\n                newStream.addTrack(stream.getTracks().filter(function(t) {\r\n                    return t.kind === 'video';\r\n                })[0]);\r\n            }\r\n\r\n            if (stream.getTracks().filter(function(t) {\r\n                    return t.kind === 'audio';\r\n                }).length) {\r\n                var audioSource = self.audioContext.createMediaStreamSource(stream);\r\n                self.audioDestination = self.audioContext.createMediaStreamDestination();\r\n                audioSource.connect(self.audioDestination);\r\n\r\n                newStream.addTrack(self.audioDestination.stream.getTracks().filter(function(t) {\r\n                    return t.kind === 'audio';\r\n                })[0]);\r\n            }\r\n\r\n            arrayOfMediaStreams.push(newStream);\r\n        });\r\n    };\r\n\r\n    this.releaseStreams = function() {\r\n        videos = [];\r\n        isStopDrawingFrames = true;\r\n\r\n        if (self.gainNode) {\r\n            self.gainNode.disconnect();\r\n            self.gainNode = null;\r\n        }\r\n\r\n        if (self.audioSources.length) {\r\n            self.audioSources.forEach(function(source) {\r\n                source.disconnect();\r\n            });\r\n            self.audioSources = [];\r\n        }\r\n\r\n        if (self.audioDestination) {\r\n            self.audioDestination.disconnect();\r\n            self.audioDestination = null;\r\n        }\r\n\r\n        if (self.audioContext) {\r\n            self.audioContext.close();\r\n        }\r\n\r\n        self.audioContext = null;\r\n\r\n        context.clearRect(0, 0, canvas.width, canvas.height);\r\n\r\n        if (canvas.stream) {\r\n            canvas.stream.stop();\r\n            canvas.stream = null;\r\n        }\r\n    };\r\n\r\n    this.resetVideoStreams = function(streams) {\r\n        if (streams && !(streams instanceof Array)) {\r\n            streams = [streams];\r\n        }\r\n\r\n        resetVideoStreams(streams);\r\n    };\r\n\r\n    function resetVideoStreams(streams) {\r\n        videos = [];\r\n        streams = streams || arrayOfMediaStreams;\r\n\r\n        // via: @adrian-ber\r\n        streams.forEach(function(stream) {\r\n            if (!stream.getTracks().filter(function(t) {\r\n                    return t.kind === 'video';\r\n                }).length) {\r\n                return;\r\n            }\r\n\r\n            var video = getVideo(stream);\r\n            video.stream = stream;\r\n            videos.push(video);\r\n        });\r\n    }\r\n\r\n    // for debugging\r\n    this.name = 'MultiStreamsMixer';\r\n    this.toString = function() {\r\n        return this.name;\r\n    };\r\n\r\n    this.getMixedStream = getMixedStream;\r\n\r\n}\r\n\r\nif (typeof RecordRTC === 'undefined') {\r\n    if (typeof module !== 'undefined' /* && !!module.exports*/ ) {\r\n        module.exports = MultiStreamsMixer;\r\n    }\r\n\r\n    if (typeof define === 'function' && define.amd) {\r\n        define('MultiStreamsMixer', [], function() {\r\n            return MultiStreamsMixer;\r\n        });\r\n    }\r\n}\n\r\n// ______________________\r\n// MultiStreamRecorder.js\r\n\r\n/*\r\n * Video conference recording, using captureStream API along with WebAudio and Canvas2D API.\r\n */\r\n\r\n/**\r\n * MultiStreamRecorder can record multiple videos in single container.\r\n * @summary Multi-videos recorder.\r\n * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}\r\n * @author {@link https://MuazKhan.com|Muaz Khan}\r\n * @typedef MultiStreamRecorder\r\n * @class\r\n * @example\r\n * var options = {\r\n *     mimeType: 'video/webm'\r\n * }\r\n * var recorder = new MultiStreamRecorder(ArrayOfMediaStreams, options);\r\n * recorder.record();\r\n * recorder.stop(function(blob) {\r\n *     video.src = URL.createObjectURL(blob);\r\n *\r\n *     // or\r\n *     var blob = recorder.blob;\r\n * });\r\n * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}\r\n * @param {MediaStreams} mediaStreams - Array of MediaStreams.\r\n * @param {object} config - {disableLogs:true, frameInterval: 1, mimeType: \"video/webm\"}\r\n */\r\n\r\nfunction MultiStreamRecorder(arrayOfMediaStreams, options) {\r\n    arrayOfMediaStreams = arrayOfMediaStreams || [];\r\n    var self = this;\r\n\r\n    var mixer;\r\n    var mediaRecorder;\r\n\r\n    options = options || {\r\n        elementClass: 'multi-streams-mixer',\r\n        mimeType: 'video/webm',\r\n        video: {\r\n            width: 360,\r\n            height: 240\r\n        }\r\n    };\r\n\r\n    if (!options.frameInterval) {\r\n        options.frameInterval = 10;\r\n    }\r\n\r\n    if (!options.video) {\r\n        options.video = {};\r\n    }\r\n\r\n    if (!options.video.width) {\r\n        options.video.width = 360;\r\n    }\r\n\r\n    if (!options.video.height) {\r\n        options.video.height = 240;\r\n    }\r\n\r\n    /**\r\n     * This method records all MediaStreams.\r\n     * @method\r\n     * @memberof MultiStreamRecorder\r\n     * @example\r\n     * recorder.record();\r\n     */\r\n    this.record = function() {\r\n        // github/muaz-khan/MultiStreamsMixer\r\n        mixer = new MultiStreamsMixer(arrayOfMediaStreams, options.elementClass || 'multi-streams-mixer');\r\n\r\n        if (getAllVideoTracks().length) {\r\n            mixer.frameInterval = options.frameInterval || 10;\r\n            mixer.width = options.video.width || 360;\r\n            mixer.height = options.video.height || 240;\r\n            mixer.startDrawingFrames();\r\n        }\r\n\r\n        if (options.previewStream && typeof options.previewStream === 'function') {\r\n            options.previewStream(mixer.getMixedStream());\r\n        }\r\n\r\n        // record using MediaRecorder API\r\n        mediaRecorder = new MediaStreamRecorder(mixer.getMixedStream(), options);\r\n        mediaRecorder.record();\r\n    };\r\n\r\n    function getAllVideoTracks() {\r\n        var tracks = [];\r\n        arrayOfMediaStreams.forEach(function(stream) {\r\n            getTracks(stream, 'video').forEach(function(track) {\r\n                tracks.push(track);\r\n            });\r\n        });\r\n        return tracks;\r\n    }\r\n\r\n    /**\r\n     * This method stops recording MediaStream.\r\n     * @param {function} callback - Callback function, that is used to pass recorded blob back to the callee.\r\n     * @method\r\n     * @memberof MultiStreamRecorder\r\n     * @example\r\n     * recorder.stop(function(blob) {\r\n     *     video.src = URL.createObjectURL(blob);\r\n     * });\r\n     */\r\n    this.stop = function(callback) {\r\n        if (!mediaRecorder) {\r\n            return;\r\n        }\r\n\r\n        mediaRecorder.stop(function(blob) {\r\n            self.blob = blob;\r\n\r\n            callback(blob);\r\n\r\n            self.clearRecordedData();\r\n        });\r\n    };\r\n\r\n    /**\r\n     * This method pauses the recording process.\r\n     * @method\r\n     * @memberof MultiStreamRecorder\r\n     * @example\r\n     * recorder.pause();\r\n     */\r\n    this.pause = function() {\r\n        if (mediaRecorder) {\r\n            mediaRecorder.pause();\r\n        }\r\n    };\r\n\r\n    /**\r\n     * This method resumes the recording process.\r\n     * @method\r\n     * @memberof MultiStreamRecorder\r\n     * @example\r\n     * recorder.resume();\r\n     */\r\n    this.resume = function() {\r\n        if (mediaRecorder) {\r\n            mediaRecorder.resume();\r\n        }\r\n    };\r\n\r\n    /**\r\n     * This method resets currently recorded data.\r\n     * @method\r\n     * @memberof MultiStreamRecorder\r\n     * @example\r\n     * recorder.clearRecordedData();\r\n     */\r\n    this.clearRecordedData = function() {\r\n        if (mediaRecorder) {\r\n            mediaRecorder.clearRecordedData();\r\n            mediaRecorder = null;\r\n        }\r\n\r\n        if (mixer) {\r\n            mixer.releaseStreams();\r\n            mixer = null;\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Add extra media-streams to existing recordings.\r\n     * @method\r\n     * @memberof MultiStreamRecorder\r\n     * @param {MediaStreams} mediaStreams - Array of MediaStreams\r\n     * @example\r\n     * recorder.addStreams([newAudioStream, newVideoStream]);\r\n     */\r\n    this.addStreams = function(streams) {\r\n        if (!streams) {\r\n            throw 'First parameter is required.';\r\n        }\r\n\r\n        if (!(streams instanceof Array)) {\r\n            streams = [streams];\r\n        }\r\n\r\n        arrayOfMediaStreams.concat(streams);\r\n\r\n        if (!mediaRecorder || !mixer) {\r\n            return;\r\n        }\r\n\r\n        mixer.appendStreams(streams);\r\n\r\n        if (options.previewStream && typeof options.previewStream === 'function') {\r\n            options.previewStream(mixer.getMixedStream());\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Reset videos during live recording. Replace old videos e.g. replace cameras with full-screen.\r\n     * @method\r\n     * @memberof MultiStreamRecorder\r\n     * @param {MediaStreams} mediaStreams - Array of MediaStreams\r\n     * @example\r\n     * recorder.resetVideoStreams([newVideo1, newVideo2]);\r\n     */\r\n    this.resetVideoStreams = function(streams) {\r\n        if (!mixer) {\r\n            return;\r\n        }\r\n\r\n        if (streams && !(streams instanceof Array)) {\r\n            streams = [streams];\r\n        }\r\n\r\n        mixer.resetVideoStreams(streams);\r\n    };\r\n\r\n    /**\r\n     * Returns MultiStreamsMixer\r\n     * @method\r\n     * @memberof MultiStreamRecorder\r\n     * @example\r\n     * let mixer = recorder.getMixer();\r\n     * mixer.appendStreams([newStream]);\r\n     */\r\n    this.getMixer = function() {\r\n        return mixer;\r\n    };\r\n\r\n    // for debugging\r\n    this.name = 'MultiStreamRecorder';\r\n    this.toString = function() {\r\n        return this.name;\r\n    };\r\n}\r\n\r\nif (typeof RecordRTC !== 'undefined') {\r\n    RecordRTC.MultiStreamRecorder = MultiStreamRecorder;\r\n}\n\r\n// _____________________\r\n// RecordRTC.promises.js\r\n\r\n/**\r\n * RecordRTCPromisesHandler adds promises support in {@link RecordRTC}. Try a {@link https://github.com/muaz-khan/RecordRTC/blob/master/simple-demos/RecordRTCPromisesHandler.html|demo here}\r\n * @summary Promises for {@link RecordRTC}\r\n * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}\r\n * @author {@link https://MuazKhan.com|Muaz Khan}\r\n * @typedef RecordRTCPromisesHandler\r\n * @class\r\n * @example\r\n * var recorder = new RecordRTCPromisesHandler(mediaStream, options);\r\n * recorder.startRecording()\r\n *         .then(successCB)\r\n *         .catch(errorCB);\r\n * // Note: You can access all RecordRTC API using \"recorder.recordRTC\" e.g. \r\n * recorder.recordRTC.onStateChanged = function(state) {};\r\n * recorder.recordRTC.setRecordingDuration(5000);\r\n * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}\r\n * @param {MediaStream} mediaStream - Single media-stream object, array of media-streams, html-canvas-element, etc.\r\n * @param {object} config - {type:\"video\", recorderType: MediaStreamRecorder, disableLogs: true, numberOfAudioChannels: 1, bufferSize: 0, sampleRate: 0, video: HTMLVideoElement, etc.}\r\n * @throws Will throw an error if \"new\" keyword is not used to initiate \"RecordRTCPromisesHandler\". Also throws error if first argument \"MediaStream\" is missing.\r\n * @requires {@link RecordRTC}\r\n */\r\n\r\nfunction RecordRTCPromisesHandler(mediaStream, options) {\r\n    if (!this) {\r\n        throw 'Use \"new RecordRTCPromisesHandler()\"';\r\n    }\r\n\r\n    if (typeof mediaStream === 'undefined') {\r\n        throw 'First argument \"MediaStream\" is required.';\r\n    }\r\n\r\n    var self = this;\r\n\r\n    /**\r\n     * @property {Blob} blob - Access/reach the native {@link RecordRTC} object.\r\n     * @memberof RecordRTCPromisesHandler\r\n     * @example\r\n     * let internal = recorder.recordRTC.getInternalRecorder();\r\n     * alert(internal instanceof MediaStreamRecorder);\r\n     * recorder.recordRTC.onStateChanged = function(state) {};\r\n     */\r\n    self.recordRTC = new RecordRTC(mediaStream, options);\r\n\r\n    /**\r\n     * This method records MediaStream.\r\n     * @method\r\n     * @memberof RecordRTCPromisesHandler\r\n     * @example\r\n     * recorder.startRecording()\r\n     *         .then(successCB)\r\n     *         .catch(errorCB);\r\n     */\r\n    this.startRecording = function() {\r\n        return new Promise(function(resolve, reject) {\r\n            try {\r\n                self.recordRTC.startRecording();\r\n                resolve();\r\n            } catch (e) {\r\n                reject(e);\r\n            }\r\n        });\r\n    };\r\n\r\n    /**\r\n     * This method stops the recording.\r\n     * @method\r\n     * @memberof RecordRTCPromisesHandler\r\n     * @example\r\n     * recorder.stopRecording().then(function() {\r\n     *     var blob = recorder.getBlob();\r\n     * }).catch(errorCB);\r\n     */\r\n    this.stopRecording = function() {\r\n        return new Promise(function(resolve, reject) {\r\n            try {\r\n                self.recordRTC.stopRecording(function(url) {\r\n                    self.blob = self.recordRTC.getBlob();\r\n\r\n                    if (!self.blob || !self.blob.size) {\r\n                        reject('Empty blob.', self.blob);\r\n                        return;\r\n                    }\r\n\r\n                    resolve(url);\r\n                });\r\n            } catch (e) {\r\n                reject(e);\r\n            }\r\n        });\r\n    };\r\n\r\n    /**\r\n     * This method pauses the recording. You can resume recording using \"resumeRecording\" method.\r\n     * @method\r\n     * @memberof RecordRTCPromisesHandler\r\n     * @example\r\n     * recorder.pauseRecording()\r\n     *         .then(successCB)\r\n     *         .catch(errorCB);\r\n     */\r\n    this.pauseRecording = function() {\r\n        return new Promise(function(resolve, reject) {\r\n            try {\r\n                self.recordRTC.pauseRecording();\r\n                resolve();\r\n            } catch (e) {\r\n                reject(e);\r\n            }\r\n        });\r\n    };\r\n\r\n    /**\r\n     * This method resumes the recording.\r\n     * @method\r\n     * @memberof RecordRTCPromisesHandler\r\n     * @example\r\n     * recorder.resumeRecording()\r\n     *         .then(successCB)\r\n     *         .catch(errorCB);\r\n     */\r\n    this.resumeRecording = function() {\r\n        return new Promise(function(resolve, reject) {\r\n            try {\r\n                self.recordRTC.resumeRecording();\r\n                resolve();\r\n            } catch (e) {\r\n                reject(e);\r\n            }\r\n        });\r\n    };\r\n\r\n    /**\r\n     * This method returns data-url for the recorded blob.\r\n     * @method\r\n     * @memberof RecordRTCPromisesHandler\r\n     * @example\r\n     * recorder.stopRecording().then(function() {\r\n     *     recorder.getDataURL().then(function(dataURL) {\r\n     *         window.open(dataURL);\r\n     *     }).catch(errorCB);;\r\n     * }).catch(errorCB);\r\n     */\r\n    this.getDataURL = function(callback) {\r\n        return new Promise(function(resolve, reject) {\r\n            try {\r\n                self.recordRTC.getDataURL(function(dataURL) {\r\n                    resolve(dataURL);\r\n                });\r\n            } catch (e) {\r\n                reject(e);\r\n            }\r\n        });\r\n    };\r\n\r\n    /**\r\n     * This method returns the recorded blob.\r\n     * @method\r\n     * @memberof RecordRTCPromisesHandler\r\n     * @example\r\n     * recorder.stopRecording().then(function() {\r\n     *     recorder.getBlob().then(function(blob) {})\r\n     * }).catch(errorCB);\r\n     */\r\n    this.getBlob = function() {\r\n        return new Promise(function(resolve, reject) {\r\n            try {\r\n                resolve(self.recordRTC.getBlob());\r\n            } catch (e) {\r\n                reject(e);\r\n            }\r\n        });\r\n    };\r\n\r\n    /**\r\n     * This method returns the internal recording object.\r\n     * @method\r\n     * @memberof RecordRTCPromisesHandler\r\n     * @example\r\n     * let internalRecorder = await recorder.getInternalRecorder();\r\n     * if(internalRecorder instanceof MultiStreamRecorder) {\r\n     *     internalRecorder.addStreams([newAudioStream]);\r\n     *     internalRecorder.resetVideoStreams([screenStream]);\r\n     * }\r\n     * @returns {Object} \r\n     */\r\n    this.getInternalRecorder = function() {\r\n        return new Promise(function(resolve, reject) {\r\n            try {\r\n                resolve(self.recordRTC.getInternalRecorder());\r\n            } catch (e) {\r\n                reject(e);\r\n            }\r\n        });\r\n    };\r\n\r\n    /**\r\n     * This method resets the recorder. So that you can reuse single recorder instance many times.\r\n     * @method\r\n     * @memberof RecordRTCPromisesHandler\r\n     * @example\r\n     * await recorder.reset();\r\n     * recorder.startRecording(); // record again\r\n     */\r\n    this.reset = function() {\r\n        return new Promise(function(resolve, reject) {\r\n            try {\r\n                resolve(self.recordRTC.reset());\r\n            } catch (e) {\r\n                reject(e);\r\n            }\r\n        });\r\n    };\r\n\r\n    /**\r\n     * Destroy RecordRTC instance. Clear all recorders and objects.\r\n     * @method\r\n     * @memberof RecordRTCPromisesHandler\r\n     * @example\r\n     * recorder.destroy().then(successCB).catch(errorCB);\r\n     */\r\n    this.destroy = function() {\r\n        return new Promise(function(resolve, reject) {\r\n            try {\r\n                resolve(self.recordRTC.destroy());\r\n            } catch (e) {\r\n                reject(e);\r\n            }\r\n        });\r\n    };\r\n\r\n    /**\r\n     * Get recorder's readonly state.\r\n     * @method\r\n     * @memberof RecordRTCPromisesHandler\r\n     * @example\r\n     * let state = await recorder.getState();\r\n     * // or\r\n     * recorder.getState().then(state => { console.log(state); })\r\n     * @returns {String} Returns recording state.\r\n     */\r\n    this.getState = function() {\r\n        return new Promise(function(resolve, reject) {\r\n            try {\r\n                resolve(self.recordRTC.getState());\r\n            } catch (e) {\r\n                reject(e);\r\n            }\r\n        });\r\n    };\r\n\r\n    /**\r\n     * @property {Blob} blob - Recorded data as \"Blob\" object.\r\n     * @memberof RecordRTCPromisesHandler\r\n     * @example\r\n     * await recorder.stopRecording();\r\n     * let blob = recorder.getBlob(); // or \"recorder.recordRTC.blob\"\r\n     * invokeSaveAsDialog(blob);\r\n     */\r\n    this.blob = null;\r\n\r\n    /**\r\n     * RecordRTC version number\r\n     * @property {String} version - Release version number.\r\n     * @memberof RecordRTCPromisesHandler\r\n     * @static\r\n     * @readonly\r\n     * @example\r\n     * alert(recorder.version);\r\n     */\r\n    this.version = '5.6.2';\r\n}\r\n\r\nif (typeof RecordRTC !== 'undefined') {\r\n    RecordRTC.RecordRTCPromisesHandler = RecordRTCPromisesHandler;\r\n}\n\r\n// ______________________\r\n// WebAssemblyRecorder.js\r\n\r\n/**\r\n * WebAssemblyRecorder lets you create webm videos in JavaScript via WebAssembly. The library consumes raw RGBA32 buffers (4 bytes per pixel) and turns them into a webm video with the given framerate and quality. This makes it compatible out-of-the-box with ImageData from a CANVAS. With realtime mode you can also use webm-wasm for streaming webm videos.\r\n * @summary Video recording feature in Chrome, Firefox and maybe Edge.\r\n * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}\r\n * @author {@link https://MuazKhan.com|Muaz Khan}\r\n * @typedef WebAssemblyRecorder\r\n * @class\r\n * @example\r\n * var recorder = new WebAssemblyRecorder(mediaStream);\r\n * recorder.record();\r\n * recorder.stop(function(blob) {\r\n *     video.src = URL.createObjectURL(blob);\r\n * });\r\n * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}\r\n * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.\r\n * @param {object} config - {webAssemblyPath:'webm-wasm.wasm',workerPath: 'webm-worker.js', frameRate: 30, width: 1920, height: 1080, bitrate: 1024, realtime: true}\r\n */\r\nfunction WebAssemblyRecorder(stream, config) {\r\n    // based on: github.com/GoogleChromeLabs/webm-wasm\r\n\r\n    if (typeof ReadableStream === 'undefined' || typeof WritableStream === 'undefined') {\r\n        // because it fixes readable/writable streams issues\r\n        console.error('Following polyfill is strongly recommended: https://unpkg.com/@mattiasbuelens/web-streams-polyfill/dist/polyfill.min.js');\r\n    }\r\n\r\n    config = config || {};\r\n\r\n    config.width = config.width || 640;\r\n    config.height = config.height || 480;\r\n    config.frameRate = config.frameRate || 30;\r\n    config.bitrate = config.bitrate || 1200;\r\n    config.realtime = config.realtime || true;\r\n\r\n    function createBufferURL(buffer, type) {\r\n        return URL.createObjectURL(new Blob([buffer], {\r\n            type: type || ''\r\n        }));\r\n    }\r\n\r\n    var finished;\r\n\r\n    function cameraStream() {\r\n        return new ReadableStream({\r\n            start: function(controller) {\r\n                var cvs = document.createElement('canvas');\r\n                var video = document.createElement('video');\r\n                var first = true;\r\n                video.srcObject = stream;\r\n                video.muted = true;\r\n                video.height = config.height;\r\n                video.width = config.width;\r\n                video.volume = 0;\r\n                video.onplaying = function() {\r\n                    cvs.width = config.width;\r\n                    cvs.height = config.height;\r\n                    var ctx = cvs.getContext('2d');\r\n                    var frameTimeout = 1000 / config.frameRate;\r\n                    var cameraTimer = setInterval(function f() {\r\n                        if (finished) {\r\n                            clearInterval(cameraTimer);\r\n                            controller.close();\r\n                        }\r\n\r\n                        if (first) {\r\n                            first = false;\r\n                            if (config.onVideoProcessStarted) {\r\n                                config.onVideoProcessStarted();\r\n                            }\r\n                        }\r\n\r\n                        ctx.drawImage(video, 0, 0);\r\n                        if (controller._controlledReadableStream.state !== 'closed') {\r\n                            try {\r\n                                controller.enqueue(\r\n                                    ctx.getImageData(0, 0, config.width, config.height)\r\n                                );\r\n                            } catch (e) {}\r\n                        }\r\n                    }, frameTimeout);\r\n                };\r\n                video.play();\r\n            }\r\n        });\r\n    }\r\n\r\n    var worker;\r\n\r\n    function startRecording(stream, buffer) {\r\n        if (!config.workerPath && !buffer) {\r\n            finished = false;\r\n\r\n            // is it safe to use @latest ?\r\n\r\n            fetch(\r\n                'https://unpkg.com/webm-wasm@latest/dist/webm-worker.js'\r\n            ).then(function(r) {\r\n                r.arrayBuffer().then(function(buffer) {\r\n                    startRecording(stream, buffer);\r\n                });\r\n            });\r\n            return;\r\n        }\r\n\r\n        if (!config.workerPath && buffer instanceof ArrayBuffer) {\r\n            var blob = new Blob([buffer], {\r\n                type: 'text/javascript'\r\n            });\r\n            config.workerPath = URL.createObjectURL(blob);\r\n        }\r\n\r\n        if (!config.workerPath) {\r\n            console.error('workerPath parameter is missing.');\r\n        }\r\n\r\n        worker = new Worker(config.workerPath);\r\n\r\n        worker.postMessage(config.webAssemblyPath || 'https://unpkg.com/webm-wasm@latest/dist/webm-wasm.wasm');\r\n        worker.addEventListener('message', function(event) {\r\n            if (event.data === 'READY') {\r\n                worker.postMessage({\r\n                    width: config.width,\r\n                    height: config.height,\r\n                    bitrate: config.bitrate || 1200,\r\n                    timebaseDen: config.frameRate || 30,\r\n                    realtime: config.realtime\r\n                });\r\n\r\n                cameraStream().pipeTo(new WritableStream({\r\n                    write: function(image) {\r\n                        if (finished) {\r\n                            console.error('Got image, but recorder is finished!');\r\n                            return;\r\n                        }\r\n\r\n                        worker.postMessage(image.data.buffer, [image.data.buffer]);\r\n                    }\r\n                }));\r\n            } else if (!!event.data) {\r\n                if (!isPaused) {\r\n                    arrayOfBuffers.push(event.data);\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * This method records video.\r\n     * @method\r\n     * @memberof WebAssemblyRecorder\r\n     * @example\r\n     * recorder.record();\r\n     */\r\n    this.record = function() {\r\n        arrayOfBuffers = [];\r\n        isPaused = false;\r\n        this.blob = null;\r\n        startRecording(stream);\r\n\r\n        if (typeof config.initCallback === 'function') {\r\n            config.initCallback();\r\n        }\r\n    };\r\n\r\n    var isPaused;\r\n\r\n    /**\r\n     * This method pauses the recording process.\r\n     * @method\r\n     * @memberof WebAssemblyRecorder\r\n     * @example\r\n     * recorder.pause();\r\n     */\r\n    this.pause = function() {\r\n        isPaused = true;\r\n    };\r\n\r\n    /**\r\n     * This method resumes the recording process.\r\n     * @method\r\n     * @memberof WebAssemblyRecorder\r\n     * @example\r\n     * recorder.resume();\r\n     */\r\n    this.resume = function() {\r\n        isPaused = false;\r\n    };\r\n\r\n    function terminate(callback) {\r\n        if (!worker) {\r\n            if (callback) {\r\n                callback();\r\n            }\r\n\r\n            return;\r\n        }\r\n\r\n        // Wait for null event data to indicate that the encoding is complete\r\n        worker.addEventListener('message', function(event) {\r\n            if (event.data === null) {\r\n                worker.terminate();\r\n                worker = null;\r\n\r\n                if (callback) {\r\n                    callback();\r\n                }\r\n            }\r\n        });\r\n\r\n        worker.postMessage(null);\r\n    }\r\n\r\n    var arrayOfBuffers = [];\r\n\r\n    /**\r\n     * This method stops recording video.\r\n     * @param {function} callback - Callback function, that is used to pass recorded blob back to the callee.\r\n     * @method\r\n     * @memberof WebAssemblyRecorder\r\n     * @example\r\n     * recorder.stop(function(blob) {\r\n     *     video.src = URL.createObjectURL(blob);\r\n     * });\r\n     */\r\n    this.stop = function(callback) {\r\n        finished = true;\r\n\r\n        var recorder = this;\r\n\r\n        terminate(function() {\r\n            recorder.blob = new Blob(arrayOfBuffers, {\r\n                type: 'video/webm'\r\n            });\r\n\r\n            callback(recorder.blob);\r\n        });\r\n    };\r\n\r\n    // for debugging\r\n    this.name = 'WebAssemblyRecorder';\r\n    this.toString = function() {\r\n        return this.name;\r\n    };\r\n\r\n    /**\r\n     * This method resets currently recorded data.\r\n     * @method\r\n     * @memberof WebAssemblyRecorder\r\n     * @example\r\n     * recorder.clearRecordedData();\r\n     */\r\n    this.clearRecordedData = function() {\r\n        arrayOfBuffers = [];\r\n        isPaused = false;\r\n        this.blob = null;\r\n\r\n        // todo: if recording-ON then STOP it first\r\n    };\r\n\r\n    /**\r\n     * @property {Blob} blob - The recorded blob object.\r\n     * @memberof WebAssemblyRecorder\r\n     * @example\r\n     * recorder.stop(function(){\r\n     *     var blob = recorder.blob;\r\n     * });\r\n     */\r\n    this.blob = null;\r\n}\r\n\r\nif (typeof RecordRTC !== 'undefined') {\r\n    RecordRTC.WebAssemblyRecorder = WebAssemblyRecorder;\r\n}\n","'use strict';\r\n\r\n// Last time updated: 2020-08-26 8:55:13 AM UTC\r\n\r\n// _________________________\r\n// RTCMultiConnection v3.7.0\r\n\r\n// Open-Sourced: https://github.com/muaz-khan/RTCMultiConnection\r\n\r\n// --------------------------------------------------\r\n// Muaz Khan     - www.MuazKhan.com\r\n// MIT License   - www.WebRTC-Experiment.com/licence\r\n// --------------------------------------------------\r\n\r\nvar RTCMultiConnection = function(roomid, forceOptions) {\r\n\r\n    var browserFakeUserAgent = 'Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45';\r\n\r\n    (function(that) {\r\n        if (!that) {\r\n            return;\r\n        }\r\n\r\n        if (typeof window !== 'undefined') {\r\n            return;\r\n        }\r\n\r\n        if (typeof global === 'undefined') {\r\n            return;\r\n        }\r\n\r\n        global.navigator = {\r\n            userAgent: browserFakeUserAgent,\r\n            getUserMedia: function() {}\r\n        };\r\n\r\n        if (!global.console) {\r\n            global.console = {};\r\n        }\r\n\r\n        if (typeof global.console.debug === 'undefined') {\r\n            global.console.debug = global.console.info = global.console.error = global.console.log = global.console.log || function() {\r\n                console.log(arguments);\r\n            };\r\n        }\r\n\r\n        if (typeof document === 'undefined') {\r\n            /*global document:true */\r\n            that.document = {};\r\n\r\n            document.createElement = document.captureStream = document.mozCaptureStream = function() {\r\n                var obj = {\r\n                    getContext: function() {\r\n                        return obj;\r\n                    },\r\n                    play: function() {},\r\n                    pause: function() {},\r\n                    drawImage: function() {},\r\n                    toDataURL: function() {\r\n                        return '';\r\n                    }\r\n                };\r\n                return obj;\r\n            };\r\n\r\n            document.addEventListener = document.removeEventListener = that.addEventListener = that.removeEventListener = function() {};\r\n\r\n            that.HTMLVideoElement = that.HTMLMediaElement = function() {};\r\n        }\r\n\r\n        if (typeof io === 'undefined') {\r\n            that.io = function() {\r\n                return {\r\n                    on: function(eventName, callback) {\r\n                        callback = callback || function() {};\r\n\r\n                        if (eventName === 'connect') {\r\n                            callback();\r\n                        }\r\n                    },\r\n                    emit: function(eventName, data, callback) {\r\n                        callback = callback || function() {};\r\n                        if (eventName === 'open-room' || eventName === 'join-room') {\r\n                            callback(true, data.sessionid, null);\r\n                        }\r\n                    }\r\n                };\r\n            };\r\n        }\r\n\r\n        if (typeof location === 'undefined') {\r\n            /*global location:true */\r\n            that.location = {\r\n                protocol: 'file:',\r\n                href: '',\r\n                hash: '',\r\n                origin: 'self'\r\n            };\r\n        }\r\n\r\n        if (typeof screen === 'undefined') {\r\n            /*global screen:true */\r\n            that.screen = {\r\n                width: 0,\r\n                height: 0\r\n            };\r\n        }\r\n\r\n        if (typeof URL === 'undefined') {\r\n            /*global screen:true */\r\n            that.URL = {\r\n                createObjectURL: function() {\r\n                    return '';\r\n                },\r\n                revokeObjectURL: function() {\r\n                    return '';\r\n                }\r\n            };\r\n        }\r\n\r\n        /*global window:true */\r\n        that.window = global;\r\n    })(typeof global !== 'undefined' ? global : null);\r\n\r\n    function SocketConnection(connection, connectCallback) {\r\n        function isData(session) {\r\n            return !session.audio && !session.video && !session.screen && session.data;\r\n        }\r\n\r\n        var parameters = '';\r\n\r\n        parameters += '?userid=' + connection.userid;\r\n        parameters += '&sessionid=' + connection.sessionid;\r\n        parameters += '&msgEvent=' + connection.socketMessageEvent;\r\n        parameters += '&socketCustomEvent=' + connection.socketCustomEvent;\r\n        parameters += '&autoCloseEntireSession=' + !!connection.autoCloseEntireSession;\r\n\r\n        if (connection.session.broadcast === true) {\r\n            parameters += '&oneToMany=true';\r\n        }\r\n\r\n        parameters += '&maxParticipantsAllowed=' + connection.maxParticipantsAllowed;\r\n\r\n        if (connection.enableScalableBroadcast) {\r\n            parameters += '&enableScalableBroadcast=true';\r\n            parameters += '&maxRelayLimitPerUser=' + (connection.maxRelayLimitPerUser || 2);\r\n        }\r\n\r\n        parameters += '&extra=' + JSON.stringify(connection.extra || {});\r\n\r\n        if (connection.socketCustomParameters) {\r\n            parameters += connection.socketCustomParameters;\r\n        }\r\n\r\n        try {\r\n            io.sockets = {};\r\n        } catch (e) {};\r\n\r\n        if (!connection.socketURL) {\r\n            connection.socketURL = '/';\r\n        }\r\n\r\n        if (connection.socketURL.substr(connection.socketURL.length - 1, 1) != '/') {\r\n            // connection.socketURL = 'https://domain.com:9001/';\r\n            throw '\"socketURL\" MUST end with a slash.';\r\n        }\r\n\r\n        if (connection.enableLogs) {\r\n            if (connection.socketURL == '/') {\r\n                console.info('socket.io url is: ', location.origin + '/');\r\n            } else {\r\n                console.info('socket.io url is: ', connection.socketURL);\r\n            }\r\n        }\r\n\r\n        try {\r\n            connection.socket = io(connection.socketURL + parameters);\r\n        } catch (e) {\r\n            connection.socket = io.connect(connection.socketURL + parameters, connection.socketOptions);\r\n        }\r\n\r\n        var mPeer = connection.multiPeersHandler;\r\n\r\n        connection.socket.on('extra-data-updated', function(remoteUserId, extra) {\r\n            if (!connection.peers[remoteUserId]) return;\r\n            connection.peers[remoteUserId].extra = extra;\r\n\r\n            connection.onExtraDataUpdated({\r\n                userid: remoteUserId,\r\n                extra: extra\r\n            });\r\n\r\n            updateExtraBackup(remoteUserId, extra);\r\n        });\r\n\r\n        function updateExtraBackup(remoteUserId, extra) {\r\n            if (!connection.peersBackup[remoteUserId]) {\r\n                connection.peersBackup[remoteUserId] = {\r\n                    userid: remoteUserId,\r\n                    extra: {}\r\n                };\r\n            }\r\n\r\n            connection.peersBackup[remoteUserId].extra = extra;\r\n        }\r\n\r\n        function onMessageEvent(message) {\r\n            if (message.remoteUserId != connection.userid) return;\r\n\r\n            if (connection.peers[message.sender] && connection.peers[message.sender].extra != message.message.extra) {\r\n                connection.peers[message.sender].extra = message.extra;\r\n                connection.onExtraDataUpdated({\r\n                    userid: message.sender,\r\n                    extra: message.extra\r\n                });\r\n\r\n                updateExtraBackup(message.sender, message.extra);\r\n            }\r\n\r\n            if (message.message.streamSyncNeeded && connection.peers[message.sender]) {\r\n                var stream = connection.streamEvents[message.message.streamid];\r\n                if (!stream || !stream.stream) {\r\n                    return;\r\n                }\r\n\r\n                var action = message.message.action;\r\n\r\n                if (action === 'ended' || action === 'inactive' || action === 'stream-removed') {\r\n                    if (connection.peersBackup[stream.userid]) {\r\n                        stream.extra = connection.peersBackup[stream.userid].extra;\r\n                    }\r\n                    connection.onstreamended(stream);\r\n                    return;\r\n                }\r\n\r\n                var type = message.message.type != 'both' ? message.message.type : null;\r\n\r\n                if (typeof stream.stream[action] == 'function') {\r\n                    stream.stream[action](type);\r\n                }\r\n                return;\r\n            }\r\n\r\n            if (message.message === 'dropPeerConnection') {\r\n                connection.deletePeer(message.sender);\r\n                return;\r\n            }\r\n\r\n            if (message.message.allParticipants) {\r\n                if (message.message.allParticipants.indexOf(message.sender) === -1) {\r\n                    message.message.allParticipants.push(message.sender);\r\n                }\r\n\r\n                message.message.allParticipants.forEach(function(participant) {\r\n                    mPeer[!connection.peers[participant] ? 'createNewPeer' : 'renegotiatePeer'](participant, {\r\n                        localPeerSdpConstraints: {\r\n                            OfferToReceiveAudio: connection.sdpConstraints.mandatory.OfferToReceiveAudio,\r\n                            OfferToReceiveVideo: connection.sdpConstraints.mandatory.OfferToReceiveVideo\r\n                        },\r\n                        remotePeerSdpConstraints: {\r\n                            OfferToReceiveAudio: connection.session.oneway ? !!connection.session.audio : connection.sdpConstraints.mandatory.OfferToReceiveAudio,\r\n                            OfferToReceiveVideo: connection.session.oneway ? !!connection.session.video || !!connection.session.screen : connection.sdpConstraints.mandatory.OfferToReceiveVideo\r\n                        },\r\n                        isOneWay: !!connection.session.oneway || connection.direction === 'one-way',\r\n                        isDataOnly: isData(connection.session)\r\n                    });\r\n                });\r\n                return;\r\n            }\r\n\r\n            if (message.message.newParticipant) {\r\n                if (message.message.newParticipant == connection.userid) return;\r\n                if (!!connection.peers[message.message.newParticipant]) return;\r\n\r\n                mPeer.createNewPeer(message.message.newParticipant, message.message.userPreferences || {\r\n                    localPeerSdpConstraints: {\r\n                        OfferToReceiveAudio: connection.sdpConstraints.mandatory.OfferToReceiveAudio,\r\n                        OfferToReceiveVideo: connection.sdpConstraints.mandatory.OfferToReceiveVideo\r\n                    },\r\n                    remotePeerSdpConstraints: {\r\n                        OfferToReceiveAudio: connection.session.oneway ? !!connection.session.audio : connection.sdpConstraints.mandatory.OfferToReceiveAudio,\r\n                        OfferToReceiveVideo: connection.session.oneway ? !!connection.session.video || !!connection.session.screen : connection.sdpConstraints.mandatory.OfferToReceiveVideo\r\n                    },\r\n                    isOneWay: !!connection.session.oneway || connection.direction === 'one-way',\r\n                    isDataOnly: isData(connection.session)\r\n                });\r\n                return;\r\n            }\r\n\r\n            if (message.message.readyForOffer) {\r\n                if (connection.attachStreams.length) {\r\n                    connection.waitingForLocalMedia = false;\r\n                }\r\n\r\n                if (connection.waitingForLocalMedia) {\r\n                    // if someone is waiting to join you\r\n                    // make sure that we've local media before making a handshake\r\n                    setTimeout(function() {\r\n                        onMessageEvent(message);\r\n                    }, 1);\r\n                    return;\r\n                }\r\n            }\r\n\r\n            if (message.message.newParticipationRequest && message.sender !== connection.userid) {\r\n                if (connection.peers[message.sender]) {\r\n                    connection.deletePeer(message.sender);\r\n                }\r\n\r\n                var userPreferences = {\r\n                    extra: message.extra || {},\r\n                    localPeerSdpConstraints: message.message.remotePeerSdpConstraints || {\r\n                        OfferToReceiveAudio: connection.sdpConstraints.mandatory.OfferToReceiveAudio,\r\n                        OfferToReceiveVideo: connection.sdpConstraints.mandatory.OfferToReceiveVideo\r\n                    },\r\n                    remotePeerSdpConstraints: message.message.localPeerSdpConstraints || {\r\n                        OfferToReceiveAudio: connection.session.oneway ? !!connection.session.audio : connection.sdpConstraints.mandatory.OfferToReceiveAudio,\r\n                        OfferToReceiveVideo: connection.session.oneway ? !!connection.session.video || !!connection.session.screen : connection.sdpConstraints.mandatory.OfferToReceiveVideo\r\n                    },\r\n                    isOneWay: typeof message.message.isOneWay !== 'undefined' ? message.message.isOneWay : !!connection.session.oneway || connection.direction === 'one-way',\r\n                    isDataOnly: typeof message.message.isDataOnly !== 'undefined' ? message.message.isDataOnly : isData(connection.session),\r\n                    dontGetRemoteStream: typeof message.message.isOneWay !== 'undefined' ? message.message.isOneWay : !!connection.session.oneway || connection.direction === 'one-way',\r\n                    dontAttachLocalStream: !!message.message.dontGetRemoteStream,\r\n                    connectionDescription: message,\r\n                    successCallback: function() {}\r\n                };\r\n\r\n                connection.onNewParticipant(message.sender, userPreferences);\r\n                return;\r\n            }\r\n\r\n            if (message.message.changedUUID) {\r\n                if (connection.peers[message.message.oldUUID]) {\r\n                    connection.peers[message.message.newUUID] = connection.peers[message.message.oldUUID];\r\n                    delete connection.peers[message.message.oldUUID];\r\n                }\r\n            }\r\n\r\n            if (message.message.userLeft) {\r\n                mPeer.onUserLeft(message.sender);\r\n\r\n                if (!!message.message.autoCloseEntireSession) {\r\n                    connection.leave();\r\n                }\r\n\r\n                return;\r\n            }\r\n\r\n            mPeer.addNegotiatedMessage(message.message, message.sender);\r\n        }\r\n\r\n        connection.socket.on(connection.socketMessageEvent, onMessageEvent);\r\n\r\n        var alreadyConnected = false;\r\n\r\n        connection.socket.resetProps = function() {\r\n            alreadyConnected = false;\r\n        };\r\n\r\n        connection.socket.on('connect', function() {\r\n            if (alreadyConnected) {\r\n                return;\r\n            }\r\n            alreadyConnected = true;\r\n\r\n            if (connection.enableLogs) {\r\n                console.info('socket.io connection is opened.');\r\n            }\r\n\r\n            setTimeout(function() {\r\n                connection.socket.emit('extra-data-updated', connection.extra);\r\n            }, 1000);\r\n\r\n            if (connectCallback) {\r\n                connectCallback(connection.socket);\r\n            }\r\n        });\r\n\r\n        connection.socket.on('disconnect', function(event) {\r\n            connection.onSocketDisconnect(event);\r\n        });\r\n\r\n        connection.socket.on('error', function(event) {\r\n            connection.onSocketError(event);\r\n        });\r\n\r\n        connection.socket.on('user-disconnected', function(remoteUserId) {\r\n            if (remoteUserId === connection.userid) {\r\n                return;\r\n            }\r\n\r\n            connection.onUserStatusChanged({\r\n                userid: remoteUserId,\r\n                status: 'offline',\r\n                extra: connection.peers[remoteUserId] ? connection.peers[remoteUserId].extra || {} : {}\r\n            });\r\n\r\n            connection.deletePeer(remoteUserId);\r\n        });\r\n\r\n        connection.socket.on('user-connected', function(userid) {\r\n            if (userid === connection.userid) {\r\n                return;\r\n            }\r\n\r\n            connection.onUserStatusChanged({\r\n                userid: userid,\r\n                status: 'online',\r\n                extra: connection.peers[userid] ? connection.peers[userid].extra || {} : {}\r\n            });\r\n        });\r\n\r\n        connection.socket.on('closed-entire-session', function(sessionid, extra) {\r\n            connection.leave();\r\n            connection.onEntireSessionClosed({\r\n                sessionid: sessionid,\r\n                userid: sessionid,\r\n                extra: extra\r\n            });\r\n        });\r\n\r\n        connection.socket.on('userid-already-taken', function(useridAlreadyTaken, yourNewUserId) {\r\n            connection.onUserIdAlreadyTaken(useridAlreadyTaken, yourNewUserId);\r\n        });\r\n\r\n        connection.socket.on('logs', function(log) {\r\n            if (!connection.enableLogs) return;\r\n            console.debug('server-logs', log);\r\n        });\r\n\r\n        connection.socket.on('number-of-broadcast-viewers-updated', function(data) {\r\n            connection.onNumberOfBroadcastViewersUpdated(data);\r\n        });\r\n\r\n        connection.socket.on('set-isInitiator-true', function(sessionid) {\r\n            if (sessionid != connection.sessionid) return;\r\n            connection.isInitiator = true;\r\n        });\r\n    }\r\n\r\n    function MultiPeers(connection) {\r\n        var self = this;\r\n\r\n        var skipPeers = ['getAllParticipants', 'getLength', 'selectFirst', 'streams', 'send', 'forEach'];\r\n        connection.peers = {\r\n            getLength: function() {\r\n                var numberOfPeers = 0;\r\n                for (var peer in this) {\r\n                    if (skipPeers.indexOf(peer) == -1) {\r\n                        numberOfPeers++;\r\n                    }\r\n                }\r\n                return numberOfPeers;\r\n            },\r\n            selectFirst: function() {\r\n                var firstPeer;\r\n                for (var peer in this) {\r\n                    if (skipPeers.indexOf(peer) == -1) {\r\n                        firstPeer = this[peer];\r\n                    }\r\n                }\r\n                return firstPeer;\r\n            },\r\n            getAllParticipants: function(sender) {\r\n                var allPeers = [];\r\n                for (var peer in this) {\r\n                    if (skipPeers.indexOf(peer) == -1 && peer != sender) {\r\n                        allPeers.push(peer);\r\n                    }\r\n                }\r\n                return allPeers;\r\n            },\r\n            forEach: function(callback) {\r\n                this.getAllParticipants().forEach(function(participant) {\r\n                    callback(connection.peers[participant]);\r\n                });\r\n            },\r\n            send: function(data, remoteUserId) {\r\n                var that = this;\r\n\r\n                if (!isNull(data.size) && !isNull(data.type)) {\r\n                    if (connection.enableFileSharing) {\r\n                        self.shareFile(data, remoteUserId);\r\n                        return;\r\n                    }\r\n\r\n                    if (typeof data !== 'string') {\r\n                        data = JSON.stringify(data);\r\n                    }\r\n                }\r\n\r\n                if (data.type !== 'text' && !(data instanceof ArrayBuffer) && !(data instanceof DataView)) {\r\n                    TextSender.send({\r\n                        text: data,\r\n                        channel: this,\r\n                        connection: connection,\r\n                        remoteUserId: remoteUserId\r\n                    });\r\n                    return;\r\n                }\r\n\r\n                if (data.type === 'text') {\r\n                    data = JSON.stringify(data);\r\n                }\r\n\r\n                if (remoteUserId) {\r\n                    var remoteUser = connection.peers[remoteUserId];\r\n                    if (remoteUser) {\r\n                        if (!remoteUser.channels.length) {\r\n                            connection.peers[remoteUserId].createDataChannel();\r\n                            connection.renegotiate(remoteUserId);\r\n                            setTimeout(function() {\r\n                                that.send(data, remoteUserId);\r\n                            }, 3000);\r\n                            return;\r\n                        }\r\n\r\n                        remoteUser.channels.forEach(function(channel) {\r\n                            channel.send(data);\r\n                        });\r\n                        return;\r\n                    }\r\n                }\r\n\r\n                this.getAllParticipants().forEach(function(participant) {\r\n                    if (!that[participant].channels.length) {\r\n                        connection.peers[participant].createDataChannel();\r\n                        connection.renegotiate(participant);\r\n                        setTimeout(function() {\r\n                            that[participant].channels.forEach(function(channel) {\r\n                                channel.send(data);\r\n                            });\r\n                        }, 3000);\r\n                        return;\r\n                    }\r\n\r\n                    that[participant].channels.forEach(function(channel) {\r\n                        channel.send(data);\r\n                    });\r\n                });\r\n            }\r\n        };\r\n\r\n        this.uuid = connection.userid;\r\n\r\n        this.getLocalConfig = function(remoteSdp, remoteUserId, userPreferences) {\r\n            if (!userPreferences) {\r\n                userPreferences = {};\r\n            }\r\n\r\n            return {\r\n                streamsToShare: userPreferences.streamsToShare || {},\r\n                rtcMultiConnection: connection,\r\n                connectionDescription: userPreferences.connectionDescription,\r\n                userid: remoteUserId,\r\n                localPeerSdpConstraints: userPreferences.localPeerSdpConstraints,\r\n                remotePeerSdpConstraints: userPreferences.remotePeerSdpConstraints,\r\n                dontGetRemoteStream: !!userPreferences.dontGetRemoteStream,\r\n                dontAttachLocalStream: !!userPreferences.dontAttachLocalStream,\r\n                renegotiatingPeer: !!userPreferences.renegotiatingPeer,\r\n                peerRef: userPreferences.peerRef,\r\n                channels: userPreferences.channels || [],\r\n                onLocalSdp: function(localSdp) {\r\n                    self.onNegotiationNeeded(localSdp, remoteUserId);\r\n                },\r\n                onLocalCandidate: function(localCandidate) {\r\n                    localCandidate = OnIceCandidateHandler.processCandidates(connection, localCandidate)\r\n                    if (localCandidate) {\r\n                        self.onNegotiationNeeded(localCandidate, remoteUserId);\r\n                    }\r\n                },\r\n                remoteSdp: remoteSdp,\r\n                onDataChannelMessage: function(message) {\r\n                    if (!connection.fbr && connection.enableFileSharing) initFileBufferReader();\r\n\r\n                    if (typeof message == 'string' || !connection.enableFileSharing) {\r\n                        self.onDataChannelMessage(message, remoteUserId);\r\n                        return;\r\n                    }\r\n\r\n                    var that = this;\r\n\r\n                    if (message instanceof ArrayBuffer || message instanceof DataView) {\r\n                        connection.fbr.convertToObject(message, function(object) {\r\n                            that.onDataChannelMessage(object);\r\n                        });\r\n                        return;\r\n                    }\r\n\r\n                    if (message.readyForNextChunk) {\r\n                        connection.fbr.getNextChunk(message, function(nextChunk, isLastChunk) {\r\n                            connection.peers[remoteUserId].channels.forEach(function(channel) {\r\n                                channel.send(nextChunk);\r\n                            });\r\n                        }, remoteUserId);\r\n                        return;\r\n                    }\r\n\r\n                    if (message.chunkMissing) {\r\n                        connection.fbr.chunkMissing(message);\r\n                        return;\r\n                    }\r\n\r\n                    connection.fbr.addChunk(message, function(promptNextChunk) {\r\n                        connection.peers[remoteUserId].peer.channel.send(promptNextChunk);\r\n                    });\r\n                },\r\n                onDataChannelError: function(error) {\r\n                    self.onDataChannelError(error, remoteUserId);\r\n                },\r\n                onDataChannelOpened: function(channel) {\r\n                    self.onDataChannelOpened(channel, remoteUserId);\r\n                },\r\n                onDataChannelClosed: function(event) {\r\n                    self.onDataChannelClosed(event, remoteUserId);\r\n                },\r\n                onRemoteStream: function(stream) {\r\n                    if (connection.peers[remoteUserId]) {\r\n                        connection.peers[remoteUserId].streams.push(stream);\r\n                    }\r\n\r\n                    self.onGettingRemoteMedia(stream, remoteUserId);\r\n                },\r\n                onRemoteStreamRemoved: function(stream) {\r\n                    self.onRemovingRemoteMedia(stream, remoteUserId);\r\n                },\r\n                onPeerStateChanged: function(states) {\r\n                    self.onPeerStateChanged(states);\r\n\r\n                    if (states.iceConnectionState === 'new') {\r\n                        self.onNegotiationStarted(remoteUserId, states);\r\n                    }\r\n\r\n                    if (states.iceConnectionState === 'connected') {\r\n                        self.onNegotiationCompleted(remoteUserId, states);\r\n                    }\r\n\r\n                    if (states.iceConnectionState.search(/closed|failed/gi) !== -1) {\r\n                        self.onUserLeft(remoteUserId);\r\n                        self.disconnectWith(remoteUserId);\r\n                    }\r\n                }\r\n            };\r\n        };\r\n\r\n        this.createNewPeer = function(remoteUserId, userPreferences) {\r\n            if (connection.maxParticipantsAllowed <= connection.getAllParticipants().length) {\r\n                return;\r\n            }\r\n\r\n            userPreferences = userPreferences || {};\r\n\r\n            if (connection.isInitiator && !!connection.session.audio && connection.session.audio === 'two-way' && !userPreferences.streamsToShare) {\r\n                userPreferences.isOneWay = false;\r\n                userPreferences.isDataOnly = false;\r\n                userPreferences.session = connection.session;\r\n            }\r\n\r\n            if (!userPreferences.isOneWay && !userPreferences.isDataOnly) {\r\n                userPreferences.isOneWay = true;\r\n                this.onNegotiationNeeded({\r\n                    enableMedia: true,\r\n                    userPreferences: userPreferences\r\n                }, remoteUserId);\r\n                return;\r\n            }\r\n\r\n            userPreferences = connection.setUserPreferences(userPreferences, remoteUserId);\r\n            var localConfig = this.getLocalConfig(null, remoteUserId, userPreferences);\r\n            connection.peers[remoteUserId] = new PeerInitiator(localConfig);\r\n        };\r\n\r\n        this.createAnsweringPeer = function(remoteSdp, remoteUserId, userPreferences) {\r\n            userPreferences = connection.setUserPreferences(userPreferences || {}, remoteUserId);\r\n\r\n            var localConfig = this.getLocalConfig(remoteSdp, remoteUserId, userPreferences);\r\n            connection.peers[remoteUserId] = new PeerInitiator(localConfig);\r\n        };\r\n\r\n        this.renegotiatePeer = function(remoteUserId, userPreferences, remoteSdp) {\r\n            if (!connection.peers[remoteUserId]) {\r\n                if (connection.enableLogs) {\r\n                    console.error('Peer (' + remoteUserId + ') does not exist. Renegotiation skipped.');\r\n                }\r\n                return;\r\n            }\r\n\r\n            if (!userPreferences) {\r\n                userPreferences = {};\r\n            }\r\n\r\n            userPreferences.renegotiatingPeer = true;\r\n            userPreferences.peerRef = connection.peers[remoteUserId].peer;\r\n            userPreferences.channels = connection.peers[remoteUserId].channels;\r\n\r\n            var localConfig = this.getLocalConfig(remoteSdp, remoteUserId, userPreferences);\r\n\r\n            connection.peers[remoteUserId] = new PeerInitiator(localConfig);\r\n        };\r\n\r\n        this.replaceTrack = function(track, remoteUserId, isVideoTrack) {\r\n            if (!connection.peers[remoteUserId]) {\r\n                throw 'This peer (' + remoteUserId + ') does not exist.';\r\n            }\r\n\r\n            var peer = connection.peers[remoteUserId].peer;\r\n\r\n            if (!!peer.getSenders && typeof peer.getSenders === 'function' && peer.getSenders().length) {\r\n                peer.getSenders().forEach(function(rtpSender) {\r\n                    if (isVideoTrack && rtpSender.track.kind === 'video') {\r\n                        connection.peers[remoteUserId].peer.lastVideoTrack = rtpSender.track;\r\n                        rtpSender.replaceTrack(track);\r\n                    }\r\n\r\n                    if (!isVideoTrack && rtpSender.track.kind === 'audio') {\r\n                        connection.peers[remoteUserId].peer.lastAudioTrack = rtpSender.track;\r\n                        rtpSender.replaceTrack(track);\r\n                    }\r\n                });\r\n                return;\r\n            }\r\n\r\n            console.warn('RTPSender.replaceTrack is NOT supported.');\r\n            this.renegotiatePeer(remoteUserId);\r\n        };\r\n\r\n        this.onNegotiationNeeded = function(message, remoteUserId) {};\r\n        this.addNegotiatedMessage = function(message, remoteUserId) {\r\n            if (message.type && message.sdp) {\r\n                if (message.type == 'answer') {\r\n                    if (connection.peers[remoteUserId]) {\r\n                        connection.peers[remoteUserId].addRemoteSdp(message);\r\n                    }\r\n                }\r\n\r\n                if (message.type == 'offer') {\r\n                    if (message.renegotiatingPeer) {\r\n                        this.renegotiatePeer(remoteUserId, null, message);\r\n                    } else {\r\n                        this.createAnsweringPeer(message, remoteUserId);\r\n                    }\r\n                }\r\n\r\n                if (connection.enableLogs) {\r\n                    console.log('Remote peer\\'s sdp:', message.sdp);\r\n                }\r\n                return;\r\n            }\r\n\r\n            if (message.candidate) {\r\n                if (connection.peers[remoteUserId]) {\r\n                    connection.peers[remoteUserId].addRemoteCandidate(message);\r\n                }\r\n\r\n                if (connection.enableLogs) {\r\n                    console.log('Remote peer\\'s candidate pairs:', message.candidate);\r\n                }\r\n                return;\r\n            }\r\n\r\n            if (message.enableMedia) {\r\n                connection.session = message.userPreferences.session || connection.session;\r\n\r\n                if (connection.session.oneway && connection.attachStreams.length) {\r\n                    connection.attachStreams = [];\r\n                }\r\n\r\n                if (message.userPreferences.isDataOnly && connection.attachStreams.length) {\r\n                    connection.attachStreams.length = [];\r\n                }\r\n\r\n                var streamsToShare = {};\r\n                connection.attachStreams.forEach(function(stream) {\r\n                    streamsToShare[stream.streamid] = {\r\n                        isAudio: !!stream.isAudio,\r\n                        isVideo: !!stream.isVideo,\r\n                        isScreen: !!stream.isScreen\r\n                    };\r\n                });\r\n                message.userPreferences.streamsToShare = streamsToShare;\r\n\r\n                self.onNegotiationNeeded({\r\n                    readyForOffer: true,\r\n                    userPreferences: message.userPreferences\r\n                }, remoteUserId);\r\n            }\r\n\r\n            if (message.readyForOffer) {\r\n                connection.onReadyForOffer(remoteUserId, message.userPreferences);\r\n            }\r\n\r\n            function cb(stream) {\r\n                gumCallback(stream, message, remoteUserId);\r\n            }\r\n        };\r\n\r\n        function gumCallback(stream, message, remoteUserId) {\r\n            var streamsToShare = {};\r\n            connection.attachStreams.forEach(function(stream) {\r\n                streamsToShare[stream.streamid] = {\r\n                    isAudio: !!stream.isAudio,\r\n                    isVideo: !!stream.isVideo,\r\n                    isScreen: !!stream.isScreen\r\n                };\r\n            });\r\n            message.userPreferences.streamsToShare = streamsToShare;\r\n\r\n            self.onNegotiationNeeded({\r\n                readyForOffer: true,\r\n                userPreferences: message.userPreferences\r\n            }, remoteUserId);\r\n        }\r\n\r\n        this.onGettingRemoteMedia = function(stream, remoteUserId) {};\r\n        this.onRemovingRemoteMedia = function(stream, remoteUserId) {};\r\n        this.onGettingLocalMedia = function(localStream) {};\r\n        this.onLocalMediaError = function(error, constraints) {\r\n            connection.onMediaError(error, constraints);\r\n        };\r\n\r\n        function initFileBufferReader() {\r\n            connection.fbr = new FileBufferReader();\r\n            connection.fbr.onProgress = function(chunk) {\r\n                connection.onFileProgress(chunk);\r\n            };\r\n            connection.fbr.onBegin = function(file) {\r\n                connection.onFileStart(file);\r\n            };\r\n            connection.fbr.onEnd = function(file) {\r\n                connection.onFileEnd(file);\r\n            };\r\n        }\r\n\r\n        this.shareFile = function(file, remoteUserId) {\r\n            initFileBufferReader();\r\n\r\n            connection.fbr.readAsArrayBuffer(file, function(uuid) {\r\n                var arrayOfUsers = connection.getAllParticipants();\r\n\r\n                if (remoteUserId) {\r\n                    arrayOfUsers = [remoteUserId];\r\n                }\r\n\r\n                arrayOfUsers.forEach(function(participant) {\r\n                    connection.fbr.getNextChunk(uuid, function(nextChunk) {\r\n                        connection.peers[participant].channels.forEach(function(channel) {\r\n                            channel.send(nextChunk);\r\n                        });\r\n                    }, participant);\r\n                });\r\n            }, {\r\n                userid: connection.userid,\r\n                // extra: connection.extra,\r\n                chunkSize: DetectRTC.browser.name === 'Firefox' ? 15 * 1000 : connection.chunkSize || 0\r\n            });\r\n        };\r\n\r\n        if (typeof 'TextReceiver' !== 'undefined') {\r\n            var textReceiver = new TextReceiver(connection);\r\n        }\r\n\r\n        this.onDataChannelMessage = function(message, remoteUserId) {\r\n            textReceiver.receive(JSON.parse(message), remoteUserId, connection.peers[remoteUserId] ? connection.peers[remoteUserId].extra : {});\r\n        };\r\n\r\n        this.onDataChannelClosed = function(event, remoteUserId) {\r\n            event.userid = remoteUserId;\r\n            event.extra = connection.peers[remoteUserId] ? connection.peers[remoteUserId].extra : {};\r\n            connection.onclose(event);\r\n        };\r\n\r\n        this.onDataChannelError = function(error, remoteUserId) {\r\n            error.userid = remoteUserId;\r\n            event.extra = connection.peers[remoteUserId] ? connection.peers[remoteUserId].extra : {};\r\n            connection.onerror(error);\r\n        };\r\n\r\n        this.onDataChannelOpened = function(channel, remoteUserId) {\r\n            // keep last channel only; we are not expecting parallel/channels channels\r\n            if (connection.peers[remoteUserId].channels.length) {\r\n                connection.peers[remoteUserId].channels = [channel];\r\n                return;\r\n            }\r\n\r\n            connection.peers[remoteUserId].channels.push(channel);\r\n            connection.onopen({\r\n                userid: remoteUserId,\r\n                extra: connection.peers[remoteUserId] ? connection.peers[remoteUserId].extra : {},\r\n                channel: channel\r\n            });\r\n        };\r\n\r\n        this.onPeerStateChanged = function(state) {\r\n            connection.onPeerStateChanged(state);\r\n        };\r\n\r\n        this.onNegotiationStarted = function(remoteUserId, states) {};\r\n        this.onNegotiationCompleted = function(remoteUserId, states) {};\r\n\r\n        this.getRemoteStreams = function(remoteUserId) {\r\n            remoteUserId = remoteUserId || connection.peers.getAllParticipants()[0];\r\n            return connection.peers[remoteUserId] ? connection.peers[remoteUserId].streams : [];\r\n        };\r\n    }\r\n\r\n    'use strict';\r\n\r\n    // Last Updated On: 2019-01-10 5:32:55 AM UTC\r\n\r\n    // ________________\r\n    // DetectRTC v1.3.9\r\n\r\n    // Open-Sourced: https://github.com/muaz-khan/DetectRTC\r\n\r\n    // --------------------------------------------------\r\n    // Muaz Khan     - www.MuazKhan.com\r\n    // MIT License   - www.WebRTC-Experiment.com/licence\r\n    // --------------------------------------------------\r\n\r\n    (function() {\r\n\r\n        var browserFakeUserAgent = 'Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45';\r\n\r\n        var isNodejs = typeof process === 'object' && typeof process.versions === 'object' && process.versions.node && /*node-process*/ !process.browser;\r\n        if (isNodejs) {\r\n            var version = process.versions.node.toString().replace('v', '');\r\n            browserFakeUserAgent = 'Nodejs/' + version + ' (NodeOS) AppleWebKit/' + version + ' (KHTML, like Gecko) Nodejs/' + version + ' Nodejs/' + version\r\n        }\r\n\r\n        (function(that) {\r\n            if (typeof window !== 'undefined') {\r\n                return;\r\n            }\r\n\r\n            if (typeof window === 'undefined' && typeof global !== 'undefined') {\r\n                global.navigator = {\r\n                    userAgent: browserFakeUserAgent,\r\n                    getUserMedia: function() {}\r\n                };\r\n\r\n                /*global window:true */\r\n                that.window = global;\r\n            } else if (typeof window === 'undefined') {\r\n                // window = this;\r\n            }\r\n\r\n            if (typeof location === 'undefined') {\r\n                /*global location:true */\r\n                that.location = {\r\n                    protocol: 'file:',\r\n                    href: '',\r\n                    hash: ''\r\n                };\r\n            }\r\n\r\n            if (typeof screen === 'undefined') {\r\n                /*global screen:true */\r\n                that.screen = {\r\n                    width: 0,\r\n                    height: 0\r\n                };\r\n            }\r\n        })(typeof global !== 'undefined' ? global : window);\r\n\r\n        /*global navigator:true */\r\n        var navigator = window.navigator;\r\n\r\n        if (typeof navigator !== 'undefined') {\r\n            if (typeof navigator.webkitGetUserMedia !== 'undefined') {\r\n                navigator.getUserMedia = navigator.webkitGetUserMedia;\r\n            }\r\n\r\n            if (typeof navigator.mozGetUserMedia !== 'undefined') {\r\n                navigator.getUserMedia = navigator.mozGetUserMedia;\r\n            }\r\n        } else {\r\n            navigator = {\r\n                getUserMedia: function() {},\r\n                userAgent: browserFakeUserAgent\r\n            };\r\n        }\r\n\r\n        var isMobileDevice = !!(/Android|webOS|iPhone|iPad|iPod|BB10|BlackBerry|IEMobile|Opera Mini|Mobile|mobile/i.test(navigator.userAgent || ''));\r\n\r\n        var isEdge = navigator.userAgent.indexOf('Edge') !== -1 && (!!navigator.msSaveOrOpenBlob || !!navigator.msSaveBlob);\r\n\r\n        var isOpera = !!window.opera || navigator.userAgent.indexOf(' OPR/') >= 0;\r\n        var isFirefox = typeof window.InstallTrigger !== 'undefined';\r\n        var isSafari = /^((?!chrome|android).)*safari/i.test(navigator.userAgent);\r\n        var isChrome = !!window.chrome && !isOpera;\r\n        var isIE = typeof document !== 'undefined' && !!document.documentMode && !isEdge;\r\n\r\n        // this one can also be used:\r\n        // https://www.websocket.org/js/stuff.js (DetectBrowser.js)\r\n\r\n        function getBrowserInfo() {\r\n            var nVer = navigator.appVersion;\r\n            var nAgt = navigator.userAgent;\r\n            var browserName = navigator.appName;\r\n            var fullVersion = '' + parseFloat(navigator.appVersion);\r\n            var majorVersion = parseInt(navigator.appVersion, 10);\r\n            var nameOffset, verOffset, ix;\r\n\r\n            // both and safri and chrome has same userAgent\r\n            if (isSafari && !isChrome && nAgt.indexOf('CriOS') !== -1) {\r\n                isSafari = false;\r\n                isChrome = true;\r\n            }\r\n\r\n            // In Opera, the true version is after 'Opera' or after 'Version'\r\n            if (isOpera) {\r\n                browserName = 'Opera';\r\n                try {\r\n                    fullVersion = navigator.userAgent.split('OPR/')[1].split(' ')[0];\r\n                    majorVersion = fullVersion.split('.')[0];\r\n                } catch (e) {\r\n                    fullVersion = '0.0.0.0';\r\n                    majorVersion = 0;\r\n                }\r\n            }\r\n            // In MSIE version <=10, the true version is after 'MSIE' in userAgent\r\n            // In IE 11, look for the string after 'rv:'\r\n            else if (isIE) {\r\n                verOffset = nAgt.indexOf('rv:');\r\n                if (verOffset > 0) { //IE 11\r\n                    fullVersion = nAgt.substring(verOffset + 3);\r\n                } else { //IE 10 or earlier\r\n                    verOffset = nAgt.indexOf('MSIE');\r\n                    fullVersion = nAgt.substring(verOffset + 5);\r\n                }\r\n                browserName = 'IE';\r\n            }\r\n            // In Chrome, the true version is after 'Chrome' \r\n            else if (isChrome) {\r\n                verOffset = nAgt.indexOf('Chrome');\r\n                browserName = 'Chrome';\r\n                fullVersion = nAgt.substring(verOffset + 7);\r\n            }\r\n            // In Safari, the true version is after 'Safari' or after 'Version' \r\n            else if (isSafari) {\r\n                verOffset = nAgt.indexOf('Safari');\r\n\r\n                browserName = 'Safari';\r\n                fullVersion = nAgt.substring(verOffset + 7);\r\n\r\n                if ((verOffset = nAgt.indexOf('Version')) !== -1) {\r\n                    fullVersion = nAgt.substring(verOffset + 8);\r\n                }\r\n\r\n                if (navigator.userAgent.indexOf('Version/') !== -1) {\r\n                    fullVersion = navigator.userAgent.split('Version/')[1].split(' ')[0];\r\n                }\r\n            }\r\n            // In Firefox, the true version is after 'Firefox' \r\n            else if (isFirefox) {\r\n                verOffset = nAgt.indexOf('Firefox');\r\n                browserName = 'Firefox';\r\n                fullVersion = nAgt.substring(verOffset + 8);\r\n            }\r\n\r\n            // In most other browsers, 'name/version' is at the end of userAgent \r\n            else if ((nameOffset = nAgt.lastIndexOf(' ') + 1) < (verOffset = nAgt.lastIndexOf('/'))) {\r\n                browserName = nAgt.substring(nameOffset, verOffset);\r\n                fullVersion = nAgt.substring(verOffset + 1);\r\n\r\n                if (browserName.toLowerCase() === browserName.toUpperCase()) {\r\n                    browserName = navigator.appName;\r\n                }\r\n            }\r\n\r\n            if (isEdge) {\r\n                browserName = 'Edge';\r\n                fullVersion = navigator.userAgent.split('Edge/')[1];\r\n                // fullVersion = parseInt(navigator.userAgent.match(/Edge\\/(\\d+).(\\d+)$/)[2], 10).toString();\r\n            }\r\n\r\n            // trim the fullVersion string at semicolon/space/bracket if present\r\n            if ((ix = fullVersion.search(/[; \\)]/)) !== -1) {\r\n                fullVersion = fullVersion.substring(0, ix);\r\n            }\r\n\r\n            majorVersion = parseInt('' + fullVersion, 10);\r\n\r\n            if (isNaN(majorVersion)) {\r\n                fullVersion = '' + parseFloat(navigator.appVersion);\r\n                majorVersion = parseInt(navigator.appVersion, 10);\r\n            }\r\n\r\n            return {\r\n                fullVersion: fullVersion,\r\n                version: majorVersion,\r\n                name: browserName,\r\n                isPrivateBrowsing: false\r\n            };\r\n        }\r\n\r\n        // via: https://gist.github.com/cou929/7973956\r\n\r\n        function retry(isDone, next) {\r\n            var currentTrial = 0,\r\n                maxRetry = 50,\r\n                interval = 10,\r\n                isTimeout = false;\r\n            var id = window.setInterval(\r\n                function() {\r\n                    if (isDone()) {\r\n                        window.clearInterval(id);\r\n                        next(isTimeout);\r\n                    }\r\n                    if (currentTrial++ > maxRetry) {\r\n                        window.clearInterval(id);\r\n                        isTimeout = true;\r\n                        next(isTimeout);\r\n                    }\r\n                },\r\n                10\r\n            );\r\n        }\r\n\r\n        function isIE10OrLater(userAgent) {\r\n            var ua = userAgent.toLowerCase();\r\n            if (ua.indexOf('msie') === 0 && ua.indexOf('trident') === 0) {\r\n                return false;\r\n            }\r\n            var match = /(?:msie|rv:)\\s?([\\d\\.]+)/.exec(ua);\r\n            if (match && parseInt(match[1], 10) >= 10) {\r\n                return true;\r\n            }\r\n            return false;\r\n        }\r\n\r\n        function detectPrivateMode(callback) {\r\n            var isPrivate;\r\n\r\n            try {\r\n\r\n                if (window.webkitRequestFileSystem) {\r\n                    window.webkitRequestFileSystem(\r\n                        window.TEMPORARY, 1,\r\n                        function() {\r\n                            isPrivate = false;\r\n                        },\r\n                        function(e) {\r\n                            isPrivate = true;\r\n                        }\r\n                    );\r\n                } else if (window.indexedDB && /Firefox/.test(window.navigator.userAgent)) {\r\n                    var db;\r\n                    try {\r\n                        db = window.indexedDB.open('test');\r\n                        db.onerror = function() {\r\n                            return true;\r\n                        };\r\n                    } catch (e) {\r\n                        isPrivate = true;\r\n                    }\r\n\r\n                    if (typeof isPrivate === 'undefined') {\r\n                        retry(\r\n                            function isDone() {\r\n                                return db.readyState === 'done' ? true : false;\r\n                            },\r\n                            function next(isTimeout) {\r\n                                if (!isTimeout) {\r\n                                    isPrivate = db.result ? false : true;\r\n                                }\r\n                            }\r\n                        );\r\n                    }\r\n                } else if (isIE10OrLater(window.navigator.userAgent)) {\r\n                    isPrivate = false;\r\n                    try {\r\n                        if (!window.indexedDB) {\r\n                            isPrivate = true;\r\n                        }\r\n                    } catch (e) {\r\n                        isPrivate = true;\r\n                    }\r\n                } else if (window.localStorage && /Safari/.test(window.navigator.userAgent)) {\r\n                    try {\r\n                        window.localStorage.setItem('test', 1);\r\n                    } catch (e) {\r\n                        isPrivate = true;\r\n                    }\r\n\r\n                    if (typeof isPrivate === 'undefined') {\r\n                        isPrivate = false;\r\n                        window.localStorage.removeItem('test');\r\n                    }\r\n                }\r\n\r\n            } catch (e) {\r\n                isPrivate = false;\r\n            }\r\n\r\n            retry(\r\n                function isDone() {\r\n                    return typeof isPrivate !== 'undefined' ? true : false;\r\n                },\r\n                function next(isTimeout) {\r\n                    callback(isPrivate);\r\n                }\r\n            );\r\n        }\r\n\r\n        var isMobile = {\r\n            Android: function() {\r\n                return navigator.userAgent.match(/Android/i);\r\n            },\r\n            BlackBerry: function() {\r\n                return navigator.userAgent.match(/BlackBerry|BB10/i);\r\n            },\r\n            iOS: function() {\r\n                return navigator.userAgent.match(/iPhone|iPad|iPod/i);\r\n            },\r\n            Opera: function() {\r\n                return navigator.userAgent.match(/Opera Mini/i);\r\n            },\r\n            Windows: function() {\r\n                return navigator.userAgent.match(/IEMobile/i);\r\n            },\r\n            any: function() {\r\n                return (isMobile.Android() || isMobile.BlackBerry() || isMobile.iOS() || isMobile.Opera() || isMobile.Windows());\r\n            },\r\n            getOsName: function() {\r\n                var osName = 'Unknown OS';\r\n                if (isMobile.Android()) {\r\n                    osName = 'Android';\r\n                }\r\n\r\n                if (isMobile.BlackBerry()) {\r\n                    osName = 'BlackBerry';\r\n                }\r\n\r\n                if (isMobile.iOS()) {\r\n                    osName = 'iOS';\r\n                }\r\n\r\n                if (isMobile.Opera()) {\r\n                    osName = 'Opera Mini';\r\n                }\r\n\r\n                if (isMobile.Windows()) {\r\n                    osName = 'Windows';\r\n                }\r\n\r\n                return osName;\r\n            }\r\n        };\r\n\r\n        // via: http://jsfiddle.net/ChristianL/AVyND/\r\n        function detectDesktopOS() {\r\n            var unknown = '-';\r\n\r\n            var nVer = navigator.appVersion;\r\n            var nAgt = navigator.userAgent;\r\n\r\n            var os = unknown;\r\n            var clientStrings = [{\r\n                s: 'Windows 10',\r\n                r: /(Windows 10.0|Windows NT 10.0)/\r\n            }, {\r\n                s: 'Windows 8.1',\r\n                r: /(Windows 8.1|Windows NT 6.3)/\r\n            }, {\r\n                s: 'Windows 8',\r\n                r: /(Windows 8|Windows NT 6.2)/\r\n            }, {\r\n                s: 'Windows 7',\r\n                r: /(Windows 7|Windows NT 6.1)/\r\n            }, {\r\n                s: 'Windows Vista',\r\n                r: /Windows NT 6.0/\r\n            }, {\r\n                s: 'Windows Server 2003',\r\n                r: /Windows NT 5.2/\r\n            }, {\r\n                s: 'Windows XP',\r\n                r: /(Windows NT 5.1|Windows XP)/\r\n            }, {\r\n                s: 'Windows 2000',\r\n                r: /(Windows NT 5.0|Windows 2000)/\r\n            }, {\r\n                s: 'Windows ME',\r\n                r: /(Win 9x 4.90|Windows ME)/\r\n            }, {\r\n                s: 'Windows 98',\r\n                r: /(Windows 98|Win98)/\r\n            }, {\r\n                s: 'Windows 95',\r\n                r: /(Windows 95|Win95|Windows_95)/\r\n            }, {\r\n                s: 'Windows NT 4.0',\r\n                r: /(Windows NT 4.0|WinNT4.0|WinNT|Windows NT)/\r\n            }, {\r\n                s: 'Windows CE',\r\n                r: /Windows CE/\r\n            }, {\r\n                s: 'Windows 3.11',\r\n                r: /Win16/\r\n            }, {\r\n                s: 'Android',\r\n                r: /Android/\r\n            }, {\r\n                s: 'Open BSD',\r\n                r: /OpenBSD/\r\n            }, {\r\n                s: 'Sun OS',\r\n                r: /SunOS/\r\n            }, {\r\n                s: 'Linux',\r\n                r: /(Linux|X11)/\r\n            }, {\r\n                s: 'iOS',\r\n                r: /(iPhone|iPad|iPod)/\r\n            }, {\r\n                s: 'Mac OS X',\r\n                r: /Mac OS X/\r\n            }, {\r\n                s: 'Mac OS',\r\n                r: /(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/\r\n            }, {\r\n                s: 'QNX',\r\n                r: /QNX/\r\n            }, {\r\n                s: 'UNIX',\r\n                r: /UNIX/\r\n            }, {\r\n                s: 'BeOS',\r\n                r: /BeOS/\r\n            }, {\r\n                s: 'OS/2',\r\n                r: /OS\\/2/\r\n            }, {\r\n                s: 'Search Bot',\r\n                r: /(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\\/Teoma|ia_archiver)/\r\n            }];\r\n            for (var i = 0, cs; cs = clientStrings[i]; i++) {\r\n                if (cs.r.test(nAgt)) {\r\n                    os = cs.s;\r\n                    break;\r\n                }\r\n            }\r\n\r\n            var osVersion = unknown;\r\n\r\n            if (/Windows/.test(os)) {\r\n                if (/Windows (.*)/.test(os)) {\r\n                    osVersion = /Windows (.*)/.exec(os)[1];\r\n                }\r\n                os = 'Windows';\r\n            }\r\n\r\n            switch (os) {\r\n                case 'Mac OS X':\r\n                    if (/Mac OS X (10[\\.\\_\\d]+)/.test(nAgt)) {\r\n                        osVersion = /Mac OS X (10[\\.\\_\\d]+)/.exec(nAgt)[1];\r\n                    }\r\n                    break;\r\n                case 'Android':\r\n                    if (/Android ([\\.\\_\\d]+)/.test(nAgt)) {\r\n                        osVersion = /Android ([\\.\\_\\d]+)/.exec(nAgt)[1];\r\n                    }\r\n                    break;\r\n                case 'iOS':\r\n                    if (/OS (\\d+)_(\\d+)_?(\\d+)?/.test(nAgt)) {\r\n                        osVersion = /OS (\\d+)_(\\d+)_?(\\d+)?/.exec(nVer);\r\n                        osVersion = osVersion[1] + '.' + osVersion[2] + '.' + (osVersion[3] | 0);\r\n                    }\r\n                    break;\r\n            }\r\n\r\n            return {\r\n                osName: os,\r\n                osVersion: osVersion\r\n            };\r\n        }\r\n\r\n        var osName = 'Unknown OS';\r\n        var osVersion = 'Unknown OS Version';\r\n\r\n        function getAndroidVersion(ua) {\r\n            ua = (ua || navigator.userAgent).toLowerCase();\r\n            var match = ua.match(/android\\s([0-9\\.]*)/);\r\n            return match ? match[1] : false;\r\n        }\r\n\r\n        var osInfo = detectDesktopOS();\r\n\r\n        if (osInfo && osInfo.osName && osInfo.osName != '-') {\r\n            osName = osInfo.osName;\r\n            osVersion = osInfo.osVersion;\r\n        } else if (isMobile.any()) {\r\n            osName = isMobile.getOsName();\r\n\r\n            if (osName == 'Android') {\r\n                osVersion = getAndroidVersion();\r\n            }\r\n        }\r\n\r\n        var isNodejs = typeof process === 'object' && typeof process.versions === 'object' && process.versions.node;\r\n\r\n        if (osName === 'Unknown OS' && isNodejs) {\r\n            osName = 'Nodejs';\r\n            osVersion = process.versions.node.toString().replace('v', '');\r\n        }\r\n\r\n        var isCanvasSupportsStreamCapturing = false;\r\n        var isVideoSupportsStreamCapturing = false;\r\n        ['captureStream', 'mozCaptureStream', 'webkitCaptureStream'].forEach(function(item) {\r\n            if (typeof document === 'undefined' || typeof document.createElement !== 'function') {\r\n                return;\r\n            }\r\n\r\n            if (!isCanvasSupportsStreamCapturing && item in document.createElement('canvas')) {\r\n                isCanvasSupportsStreamCapturing = true;\r\n            }\r\n\r\n            if (!isVideoSupportsStreamCapturing && item in document.createElement('video')) {\r\n                isVideoSupportsStreamCapturing = true;\r\n            }\r\n        });\r\n\r\n        var regexIpv4Local = /^(192\\.168\\.|169\\.254\\.|10\\.|172\\.(1[6-9]|2\\d|3[01]))/,\r\n            regexIpv4 = /([0-9]{1,3}(\\.[0-9]{1,3}){3})/,\r\n            regexIpv6 = /[a-f0-9]{1,4}(:[a-f0-9]{1,4}){7}/;\r\n\r\n        // via: https://github.com/diafygi/webrtc-ips\r\n        function DetectLocalIPAddress(callback, stream) {\r\n            if (!DetectRTC.isWebRTCSupported) {\r\n                return;\r\n            }\r\n\r\n            var isPublic = true,\r\n                isIpv4 = true;\r\n            getIPs(function(ip) {\r\n                if (!ip) {\r\n                    callback(); // Pass nothing to tell that ICE-gathering-ended\r\n                } else if (ip.match(regexIpv4Local)) {\r\n                    isPublic = false;\r\n                    callback('Local: ' + ip, isPublic, isIpv4);\r\n                } else if (ip.match(regexIpv6)) { //via https://ourcodeworld.com/articles/read/257/how-to-get-the-client-ip-address-with-javascript-only\r\n                    isIpv4 = false;\r\n                    callback('Public: ' + ip, isPublic, isIpv4);\r\n                } else {\r\n                    callback('Public: ' + ip, isPublic, isIpv4);\r\n                }\r\n            }, stream);\r\n        }\r\n\r\n        function getIPs(callback, stream) {\r\n            if (typeof document === 'undefined' || typeof document.getElementById !== 'function') {\r\n                return;\r\n            }\r\n\r\n            var ipDuplicates = {};\r\n\r\n            var RTCPeerConnection = window.RTCPeerConnection || window.mozRTCPeerConnection || window.webkitRTCPeerConnection;\r\n\r\n            if (!RTCPeerConnection) {\r\n                var iframe = document.getElementById('iframe');\r\n                if (!iframe) {\r\n                    return;\r\n                }\r\n                var win = iframe.contentWindow;\r\n                RTCPeerConnection = win.RTCPeerConnection || win.mozRTCPeerConnection || win.webkitRTCPeerConnection;\r\n            }\r\n\r\n            if (!RTCPeerConnection) {\r\n                return;\r\n            }\r\n\r\n            var peerConfig = null;\r\n\r\n            if (DetectRTC.browser === 'Chrome' && DetectRTC.browser.version < 58) {\r\n                // todo: add support for older Opera\r\n                peerConfig = {\r\n                    optional: [{\r\n                        RtpDataChannels: true\r\n                    }]\r\n                };\r\n            }\r\n\r\n            var servers = {\r\n                iceServers: [{\r\n                    urls: 'stun:stun.l.google.com:19302'\r\n                }]\r\n            };\r\n\r\n            var pc = new RTCPeerConnection(servers, peerConfig);\r\n\r\n            if (stream) {\r\n                if (pc.addStream) {\r\n                    pc.addStream(stream);\r\n                } else if (pc.addTrack && stream.getTracks()[0]) {\r\n                    pc.addTrack(stream.getTracks()[0], stream);\r\n                }\r\n            }\r\n\r\n            function handleCandidate(candidate) {\r\n                if (!candidate) {\r\n                    callback(); // Pass nothing to tell that ICE-gathering-ended\r\n                    return;\r\n                }\r\n\r\n                var match = regexIpv4.exec(candidate);\r\n                if (!match) {\r\n                    return;\r\n                }\r\n                var ipAddress = match[1];\r\n                var isPublic = (candidate.match(regexIpv4Local)),\r\n                    isIpv4 = true;\r\n\r\n                if (ipDuplicates[ipAddress] === undefined) {\r\n                    callback(ipAddress, isPublic, isIpv4);\r\n                }\r\n\r\n                ipDuplicates[ipAddress] = true;\r\n            }\r\n\r\n            // listen for candidate events\r\n            pc.onicecandidate = function(event) {\r\n                if (event.candidate && event.candidate.candidate) {\r\n                    handleCandidate(event.candidate.candidate);\r\n                } else {\r\n                    handleCandidate(); // Pass nothing to tell that ICE-gathering-ended\r\n                }\r\n            };\r\n\r\n            // create data channel\r\n            if (!stream) {\r\n                try {\r\n                    pc.createDataChannel('sctp', {});\r\n                } catch (e) {}\r\n            }\r\n\r\n            // create an offer sdp\r\n            if (DetectRTC.isPromisesSupported) {\r\n                pc.createOffer().then(function(result) {\r\n                    pc.setLocalDescription(result).then(afterCreateOffer);\r\n                });\r\n            } else {\r\n                pc.createOffer(function(result) {\r\n                    pc.setLocalDescription(result, afterCreateOffer, function() {});\r\n                }, function() {});\r\n            }\r\n\r\n            function afterCreateOffer() {\r\n                var lines = pc.localDescription.sdp.split('\\n');\r\n\r\n                lines.forEach(function(line) {\r\n                    if (line && line.indexOf('a=candidate:') === 0) {\r\n                        handleCandidate(line);\r\n                    }\r\n                });\r\n            }\r\n        }\r\n\r\n        var MediaDevices = [];\r\n\r\n        var audioInputDevices = [];\r\n        var audioOutputDevices = [];\r\n        var videoInputDevices = [];\r\n\r\n        if (navigator.mediaDevices && navigator.mediaDevices.enumerateDevices) {\r\n            // Firefox 38+ seems having support of enumerateDevices\r\n            // Thanks @xdumaine/enumerateDevices\r\n            navigator.enumerateDevices = function(callback) {\r\n                var enumerateDevices = navigator.mediaDevices.enumerateDevices();\r\n                if (enumerateDevices && enumerateDevices.then) {\r\n                    navigator.mediaDevices.enumerateDevices().then(callback).catch(function() {\r\n                        callback([]);\r\n                    });\r\n                } else {\r\n                    callback([]);\r\n                }\r\n            };\r\n        }\r\n\r\n        // Media Devices detection\r\n        var canEnumerate = false;\r\n\r\n        /*global MediaStreamTrack:true */\r\n        if (typeof MediaStreamTrack !== 'undefined' && 'getSources' in MediaStreamTrack) {\r\n            canEnumerate = true;\r\n        } else if (navigator.mediaDevices && !!navigator.mediaDevices.enumerateDevices) {\r\n            canEnumerate = true;\r\n        }\r\n\r\n        var hasMicrophone = false;\r\n        var hasSpeakers = false;\r\n        var hasWebcam = false;\r\n\r\n        var isWebsiteHasMicrophonePermissions = false;\r\n        var isWebsiteHasWebcamPermissions = false;\r\n\r\n        // http://dev.w3.org/2011/webrtc/editor/getusermedia.html#mediadevices\r\n        function checkDeviceSupport(callback) {\r\n            if (!canEnumerate) {\r\n                if (callback) {\r\n                    callback();\r\n                }\r\n                return;\r\n            }\r\n\r\n            if (!navigator.enumerateDevices && window.MediaStreamTrack && window.MediaStreamTrack.getSources) {\r\n                navigator.enumerateDevices = window.MediaStreamTrack.getSources.bind(window.MediaStreamTrack);\r\n            }\r\n\r\n            if (!navigator.enumerateDevices && navigator.enumerateDevices) {\r\n                navigator.enumerateDevices = navigator.enumerateDevices.bind(navigator);\r\n            }\r\n\r\n            if (!navigator.enumerateDevices) {\r\n                if (callback) {\r\n                    callback();\r\n                }\r\n                return;\r\n            }\r\n\r\n            MediaDevices = [];\r\n\r\n            audioInputDevices = [];\r\n            audioOutputDevices = [];\r\n            videoInputDevices = [];\r\n\r\n            hasMicrophone = false;\r\n            hasSpeakers = false;\r\n            hasWebcam = false;\r\n\r\n            isWebsiteHasMicrophonePermissions = false;\r\n            isWebsiteHasWebcamPermissions = false;\r\n\r\n            // to prevent duplication\r\n            var alreadyUsedDevices = {};\r\n\r\n            navigator.enumerateDevices(function(devices) {\r\n                devices.forEach(function(_device) {\r\n                    var device = {};\r\n                    for (var d in _device) {\r\n                        try {\r\n                            if (typeof _device[d] !== 'function') {\r\n                                device[d] = _device[d];\r\n                            }\r\n                        } catch (e) {}\r\n                    }\r\n\r\n                    if (alreadyUsedDevices[device.deviceId + device.label + device.kind]) {\r\n                        return;\r\n                    }\r\n\r\n                    // if it is MediaStreamTrack.getSources\r\n                    if (device.kind === 'audio') {\r\n                        device.kind = 'audioinput';\r\n                    }\r\n\r\n                    if (device.kind === 'video') {\r\n                        device.kind = 'videoinput';\r\n                    }\r\n\r\n                    if (!device.deviceId) {\r\n                        device.deviceId = device.id;\r\n                    }\r\n\r\n                    if (!device.id) {\r\n                        device.id = device.deviceId;\r\n                    }\r\n\r\n                    if (!device.label) {\r\n                        device.isCustomLabel = true;\r\n\r\n                        if (device.kind === 'videoinput') {\r\n                            device.label = 'Camera ' + (videoInputDevices.length + 1);\r\n                        } else if (device.kind === 'audioinput') {\r\n                            device.label = 'Microphone ' + (audioInputDevices.length + 1);\r\n                        } else if (device.kind === 'audiooutput') {\r\n                            device.label = 'Speaker ' + (audioOutputDevices.length + 1);\r\n                        } else {\r\n                            device.label = 'Please invoke getUserMedia once.';\r\n                        }\r\n\r\n                        if (typeof DetectRTC !== 'undefined' && DetectRTC.browser.isChrome && DetectRTC.browser.version >= 46 && !/^(https:|chrome-extension:)$/g.test(location.protocol || '')) {\r\n                            if (typeof document !== 'undefined' && typeof document.domain === 'string' && document.domain.search && document.domain.search(/localhost|127.0./g) === -1) {\r\n                                device.label = 'HTTPs is required to get label of this ' + device.kind + ' device.';\r\n                            }\r\n                        }\r\n                    } else {\r\n                        // Firefox on Android still returns empty label\r\n                        if (device.kind === 'videoinput' && !isWebsiteHasWebcamPermissions) {\r\n                            isWebsiteHasWebcamPermissions = true;\r\n                        }\r\n\r\n                        if (device.kind === 'audioinput' && !isWebsiteHasMicrophonePermissions) {\r\n                            isWebsiteHasMicrophonePermissions = true;\r\n                        }\r\n                    }\r\n\r\n                    if (device.kind === 'audioinput') {\r\n                        hasMicrophone = true;\r\n\r\n                        if (audioInputDevices.indexOf(device) === -1) {\r\n                            audioInputDevices.push(device);\r\n                        }\r\n                    }\r\n\r\n                    if (device.kind === 'audiooutput') {\r\n                        hasSpeakers = true;\r\n\r\n                        if (audioOutputDevices.indexOf(device) === -1) {\r\n                            audioOutputDevices.push(device);\r\n                        }\r\n                    }\r\n\r\n                    if (device.kind === 'videoinput') {\r\n                        hasWebcam = true;\r\n\r\n                        if (videoInputDevices.indexOf(device) === -1) {\r\n                            videoInputDevices.push(device);\r\n                        }\r\n                    }\r\n\r\n                    // there is no 'videoouput' in the spec.\r\n                    MediaDevices.push(device);\r\n\r\n                    alreadyUsedDevices[device.deviceId + device.label + device.kind] = device;\r\n                });\r\n\r\n                if (typeof DetectRTC !== 'undefined') {\r\n                    // to sync latest outputs\r\n                    DetectRTC.MediaDevices = MediaDevices;\r\n                    DetectRTC.hasMicrophone = hasMicrophone;\r\n                    DetectRTC.hasSpeakers = hasSpeakers;\r\n                    DetectRTC.hasWebcam = hasWebcam;\r\n\r\n                    DetectRTC.isWebsiteHasWebcamPermissions = isWebsiteHasWebcamPermissions;\r\n                    DetectRTC.isWebsiteHasMicrophonePermissions = isWebsiteHasMicrophonePermissions;\r\n\r\n                    DetectRTC.audioInputDevices = audioInputDevices;\r\n                    DetectRTC.audioOutputDevices = audioOutputDevices;\r\n                    DetectRTC.videoInputDevices = videoInputDevices;\r\n                }\r\n\r\n                if (callback) {\r\n                    callback();\r\n                }\r\n            });\r\n        }\r\n\r\n        var DetectRTC = window.DetectRTC || {};\r\n\r\n        // ----------\r\n        // DetectRTC.browser.name || DetectRTC.browser.version || DetectRTC.browser.fullVersion\r\n        DetectRTC.browser = getBrowserInfo();\r\n\r\n        detectPrivateMode(function(isPrivateBrowsing) {\r\n            DetectRTC.browser.isPrivateBrowsing = !!isPrivateBrowsing;\r\n        });\r\n\r\n        // DetectRTC.isChrome || DetectRTC.isFirefox || DetectRTC.isEdge\r\n        DetectRTC.browser['is' + DetectRTC.browser.name] = true;\r\n\r\n        // -----------\r\n        DetectRTC.osName = osName;\r\n        DetectRTC.osVersion = osVersion;\r\n\r\n        var isNodeWebkit = typeof process === 'object' && typeof process.versions === 'object' && process.versions['node-webkit'];\r\n\r\n        // --------- Detect if system supports WebRTC 1.0 or WebRTC 1.1.\r\n        var isWebRTCSupported = false;\r\n        ['RTCPeerConnection', 'webkitRTCPeerConnection', 'mozRTCPeerConnection', 'RTCIceGatherer'].forEach(function(item) {\r\n            if (isWebRTCSupported) {\r\n                return;\r\n            }\r\n\r\n            if (item in window) {\r\n                isWebRTCSupported = true;\r\n            }\r\n        });\r\n        DetectRTC.isWebRTCSupported = isWebRTCSupported;\r\n\r\n        //-------\r\n        DetectRTC.isORTCSupported = typeof RTCIceGatherer !== 'undefined';\r\n\r\n        // --------- Detect if system supports screen capturing API\r\n        var isScreenCapturingSupported = false;\r\n        if (DetectRTC.browser.isChrome && DetectRTC.browser.version >= 35) {\r\n            isScreenCapturingSupported = true;\r\n        } else if (DetectRTC.browser.isFirefox && DetectRTC.browser.version >= 34) {\r\n            isScreenCapturingSupported = true;\r\n        } else if (DetectRTC.browser.isEdge && DetectRTC.browser.version >= 17) {\r\n            isScreenCapturingSupported = true; // navigator.getDisplayMedia\r\n        } else if (DetectRTC.osName === 'Android' && DetectRTC.browser.isChrome) {\r\n            isScreenCapturingSupported = true;\r\n        }\r\n\r\n        if (!/^(https:|chrome-extension:)$/g.test(location.protocol || '')) {\r\n            var isNonLocalHost = typeof document !== 'undefined' && typeof document.domain === 'string' && document.domain.search && document.domain.search(/localhost|127.0./g) === -1;\r\n            if (isNonLocalHost && (DetectRTC.browser.isChrome || DetectRTC.browser.isEdge || DetectRTC.browser.isOpera)) {\r\n                isScreenCapturingSupported = false;\r\n            } else if (DetectRTC.browser.isFirefox) {\r\n                isScreenCapturingSupported = false;\r\n            }\r\n        }\r\n        DetectRTC.isScreenCapturingSupported = isScreenCapturingSupported;\r\n\r\n        // --------- Detect if WebAudio API are supported\r\n        var webAudio = {\r\n            isSupported: false,\r\n            isCreateMediaStreamSourceSupported: false\r\n        };\r\n\r\n        ['AudioContext', 'webkitAudioContext', 'mozAudioContext', 'msAudioContext'].forEach(function(item) {\r\n            if (webAudio.isSupported) {\r\n                return;\r\n            }\r\n\r\n            if (item in window) {\r\n                webAudio.isSupported = true;\r\n\r\n                if (window[item] && 'createMediaStreamSource' in window[item].prototype) {\r\n                    webAudio.isCreateMediaStreamSourceSupported = true;\r\n                }\r\n            }\r\n        });\r\n        DetectRTC.isAudioContextSupported = webAudio.isSupported;\r\n        DetectRTC.isCreateMediaStreamSourceSupported = webAudio.isCreateMediaStreamSourceSupported;\r\n\r\n        // ---------- Detect if SCTP/RTP channels are supported.\r\n\r\n        var isRtpDataChannelsSupported = false;\r\n        if (DetectRTC.browser.isChrome && DetectRTC.browser.version > 31) {\r\n            isRtpDataChannelsSupported = true;\r\n        }\r\n        DetectRTC.isRtpDataChannelsSupported = isRtpDataChannelsSupported;\r\n\r\n        var isSCTPSupportd = false;\r\n        if (DetectRTC.browser.isFirefox && DetectRTC.browser.version > 28) {\r\n            isSCTPSupportd = true;\r\n        } else if (DetectRTC.browser.isChrome && DetectRTC.browser.version > 25) {\r\n            isSCTPSupportd = true;\r\n        } else if (DetectRTC.browser.isOpera && DetectRTC.browser.version >= 11) {\r\n            isSCTPSupportd = true;\r\n        }\r\n        DetectRTC.isSctpDataChannelsSupported = isSCTPSupportd;\r\n\r\n        // ---------\r\n\r\n        DetectRTC.isMobileDevice = isMobileDevice; // \"isMobileDevice\" boolean is defined in \"getBrowserInfo.js\"\r\n\r\n        // ------\r\n        var isGetUserMediaSupported = false;\r\n        if (navigator.getUserMedia) {\r\n            isGetUserMediaSupported = true;\r\n        } else if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {\r\n            isGetUserMediaSupported = true;\r\n        }\r\n\r\n        if (DetectRTC.browser.isChrome && DetectRTC.browser.version >= 46 && !/^(https:|chrome-extension:)$/g.test(location.protocol || '')) {\r\n            if (typeof document !== 'undefined' && typeof document.domain === 'string' && document.domain.search && document.domain.search(/localhost|127.0./g) === -1) {\r\n                isGetUserMediaSupported = 'Requires HTTPs';\r\n            }\r\n        }\r\n\r\n        if (DetectRTC.osName === 'Nodejs') {\r\n            isGetUserMediaSupported = false;\r\n        }\r\n        DetectRTC.isGetUserMediaSupported = isGetUserMediaSupported;\r\n\r\n        var displayResolution = '';\r\n        if (screen.width) {\r\n            var width = (screen.width) ? screen.width : '';\r\n            var height = (screen.height) ? screen.height : '';\r\n            displayResolution += '' + width + ' x ' + height;\r\n        }\r\n        DetectRTC.displayResolution = displayResolution;\r\n\r\n        function getAspectRatio(w, h) {\r\n            function gcd(a, b) {\r\n                return (b == 0) ? a : gcd(b, a % b);\r\n            }\r\n            var r = gcd(w, h);\r\n            return (w / r) / (h / r);\r\n        }\r\n\r\n        DetectRTC.displayAspectRatio = getAspectRatio(screen.width, screen.height).toFixed(2);\r\n\r\n        // ----------\r\n        DetectRTC.isCanvasSupportsStreamCapturing = isCanvasSupportsStreamCapturing;\r\n        DetectRTC.isVideoSupportsStreamCapturing = isVideoSupportsStreamCapturing;\r\n\r\n        if (DetectRTC.browser.name == 'Chrome' && DetectRTC.browser.version >= 53) {\r\n            if (!DetectRTC.isCanvasSupportsStreamCapturing) {\r\n                DetectRTC.isCanvasSupportsStreamCapturing = 'Requires chrome flag: enable-experimental-web-platform-features';\r\n            }\r\n\r\n            if (!DetectRTC.isVideoSupportsStreamCapturing) {\r\n                DetectRTC.isVideoSupportsStreamCapturing = 'Requires chrome flag: enable-experimental-web-platform-features';\r\n            }\r\n        }\r\n\r\n        // ------\r\n        DetectRTC.DetectLocalIPAddress = DetectLocalIPAddress;\r\n\r\n        DetectRTC.isWebSocketsSupported = 'WebSocket' in window && 2 === window.WebSocket.CLOSING;\r\n        DetectRTC.isWebSocketsBlocked = !DetectRTC.isWebSocketsSupported;\r\n\r\n        if (DetectRTC.osName === 'Nodejs') {\r\n            DetectRTC.isWebSocketsSupported = true;\r\n            DetectRTC.isWebSocketsBlocked = false;\r\n        }\r\n\r\n        DetectRTC.checkWebSocketsSupport = function(callback) {\r\n            callback = callback || function() {};\r\n            try {\r\n                var starttime;\r\n                var websocket = new WebSocket('wss://echo.websocket.org:443/');\r\n                websocket.onopen = function() {\r\n                    DetectRTC.isWebSocketsBlocked = false;\r\n                    starttime = (new Date).getTime();\r\n                    websocket.send('ping');\r\n                };\r\n                websocket.onmessage = function() {\r\n                    DetectRTC.WebsocketLatency = (new Date).getTime() - starttime + 'ms';\r\n                    callback();\r\n                    websocket.close();\r\n                    websocket = null;\r\n                };\r\n                websocket.onerror = function() {\r\n                    DetectRTC.isWebSocketsBlocked = true;\r\n                    callback();\r\n                };\r\n            } catch (e) {\r\n                DetectRTC.isWebSocketsBlocked = true;\r\n                callback();\r\n            }\r\n        };\r\n\r\n        // -------\r\n        DetectRTC.load = function(callback) {\r\n            callback = callback || function() {};\r\n            checkDeviceSupport(callback);\r\n        };\r\n\r\n        // check for microphone/camera support!\r\n        if (typeof checkDeviceSupport === 'function') {\r\n            // checkDeviceSupport();\r\n        }\r\n\r\n        if (typeof MediaDevices !== 'undefined') {\r\n            DetectRTC.MediaDevices = MediaDevices;\r\n        } else {\r\n            DetectRTC.MediaDevices = [];\r\n        }\r\n\r\n        DetectRTC.hasMicrophone = hasMicrophone;\r\n        DetectRTC.hasSpeakers = hasSpeakers;\r\n        DetectRTC.hasWebcam = hasWebcam;\r\n\r\n        DetectRTC.isWebsiteHasWebcamPermissions = isWebsiteHasWebcamPermissions;\r\n        DetectRTC.isWebsiteHasMicrophonePermissions = isWebsiteHasMicrophonePermissions;\r\n\r\n        DetectRTC.audioInputDevices = audioInputDevices;\r\n        DetectRTC.audioOutputDevices = audioOutputDevices;\r\n        DetectRTC.videoInputDevices = videoInputDevices;\r\n\r\n        // ------\r\n        var isSetSinkIdSupported = false;\r\n        if (typeof document !== 'undefined' && typeof document.createElement === 'function' && 'setSinkId' in document.createElement('video')) {\r\n            isSetSinkIdSupported = true;\r\n        }\r\n        DetectRTC.isSetSinkIdSupported = isSetSinkIdSupported;\r\n\r\n        // -----\r\n        var isRTPSenderReplaceTracksSupported = false;\r\n        if (DetectRTC.browser.isFirefox && typeof mozRTCPeerConnection !== 'undefined' /*&& DetectRTC.browser.version > 39*/ ) {\r\n            /*global mozRTCPeerConnection:true */\r\n            if ('getSenders' in mozRTCPeerConnection.prototype) {\r\n                isRTPSenderReplaceTracksSupported = true;\r\n            }\r\n        } else if (DetectRTC.browser.isChrome && typeof webkitRTCPeerConnection !== 'undefined') {\r\n            /*global webkitRTCPeerConnection:true */\r\n            if ('getSenders' in webkitRTCPeerConnection.prototype) {\r\n                isRTPSenderReplaceTracksSupported = true;\r\n            }\r\n        }\r\n        DetectRTC.isRTPSenderReplaceTracksSupported = isRTPSenderReplaceTracksSupported;\r\n\r\n        //------\r\n        var isRemoteStreamProcessingSupported = false;\r\n        if (DetectRTC.browser.isFirefox && DetectRTC.browser.version > 38) {\r\n            isRemoteStreamProcessingSupported = true;\r\n        }\r\n        DetectRTC.isRemoteStreamProcessingSupported = isRemoteStreamProcessingSupported;\r\n\r\n        //-------\r\n        var isApplyConstraintsSupported = false;\r\n\r\n        /*global MediaStreamTrack:true */\r\n        if (typeof MediaStreamTrack !== 'undefined' && 'applyConstraints' in MediaStreamTrack.prototype) {\r\n            isApplyConstraintsSupported = true;\r\n        }\r\n        DetectRTC.isApplyConstraintsSupported = isApplyConstraintsSupported;\r\n\r\n        //-------\r\n        var isMultiMonitorScreenCapturingSupported = false;\r\n        if (DetectRTC.browser.isFirefox && DetectRTC.browser.version >= 43) {\r\n            // version 43 merely supports platforms for multi-monitors\r\n            // version 44 will support exact multi-monitor selection i.e. you can select any monitor for screen capturing.\r\n            isMultiMonitorScreenCapturingSupported = true;\r\n        }\r\n        DetectRTC.isMultiMonitorScreenCapturingSupported = isMultiMonitorScreenCapturingSupported;\r\n\r\n        DetectRTC.isPromisesSupported = !!('Promise' in window);\r\n\r\n        // version is generated by \"grunt\"\r\n        DetectRTC.version = '1.3.9';\r\n\r\n        if (typeof DetectRTC === 'undefined') {\r\n            window.DetectRTC = {};\r\n        }\r\n\r\n        var MediaStream = window.MediaStream;\r\n\r\n        if (typeof MediaStream === 'undefined' && typeof webkitMediaStream !== 'undefined') {\r\n            MediaStream = webkitMediaStream;\r\n        }\r\n\r\n        if (typeof MediaStream !== 'undefined' && typeof MediaStream === 'function') {\r\n            DetectRTC.MediaStream = Object.keys(MediaStream.prototype);\r\n        } else DetectRTC.MediaStream = false;\r\n\r\n        if (typeof MediaStreamTrack !== 'undefined') {\r\n            DetectRTC.MediaStreamTrack = Object.keys(MediaStreamTrack.prototype);\r\n        } else DetectRTC.MediaStreamTrack = false;\r\n\r\n        var RTCPeerConnection = window.RTCPeerConnection || window.mozRTCPeerConnection || window.webkitRTCPeerConnection;\r\n\r\n        if (typeof RTCPeerConnection !== 'undefined') {\r\n            DetectRTC.RTCPeerConnection = Object.keys(RTCPeerConnection.prototype);\r\n        } else DetectRTC.RTCPeerConnection = false;\r\n\r\n        window.DetectRTC = DetectRTC;\r\n\r\n        if (typeof module !== 'undefined' /* && !!module.exports*/ ) {\r\n            module.exports = DetectRTC;\r\n        }\r\n\r\n        if (typeof define === 'function' && define.amd) {\r\n            define('DetectRTC', [], function() {\r\n                return DetectRTC;\r\n            });\r\n        }\r\n    })();\r\n\r\n    // globals.js\r\n\r\n    if (typeof cordova !== 'undefined') {\r\n        DetectRTC.isMobileDevice = true;\r\n        DetectRTC.browser.name = 'Chrome';\r\n    }\r\n\r\n    if (navigator && navigator.userAgent && navigator.userAgent.indexOf('Crosswalk') !== -1) {\r\n        DetectRTC.isMobileDevice = true;\r\n        DetectRTC.browser.name = 'Chrome';\r\n    }\r\n\r\n    function fireEvent(obj, eventName, args) {\r\n        if (typeof CustomEvent === 'undefined') {\r\n            return;\r\n        }\r\n\r\n        var eventDetail = {\r\n            arguments: args,\r\n            __exposedProps__: args\r\n        };\r\n\r\n        var event = new CustomEvent(eventName, eventDetail);\r\n        obj.dispatchEvent(event);\r\n    }\r\n\r\n    function setHarkEvents(connection, streamEvent) {\r\n        if (!streamEvent.stream || !getTracks(streamEvent.stream, 'audio').length) return;\r\n\r\n        if (!connection || !streamEvent) {\r\n            throw 'Both arguments are required.';\r\n        }\r\n\r\n        if (!connection.onspeaking || !connection.onsilence) {\r\n            return;\r\n        }\r\n\r\n        if (typeof hark === 'undefined') {\r\n            throw 'hark.js not found.';\r\n        }\r\n\r\n        hark(streamEvent.stream, {\r\n            onspeaking: function() {\r\n                connection.onspeaking(streamEvent);\r\n            },\r\n            onsilence: function() {\r\n                connection.onsilence(streamEvent);\r\n            },\r\n            onvolumechange: function(volume, threshold) {\r\n                if (!connection.onvolumechange) {\r\n                    return;\r\n                }\r\n                connection.onvolumechange(merge({\r\n                    volume: volume,\r\n                    threshold: threshold\r\n                }, streamEvent));\r\n            }\r\n        });\r\n    }\r\n\r\n    function setMuteHandlers(connection, streamEvent) {\r\n        if (!streamEvent.stream || !streamEvent.stream || !streamEvent.stream.addEventListener) return;\r\n\r\n        streamEvent.stream.addEventListener('mute', function(event) {\r\n            event = connection.streamEvents[streamEvent.streamid];\r\n\r\n            event.session = {\r\n                audio: event.muteType === 'audio',\r\n                video: event.muteType === 'video'\r\n            };\r\n\r\n            connection.onmute(event);\r\n        }, false);\r\n\r\n        streamEvent.stream.addEventListener('unmute', function(event) {\r\n            event = connection.streamEvents[streamEvent.streamid];\r\n\r\n            event.session = {\r\n                audio: event.unmuteType === 'audio',\r\n                video: event.unmuteType === 'video'\r\n            };\r\n\r\n            connection.onunmute(event);\r\n        }, false);\r\n    }\r\n\r\n    function getRandomString() {\r\n        if (window.crypto && window.crypto.getRandomValues && navigator.userAgent.indexOf('Safari') === -1) {\r\n            var a = window.crypto.getRandomValues(new Uint32Array(3)),\r\n                token = '';\r\n            for (var i = 0, l = a.length; i < l; i++) {\r\n                token += a[i].toString(36);\r\n            }\r\n            return token;\r\n        } else {\r\n            return (Math.random() * new Date().getTime()).toString(36).replace(/\\./g, '');\r\n        }\r\n    }\r\n\r\n    // Get HTMLAudioElement/HTMLVideoElement accordingly\r\n    // todo: add API documentation for connection.autoCreateMediaElement\r\n\r\n    function getRMCMediaElement(stream, callback, connection) {\r\n        if (!connection.autoCreateMediaElement) {\r\n            callback({});\r\n            return;\r\n        }\r\n\r\n        var isAudioOnly = false;\r\n        if (!getTracks(stream, 'video').length && !stream.isVideo && !stream.isScreen) {\r\n            isAudioOnly = true;\r\n        }\r\n\r\n        if (DetectRTC.browser.name === 'Firefox') {\r\n            if (connection.session.video || connection.session.screen) {\r\n                isAudioOnly = false;\r\n            }\r\n        }\r\n\r\n        var mediaElement = document.createElement(isAudioOnly ? 'audio' : 'video');\r\n\r\n        mediaElement.srcObject = stream;\r\n\r\n        mediaElement.setAttribute('autoplay', true);\r\n        mediaElement.setAttribute('playsinline', true);\r\n        mediaElement.setAttribute('controls', true);\r\n        mediaElement.setAttribute('muted', false);\r\n        mediaElement.setAttribute('volume', 1);\r\n\r\n        // http://goo.gl/WZ5nFl\r\n        // Firefox don't yet support onended for any stream (remote/local)\r\n        if (DetectRTC.browser.name === 'Firefox') {\r\n            var streamEndedEvent = 'ended';\r\n\r\n            if ('oninactive' in mediaElement) {\r\n                streamEndedEvent = 'inactive';\r\n            }\r\n\r\n            mediaElement.addEventListener(streamEndedEvent, function() {\r\n                // fireEvent(stream, streamEndedEvent, stream);\r\n                currentUserMediaRequest.remove(stream.idInstance);\r\n\r\n                if (stream.type === 'local') {\r\n                    streamEndedEvent = 'ended';\r\n\r\n                    if ('oninactive' in stream) {\r\n                        streamEndedEvent = 'inactive';\r\n                    }\r\n\r\n                    StreamsHandler.onSyncNeeded(stream.streamid, streamEndedEvent);\r\n\r\n                    connection.attachStreams.forEach(function(aStream, idx) {\r\n                        if (stream.streamid === aStream.streamid) {\r\n                            delete connection.attachStreams[idx];\r\n                        }\r\n                    });\r\n\r\n                    var newStreamsArray = [];\r\n                    connection.attachStreams.forEach(function(aStream) {\r\n                        if (aStream) {\r\n                            newStreamsArray.push(aStream);\r\n                        }\r\n                    });\r\n                    connection.attachStreams = newStreamsArray;\r\n\r\n                    var streamEvent = connection.streamEvents[stream.streamid];\r\n\r\n                    if (streamEvent) {\r\n                        connection.onstreamended(streamEvent);\r\n                        return;\r\n                    }\r\n                    if (this.parentNode) {\r\n                        this.parentNode.removeChild(this);\r\n                    }\r\n                }\r\n            }, false);\r\n        }\r\n\r\n        var played = mediaElement.play();\r\n        if (typeof played !== 'undefined') {\r\n            var cbFired = false;\r\n            setTimeout(function() {\r\n                if (!cbFired) {\r\n                    cbFired = true;\r\n                    callback(mediaElement);\r\n                }\r\n            }, 1000);\r\n            played.then(function() {\r\n                if (cbFired) return;\r\n                cbFired = true;\r\n                callback(mediaElement);\r\n            }).catch(function(error) {\r\n                if (cbFired) return;\r\n                cbFired = true;\r\n                callback(mediaElement);\r\n            });\r\n        } else {\r\n            callback(mediaElement);\r\n        }\r\n    }\r\n\r\n    // if IE\r\n    if (!window.addEventListener) {\r\n        window.addEventListener = function(el, eventName, eventHandler) {\r\n            if (!el.attachEvent) {\r\n                return;\r\n            }\r\n            el.attachEvent('on' + eventName, eventHandler);\r\n        };\r\n    }\r\n\r\n    function listenEventHandler(eventName, eventHandler) {\r\n        window.removeEventListener(eventName, eventHandler);\r\n        window.addEventListener(eventName, eventHandler, false);\r\n    }\r\n\r\n    window.attachEventListener = function(video, type, listener, useCapture) {\r\n        video.addEventListener(type, listener, useCapture);\r\n    };\r\n\r\n    function removeNullEntries(array) {\r\n        var newArray = [];\r\n        array.forEach(function(item) {\r\n            if (item) {\r\n                newArray.push(item);\r\n            }\r\n        });\r\n        return newArray;\r\n    }\r\n\r\n\r\n    function isData(session) {\r\n        return !session.audio && !session.video && !session.screen && session.data;\r\n    }\r\n\r\n    function isNull(obj) {\r\n        return typeof obj === 'undefined';\r\n    }\r\n\r\n    function isString(obj) {\r\n        return typeof obj === 'string';\r\n    }\r\n\r\n    var MediaStream = window.MediaStream;\r\n\r\n    if (typeof MediaStream === 'undefined' && typeof webkitMediaStream !== 'undefined') {\r\n        MediaStream = webkitMediaStream;\r\n    }\r\n\r\n    /*global MediaStream:true */\r\n    if (typeof MediaStream !== 'undefined') {\r\n        if (!('stop' in MediaStream.prototype)) {\r\n            MediaStream.prototype.stop = function() {\r\n                this.getTracks().forEach(function(track) {\r\n                    track.stop();\r\n                });\r\n            };\r\n        }\r\n    }\r\n\r\n    function isAudioPlusTab(connection, audioPlusTab) {\r\n        if (connection.session.audio && connection.session.audio === 'two-way') {\r\n            return false;\r\n        }\r\n\r\n        if (DetectRTC.browser.name === 'Firefox' && audioPlusTab !== false) {\r\n            return true;\r\n        }\r\n\r\n        if (DetectRTC.browser.name !== 'Chrome' || DetectRTC.browser.version < 50) return false;\r\n\r\n        if (typeof audioPlusTab === true) {\r\n            return true;\r\n        }\r\n\r\n        if (typeof audioPlusTab === 'undefined' && connection.session.audio && connection.session.screen && !connection.session.video) {\r\n            audioPlusTab = true;\r\n            return true;\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    function getAudioScreenConstraints(screen_constraints) {\r\n        if (DetectRTC.browser.name === 'Firefox') {\r\n            return true;\r\n        }\r\n\r\n        if (DetectRTC.browser.name !== 'Chrome') return false;\r\n\r\n        return {\r\n            mandatory: {\r\n                chromeMediaSource: screen_constraints.mandatory.chromeMediaSource,\r\n                chromeMediaSourceId: screen_constraints.mandatory.chromeMediaSourceId\r\n            }\r\n        };\r\n    }\r\n\r\n    window.iOSDefaultAudioOutputDevice = window.iOSDefaultAudioOutputDevice || 'speaker'; // earpiece or speaker\r\n\r\n    function getTracks(stream, kind) {\r\n        if (!stream || !stream.getTracks) {\r\n            return [];\r\n        }\r\n\r\n        return stream.getTracks().filter(function(t) {\r\n            return t.kind === (kind || 'audio');\r\n        });\r\n    }\r\n\r\n    function isUnifiedPlanSupportedDefault() {\r\n        var canAddTransceiver = false;\r\n\r\n        try {\r\n            if (typeof RTCRtpTransceiver === 'undefined') return false;\r\n            if (!('currentDirection' in RTCRtpTransceiver.prototype)) return false;\r\n\r\n            var tempPc = new RTCPeerConnection();\r\n\r\n            try {\r\n                tempPc.addTransceiver('audio');\r\n                canAddTransceiver = true;\r\n            } catch (e) {}\r\n\r\n            tempPc.close();\r\n        } catch (e) {\r\n            canAddTransceiver = false;\r\n        }\r\n\r\n        return canAddTransceiver && isUnifiedPlanSuppored();\r\n    }\r\n\r\n    function isUnifiedPlanSuppored() {\r\n        var isUnifiedPlanSupported = false;\r\n\r\n        try {\r\n            var pc = new RTCPeerConnection({\r\n                sdpSemantics: 'unified-plan'\r\n            });\r\n\r\n            try {\r\n                var config = pc.getConfiguration();\r\n                if (config.sdpSemantics == 'unified-plan')\r\n                    isUnifiedPlanSupported = true;\r\n                else if (config.sdpSemantics == 'plan-b')\r\n                    isUnifiedPlanSupported = false;\r\n                else\r\n                    isUnifiedPlanSupported = false;\r\n            } catch (e) {\r\n                isUnifiedPlanSupported = false;\r\n            }\r\n        } catch (e) {\r\n            isUnifiedPlanSupported = false;\r\n        }\r\n\r\n        return isUnifiedPlanSupported;\r\n    }\r\n\r\n    // ios-hacks.js\r\n\r\n    function setCordovaAPIs() {\r\n        // if (DetectRTC.osName !== 'iOS') return;\r\n        if (typeof cordova === 'undefined' || typeof cordova.plugins === 'undefined' || typeof cordova.plugins.iosrtc === 'undefined') return;\r\n\r\n        var iosrtc = cordova.plugins.iosrtc;\r\n        window.webkitRTCPeerConnection = iosrtc.RTCPeerConnection;\r\n        window.RTCSessionDescription = iosrtc.RTCSessionDescription;\r\n        window.RTCIceCandidate = iosrtc.RTCIceCandidate;\r\n        window.MediaStream = iosrtc.MediaStream;\r\n        window.MediaStreamTrack = iosrtc.MediaStreamTrack;\r\n        navigator.getUserMedia = navigator.webkitGetUserMedia = iosrtc.getUserMedia;\r\n\r\n        iosrtc.debug.enable('iosrtc*');\r\n        if (typeof iosrtc.selectAudioOutput == 'function') {\r\n            iosrtc.selectAudioOutput(window.iOSDefaultAudioOutputDevice || 'speaker'); // earpiece or speaker\r\n        }\r\n        iosrtc.registerGlobals();\r\n    }\r\n\r\n    document.addEventListener('deviceready', setCordovaAPIs, false);\r\n    setCordovaAPIs();\r\n\r\n    // RTCPeerConnection.js\r\n\r\n    var defaults = {};\r\n\r\n    function setSdpConstraints(config) {\r\n        var sdpConstraints = {\r\n            OfferToReceiveAudio: !!config.OfferToReceiveAudio,\r\n            OfferToReceiveVideo: !!config.OfferToReceiveVideo\r\n        };\r\n\r\n        return sdpConstraints;\r\n    }\r\n\r\n    var RTCPeerConnection;\r\n    if (typeof window.RTCPeerConnection !== 'undefined') {\r\n        RTCPeerConnection = window.RTCPeerConnection;\r\n    } else if (typeof mozRTCPeerConnection !== 'undefined') {\r\n        RTCPeerConnection = mozRTCPeerConnection;\r\n    } else if (typeof webkitRTCPeerConnection !== 'undefined') {\r\n        RTCPeerConnection = webkitRTCPeerConnection;\r\n    }\r\n\r\n    var RTCSessionDescription = window.RTCSessionDescription || window.mozRTCSessionDescription;\r\n    var RTCIceCandidate = window.RTCIceCandidate || window.mozRTCIceCandidate;\r\n    var MediaStreamTrack = window.MediaStreamTrack;\r\n\r\n    function PeerInitiator(config) {\r\n        if (typeof window.RTCPeerConnection !== 'undefined') {\r\n            RTCPeerConnection = window.RTCPeerConnection;\r\n        } else if (typeof mozRTCPeerConnection !== 'undefined') {\r\n            RTCPeerConnection = mozRTCPeerConnection;\r\n        } else if (typeof webkitRTCPeerConnection !== 'undefined') {\r\n            RTCPeerConnection = webkitRTCPeerConnection;\r\n        }\r\n\r\n        RTCSessionDescription = window.RTCSessionDescription || window.mozRTCSessionDescription;\r\n        RTCIceCandidate = window.RTCIceCandidate || window.mozRTCIceCandidate;\r\n        MediaStreamTrack = window.MediaStreamTrack;\r\n\r\n        if (!RTCPeerConnection) {\r\n            throw 'WebRTC 1.0 (RTCPeerConnection) API are NOT available in this browser.';\r\n        }\r\n\r\n        var connection = config.rtcMultiConnection;\r\n\r\n        this.extra = config.remoteSdp ? config.remoteSdp.extra : connection.extra;\r\n        this.userid = config.userid;\r\n        this.streams = [];\r\n        this.channels = config.channels || [];\r\n        this.connectionDescription = config.connectionDescription;\r\n\r\n        this.addStream = function(session) {\r\n            connection.addStream(session, self.userid);\r\n        };\r\n\r\n        this.removeStream = function(streamid) {\r\n            connection.removeStream(streamid, self.userid);\r\n        };\r\n\r\n        var self = this;\r\n\r\n        if (config.remoteSdp) {\r\n            this.connectionDescription = config.remoteSdp.connectionDescription;\r\n        }\r\n\r\n        var allRemoteStreams = {};\r\n\r\n        defaults.sdpConstraints = setSdpConstraints({\r\n            OfferToReceiveAudio: true,\r\n            OfferToReceiveVideo: true\r\n        });\r\n\r\n        var peer;\r\n\r\n        var renegotiatingPeer = !!config.renegotiatingPeer;\r\n        if (config.remoteSdp) {\r\n            renegotiatingPeer = !!config.remoteSdp.renegotiatingPeer;\r\n        }\r\n\r\n        var localStreams = [];\r\n        connection.attachStreams.forEach(function(stream) {\r\n            if (!!stream) {\r\n                localStreams.push(stream);\r\n            }\r\n        });\r\n\r\n        if (!renegotiatingPeer) {\r\n            var iceTransports = 'all';\r\n            if (connection.candidates.turn || connection.candidates.relay) {\r\n                if (!connection.candidates.stun && !connection.candidates.reflexive && !connection.candidates.host) {\r\n                    iceTransports = 'relay';\r\n                }\r\n            }\r\n\r\n            try {\r\n                // ref: developer.mozilla.org/en-US/docs/Web/API/RTCConfiguration\r\n                var params = {\r\n                    iceServers: connection.iceServers,\r\n                    iceTransportPolicy: connection.iceTransportPolicy || iceTransports\r\n                };\r\n\r\n                if (typeof connection.iceCandidatePoolSize !== 'undefined') {\r\n                    params.iceCandidatePoolSize = connection.iceCandidatePoolSize;\r\n                }\r\n\r\n                if (typeof connection.bundlePolicy !== 'undefined') {\r\n                    params.bundlePolicy = connection.bundlePolicy;\r\n                }\r\n\r\n                if (typeof connection.rtcpMuxPolicy !== 'undefined') {\r\n                    params.rtcpMuxPolicy = connection.rtcpMuxPolicy;\r\n                }\r\n\r\n                if (!!connection.sdpSemantics) {\r\n                    params.sdpSemantics = connection.sdpSemantics || 'unified-plan';\r\n                }\r\n\r\n                if (!connection.iceServers || !connection.iceServers.length) {\r\n                    params = null;\r\n                    connection.optionalArgument = null;\r\n                }\r\n\r\n                peer = new RTCPeerConnection(params, connection.optionalArgument);\r\n            } catch (e) {\r\n                try {\r\n                    var params = {\r\n                        iceServers: connection.iceServers\r\n                    };\r\n\r\n                    peer = new RTCPeerConnection(params);\r\n                } catch (e) {\r\n                    peer = new RTCPeerConnection();\r\n                }\r\n            }\r\n        } else {\r\n            peer = config.peerRef;\r\n        }\r\n\r\n        if (!peer.getRemoteStreams && peer.getReceivers) {\r\n            peer.getRemoteStreams = function() {\r\n                var stream = new MediaStream();\r\n                peer.getReceivers().forEach(function(receiver) {\r\n                    stream.addTrack(receiver.track);\r\n                });\r\n                return [stream];\r\n            };\r\n        }\r\n\r\n        if (!peer.getLocalStreams && peer.getSenders) {\r\n            peer.getLocalStreams = function() {\r\n                var stream = new MediaStream();\r\n                peer.getSenders().forEach(function(sender) {\r\n                    stream.addTrack(sender.track);\r\n                });\r\n                return [stream];\r\n            };\r\n        }\r\n\r\n        peer.onicecandidate = function(event) {\r\n            if (!event.candidate) {\r\n                if (!connection.trickleIce) {\r\n                    var localSdp = peer.localDescription;\r\n                    config.onLocalSdp({\r\n                        type: localSdp.type,\r\n                        sdp: localSdp.sdp,\r\n                        remotePeerSdpConstraints: config.remotePeerSdpConstraints || false,\r\n                        renegotiatingPeer: !!config.renegotiatingPeer || false,\r\n                        connectionDescription: self.connectionDescription,\r\n                        dontGetRemoteStream: !!config.dontGetRemoteStream,\r\n                        extra: connection ? connection.extra : {},\r\n                        streamsToShare: streamsToShare\r\n                    });\r\n                }\r\n                return;\r\n            }\r\n\r\n            if (!connection.trickleIce) return;\r\n            config.onLocalCandidate({\r\n                candidate: event.candidate.candidate,\r\n                sdpMid: event.candidate.sdpMid,\r\n                sdpMLineIndex: event.candidate.sdpMLineIndex\r\n            });\r\n        };\r\n\r\n        localStreams.forEach(function(localStream) {\r\n            if (config.remoteSdp && config.remoteSdp.remotePeerSdpConstraints && config.remoteSdp.remotePeerSdpConstraints.dontGetRemoteStream) {\r\n                return;\r\n            }\r\n\r\n            if (config.dontAttachLocalStream) {\r\n                return;\r\n            }\r\n\r\n            localStream = connection.beforeAddingStream(localStream, self);\r\n\r\n            if (!localStream) return;\r\n\r\n            peer.getLocalStreams().forEach(function(stream) {\r\n                if (localStream && stream.id == localStream.id) {\r\n                    localStream = null;\r\n                }\r\n            });\r\n\r\n            if (localStream && localStream.getTracks) {\r\n                localStream.getTracks().forEach(function(track) {\r\n                    try {\r\n                        // last parameter is redundant for unified-plan\r\n                        // starting from chrome version 72\r\n                        peer.addTrack(track, localStream);\r\n                    } catch (e) {}\r\n                });\r\n            }\r\n        });\r\n\r\n        peer.oniceconnectionstatechange = peer.onsignalingstatechange = function() {\r\n            var extra = self.extra;\r\n            if (connection.peers[self.userid]) {\r\n                extra = connection.peers[self.userid].extra || extra;\r\n            }\r\n\r\n            if (!peer) {\r\n                return;\r\n            }\r\n\r\n            config.onPeerStateChanged({\r\n                iceConnectionState: peer.iceConnectionState,\r\n                iceGatheringState: peer.iceGatheringState,\r\n                signalingState: peer.signalingState,\r\n                extra: extra,\r\n                userid: self.userid\r\n            });\r\n\r\n            if (peer && peer.iceConnectionState && peer.iceConnectionState.search(/closed|failed/gi) !== -1 && self.streams instanceof Array) {\r\n                self.streams.forEach(function(stream) {\r\n                    var streamEvent = connection.streamEvents[stream.id] || {\r\n                        streamid: stream.id,\r\n                        stream: stream,\r\n                        type: 'remote'\r\n                    };\r\n\r\n                    connection.onstreamended(streamEvent);\r\n                });\r\n            }\r\n        };\r\n\r\n        var sdpConstraints = {\r\n            OfferToReceiveAudio: !!localStreams.length,\r\n            OfferToReceiveVideo: !!localStreams.length\r\n        };\r\n\r\n        if (config.localPeerSdpConstraints) sdpConstraints = config.localPeerSdpConstraints;\r\n\r\n        defaults.sdpConstraints = setSdpConstraints(sdpConstraints);\r\n\r\n        var streamObject;\r\n        var dontDuplicate = {};\r\n\r\n        peer.ontrack = function(event) {\r\n            if (!event || event.type !== 'track') return;\r\n\r\n            event.stream = event.streams[event.streams.length - 1];\r\n\r\n            if (!event.stream.id) {\r\n                event.stream.id = event.track.id;\r\n            }\r\n\r\n            if (dontDuplicate[event.stream.id] && DetectRTC.browser.name !== 'Safari') {\r\n                if (event.track) {\r\n                    event.track.onended = function() { // event.track.onmute = \r\n                        peer && peer.onremovestream(event);\r\n                    };\r\n                }\r\n                return;\r\n            }\r\n\r\n            dontDuplicate[event.stream.id] = event.stream.id;\r\n\r\n            var streamsToShare = {};\r\n            if (config.remoteSdp && config.remoteSdp.streamsToShare) {\r\n                streamsToShare = config.remoteSdp.streamsToShare;\r\n            } else if (config.streamsToShare) {\r\n                streamsToShare = config.streamsToShare;\r\n            }\r\n\r\n            var streamToShare = streamsToShare[event.stream.id];\r\n            if (streamToShare) {\r\n                event.stream.isAudio = streamToShare.isAudio;\r\n                event.stream.isVideo = streamToShare.isVideo;\r\n                event.stream.isScreen = streamToShare.isScreen;\r\n            } else {\r\n                event.stream.isVideo = !!getTracks(event.stream, 'video').length;\r\n                event.stream.isAudio = !event.stream.isVideo;\r\n                event.stream.isScreen = false;\r\n            }\r\n\r\n            event.stream.streamid = event.stream.id;\r\n\r\n            allRemoteStreams[event.stream.id] = event.stream;\r\n            config.onRemoteStream(event.stream);\r\n\r\n            event.stream.getTracks().forEach(function(track) {\r\n                track.onended = function() { // track.onmute = \r\n                    peer && peer.onremovestream(event);\r\n                };\r\n            });\r\n\r\n            event.stream.onremovetrack = function() {\r\n                peer && peer.onremovestream(event);\r\n            };\r\n        };\r\n\r\n        peer.onremovestream = function(event) {\r\n            // this event doesn't works anymore\r\n            event.stream.streamid = event.stream.id;\r\n\r\n            if (allRemoteStreams[event.stream.id]) {\r\n                delete allRemoteStreams[event.stream.id];\r\n            }\r\n\r\n            config.onRemoteStreamRemoved(event.stream);\r\n        };\r\n\r\n        if (typeof peer.removeStream !== 'function') {\r\n            // removeStream backward compatibility\r\n            peer.removeStream = function(stream) {\r\n                stream.getTracks().forEach(function(track) {\r\n                    peer.removeTrack(track, stream);\r\n                });\r\n            };\r\n        }\r\n\r\n        this.addRemoteCandidate = function(remoteCandidate) {\r\n            peer.addIceCandidate(new RTCIceCandidate(remoteCandidate));\r\n        };\r\n\r\n        function oldAddRemoteSdp(remoteSdp, cb) {\r\n            cb = cb || function() {};\r\n\r\n            if (DetectRTC.browser.name !== 'Safari') {\r\n                remoteSdp.sdp = connection.processSdp(remoteSdp.sdp);\r\n            }\r\n            peer.setRemoteDescription(new RTCSessionDescription(remoteSdp), cb, function(error) {\r\n                if (!!connection.enableLogs) {\r\n                    console.error('setRemoteDescription failed', '\\n', error, '\\n', remoteSdp.sdp);\r\n                }\r\n\r\n                cb();\r\n            });\r\n        }\r\n\r\n        this.addRemoteSdp = function(remoteSdp, cb) {\r\n            cb = cb || function() {};\r\n\r\n            if (DetectRTC.browser.name !== 'Safari') {\r\n                remoteSdp.sdp = connection.processSdp(remoteSdp.sdp);\r\n            }\r\n\r\n            peer.setRemoteDescription(new RTCSessionDescription(remoteSdp)).then(cb, function(error) {\r\n                if (!!connection.enableLogs) {\r\n                    console.error('setRemoteDescription failed', '\\n', error, '\\n', remoteSdp.sdp);\r\n                }\r\n\r\n                cb();\r\n            }).catch(function(error) {\r\n                if (!!connection.enableLogs) {\r\n                    console.error('setRemoteDescription failed', '\\n', error, '\\n', remoteSdp.sdp);\r\n                }\r\n\r\n                cb();\r\n            });\r\n        };\r\n\r\n        var isOfferer = true;\r\n\r\n        if (config.remoteSdp) {\r\n            isOfferer = false;\r\n        }\r\n\r\n        this.createDataChannel = function() {\r\n            var channel = peer.createDataChannel('sctp', {});\r\n            setChannelEvents(channel);\r\n        };\r\n\r\n        if (connection.session.data === true && !renegotiatingPeer) {\r\n            if (!isOfferer) {\r\n                peer.ondatachannel = function(event) {\r\n                    var channel = event.channel;\r\n                    setChannelEvents(channel);\r\n                };\r\n            } else {\r\n                this.createDataChannel();\r\n            }\r\n        }\r\n\r\n        this.enableDisableVideoEncoding = function(enable) {\r\n            var rtcp;\r\n            peer.getSenders().forEach(function(sender) {\r\n                if (!rtcp && sender.track.kind === 'video') {\r\n                    rtcp = sender;\r\n                }\r\n            });\r\n\r\n            if (!rtcp || !rtcp.getParameters) return;\r\n\r\n            var parameters = rtcp.getParameters();\r\n            parameters.encodings[1] && (parameters.encodings[1].active = !!enable);\r\n            parameters.encodings[2] && (parameters.encodings[2].active = !!enable);\r\n            rtcp.setParameters(parameters);\r\n        };\r\n\r\n        if (config.remoteSdp) {\r\n            if (config.remoteSdp.remotePeerSdpConstraints) {\r\n                sdpConstraints = config.remoteSdp.remotePeerSdpConstraints;\r\n            }\r\n            defaults.sdpConstraints = setSdpConstraints(sdpConstraints);\r\n            this.addRemoteSdp(config.remoteSdp, function() {\r\n                createOfferOrAnswer('createAnswer');\r\n            });\r\n        }\r\n\r\n        function setChannelEvents(channel) {\r\n            // force ArrayBuffer in Firefox; which uses \"Blob\" by default.\r\n            channel.binaryType = 'arraybuffer';\r\n\r\n            channel.onmessage = function(event) {\r\n                config.onDataChannelMessage(event.data);\r\n            };\r\n\r\n            channel.onopen = function() {\r\n                config.onDataChannelOpened(channel);\r\n            };\r\n\r\n            channel.onerror = function(error) {\r\n                config.onDataChannelError(error);\r\n            };\r\n\r\n            channel.onclose = function(event) {\r\n                config.onDataChannelClosed(event);\r\n            };\r\n\r\n            channel.internalSend = channel.send;\r\n            channel.send = function(data) {\r\n                if (channel.readyState !== 'open') {\r\n                    return;\r\n                }\r\n\r\n                channel.internalSend(data);\r\n            };\r\n\r\n            peer.channel = channel;\r\n        }\r\n\r\n        if (connection.session.audio == 'two-way' || connection.session.video == 'two-way' || connection.session.screen == 'two-way') {\r\n            defaults.sdpConstraints = setSdpConstraints({\r\n                OfferToReceiveAudio: connection.session.audio == 'two-way' || (config.remoteSdp && config.remoteSdp.remotePeerSdpConstraints && config.remoteSdp.remotePeerSdpConstraints.OfferToReceiveAudio),\r\n                OfferToReceiveVideo: connection.session.video == 'two-way' || connection.session.screen == 'two-way' || (config.remoteSdp && config.remoteSdp.remotePeerSdpConstraints && config.remoteSdp.remotePeerSdpConstraints.OfferToReceiveAudio)\r\n            });\r\n        }\r\n\r\n        var streamsToShare = {};\r\n        peer.getLocalStreams().forEach(function(stream) {\r\n            streamsToShare[stream.streamid] = {\r\n                isAudio: !!stream.isAudio,\r\n                isVideo: !!stream.isVideo,\r\n                isScreen: !!stream.isScreen\r\n            };\r\n        });\r\n\r\n        function oldCreateOfferOrAnswer(_method) {\r\n            peer[_method](function(localSdp) {\r\n                if (DetectRTC.browser.name !== 'Safari') {\r\n                    localSdp.sdp = connection.processSdp(localSdp.sdp);\r\n                }\r\n                peer.setLocalDescription(localSdp, function() {\r\n                    if (!connection.trickleIce) return;\r\n\r\n                    config.onLocalSdp({\r\n                        type: localSdp.type,\r\n                        sdp: localSdp.sdp,\r\n                        remotePeerSdpConstraints: config.remotePeerSdpConstraints || false,\r\n                        renegotiatingPeer: !!config.renegotiatingPeer || false,\r\n                        connectionDescription: self.connectionDescription,\r\n                        dontGetRemoteStream: !!config.dontGetRemoteStream,\r\n                        extra: connection ? connection.extra : {},\r\n                        streamsToShare: streamsToShare\r\n                    });\r\n\r\n                    connection.onSettingLocalDescription(self);\r\n                }, function(error) {\r\n                    if (!!connection.enableLogs) {\r\n                        console.error('setLocalDescription-error', error);\r\n                    }\r\n                });\r\n            }, function(error) {\r\n                if (!!connection.enableLogs) {\r\n                    console.error('sdp-' + _method + '-error', error);\r\n                }\r\n            }, defaults.sdpConstraints);\r\n        }\r\n\r\n        function createOfferOrAnswer(_method) {\r\n            peer[_method](defaults.sdpConstraints).then(function(localSdp) {\r\n                if (DetectRTC.browser.name !== 'Safari') {\r\n                    localSdp.sdp = connection.processSdp(localSdp.sdp);\r\n                }\r\n                peer.setLocalDescription(localSdp).then(function() {\r\n                    if (!connection.trickleIce) return;\r\n\r\n                    config.onLocalSdp({\r\n                        type: localSdp.type,\r\n                        sdp: localSdp.sdp,\r\n                        remotePeerSdpConstraints: config.remotePeerSdpConstraints || false,\r\n                        renegotiatingPeer: !!config.renegotiatingPeer || false,\r\n                        connectionDescription: self.connectionDescription,\r\n                        dontGetRemoteStream: !!config.dontGetRemoteStream,\r\n                        extra: connection ? connection.extra : {},\r\n                        streamsToShare: streamsToShare\r\n                    });\r\n\r\n                    connection.onSettingLocalDescription(self);\r\n                }, function(error) {\r\n                    if (!connection.enableLogs) return;\r\n                    console.error('setLocalDescription error', error);\r\n                });\r\n            }, function(error) {\r\n                if (!!connection.enableLogs) {\r\n                    console.error('sdp-error', error);\r\n                }\r\n            });\r\n        }\r\n\r\n        if (isOfferer) {\r\n            createOfferOrAnswer('createOffer');\r\n        }\r\n\r\n        peer.nativeClose = peer.close;\r\n        peer.close = function() {\r\n            if (!peer) {\r\n                return;\r\n            }\r\n\r\n            try {\r\n                if (peer.nativeClose !== peer.close) {\r\n                    peer.nativeClose();\r\n                }\r\n            } catch (e) {}\r\n\r\n            peer = null;\r\n            self.peer = null;\r\n        };\r\n\r\n        this.peer = peer;\r\n    }\r\n\r\n    // CodecsHandler.js\r\n\r\n    var CodecsHandler = (function() {\r\n        // use \"RTCRtpTransceiver.setCodecPreferences\"\r\n        function preferCodec(sdp, codecName) {\r\n            var info = splitLines(sdp);\r\n\r\n            if (!info.videoCodecNumbers) {\r\n                return sdp;\r\n            }\r\n\r\n            if (codecName === 'vp8' && info.vp8LineNumber === info.videoCodecNumbers[0]) {\r\n                return sdp;\r\n            }\r\n\r\n            if (codecName === 'vp9' && info.vp9LineNumber === info.videoCodecNumbers[0]) {\r\n                return sdp;\r\n            }\r\n\r\n            if (codecName === 'h264' && info.h264LineNumber === info.videoCodecNumbers[0]) {\r\n                return sdp;\r\n            }\r\n\r\n            sdp = preferCodecHelper(sdp, codecName, info);\r\n\r\n            return sdp;\r\n        }\r\n\r\n        function preferCodecHelper(sdp, codec, info, ignore) {\r\n            var preferCodecNumber = '';\r\n\r\n            if (codec === 'vp8') {\r\n                if (!info.vp8LineNumber) {\r\n                    return sdp;\r\n                }\r\n                preferCodecNumber = info.vp8LineNumber;\r\n            }\r\n\r\n            if (codec === 'vp9') {\r\n                if (!info.vp9LineNumber) {\r\n                    return sdp;\r\n                }\r\n                preferCodecNumber = info.vp9LineNumber;\r\n            }\r\n\r\n            if (codec === 'h264') {\r\n                if (!info.h264LineNumber) {\r\n                    return sdp;\r\n                }\r\n\r\n                preferCodecNumber = info.h264LineNumber;\r\n            }\r\n\r\n            var newLine = info.videoCodecNumbersOriginal.split('SAVPF')[0] + 'SAVPF ';\r\n\r\n            var newOrder = [preferCodecNumber];\r\n\r\n            if (ignore) {\r\n                newOrder = [];\r\n            }\r\n\r\n            info.videoCodecNumbers.forEach(function(codecNumber) {\r\n                if (codecNumber === preferCodecNumber) return;\r\n                newOrder.push(codecNumber);\r\n            });\r\n\r\n            newLine += newOrder.join(' ');\r\n\r\n            sdp = sdp.replace(info.videoCodecNumbersOriginal, newLine);\r\n            return sdp;\r\n        }\r\n\r\n        function splitLines(sdp) {\r\n            var info = {};\r\n            sdp.split('\\n').forEach(function(line) {\r\n                if (line.indexOf('m=video') === 0) {\r\n                    info.videoCodecNumbers = [];\r\n                    line.split('SAVPF')[1].split(' ').forEach(function(codecNumber) {\r\n                        codecNumber = codecNumber.trim();\r\n                        if (!codecNumber || !codecNumber.length) return;\r\n                        info.videoCodecNumbers.push(codecNumber);\r\n                        info.videoCodecNumbersOriginal = line;\r\n                    });\r\n                }\r\n\r\n                if (line.indexOf('VP8/90000') !== -1 && !info.vp8LineNumber) {\r\n                    info.vp8LineNumber = line.replace('a=rtpmap:', '').split(' ')[0];\r\n                }\r\n\r\n                if (line.indexOf('VP9/90000') !== -1 && !info.vp9LineNumber) {\r\n                    info.vp9LineNumber = line.replace('a=rtpmap:', '').split(' ')[0];\r\n                }\r\n\r\n                if (line.indexOf('H264/90000') !== -1 && !info.h264LineNumber) {\r\n                    info.h264LineNumber = line.replace('a=rtpmap:', '').split(' ')[0];\r\n                }\r\n            });\r\n\r\n            return info;\r\n        }\r\n\r\n        function removeVPX(sdp) {\r\n            var info = splitLines(sdp);\r\n\r\n            // last parameter below means: ignore these codecs\r\n            sdp = preferCodecHelper(sdp, 'vp9', info, true);\r\n            sdp = preferCodecHelper(sdp, 'vp8', info, true);\r\n\r\n            return sdp;\r\n        }\r\n\r\n        function disableNACK(sdp) {\r\n            if (!sdp || typeof sdp !== 'string') {\r\n                throw 'Invalid arguments.';\r\n            }\r\n\r\n            sdp = sdp.replace('a=rtcp-fb:126 nack\\r\\n', '');\r\n            sdp = sdp.replace('a=rtcp-fb:126 nack pli\\r\\n', 'a=rtcp-fb:126 pli\\r\\n');\r\n            sdp = sdp.replace('a=rtcp-fb:97 nack\\r\\n', '');\r\n            sdp = sdp.replace('a=rtcp-fb:97 nack pli\\r\\n', 'a=rtcp-fb:97 pli\\r\\n');\r\n\r\n            return sdp;\r\n        }\r\n\r\n        function prioritize(codecMimeType, peer) {\r\n            if (!peer || !peer.getSenders || !peer.getSenders().length) {\r\n                return;\r\n            }\r\n\r\n            if (!codecMimeType || typeof codecMimeType !== 'string') {\r\n                throw 'Invalid arguments.';\r\n            }\r\n\r\n            peer.getSenders().forEach(function(sender) {\r\n                var params = sender.getParameters();\r\n                for (var i = 0; i < params.codecs.length; i++) {\r\n                    if (params.codecs[i].mimeType == codecMimeType) {\r\n                        params.codecs.unshift(params.codecs.splice(i, 1));\r\n                        break;\r\n                    }\r\n                }\r\n                sender.setParameters(params);\r\n            });\r\n        }\r\n\r\n        function removeNonG722(sdp) {\r\n            return sdp.replace(/m=audio ([0-9]+) RTP\\/SAVPF ([0-9 ]*)/g, 'm=audio $1 RTP\\/SAVPF 9');\r\n        }\r\n\r\n        function setBAS(sdp, bandwidth, isScreen) {\r\n            if (!bandwidth) {\r\n                return sdp;\r\n            }\r\n\r\n            if (typeof isFirefox !== 'undefined' && isFirefox) {\r\n                return sdp;\r\n            }\r\n\r\n            if (isScreen) {\r\n                if (!bandwidth.screen) {\r\n                    console.warn('It seems that you are not using bandwidth for screen. Screen sharing is expected to fail.');\r\n                } else if (bandwidth.screen < 300) {\r\n                    console.warn('It seems that you are using wrong bandwidth value for screen. Screen sharing is expected to fail.');\r\n                }\r\n            }\r\n\r\n            // if screen; must use at least 300kbs\r\n            if (bandwidth.screen && isScreen) {\r\n                sdp = sdp.replace(/b=AS([^\\r\\n]+\\r\\n)/g, '');\r\n                sdp = sdp.replace(/a=mid:video\\r\\n/g, 'a=mid:video\\r\\nb=AS:' + bandwidth.screen + '\\r\\n');\r\n            }\r\n\r\n            // remove existing bandwidth lines\r\n            if (bandwidth.audio || bandwidth.video) {\r\n                sdp = sdp.replace(/b=AS([^\\r\\n]+\\r\\n)/g, '');\r\n            }\r\n\r\n            if (bandwidth.audio) {\r\n                sdp = sdp.replace(/a=mid:audio\\r\\n/g, 'a=mid:audio\\r\\nb=AS:' + bandwidth.audio + '\\r\\n');\r\n            }\r\n\r\n            if (bandwidth.screen) {\r\n                sdp = sdp.replace(/a=mid:video\\r\\n/g, 'a=mid:video\\r\\nb=AS:' + bandwidth.screen + '\\r\\n');\r\n            } else if (bandwidth.video) {\r\n                sdp = sdp.replace(/a=mid:video\\r\\n/g, 'a=mid:video\\r\\nb=AS:' + bandwidth.video + '\\r\\n');\r\n            }\r\n\r\n            return sdp;\r\n        }\r\n\r\n        // Find the line in sdpLines that starts with |prefix|, and, if specified,\r\n        // contains |substr| (case-insensitive search).\r\n        function findLine(sdpLines, prefix, substr) {\r\n            return findLineInRange(sdpLines, 0, -1, prefix, substr);\r\n        }\r\n\r\n        // Find the line in sdpLines[startLine...endLine - 1] that starts with |prefix|\r\n        // and, if specified, contains |substr| (case-insensitive search).\r\n        function findLineInRange(sdpLines, startLine, endLine, prefix, substr) {\r\n            var realEndLine = endLine !== -1 ? endLine : sdpLines.length;\r\n            for (var i = startLine; i < realEndLine; ++i) {\r\n                if (sdpLines[i].indexOf(prefix) === 0) {\r\n                    if (!substr ||\r\n                        sdpLines[i].toLowerCase().indexOf(substr.toLowerCase()) !== -1) {\r\n                        return i;\r\n                    }\r\n                }\r\n            }\r\n            return null;\r\n        }\r\n\r\n        // Gets the codec payload type from an a=rtpmap:X line.\r\n        function getCodecPayloadType(sdpLine) {\r\n            var pattern = new RegExp('a=rtpmap:(\\\\d+) \\\\w+\\\\/\\\\d+');\r\n            var result = sdpLine.match(pattern);\r\n            return (result && result.length === 2) ? result[1] : null;\r\n        }\r\n\r\n        function setVideoBitrates(sdp, params) {\r\n            params = params || {};\r\n            var xgoogle_min_bitrate = params.min;\r\n            var xgoogle_max_bitrate = params.max;\r\n\r\n            var sdpLines = sdp.split('\\r\\n');\r\n\r\n            // VP8\r\n            var vp8Index = findLine(sdpLines, 'a=rtpmap', 'VP8/90000');\r\n            var vp8Payload;\r\n            if (vp8Index) {\r\n                vp8Payload = getCodecPayloadType(sdpLines[vp8Index]);\r\n            }\r\n\r\n            if (!vp8Payload) {\r\n                return sdp;\r\n            }\r\n\r\n            var rtxIndex = findLine(sdpLines, 'a=rtpmap', 'rtx/90000');\r\n            var rtxPayload;\r\n            if (rtxIndex) {\r\n                rtxPayload = getCodecPayloadType(sdpLines[rtxIndex]);\r\n            }\r\n\r\n            if (!rtxIndex) {\r\n                return sdp;\r\n            }\r\n\r\n            var rtxFmtpLineIndex = findLine(sdpLines, 'a=fmtp:' + rtxPayload.toString());\r\n            if (rtxFmtpLineIndex !== null) {\r\n                var appendrtxNext = '\\r\\n';\r\n                appendrtxNext += 'a=fmtp:' + vp8Payload + ' x-google-min-bitrate=' + (xgoogle_min_bitrate || '228') + '; x-google-max-bitrate=' + (xgoogle_max_bitrate || '228');\r\n                sdpLines[rtxFmtpLineIndex] = sdpLines[rtxFmtpLineIndex].concat(appendrtxNext);\r\n                sdp = sdpLines.join('\\r\\n');\r\n            }\r\n\r\n            return sdp;\r\n        }\r\n\r\n        function setOpusAttributes(sdp, params) {\r\n            params = params || {};\r\n\r\n            var sdpLines = sdp.split('\\r\\n');\r\n\r\n            // Opus\r\n            var opusIndex = findLine(sdpLines, 'a=rtpmap', 'opus/48000');\r\n            var opusPayload;\r\n            if (opusIndex) {\r\n                opusPayload = getCodecPayloadType(sdpLines[opusIndex]);\r\n            }\r\n\r\n            if (!opusPayload) {\r\n                return sdp;\r\n            }\r\n\r\n            var opusFmtpLineIndex = findLine(sdpLines, 'a=fmtp:' + opusPayload.toString());\r\n            if (opusFmtpLineIndex === null) {\r\n                return sdp;\r\n            }\r\n\r\n            var appendOpusNext = '';\r\n            appendOpusNext += '; stereo=' + (typeof params.stereo != 'undefined' ? params.stereo : '1');\r\n            appendOpusNext += '; sprop-stereo=' + (typeof params['sprop-stereo'] != 'undefined' ? params['sprop-stereo'] : '1');\r\n\r\n            if (typeof params.maxaveragebitrate != 'undefined') {\r\n                appendOpusNext += '; maxaveragebitrate=' + (params.maxaveragebitrate || 128 * 1024 * 8);\r\n            }\r\n\r\n            if (typeof params.maxplaybackrate != 'undefined') {\r\n                appendOpusNext += '; maxplaybackrate=' + (params.maxplaybackrate || 128 * 1024 * 8);\r\n            }\r\n\r\n            if (typeof params.cbr != 'undefined') {\r\n                appendOpusNext += '; cbr=' + (typeof params.cbr != 'undefined' ? params.cbr : '1');\r\n            }\r\n\r\n            if (typeof params.useinbandfec != 'undefined') {\r\n                appendOpusNext += '; useinbandfec=' + params.useinbandfec;\r\n            }\r\n\r\n            if (typeof params.usedtx != 'undefined') {\r\n                appendOpusNext += '; usedtx=' + params.usedtx;\r\n            }\r\n\r\n            if (typeof params.maxptime != 'undefined') {\r\n                appendOpusNext += '\\r\\na=maxptime:' + params.maxptime;\r\n            }\r\n\r\n            sdpLines[opusFmtpLineIndex] = sdpLines[opusFmtpLineIndex].concat(appendOpusNext);\r\n\r\n            sdp = sdpLines.join('\\r\\n');\r\n            return sdp;\r\n        }\r\n\r\n        // forceStereoAudio => via webrtcexample.com\r\n        // requires getUserMedia => echoCancellation:false\r\n        function forceStereoAudio(sdp) {\r\n            var sdpLines = sdp.split('\\r\\n');\r\n            var fmtpLineIndex = null;\r\n            for (var i = 0; i < sdpLines.length; i++) {\r\n                if (sdpLines[i].search('opus/48000') !== -1) {\r\n                    var opusPayload = extractSdp(sdpLines[i], /:(\\d+) opus\\/48000/i);\r\n                    break;\r\n                }\r\n            }\r\n            for (var i = 0; i < sdpLines.length; i++) {\r\n                if (sdpLines[i].search('a=fmtp') !== -1) {\r\n                    var payload = extractSdp(sdpLines[i], /a=fmtp:(\\d+)/);\r\n                    if (payload === opusPayload) {\r\n                        fmtpLineIndex = i;\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n            if (fmtpLineIndex === null) return sdp;\r\n            sdpLines[fmtpLineIndex] = sdpLines[fmtpLineIndex].concat('; stereo=1; sprop-stereo=1');\r\n            sdp = sdpLines.join('\\r\\n');\r\n            return sdp;\r\n        }\r\n\r\n        return {\r\n            removeVPX: removeVPX,\r\n            disableNACK: disableNACK,\r\n            prioritize: prioritize,\r\n            removeNonG722: removeNonG722,\r\n            setApplicationSpecificBandwidth: function(sdp, bandwidth, isScreen) {\r\n                return setBAS(sdp, bandwidth, isScreen);\r\n            },\r\n            setVideoBitrates: function(sdp, params) {\r\n                return setVideoBitrates(sdp, params);\r\n            },\r\n            setOpusAttributes: function(sdp, params) {\r\n                return setOpusAttributes(sdp, params);\r\n            },\r\n            preferVP9: function(sdp) {\r\n                return preferCodec(sdp, 'vp9');\r\n            },\r\n            preferCodec: preferCodec,\r\n            forceStereoAudio: forceStereoAudio\r\n        };\r\n    })();\r\n\r\n    // backward compatibility\r\n    window.BandwidthHandler = CodecsHandler;\r\n\r\n    // OnIceCandidateHandler.js\r\n\r\n    var OnIceCandidateHandler = (function() {\r\n        function processCandidates(connection, icePair) {\r\n            var candidate = icePair.candidate;\r\n\r\n            var iceRestrictions = connection.candidates;\r\n            var stun = iceRestrictions.stun;\r\n            var turn = iceRestrictions.turn;\r\n\r\n            if (!isNull(iceRestrictions.reflexive)) {\r\n                stun = iceRestrictions.reflexive;\r\n            }\r\n\r\n            if (!isNull(iceRestrictions.relay)) {\r\n                turn = iceRestrictions.relay;\r\n            }\r\n\r\n            if (!iceRestrictions.host && !!candidate.match(/typ host/g)) {\r\n                return;\r\n            }\r\n\r\n            if (!turn && !!candidate.match(/typ relay/g)) {\r\n                return;\r\n            }\r\n\r\n            if (!stun && !!candidate.match(/typ srflx/g)) {\r\n                return;\r\n            }\r\n\r\n            var protocol = connection.iceProtocols;\r\n\r\n            if (!protocol.udp && !!candidate.match(/ udp /g)) {\r\n                return;\r\n            }\r\n\r\n            if (!protocol.tcp && !!candidate.match(/ tcp /g)) {\r\n                return;\r\n            }\r\n\r\n            if (connection.enableLogs) {\r\n                console.debug('Your candidate pairs:', candidate);\r\n            }\r\n\r\n            return {\r\n                candidate: candidate,\r\n                sdpMid: icePair.sdpMid,\r\n                sdpMLineIndex: icePair.sdpMLineIndex\r\n            };\r\n        }\r\n\r\n        return {\r\n            processCandidates: processCandidates\r\n        };\r\n    })();\r\n\r\n    // IceServersHandler.js\r\n\r\n    var IceServersHandler = (function() {\r\n        function getIceServers(connection) {\r\n            // resiprocate: 3344+4433\r\n            // pions: 7575\r\n            var iceServers = [{\r\n                'urls': [\r\n                    'stun:stun.l.google.com:19302',\r\n                    'stun:stun1.l.google.com:19302',\r\n                    'stun:stun2.l.google.com:19302',\r\n                    'stun:stun.l.google.com:19302?transport=udp',\r\n                ]\r\n            }];\r\n\r\n            return iceServers;\r\n        }\r\n\r\n        return {\r\n            getIceServers: getIceServers\r\n        };\r\n    })();\r\n\r\n    // getUserMediaHandler.js\r\n\r\n    function setStreamType(constraints, stream) {\r\n        if (constraints.mandatory && constraints.mandatory.chromeMediaSource) {\r\n            stream.isScreen = true;\r\n        } else if (constraints.mozMediaSource || constraints.mediaSource) {\r\n            stream.isScreen = true;\r\n        } else if (constraints.video) {\r\n            stream.isVideo = true;\r\n        } else if (constraints.audio) {\r\n            stream.isAudio = true;\r\n        }\r\n    }\r\n\r\n    // allow users to manage this object (to support re-capturing of screen/etc.)\r\n    window.currentUserMediaRequest = {\r\n        streams: [],\r\n        mutex: false,\r\n        queueRequests: [],\r\n        remove: function(idInstance) {\r\n            this.mutex = false;\r\n\r\n            var stream = this.streams[idInstance];\r\n            if (!stream) {\r\n                return;\r\n            }\r\n\r\n            stream = stream.stream;\r\n\r\n            var options = stream.currentUserMediaRequestOptions;\r\n\r\n            if (this.queueRequests.indexOf(options)) {\r\n                delete this.queueRequests[this.queueRequests.indexOf(options)];\r\n                this.queueRequests = removeNullEntries(this.queueRequests);\r\n            }\r\n\r\n            this.streams[idInstance].stream = null;\r\n            delete this.streams[idInstance];\r\n        }\r\n    };\r\n\r\n    function getUserMediaHandler(options) {\r\n        if (currentUserMediaRequest.mutex === true) {\r\n            currentUserMediaRequest.queueRequests.push(options);\r\n            return;\r\n        }\r\n        currentUserMediaRequest.mutex = true;\r\n\r\n        // easy way to match\r\n        var idInstance = JSON.stringify(options.localMediaConstraints);\r\n\r\n        function streaming(stream, returnBack) {\r\n            setStreamType(options.localMediaConstraints, stream);\r\n\r\n            var streamEndedEvent = 'ended';\r\n\r\n            if ('oninactive' in stream) {\r\n                streamEndedEvent = 'inactive';\r\n            }\r\n            stream.addEventListener(streamEndedEvent, function() {\r\n                delete currentUserMediaRequest.streams[idInstance];\r\n\r\n                currentUserMediaRequest.mutex = false;\r\n                if (currentUserMediaRequest.queueRequests.indexOf(options)) {\r\n                    delete currentUserMediaRequest.queueRequests[currentUserMediaRequest.queueRequests.indexOf(options)];\r\n                    currentUserMediaRequest.queueRequests = removeNullEntries(currentUserMediaRequest.queueRequests);\r\n                }\r\n            }, false);\r\n\r\n            currentUserMediaRequest.streams[idInstance] = {\r\n                stream: stream\r\n            };\r\n            currentUserMediaRequest.mutex = false;\r\n\r\n            if (currentUserMediaRequest.queueRequests.length) {\r\n                getUserMediaHandler(currentUserMediaRequest.queueRequests.shift());\r\n            }\r\n\r\n            // callback\r\n            options.onGettingLocalMedia(stream, returnBack);\r\n        }\r\n\r\n        if (currentUserMediaRequest.streams[idInstance]) {\r\n            streaming(currentUserMediaRequest.streams[idInstance].stream, true);\r\n        } else {\r\n            var isBlackBerry = !!(/BB10|BlackBerry/i.test(navigator.userAgent || ''));\r\n            if (isBlackBerry || typeof navigator.mediaDevices === 'undefined' || typeof navigator.mediaDevices.getUserMedia !== 'function') {\r\n                navigator.getUserMedia = navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia;\r\n                navigator.getUserMedia(options.localMediaConstraints, function(stream) {\r\n                    stream.streamid = stream.streamid || stream.id || getRandomString();\r\n                    stream.idInstance = idInstance;\r\n                    streaming(stream);\r\n                }, function(error) {\r\n                    options.onLocalMediaError(error, options.localMediaConstraints);\r\n                });\r\n                return;\r\n            }\r\n\r\n            if (typeof navigator.mediaDevices === 'undefined') {\r\n                navigator.getUserMedia = navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia;\r\n                var getUserMediaSuccess = function() {};\r\n                var getUserMediaFailure = function() {};\r\n\r\n                var getUserMediaStream, getUserMediaError;\r\n                navigator.mediaDevices = {\r\n                    getUserMedia: function(hints) {\r\n                        navigator.getUserMedia(hints, function(getUserMediaSuccess) {\r\n                            getUserMediaSuccess(stream);\r\n                            getUserMediaStream = stream;\r\n                        }, function(error) {\r\n                            getUserMediaFailure(error);\r\n                            getUserMediaError = error;\r\n                        });\r\n\r\n                        return {\r\n                            then: function(successCB) {\r\n                                if (getUserMediaStream) {\r\n                                    successCB(getUserMediaStream);\r\n                                    return;\r\n                                }\r\n\r\n                                getUserMediaSuccess = successCB;\r\n\r\n                                return {\r\n                                    then: function(failureCB) {\r\n                                        if (getUserMediaError) {\r\n                                            failureCB(getUserMediaError);\r\n                                            return;\r\n                                        }\r\n\r\n                                        getUserMediaFailure = failureCB;\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                };\r\n            }\r\n\r\n            if (options.localMediaConstraints.isScreen === true) {\r\n                if (navigator.mediaDevices.getDisplayMedia) {\r\n                    navigator.mediaDevices.getDisplayMedia(options.localMediaConstraints).then(function(stream) {\r\n                        stream.streamid = stream.streamid || stream.id || getRandomString();\r\n                        stream.idInstance = idInstance;\r\n\r\n                        streaming(stream);\r\n                    }).catch(function(error) {\r\n                        options.onLocalMediaError(error, options.localMediaConstraints);\r\n                    });\r\n                } else if (navigator.getDisplayMedia) {\r\n                    navigator.getDisplayMedia(options.localMediaConstraints).then(function(stream) {\r\n                        stream.streamid = stream.streamid || stream.id || getRandomString();\r\n                        stream.idInstance = idInstance;\r\n\r\n                        streaming(stream);\r\n                    }).catch(function(error) {\r\n                        options.onLocalMediaError(error, options.localMediaConstraints);\r\n                    });\r\n                } else {\r\n                    throw new Error('getDisplayMedia API is not availabe in this browser.');\r\n                }\r\n                return;\r\n            }\r\n\r\n            navigator.mediaDevices.getUserMedia(options.localMediaConstraints).then(function(stream) {\r\n                stream.streamid = stream.streamid || stream.id || getRandomString();\r\n                stream.idInstance = idInstance;\r\n\r\n                streaming(stream);\r\n            }).catch(function(error) {\r\n                options.onLocalMediaError(error, options.localMediaConstraints);\r\n            });\r\n        }\r\n    }\r\n\r\n    // StreamsHandler.js\r\n\r\n    var StreamsHandler = (function() {\r\n        function handleType(type) {\r\n            if (!type) {\r\n                return;\r\n            }\r\n\r\n            if (typeof type === 'string' || typeof type === 'undefined') {\r\n                return type;\r\n            }\r\n\r\n            if (type.audio && type.video) {\r\n                return null;\r\n            }\r\n\r\n            if (type.audio) {\r\n                return 'audio';\r\n            }\r\n\r\n            if (type.video) {\r\n                return 'video';\r\n            }\r\n\r\n            return;\r\n        }\r\n\r\n        function setHandlers(stream, syncAction, connection) {\r\n            if (!stream || !stream.addEventListener) return;\r\n\r\n            if (typeof syncAction == 'undefined' || syncAction == true) {\r\n                var streamEndedEvent = 'ended';\r\n\r\n                if ('oninactive' in stream) {\r\n                    streamEndedEvent = 'inactive';\r\n                }\r\n\r\n                stream.addEventListener(streamEndedEvent, function() {\r\n                    StreamsHandler.onSyncNeeded(this.streamid, streamEndedEvent);\r\n                }, false);\r\n            }\r\n\r\n            stream.mute = function(type, isSyncAction) {\r\n                type = handleType(type);\r\n\r\n                if (typeof isSyncAction !== 'undefined') {\r\n                    syncAction = isSyncAction;\r\n                }\r\n\r\n                if (typeof type == 'undefined' || type == 'audio') {\r\n                    getTracks(stream, 'audio').forEach(function(track) {\r\n                        track.enabled = false;\r\n                        connection.streamEvents[stream.streamid].isAudioMuted = true;\r\n                    });\r\n                }\r\n\r\n                if (typeof type == 'undefined' || type == 'video') {\r\n                    getTracks(stream, 'video').forEach(function(track) {\r\n                        track.enabled = false;\r\n                    });\r\n                }\r\n\r\n                if (typeof syncAction == 'undefined' || syncAction == true) {\r\n                    StreamsHandler.onSyncNeeded(stream.streamid, 'mute', type);\r\n                }\r\n\r\n                connection.streamEvents[stream.streamid].muteType = type || 'both';\r\n\r\n                fireEvent(stream, 'mute', type);\r\n            };\r\n\r\n            stream.unmute = function(type, isSyncAction) {\r\n                type = handleType(type);\r\n\r\n                if (typeof isSyncAction !== 'undefined') {\r\n                    syncAction = isSyncAction;\r\n                }\r\n\r\n                graduallyIncreaseVolume();\r\n\r\n                if (typeof type == 'undefined' || type == 'audio') {\r\n                    getTracks(stream, 'audio').forEach(function(track) {\r\n                        track.enabled = true;\r\n                        connection.streamEvents[stream.streamid].isAudioMuted = false;\r\n                    });\r\n                }\r\n\r\n                if (typeof type == 'undefined' || type == 'video') {\r\n                    getTracks(stream, 'video').forEach(function(track) {\r\n                        track.enabled = true;\r\n                    });\r\n\r\n                    // make sure that video unmute doesn't affects audio\r\n                    if (typeof type !== 'undefined' && type == 'video' && connection.streamEvents[stream.streamid].isAudioMuted) {\r\n                        (function looper(times) {\r\n                            if (!times) {\r\n                                times = 0;\r\n                            }\r\n\r\n                            times++;\r\n\r\n                            // check until five-seconds\r\n                            if (times < 100 && connection.streamEvents[stream.streamid].isAudioMuted) {\r\n                                stream.mute('audio');\r\n\r\n                                setTimeout(function() {\r\n                                    looper(times);\r\n                                }, 50);\r\n                            }\r\n                        })();\r\n                    }\r\n                }\r\n\r\n                if (typeof syncAction == 'undefined' || syncAction == true) {\r\n                    StreamsHandler.onSyncNeeded(stream.streamid, 'unmute', type);\r\n                }\r\n\r\n                connection.streamEvents[stream.streamid].unmuteType = type || 'both';\r\n\r\n                fireEvent(stream, 'unmute', type);\r\n            };\r\n\r\n            function graduallyIncreaseVolume() {\r\n                if (!connection.streamEvents[stream.streamid].mediaElement) {\r\n                    return;\r\n                }\r\n\r\n                var mediaElement = connection.streamEvents[stream.streamid].mediaElement;\r\n                mediaElement.volume = 0;\r\n                afterEach(200, 5, function() {\r\n                    try {\r\n                        mediaElement.volume += .20;\r\n                    } catch (e) {\r\n                        mediaElement.volume = 1;\r\n                    }\r\n                });\r\n            }\r\n        }\r\n\r\n        function afterEach(setTimeoutInteval, numberOfTimes, callback, startedTimes) {\r\n            startedTimes = (startedTimes || 0) + 1;\r\n            if (startedTimes >= numberOfTimes) return;\r\n\r\n            setTimeout(function() {\r\n                callback();\r\n                afterEach(setTimeoutInteval, numberOfTimes, callback, startedTimes);\r\n            }, setTimeoutInteval);\r\n        }\r\n\r\n        return {\r\n            setHandlers: setHandlers,\r\n            onSyncNeeded: function(streamid, action, type) {}\r\n        };\r\n    })();\r\n\r\n    // TextReceiver.js & TextSender.js\r\n\r\n    function TextReceiver(connection) {\r\n        var content = {};\r\n\r\n        function receive(data, userid, extra) {\r\n            // uuid is used to uniquely identify sending instance\r\n            var uuid = data.uuid;\r\n            if (!content[uuid]) {\r\n                content[uuid] = [];\r\n            }\r\n\r\n            content[uuid].push(data.message);\r\n\r\n            if (data.last) {\r\n                var message = content[uuid].join('');\r\n                if (data.isobject) {\r\n                    message = JSON.parse(message);\r\n                }\r\n\r\n                // latency detection\r\n                var receivingTime = new Date().getTime();\r\n                var latency = receivingTime - data.sendingTime;\r\n\r\n                var e = {\r\n                    data: message,\r\n                    userid: userid,\r\n                    extra: extra,\r\n                    latency: latency\r\n                };\r\n\r\n                if (connection.autoTranslateText) {\r\n                    e.original = e.data;\r\n                    connection.Translator.TranslateText(e.data, function(translatedText) {\r\n                        e.data = translatedText;\r\n                        connection.onmessage(e);\r\n                    });\r\n                } else {\r\n                    connection.onmessage(e);\r\n                }\r\n\r\n                delete content[uuid];\r\n            }\r\n        }\r\n\r\n        return {\r\n            receive: receive\r\n        };\r\n    }\r\n\r\n    // TextSender.js\r\n    var TextSender = {\r\n        send: function(config) {\r\n            var connection = config.connection;\r\n\r\n            var channel = config.channel,\r\n                remoteUserId = config.remoteUserId,\r\n                initialText = config.text,\r\n                packetSize = connection.chunkSize || 1000,\r\n                textToTransfer = '',\r\n                isobject = false;\r\n\r\n            if (!isString(initialText)) {\r\n                isobject = true;\r\n                initialText = JSON.stringify(initialText);\r\n            }\r\n\r\n            // uuid is used to uniquely identify sending instance\r\n            var uuid = getRandomString();\r\n            var sendingTime = new Date().getTime();\r\n\r\n            sendText(initialText);\r\n\r\n            function sendText(textMessage, text) {\r\n                var data = {\r\n                    type: 'text',\r\n                    uuid: uuid,\r\n                    sendingTime: sendingTime\r\n                };\r\n\r\n                if (textMessage) {\r\n                    text = textMessage;\r\n                    data.packets = parseInt(text.length / packetSize);\r\n                }\r\n\r\n                if (text.length > packetSize) {\r\n                    data.message = text.slice(0, packetSize);\r\n                } else {\r\n                    data.message = text;\r\n                    data.last = true;\r\n                    data.isobject = isobject;\r\n                }\r\n\r\n                channel.send(data, remoteUserId);\r\n\r\n                textToTransfer = text.slice(data.message.length);\r\n\r\n                if (textToTransfer.length) {\r\n                    setTimeout(function() {\r\n                        sendText(null, textToTransfer);\r\n                    }, connection.chunkInterval || 100);\r\n                }\r\n            }\r\n        }\r\n    };\r\n\r\n    // FileProgressBarHandler.js\r\n\r\n    var FileProgressBarHandler = (function() {\r\n        function handle(connection) {\r\n            var progressHelper = {};\r\n\r\n            // www.RTCMultiConnection.org/docs/onFileStart/\r\n            connection.onFileStart = function(file) {\r\n                var div = document.createElement('div');\r\n                div.title = file.name;\r\n                div.innerHTML = '<label>0%</label> <progress></progress>';\r\n\r\n                if (file.remoteUserId) {\r\n                    div.innerHTML += ' (Sharing with:' + file.remoteUserId + ')';\r\n                }\r\n\r\n                if (!connection.filesContainer) {\r\n                    connection.filesContainer = document.body || document.documentElement;\r\n                }\r\n\r\n                connection.filesContainer.insertBefore(div, connection.filesContainer.firstChild);\r\n\r\n                if (!file.remoteUserId) {\r\n                    progressHelper[file.uuid] = {\r\n                        div: div,\r\n                        progress: div.querySelector('progress'),\r\n                        label: div.querySelector('label')\r\n                    };\r\n                    progressHelper[file.uuid].progress.max = file.maxChunks;\r\n                    return;\r\n                }\r\n\r\n                if (!progressHelper[file.uuid]) {\r\n                    progressHelper[file.uuid] = {};\r\n                }\r\n\r\n                progressHelper[file.uuid][file.remoteUserId] = {\r\n                    div: div,\r\n                    progress: div.querySelector('progress'),\r\n                    label: div.querySelector('label')\r\n                };\r\n                progressHelper[file.uuid][file.remoteUserId].progress.max = file.maxChunks;\r\n            };\r\n\r\n            // www.RTCMultiConnection.org/docs/onFileProgress/\r\n            connection.onFileProgress = function(chunk) {\r\n                var helper = progressHelper[chunk.uuid];\r\n                if (!helper) {\r\n                    return;\r\n                }\r\n                if (chunk.remoteUserId) {\r\n                    helper = progressHelper[chunk.uuid][chunk.remoteUserId];\r\n                    if (!helper) {\r\n                        return;\r\n                    }\r\n                }\r\n\r\n                helper.progress.value = chunk.currentPosition || chunk.maxChunks || helper.progress.max;\r\n                updateLabel(helper.progress, helper.label);\r\n            };\r\n\r\n            // www.RTCMultiConnection.org/docs/onFileEnd/\r\n            connection.onFileEnd = function(file) {\r\n                var helper = progressHelper[file.uuid];\r\n                if (!helper) {\r\n                    console.error('No such progress-helper element exist.', file);\r\n                    return;\r\n                }\r\n\r\n                if (file.remoteUserId) {\r\n                    helper = progressHelper[file.uuid][file.remoteUserId];\r\n                    if (!helper) {\r\n                        return;\r\n                    }\r\n                }\r\n\r\n                var div = helper.div;\r\n                if (file.type.indexOf('image') != -1) {\r\n                    div.innerHTML = '<a href=\"' + file.url + '\" download=\"' + file.name + '\">Download <strong style=\"color:red;\">' + file.name + '</strong> </a><br /><img src=\"' + file.url + '\" title=\"' + file.name + '\" style=\"max-width: 80%;\">';\r\n                } else {\r\n                    div.innerHTML = '<a href=\"' + file.url + '\" download=\"' + file.name + '\">Download <strong style=\"color:red;\">' + file.name + '</strong> </a><br /><iframe src=\"' + file.url + '\" title=\"' + file.name + '\" style=\"width: 80%;border: 0;height: inherit;margin-top:1em;\"></iframe>';\r\n                }\r\n            };\r\n\r\n            function updateLabel(progress, label) {\r\n                if (progress.position === -1) {\r\n                    return;\r\n                }\r\n\r\n                var position = +progress.position.toFixed(2).split('.')[1] || 100;\r\n                label.innerHTML = position + '%';\r\n            }\r\n        }\r\n\r\n        return {\r\n            handle: handle\r\n        };\r\n    })();\r\n\r\n    // TranslationHandler.js\r\n\r\n    var TranslationHandler = (function() {\r\n        function handle(connection) {\r\n            connection.autoTranslateText = false;\r\n            connection.language = 'en';\r\n            connection.googKey = 'AIzaSyCgB5hmFY74WYB-EoWkhr9cAGr6TiTHrEE';\r\n\r\n            // www.RTCMultiConnection.org/docs/Translator/\r\n            connection.Translator = {\r\n                TranslateText: function(text, callback) {\r\n                    // if(location.protocol === 'https:') return callback(text);\r\n\r\n                    var newScript = document.createElement('script');\r\n                    newScript.type = 'text/javascript';\r\n\r\n                    var sourceText = encodeURIComponent(text); // escape\r\n\r\n                    var randomNumber = 'method' + connection.token();\r\n                    window[randomNumber] = function(response) {\r\n                        if (response.data && response.data.translations[0] && callback) {\r\n                            callback(response.data.translations[0].translatedText);\r\n                            return;\r\n                        }\r\n\r\n                        if (response.error && response.error.message === 'Daily Limit Exceeded') {\r\n                            console.error('Text translation failed. Error message: \"Daily Limit Exceeded.\"');\r\n                            return;\r\n                        }\r\n\r\n                        if (response.error) {\r\n                            console.error(response.error.message);\r\n                            return;\r\n                        }\r\n\r\n                        console.error(response);\r\n                    };\r\n\r\n                    var source = 'https://www.googleapis.com/language/translate/v2?key=' + connection.googKey + '&target=' + (connection.language || 'en-US') + '&callback=window.' + randomNumber + '&q=' + sourceText;\r\n                    newScript.src = source;\r\n                    document.getElementsByTagName('head')[0].appendChild(newScript);\r\n                },\r\n                getListOfLanguages: function(callback) {\r\n                    var xhr = new XMLHttpRequest();\r\n                    xhr.onreadystatechange = function() {\r\n                        if (xhr.readyState == XMLHttpRequest.DONE) {\r\n                            var response = JSON.parse(xhr.responseText);\r\n\r\n                            if (response && response.data && response.data.languages) {\r\n                                callback(response.data.languages);\r\n                                return;\r\n                            }\r\n\r\n                            if (response.error && response.error.message === 'Daily Limit Exceeded') {\r\n                                console.error('Text translation failed. Error message: \"Daily Limit Exceeded.\"');\r\n                                return;\r\n                            }\r\n\r\n                            if (response.error) {\r\n                                console.error(response.error.message);\r\n                                return;\r\n                            }\r\n\r\n                            console.error(response);\r\n                        }\r\n                    }\r\n                    var url = 'https://www.googleapis.com/language/translate/v2/languages?key=' + connection.googKey + '&target=en';\r\n                    xhr.open('GET', url, true);\r\n                    xhr.send(null);\r\n                }\r\n            };\r\n        }\r\n\r\n        return {\r\n            handle: handle\r\n        };\r\n    })();\r\n\r\n    // _____________________\r\n    // RTCMultiConnection.js\r\n\r\n    (function(connection) {\r\n        forceOptions = forceOptions || {\r\n            useDefaultDevices: true\r\n        };\r\n\r\n        connection.channel = connection.sessionid = (roomid || location.href.replace(/\\/|:|#|\\?|\\$|\\^|%|\\.|`|~|!|\\+|@|\\[|\\||]|\\|*. /g, '').split('\\n').join('').split('\\r').join('')) + '';\r\n\r\n        var mPeer = new MultiPeers(connection);\r\n\r\n        var preventDuplicateOnStreamEvents = {};\r\n        mPeer.onGettingLocalMedia = function(stream, callback) {\r\n            callback = callback || function() {};\r\n\r\n            if (preventDuplicateOnStreamEvents[stream.streamid]) {\r\n                callback();\r\n                return;\r\n            }\r\n            preventDuplicateOnStreamEvents[stream.streamid] = true;\r\n\r\n            try {\r\n                stream.type = 'local';\r\n            } catch (e) {}\r\n\r\n            connection.setStreamEndHandler(stream);\r\n\r\n            getRMCMediaElement(stream, function(mediaElement) {\r\n                mediaElement.id = stream.streamid;\r\n                mediaElement.muted = true;\r\n                mediaElement.volume = 0;\r\n\r\n                if (connection.attachStreams.indexOf(stream) === -1) {\r\n                    connection.attachStreams.push(stream);\r\n                }\r\n\r\n                if (typeof StreamsHandler !== 'undefined') {\r\n                    StreamsHandler.setHandlers(stream, true, connection);\r\n                }\r\n                var isAudioMuted = stream.getAudioTracks().filter(function(track) {\r\n                    return track.enabled;\r\n                }).length === 0;\r\n\r\n                connection.streamEvents[stream.streamid] = {\r\n                    stream: stream,\r\n                    type: 'local',\r\n                    mediaElement: mediaElement,\r\n                    userid: connection.userid,\r\n                    extra: connection.extra,\r\n                    streamid: stream.streamid,\r\n                    isAudioMuted: isAudioMuted\r\n                };\r\n\r\n                try {\r\n                    setHarkEvents(connection, connection.streamEvents[stream.streamid]);\r\n                    setMuteHandlers(connection, connection.streamEvents[stream.streamid]);\r\n\r\n                    connection.onstream(connection.streamEvents[stream.streamid]);\r\n                } catch (e) {\r\n                    //\r\n                }\r\n\r\n                callback();\r\n            }, connection);\r\n        };\r\n\r\n        mPeer.onGettingRemoteMedia = function(stream, remoteUserId) {\r\n            try {\r\n                stream.type = 'remote';\r\n            } catch (e) {}\r\n\r\n            connection.setStreamEndHandler(stream, 'remote-stream');\r\n\r\n            getRMCMediaElement(stream, function(mediaElement) {\r\n                mediaElement.id = stream.streamid;\r\n\r\n                if (typeof StreamsHandler !== 'undefined') {\r\n                    StreamsHandler.setHandlers(stream, false, connection);\r\n                }\r\n\r\n                connection.streamEvents[stream.streamid] = {\r\n                    stream: stream,\r\n                    type: 'remote',\r\n                    userid: remoteUserId,\r\n                    extra: connection.peers[remoteUserId] ? connection.peers[remoteUserId].extra : {},\r\n                    mediaElement: mediaElement,\r\n                    streamid: stream.streamid\r\n                };\r\n\r\n                setMuteHandlers(connection, connection.streamEvents[stream.streamid]);\r\n\r\n                connection.onstream(connection.streamEvents[stream.streamid]);\r\n            }, connection);\r\n        };\r\n\r\n        mPeer.onRemovingRemoteMedia = function(stream, remoteUserId) {\r\n            var streamEvent = connection.streamEvents[stream.streamid];\r\n            if (!streamEvent) {\r\n                streamEvent = {\r\n                    stream: stream,\r\n                    type: 'remote',\r\n                    userid: remoteUserId,\r\n                    extra: connection.peers[remoteUserId] ? connection.peers[remoteUserId].extra : {},\r\n                    streamid: stream.streamid,\r\n                    mediaElement: connection.streamEvents[stream.streamid] ? connection.streamEvents[stream.streamid].mediaElement : null\r\n                };\r\n            }\r\n\r\n            if (connection.peersBackup[streamEvent.userid]) {\r\n                streamEvent.extra = connection.peersBackup[streamEvent.userid].extra;\r\n            }\r\n\r\n            connection.onstreamended(streamEvent);\r\n\r\n            delete connection.streamEvents[stream.streamid];\r\n        };\r\n\r\n        mPeer.onNegotiationNeeded = function(message, remoteUserId, callback) {\r\n            callback = callback || function() {};\r\n\r\n            remoteUserId = remoteUserId || message.remoteUserId;\r\n            message = message || '';\r\n\r\n            // usually a message looks like this\r\n            var messageToDeliver = {\r\n                remoteUserId: remoteUserId,\r\n                message: message,\r\n                sender: connection.userid\r\n            };\r\n\r\n            if (message.remoteUserId && message.message && message.sender) {\r\n                // if a code is manually passing required data\r\n                messageToDeliver = message;\r\n            }\r\n\r\n            connectSocket(function() {\r\n                connection.socket.emit(connection.socketMessageEvent, messageToDeliver, callback);\r\n            });\r\n        };\r\n\r\n        function onUserLeft(remoteUserId) {\r\n            connection.deletePeer(remoteUserId);\r\n        }\r\n\r\n        mPeer.onUserLeft = onUserLeft;\r\n        mPeer.disconnectWith = function(remoteUserId, callback) {\r\n            if (connection.socket) {\r\n                connection.socket.emit('disconnect-with', remoteUserId, callback || function() {});\r\n            }\r\n\r\n            connection.deletePeer(remoteUserId);\r\n        };\r\n\r\n        connection.socketOptions = {\r\n            // 'force new connection': true, // For SocketIO version < 1.0\r\n            // 'forceNew': true, // For SocketIO version >= 1.0\r\n            'transport': 'polling' // fixing transport:unknown issues\r\n        };\r\n\r\n        function connectSocket(connectCallback) {\r\n            connection.socketAutoReConnect = true;\r\n\r\n            if (connection.socket) { // todo: check here readySate/etc. to make sure socket is still opened\r\n                if (connectCallback) {\r\n                    connectCallback(connection.socket);\r\n                }\r\n                return;\r\n            }\r\n\r\n            if (typeof SocketConnection === 'undefined') {\r\n                if (typeof FirebaseConnection !== 'undefined') {\r\n                    window.SocketConnection = FirebaseConnection;\r\n                } else if (typeof PubNubConnection !== 'undefined') {\r\n                    window.SocketConnection = PubNubConnection;\r\n                } else {\r\n                    throw 'SocketConnection.js seems missed.';\r\n                }\r\n            }\r\n\r\n            new SocketConnection(connection, function(s) {\r\n                if (connectCallback) {\r\n                    connectCallback(connection.socket);\r\n                }\r\n            });\r\n        }\r\n\r\n        // 1st paramter is roomid\r\n        // 2rd paramter is a callback function\r\n        connection.openOrJoin = function(roomid, callback) {\r\n            callback = callback || function() {};\r\n\r\n            connection.checkPresence(roomid, function(isRoomExist, roomid) {\r\n                if (isRoomExist) {\r\n                    connection.sessionid = roomid;\r\n\r\n                    var localPeerSdpConstraints = false;\r\n                    var remotePeerSdpConstraints = false;\r\n                    var isOneWay = !!connection.session.oneway;\r\n                    var isDataOnly = isData(connection.session);\r\n\r\n                    remotePeerSdpConstraints = {\r\n                        OfferToReceiveAudio: connection.sdpConstraints.mandatory.OfferToReceiveAudio,\r\n                        OfferToReceiveVideo: connection.sdpConstraints.mandatory.OfferToReceiveVideo\r\n                    }\r\n\r\n                    localPeerSdpConstraints = {\r\n                        OfferToReceiveAudio: isOneWay ? !!connection.session.audio : connection.sdpConstraints.mandatory.OfferToReceiveAudio,\r\n                        OfferToReceiveVideo: isOneWay ? !!connection.session.video || !!connection.session.screen : connection.sdpConstraints.mandatory.OfferToReceiveVideo\r\n                    }\r\n\r\n                    var connectionDescription = {\r\n                        remoteUserId: connection.sessionid,\r\n                        message: {\r\n                            newParticipationRequest: true,\r\n                            isOneWay: isOneWay,\r\n                            isDataOnly: isDataOnly,\r\n                            localPeerSdpConstraints: localPeerSdpConstraints,\r\n                            remotePeerSdpConstraints: remotePeerSdpConstraints\r\n                        },\r\n                        sender: connection.userid\r\n                    };\r\n\r\n                    beforeJoin(connectionDescription.message, function() {\r\n                        joinRoom(connectionDescription, callback);\r\n                    });\r\n                    return;\r\n                }\r\n\r\n                connection.waitingForLocalMedia = true;\r\n                connection.isInitiator = true;\r\n\r\n                connection.sessionid = roomid || connection.sessionid;\r\n\r\n                if (isData(connection.session)) {\r\n                    openRoom(callback);\r\n                    return;\r\n                }\r\n\r\n                connection.captureUserMedia(function() {\r\n                    openRoom(callback);\r\n                });\r\n            });\r\n        };\r\n\r\n        // don't allow someone to join this person until he has the media\r\n        connection.waitingForLocalMedia = false;\r\n\r\n        connection.open = function(roomid, callback) {\r\n            callback = callback || function() {};\r\n\r\n            connection.waitingForLocalMedia = true;\r\n            connection.isInitiator = true;\r\n\r\n            connection.sessionid = roomid || connection.sessionid;\r\n\r\n            connectSocket(function() {\r\n                if (isData(connection.session)) {\r\n                    openRoom(callback);\r\n                    return;\r\n                }\r\n\r\n                connection.captureUserMedia(function() {\r\n                    openRoom(callback);\r\n                });\r\n            });\r\n        };\r\n\r\n        // this object keeps extra-data records for all connected users\r\n        // this object is never cleared so you can always access extra-data even if a user left\r\n        connection.peersBackup = {};\r\n\r\n        connection.deletePeer = function(remoteUserId) {\r\n            if (!remoteUserId || !connection.peers[remoteUserId]) {\r\n                return;\r\n            }\r\n\r\n            var eventObject = {\r\n                userid: remoteUserId,\r\n                extra: connection.peers[remoteUserId] ? connection.peers[remoteUserId].extra : {}\r\n            };\r\n\r\n            if (connection.peersBackup[eventObject.userid]) {\r\n                eventObject.extra = connection.peersBackup[eventObject.userid].extra;\r\n            }\r\n\r\n            connection.onleave(eventObject);\r\n\r\n            if (!!connection.peers[remoteUserId]) {\r\n                connection.peers[remoteUserId].streams.forEach(function(stream) {\r\n                    stream.stop();\r\n                });\r\n\r\n                var peer = connection.peers[remoteUserId].peer;\r\n                if (peer && peer.iceConnectionState !== 'closed') {\r\n                    try {\r\n                        peer.close();\r\n                    } catch (e) {}\r\n                }\r\n\r\n                if (connection.peers[remoteUserId]) {\r\n                    connection.peers[remoteUserId].peer = null;\r\n                    delete connection.peers[remoteUserId];\r\n                }\r\n            }\r\n        }\r\n\r\n        connection.rejoin = function(connectionDescription) {\r\n            if (connection.isInitiator || !connectionDescription || !Object.keys(connectionDescription).length) {\r\n                return;\r\n            }\r\n\r\n            var extra = {};\r\n\r\n            if (connection.peers[connectionDescription.remoteUserId]) {\r\n                extra = connection.peers[connectionDescription.remoteUserId].extra;\r\n                connection.deletePeer(connectionDescription.remoteUserId);\r\n            }\r\n\r\n            if (connectionDescription && connectionDescription.remoteUserId) {\r\n                connection.join(connectionDescription.remoteUserId);\r\n\r\n                connection.onReConnecting({\r\n                    userid: connectionDescription.remoteUserId,\r\n                    extra: extra\r\n                });\r\n            }\r\n        };\r\n\r\n        connection.join = function(remoteUserId, options) {\r\n            connection.sessionid = (remoteUserId ? remoteUserId.sessionid || remoteUserId.remoteUserId || remoteUserId : false) || connection.sessionid;\r\n            connection.sessionid += '';\r\n\r\n            var localPeerSdpConstraints = false;\r\n            var remotePeerSdpConstraints = false;\r\n            var isOneWay = false;\r\n            var isDataOnly = false;\r\n\r\n            if ((remoteUserId && remoteUserId.session) || !remoteUserId || typeof remoteUserId === 'string') {\r\n                var session = remoteUserId ? remoteUserId.session || connection.session : connection.session;\r\n\r\n                isOneWay = !!session.oneway;\r\n                isDataOnly = isData(session);\r\n\r\n                remotePeerSdpConstraints = {\r\n                    OfferToReceiveAudio: connection.sdpConstraints.mandatory.OfferToReceiveAudio,\r\n                    OfferToReceiveVideo: connection.sdpConstraints.mandatory.OfferToReceiveVideo\r\n                };\r\n\r\n                localPeerSdpConstraints = {\r\n                    OfferToReceiveAudio: isOneWay ? !!connection.session.audio : connection.sdpConstraints.mandatory.OfferToReceiveAudio,\r\n                    OfferToReceiveVideo: isOneWay ? !!connection.session.video || !!connection.session.screen : connection.sdpConstraints.mandatory.OfferToReceiveVideo\r\n                };\r\n            }\r\n\r\n            options = options || {};\r\n\r\n            var cb = function() {};\r\n            if (typeof options === 'function') {\r\n                cb = options;\r\n                options = {};\r\n            }\r\n\r\n            if (typeof options.localPeerSdpConstraints !== 'undefined') {\r\n                localPeerSdpConstraints = options.localPeerSdpConstraints;\r\n            }\r\n\r\n            if (typeof options.remotePeerSdpConstraints !== 'undefined') {\r\n                remotePeerSdpConstraints = options.remotePeerSdpConstraints;\r\n            }\r\n\r\n            if (typeof options.isOneWay !== 'undefined') {\r\n                isOneWay = options.isOneWay;\r\n            }\r\n\r\n            if (typeof options.isDataOnly !== 'undefined') {\r\n                isDataOnly = options.isDataOnly;\r\n            }\r\n\r\n            var connectionDescription = {\r\n                remoteUserId: connection.sessionid,\r\n                message: {\r\n                    newParticipationRequest: true,\r\n                    isOneWay: isOneWay,\r\n                    isDataOnly: isDataOnly,\r\n                    localPeerSdpConstraints: localPeerSdpConstraints,\r\n                    remotePeerSdpConstraints: remotePeerSdpConstraints\r\n                },\r\n                sender: connection.userid\r\n            };\r\n\r\n            beforeJoin(connectionDescription.message, function() {\r\n                connectSocket(function() {\r\n                    joinRoom(connectionDescription, cb);\r\n                });\r\n            });\r\n            return connectionDescription;\r\n        };\r\n\r\n        function joinRoom(connectionDescription, cb) {\r\n            connection.socket.emit('join-room', {\r\n                sessionid: connection.sessionid,\r\n                session: connection.session,\r\n                mediaConstraints: connection.mediaConstraints,\r\n                sdpConstraints: connection.sdpConstraints,\r\n                streams: getStreamInfoForAdmin(),\r\n                extra: connection.extra,\r\n                password: typeof connection.password !== 'undefined' && typeof connection.password !== 'object' ? connection.password : ''\r\n            }, function(isRoomJoined, error) {\r\n                if (isRoomJoined === true) {\r\n                    if (connection.enableLogs) {\r\n                        console.log('isRoomJoined: ', isRoomJoined, ' roomid: ', connection.sessionid);\r\n                    }\r\n\r\n                    if (!!connection.peers[connection.sessionid]) {\r\n                        // on socket disconnect & reconnect\r\n                        return;\r\n                    }\r\n\r\n                    mPeer.onNegotiationNeeded(connectionDescription);\r\n                }\r\n\r\n                if (isRoomJoined === false) {\r\n                    if (connection.enableLogs) {\r\n                        console.warn('isRoomJoined: ', error, ' roomid: ', connection.sessionid);\r\n                    }\r\n\r\n                    // [disabled] retry after 3 seconds\r\n                    false && setTimeout(function() {\r\n                        joinRoom(connectionDescription, cb);\r\n                    }, 3000);\r\n                }\r\n\r\n                cb(isRoomJoined, connection.sessionid, error);\r\n            });\r\n        }\r\n\r\n        connection.publicRoomIdentifier = '';\r\n\r\n        function openRoom(callback) {\r\n            if (connection.enableLogs) {\r\n                console.log('Sending open-room signal to socket.io');\r\n            }\r\n\r\n            connection.waitingForLocalMedia = false;\r\n            connection.socket.emit('open-room', {\r\n                sessionid: connection.sessionid,\r\n                session: connection.session,\r\n                mediaConstraints: connection.mediaConstraints,\r\n                sdpConstraints: connection.sdpConstraints,\r\n                streams: getStreamInfoForAdmin(),\r\n                extra: connection.extra,\r\n                identifier: connection.publicRoomIdentifier,\r\n                password: typeof connection.password !== 'undefined' && typeof connection.password !== 'object' ? connection.password : ''\r\n            }, function(isRoomOpened, error) {\r\n                if (isRoomOpened === true) {\r\n                    if (connection.enableLogs) {\r\n                        console.log('isRoomOpened: ', isRoomOpened, ' roomid: ', connection.sessionid);\r\n                    }\r\n                    callback(isRoomOpened, connection.sessionid);\r\n                }\r\n\r\n                if (isRoomOpened === false) {\r\n                    if (connection.enableLogs) {\r\n                        console.warn('isRoomOpened: ', error, ' roomid: ', connection.sessionid);\r\n                    }\r\n\r\n                    callback(isRoomOpened, connection.sessionid, error);\r\n                }\r\n            });\r\n        }\r\n\r\n        function getStreamInfoForAdmin() {\r\n            try {\r\n                return connection.streamEvents.selectAll('local').map(function(event) {\r\n                    return {\r\n                        streamid: event.streamid,\r\n                        tracks: event.stream.getTracks().length\r\n                    };\r\n                });\r\n            } catch (e) {\r\n                return [];\r\n            }\r\n        }\r\n\r\n        function beforeJoin(userPreferences, callback) {\r\n            if (connection.dontCaptureUserMedia || userPreferences.isDataOnly) {\r\n                callback();\r\n                return;\r\n            }\r\n\r\n            var localMediaConstraints = {};\r\n\r\n            if (userPreferences.localPeerSdpConstraints.OfferToReceiveAudio) {\r\n                localMediaConstraints.audio = connection.mediaConstraints.audio;\r\n            }\r\n\r\n            if (userPreferences.localPeerSdpConstraints.OfferToReceiveVideo) {\r\n                localMediaConstraints.video = connection.mediaConstraints.video;\r\n            }\r\n\r\n            var session = userPreferences.session || connection.session;\r\n\r\n            if (session.oneway && session.audio !== 'two-way' && session.video !== 'two-way' && session.screen !== 'two-way') {\r\n                callback();\r\n                return;\r\n            }\r\n\r\n            if (session.oneway && session.audio && session.audio === 'two-way') {\r\n                session = {\r\n                    audio: true\r\n                };\r\n            }\r\n\r\n            if (session.audio || session.video || session.screen) {\r\n                if (session.screen) {\r\n                    if (DetectRTC.browser.name === 'Edge') {\r\n                        navigator.getDisplayMedia({\r\n                            video: true,\r\n                            audio: isAudioPlusTab(connection)\r\n                        }).then(function(screen) {\r\n                            screen.isScreen = true;\r\n                            mPeer.onGettingLocalMedia(screen);\r\n\r\n                            if ((session.audio || session.video) && !isAudioPlusTab(connection)) {\r\n                                connection.invokeGetUserMedia(null, callback);\r\n                            } else {\r\n                                callback(screen);\r\n                            }\r\n                        }, function(error) {\r\n                            console.error('Unable to capture screen on Edge. HTTPs and version 17+ is required.');\r\n                        });\r\n                    } else {\r\n                        connection.invokeGetUserMedia({\r\n                            audio: isAudioPlusTab(connection),\r\n                            video: true,\r\n                            isScreen: true\r\n                        }, (session.audio || session.video) && !isAudioPlusTab(connection) ? connection.invokeGetUserMedia(null, callback) : callback);\r\n                    }\r\n                } else if (session.audio || session.video) {\r\n                    connection.invokeGetUserMedia(null, callback, session);\r\n                }\r\n            }\r\n        }\r\n\r\n        connection.getUserMedia = connection.captureUserMedia = function(callback, sessionForced) {\r\n            callback = callback || function() {};\r\n            var session = sessionForced || connection.session;\r\n\r\n            if (connection.dontCaptureUserMedia || isData(session)) {\r\n                callback();\r\n                return;\r\n            }\r\n\r\n            if (session.audio || session.video || session.screen) {\r\n                if (session.screen) {\r\n                    if (DetectRTC.browser.name === 'Edge') {\r\n                        navigator.getDisplayMedia({\r\n                            video: true,\r\n                            audio: isAudioPlusTab(connection)\r\n                        }).then(function(screen) {\r\n                            screen.isScreen = true;\r\n                            mPeer.onGettingLocalMedia(screen);\r\n\r\n                            if ((session.audio || session.video) && !isAudioPlusTab(connection)) {\r\n                                var nonScreenSession = {};\r\n                                for (var s in session) {\r\n                                    if (s !== 'screen') {\r\n                                        nonScreenSession[s] = session[s];\r\n                                    }\r\n                                }\r\n                                connection.invokeGetUserMedia(sessionForced, callback, nonScreenSession);\r\n                                return;\r\n                            }\r\n                            callback(screen);\r\n                        }, function(error) {\r\n                            console.error('Unable to capture screen on Edge. HTTPs and version 17+ is required.');\r\n                        });\r\n                    } else {\r\n                        connection.invokeGetUserMedia({\r\n                            audio: isAudioPlusTab(connection),\r\n                            video: true,\r\n                            isScreen: true\r\n                        }, function(stream) {\r\n                            if ((session.audio || session.video) && !isAudioPlusTab(connection)) {\r\n                                var nonScreenSession = {};\r\n                                for (var s in session) {\r\n                                    if (s !== 'screen') {\r\n                                        nonScreenSession[s] = session[s];\r\n                                    }\r\n                                }\r\n                                connection.invokeGetUserMedia(sessionForced, callback, nonScreenSession);\r\n                                return;\r\n                            }\r\n                            callback(stream);\r\n                        });\r\n                    }\r\n                } else if (session.audio || session.video) {\r\n                    connection.invokeGetUserMedia(sessionForced, callback, session);\r\n                }\r\n            }\r\n        };\r\n\r\n        connection.onbeforeunload = function(arg1, dontCloseSocket) {\r\n            if (!connection.closeBeforeUnload) {\r\n                return;\r\n            }\r\n\r\n            connection.peers.getAllParticipants().forEach(function(participant) {\r\n                mPeer.onNegotiationNeeded({\r\n                    userLeft: true\r\n                }, participant);\r\n\r\n                if (connection.peers[participant] && connection.peers[participant].peer) {\r\n                    connection.peers[participant].peer.close();\r\n                }\r\n\r\n                delete connection.peers[participant];\r\n            });\r\n\r\n            if (!dontCloseSocket) {\r\n                connection.closeSocket();\r\n            }\r\n\r\n            connection.isInitiator = false;\r\n        };\r\n\r\n        if (!window.ignoreBeforeUnload) {\r\n            // user can implement its own version of window.onbeforeunload\r\n            connection.closeBeforeUnload = true;\r\n            window.addEventListener('beforeunload', connection.onbeforeunload, false);\r\n        } else {\r\n            connection.closeBeforeUnload = false;\r\n        }\r\n\r\n        connection.userid = getRandomString();\r\n        connection.changeUserId = function(newUserId, callback) {\r\n            callback = callback || function() {};\r\n            connection.userid = newUserId || getRandomString();\r\n            connection.socket.emit('changed-uuid', connection.userid, callback);\r\n        };\r\n\r\n        connection.extra = {};\r\n        connection.attachStreams = [];\r\n\r\n        connection.session = {\r\n            audio: true,\r\n            video: true\r\n        };\r\n\r\n        connection.enableFileSharing = false;\r\n\r\n        // all values in kbps\r\n        connection.bandwidth = {\r\n            screen: false,\r\n            audio: false,\r\n            video: false\r\n        };\r\n\r\n        connection.codecs = {\r\n            audio: 'opus',\r\n            video: 'VP9'\r\n        };\r\n\r\n        connection.processSdp = function(sdp) {\r\n            // ignore SDP modification if unified-pan is supported\r\n            if (isUnifiedPlanSupportedDefault()) {\r\n                return sdp;\r\n            }\r\n\r\n            if (DetectRTC.browser.name === 'Safari') {\r\n                return sdp;\r\n            }\r\n\r\n            if (connection.codecs.video.toUpperCase() === 'VP8') {\r\n                sdp = CodecsHandler.preferCodec(sdp, 'vp8');\r\n            }\r\n\r\n            if (connection.codecs.video.toUpperCase() === 'VP9') {\r\n                sdp = CodecsHandler.preferCodec(sdp, 'vp9');\r\n            }\r\n\r\n            if (connection.codecs.video.toUpperCase() === 'H264') {\r\n                sdp = CodecsHandler.preferCodec(sdp, 'h264');\r\n            }\r\n\r\n            if (connection.codecs.audio === 'G722') {\r\n                sdp = CodecsHandler.removeNonG722(sdp);\r\n            }\r\n\r\n            if (DetectRTC.browser.name === 'Firefox') {\r\n                return sdp;\r\n            }\r\n\r\n            if (connection.bandwidth.video || connection.bandwidth.screen) {\r\n                sdp = CodecsHandler.setApplicationSpecificBandwidth(sdp, connection.bandwidth, !!connection.session.screen);\r\n            }\r\n\r\n            if (connection.bandwidth.video) {\r\n                sdp = CodecsHandler.setVideoBitrates(sdp, {\r\n                    min: connection.bandwidth.video * 8 * 1024,\r\n                    max: connection.bandwidth.video * 8 * 1024\r\n                });\r\n            }\r\n\r\n            if (connection.bandwidth.audio) {\r\n                sdp = CodecsHandler.setOpusAttributes(sdp, {\r\n                    maxaveragebitrate: connection.bandwidth.audio * 8 * 1024,\r\n                    maxplaybackrate: connection.bandwidth.audio * 8 * 1024,\r\n                    stereo: 1,\r\n                    maxptime: 3\r\n                });\r\n            }\r\n\r\n            return sdp;\r\n        };\r\n\r\n        if (typeof CodecsHandler !== 'undefined') {\r\n            connection.BandwidthHandler = connection.CodecsHandler = CodecsHandler;\r\n        }\r\n\r\n        connection.mediaConstraints = {\r\n            audio: {\r\n                mandatory: {},\r\n                optional: connection.bandwidth.audio ? [{\r\n                    bandwidth: connection.bandwidth.audio * 8 * 1024 || 128 * 8 * 1024\r\n                }] : []\r\n            },\r\n            video: {\r\n                mandatory: {},\r\n                optional: connection.bandwidth.video ? [{\r\n                    bandwidth: connection.bandwidth.video * 8 * 1024 || 128 * 8 * 1024\r\n                }, {\r\n                    facingMode: 'user'\r\n                }] : [{\r\n                    facingMode: 'user'\r\n                }]\r\n            }\r\n        };\r\n\r\n        if (DetectRTC.browser.name === 'Firefox') {\r\n            connection.mediaConstraints = {\r\n                audio: true,\r\n                video: true\r\n            };\r\n        }\r\n\r\n        if (!forceOptions.useDefaultDevices && !DetectRTC.isMobileDevice) {\r\n            DetectRTC.load(function() {\r\n                var lastAudioDevice, lastVideoDevice;\r\n                // it will force RTCMultiConnection to capture last-devices\r\n                // i.e. if external microphone is attached to system, we should prefer it over built-in devices.\r\n                DetectRTC.MediaDevices.forEach(function(device) {\r\n                    if (device.kind === 'audioinput' && connection.mediaConstraints.audio !== false) {\r\n                        lastAudioDevice = device;\r\n                    }\r\n\r\n                    if (device.kind === 'videoinput' && connection.mediaConstraints.video !== false) {\r\n                        lastVideoDevice = device;\r\n                    }\r\n                });\r\n\r\n                if (lastAudioDevice) {\r\n                    if (DetectRTC.browser.name === 'Firefox') {\r\n                        if (connection.mediaConstraints.audio !== true) {\r\n                            connection.mediaConstraints.audio.deviceId = lastAudioDevice.id;\r\n                        } else {\r\n                            connection.mediaConstraints.audio = {\r\n                                deviceId: lastAudioDevice.id\r\n                            }\r\n                        }\r\n                        return;\r\n                    }\r\n\r\n                    if (connection.mediaConstraints.audio == true) {\r\n                        connection.mediaConstraints.audio = {\r\n                            mandatory: {},\r\n                            optional: []\r\n                        }\r\n                    }\r\n\r\n                    if (!connection.mediaConstraints.audio.optional) {\r\n                        connection.mediaConstraints.audio.optional = [];\r\n                    }\r\n\r\n                    var optional = [{\r\n                        sourceId: lastAudioDevice.id\r\n                    }];\r\n\r\n                    connection.mediaConstraints.audio.optional = optional.concat(connection.mediaConstraints.audio.optional);\r\n                }\r\n\r\n                if (lastVideoDevice) {\r\n                    if (DetectRTC.browser.name === 'Firefox') {\r\n                        if (connection.mediaConstraints.video !== true) {\r\n                            connection.mediaConstraints.video.deviceId = lastVideoDevice.id;\r\n                        } else {\r\n                            connection.mediaConstraints.video = {\r\n                                deviceId: lastVideoDevice.id\r\n                            }\r\n                        }\r\n                        return;\r\n                    }\r\n\r\n                    if (connection.mediaConstraints.video == true) {\r\n                        connection.mediaConstraints.video = {\r\n                            mandatory: {},\r\n                            optional: []\r\n                        }\r\n                    }\r\n\r\n                    if (!connection.mediaConstraints.video.optional) {\r\n                        connection.mediaConstraints.video.optional = [];\r\n                    }\r\n\r\n                    var optional = [{\r\n                        sourceId: lastVideoDevice.id\r\n                    }];\r\n\r\n                    connection.mediaConstraints.video.optional = optional.concat(connection.mediaConstraints.video.optional);\r\n                }\r\n            });\r\n        }\r\n\r\n        connection.sdpConstraints = {\r\n            mandatory: {\r\n                OfferToReceiveAudio: true,\r\n                OfferToReceiveVideo: true\r\n            },\r\n            optional: [{\r\n                VoiceActivityDetection: false\r\n            }]\r\n        };\r\n\r\n        connection.sdpSemantics = null; // \"unified-plan\" or \"plan-b\", ref: webrtc.org/web-apis/chrome/unified-plan/\r\n        connection.iceCandidatePoolSize = null; // 0\r\n        connection.bundlePolicy = null; // max-bundle\r\n        connection.rtcpMuxPolicy = null; // \"require\" or \"negotiate\"\r\n        connection.iceTransportPolicy = null; // \"relay\" or \"all\"\r\n        connection.optionalArgument = {\r\n            optional: [{\r\n                DtlsSrtpKeyAgreement: true\r\n            }, {\r\n                googImprovedWifiBwe: true\r\n            }, {\r\n                googScreencastMinBitrate: 300\r\n            }, {\r\n                googIPv6: true\r\n            }, {\r\n                googDscp: true\r\n            }, {\r\n                googCpuUnderuseThreshold: 55\r\n            }, {\r\n                googCpuOveruseThreshold: 85\r\n            }, {\r\n                googSuspendBelowMinBitrate: true\r\n            }, {\r\n                googCpuOveruseDetection: true\r\n            }],\r\n            mandatory: {}\r\n        };\r\n\r\n        connection.iceServers = IceServersHandler.getIceServers(connection);\r\n\r\n        connection.candidates = {\r\n            host: true,\r\n            stun: true,\r\n            turn: true\r\n        };\r\n\r\n        connection.iceProtocols = {\r\n            tcp: true,\r\n            udp: true\r\n        };\r\n\r\n        // EVENTs\r\n        connection.onopen = function(event) {\r\n            if (!!connection.enableLogs) {\r\n                console.info('Data connection has been opened between you & ', event.userid);\r\n            }\r\n        };\r\n\r\n        connection.onclose = function(event) {\r\n            if (!!connection.enableLogs) {\r\n                console.warn('Data connection has been closed between you & ', event.userid);\r\n            }\r\n        };\r\n\r\n        connection.onerror = function(error) {\r\n            if (!!connection.enableLogs) {\r\n                console.error(error.userid, 'data-error', error);\r\n            }\r\n        };\r\n\r\n        connection.onmessage = function(event) {\r\n            if (!!connection.enableLogs) {\r\n                console.debug('data-message', event.userid, event.data);\r\n            }\r\n        };\r\n\r\n        connection.send = function(data, remoteUserId) {\r\n            connection.peers.send(data, remoteUserId);\r\n        };\r\n\r\n        connection.close = connection.disconnect = connection.leave = function() {\r\n            connection.onbeforeunload(false, true);\r\n        };\r\n\r\n        connection.closeEntireSession = function(callback) {\r\n            callback = callback || function() {};\r\n            connection.socket.emit('close-entire-session', function looper() {\r\n                if (connection.getAllParticipants().length) {\r\n                    setTimeout(looper, 100);\r\n                    return;\r\n                }\r\n\r\n                connection.onEntireSessionClosed({\r\n                    sessionid: connection.sessionid,\r\n                    userid: connection.userid,\r\n                    extra: connection.extra\r\n                });\r\n\r\n                connection.changeUserId(null, function() {\r\n                    connection.close();\r\n                    callback();\r\n                });\r\n            });\r\n        };\r\n\r\n        connection.onEntireSessionClosed = function(event) {\r\n            if (!connection.enableLogs) return;\r\n            console.info('Entire session is closed: ', event.sessionid, event.extra);\r\n        };\r\n\r\n        connection.onstream = function(e) {\r\n            var parentNode = connection.videosContainer;\r\n            parentNode.insertBefore(e.mediaElement, parentNode.firstChild);\r\n            var played = e.mediaElement.play();\r\n\r\n            if (typeof played !== 'undefined') {\r\n                played.catch(function() {\r\n                    /*** iOS 11 doesn't allow automatic play and rejects ***/\r\n                }).then(function() {\r\n                    setTimeout(function() {\r\n                        e.mediaElement.play();\r\n                    }, 2000);\r\n                });\r\n                return;\r\n            }\r\n\r\n            setTimeout(function() {\r\n                e.mediaElement.play();\r\n            }, 2000);\r\n        };\r\n\r\n        connection.onstreamended = function(e) {\r\n            if (!e.mediaElement) {\r\n                e.mediaElement = document.getElementById(e.streamid);\r\n            }\r\n\r\n            if (!e.mediaElement || !e.mediaElement.parentNode) {\r\n                return;\r\n            }\r\n\r\n            e.mediaElement.parentNode.removeChild(e.mediaElement);\r\n        };\r\n\r\n        connection.direction = 'many-to-many';\r\n\r\n        connection.removeStream = function(streamid, remoteUserId) {\r\n            var stream;\r\n            connection.attachStreams.forEach(function(localStream) {\r\n                if (localStream.id === streamid) {\r\n                    stream = localStream;\r\n                }\r\n            });\r\n\r\n            if (!stream) {\r\n                console.warn('No such stream exist.', streamid);\r\n                return;\r\n            }\r\n\r\n            connection.peers.getAllParticipants().forEach(function(participant) {\r\n                if (remoteUserId && participant !== remoteUserId) {\r\n                    return;\r\n                }\r\n\r\n                var user = connection.peers[participant];\r\n                try {\r\n                    user.peer.removeStream(stream);\r\n                } catch (e) {}\r\n            });\r\n\r\n            connection.renegotiate();\r\n        };\r\n\r\n        connection.addStream = function(session, remoteUserId) {\r\n            if (!!session.getTracks) {\r\n                if (connection.attachStreams.indexOf(session) === -1) {\r\n                    if (!session.streamid) {\r\n                        session.streamid = session.id;\r\n                    }\r\n\r\n                    connection.attachStreams.push(session);\r\n                }\r\n                connection.renegotiate(remoteUserId);\r\n                return;\r\n            }\r\n\r\n            if (isData(session)) {\r\n                connection.renegotiate(remoteUserId);\r\n                return;\r\n            }\r\n\r\n            if (session.audio || session.video || session.screen) {\r\n                if (session.screen) {\r\n                    if (DetectRTC.browser.name === 'Edge') {\r\n                        navigator.getDisplayMedia({\r\n                            video: true,\r\n                            audio: isAudioPlusTab(connection)\r\n                        }).then(function(screen) {\r\n                            screen.isScreen = true;\r\n                            mPeer.onGettingLocalMedia(screen);\r\n\r\n                            if ((session.audio || session.video) && !isAudioPlusTab(connection)) {\r\n                                connection.invokeGetUserMedia(null, function(stream) {\r\n                                    gumCallback(stream);\r\n                                });\r\n                            } else {\r\n                                gumCallback(screen);\r\n                            }\r\n                        }, function(error) {\r\n                            console.error('Unable to capture screen on Edge. HTTPs and version 17+ is required.');\r\n                        });\r\n                    } else {\r\n                        connection.invokeGetUserMedia({\r\n                            audio: isAudioPlusTab(connection),\r\n                            video: true,\r\n                            isScreen: true\r\n                        }, function(stream) {\r\n                            if ((session.audio || session.video) && !isAudioPlusTab(connection)) {\r\n                                connection.invokeGetUserMedia(null, function(stream) {\r\n                                    gumCallback(stream);\r\n                                });\r\n                            } else {\r\n                                gumCallback(stream);\r\n                            }\r\n                        });\r\n                    }\r\n                } else if (session.audio || session.video) {\r\n                    connection.invokeGetUserMedia(null, gumCallback);\r\n                }\r\n            }\r\n\r\n            function gumCallback(stream) {\r\n                if (session.streamCallback) {\r\n                    session.streamCallback(stream);\r\n                }\r\n\r\n                connection.renegotiate(remoteUserId);\r\n            }\r\n        };\r\n\r\n        connection.invokeGetUserMedia = function(localMediaConstraints, callback, session) {\r\n            if (!session) {\r\n                session = connection.session;\r\n            }\r\n\r\n            if (!localMediaConstraints) {\r\n                localMediaConstraints = connection.mediaConstraints;\r\n            }\r\n\r\n            getUserMediaHandler({\r\n                onGettingLocalMedia: function(stream) {\r\n                    var videoConstraints = localMediaConstraints.video;\r\n                    if (videoConstraints) {\r\n                        if (videoConstraints.mediaSource || videoConstraints.mozMediaSource) {\r\n                            stream.isScreen = true;\r\n                        } else if (videoConstraints.mandatory && videoConstraints.mandatory.chromeMediaSource) {\r\n                            stream.isScreen = true;\r\n                        }\r\n                    }\r\n\r\n                    if (!stream.isScreen) {\r\n                        stream.isVideo = !!getTracks(stream, 'video').length;\r\n                        stream.isAudio = !stream.isVideo && getTracks(stream, 'audio').length;\r\n                    }\r\n\r\n                    mPeer.onGettingLocalMedia(stream, function() {\r\n                        if (typeof callback === 'function') {\r\n                            callback(stream);\r\n                        }\r\n                    });\r\n                },\r\n                onLocalMediaError: function(error, constraints) {\r\n                    mPeer.onLocalMediaError(error, constraints);\r\n                },\r\n                localMediaConstraints: localMediaConstraints || {\r\n                    audio: session.audio ? localMediaConstraints.audio : false,\r\n                    video: session.video ? localMediaConstraints.video : false\r\n                }\r\n            });\r\n        };\r\n\r\n        function applyConstraints(stream, mediaConstraints) {\r\n            if (!stream) {\r\n                if (!!connection.enableLogs) {\r\n                    console.error('No stream to applyConstraints.');\r\n                }\r\n                return;\r\n            }\r\n\r\n            if (mediaConstraints.audio) {\r\n                getTracks(stream, 'audio').forEach(function(track) {\r\n                    track.applyConstraints(mediaConstraints.audio);\r\n                });\r\n            }\r\n\r\n            if (mediaConstraints.video) {\r\n                getTracks(stream, 'video').forEach(function(track) {\r\n                    track.applyConstraints(mediaConstraints.video);\r\n                });\r\n            }\r\n        }\r\n\r\n        connection.applyConstraints = function(mediaConstraints, streamid) {\r\n            if (!MediaStreamTrack || !MediaStreamTrack.prototype.applyConstraints) {\r\n                alert('track.applyConstraints is NOT supported in your browser.');\r\n                return;\r\n            }\r\n\r\n            if (streamid) {\r\n                var stream;\r\n                if (connection.streamEvents[streamid]) {\r\n                    stream = connection.streamEvents[streamid].stream;\r\n                }\r\n                applyConstraints(stream, mediaConstraints);\r\n                return;\r\n            }\r\n\r\n            connection.attachStreams.forEach(function(stream) {\r\n                applyConstraints(stream, mediaConstraints);\r\n            });\r\n        };\r\n\r\n        function replaceTrack(track, remoteUserId, isVideoTrack) {\r\n            if (remoteUserId) {\r\n                mPeer.replaceTrack(track, remoteUserId, isVideoTrack);\r\n                return;\r\n            }\r\n\r\n            connection.peers.getAllParticipants().forEach(function(participant) {\r\n                mPeer.replaceTrack(track, participant, isVideoTrack);\r\n            });\r\n        }\r\n\r\n        connection.replaceTrack = function(session, remoteUserId, isVideoTrack) {\r\n            session = session || {};\r\n\r\n            if (!RTCPeerConnection.prototype.getSenders) {\r\n                connection.addStream(session);\r\n                return;\r\n            }\r\n\r\n            if (session instanceof MediaStreamTrack) {\r\n                replaceTrack(session, remoteUserId, isVideoTrack);\r\n                return;\r\n            }\r\n\r\n            if (session instanceof MediaStream) {\r\n                if (getTracks(session, 'video').length) {\r\n                    replaceTrack(getTracks(session, 'video')[0], remoteUserId, true);\r\n                }\r\n\r\n                if (getTracks(session, 'audio').length) {\r\n                    replaceTrack(getTracks(session, 'audio')[0], remoteUserId, false);\r\n                }\r\n                return;\r\n            }\r\n\r\n            if (isData(session)) {\r\n                throw 'connection.replaceTrack requires audio and/or video and/or screen.';\r\n                return;\r\n            }\r\n\r\n            if (session.audio || session.video || session.screen) {\r\n                if (session.screen) {\r\n                    if (DetectRTC.browser.name === 'Edge') {\r\n                        navigator.getDisplayMedia({\r\n                            video: true,\r\n                            audio: isAudioPlusTab(connection)\r\n                        }).then(function(screen) {\r\n                            screen.isScreen = true;\r\n                            mPeer.onGettingLocalMedia(screen);\r\n\r\n                            if ((session.audio || session.video) && !isAudioPlusTab(connection)) {\r\n                                connection.invokeGetUserMedia(null, gumCallback);\r\n                            } else {\r\n                                gumCallback(screen);\r\n                            }\r\n                        }, function(error) {\r\n                            console.error('Unable to capture screen on Edge. HTTPs and version 17+ is required.');\r\n                        });\r\n                    } else {\r\n                        connection.invokeGetUserMedia({\r\n                            audio: isAudioPlusTab(connection),\r\n                            video: true,\r\n                            isScreen: true\r\n                        }, (session.audio || session.video) && !isAudioPlusTab(connection) ? connection.invokeGetUserMedia(null, gumCallback) : gumCallback);\r\n                    }\r\n                } else if (session.audio || session.video) {\r\n                    connection.invokeGetUserMedia(null, gumCallback);\r\n                }\r\n            }\r\n\r\n            function gumCallback(stream) {\r\n                connection.replaceTrack(stream, remoteUserId, isVideoTrack || session.video || session.screen);\r\n            }\r\n        };\r\n\r\n        connection.resetTrack = function(remoteUsersIds, isVideoTrack) {\r\n            if (!remoteUsersIds) {\r\n                remoteUsersIds = connection.getAllParticipants();\r\n            }\r\n\r\n            if (typeof remoteUsersIds == 'string') {\r\n                remoteUsersIds = [remoteUsersIds];\r\n            }\r\n\r\n            remoteUsersIds.forEach(function(participant) {\r\n                var peer = connection.peers[participant].peer;\r\n\r\n                if ((typeof isVideoTrack === 'undefined' || isVideoTrack === true) && peer.lastVideoTrack) {\r\n                    connection.replaceTrack(peer.lastVideoTrack, participant, true);\r\n                }\r\n\r\n                if ((typeof isVideoTrack === 'undefined' || isVideoTrack === false) && peer.lastAudioTrack) {\r\n                    connection.replaceTrack(peer.lastAudioTrack, participant, false);\r\n                }\r\n            });\r\n        };\r\n\r\n        connection.renegotiate = function(remoteUserId) {\r\n            if (remoteUserId) {\r\n                mPeer.renegotiatePeer(remoteUserId);\r\n                return;\r\n            }\r\n\r\n            connection.peers.getAllParticipants().forEach(function(participant) {\r\n                mPeer.renegotiatePeer(participant);\r\n            });\r\n        };\r\n\r\n        connection.setStreamEndHandler = function(stream, isRemote) {\r\n            if (!stream || !stream.addEventListener) return;\r\n\r\n            isRemote = !!isRemote;\r\n\r\n            if (stream.alreadySetEndHandler) {\r\n                return;\r\n            }\r\n            stream.alreadySetEndHandler = true;\r\n\r\n            var streamEndedEvent = 'ended';\r\n\r\n            if ('oninactive' in stream) {\r\n                streamEndedEvent = 'inactive';\r\n            }\r\n\r\n            stream.addEventListener(streamEndedEvent, function() {\r\n                if (stream.idInstance) {\r\n                    currentUserMediaRequest.remove(stream.idInstance);\r\n                }\r\n\r\n                if (!isRemote) {\r\n                    // reset attachStreams\r\n                    var streams = [];\r\n                    connection.attachStreams.forEach(function(s) {\r\n                        if (s.id != stream.id) {\r\n                            streams.push(s);\r\n                        }\r\n                    });\r\n                    connection.attachStreams = streams;\r\n                }\r\n\r\n                // connection.renegotiate();\r\n\r\n                var streamEvent = connection.streamEvents[stream.streamid];\r\n                if (!streamEvent) {\r\n                    streamEvent = {\r\n                        stream: stream,\r\n                        streamid: stream.streamid,\r\n                        type: isRemote ? 'remote' : 'local',\r\n                        userid: connection.userid,\r\n                        extra: connection.extra,\r\n                        mediaElement: connection.streamEvents[stream.streamid] ? connection.streamEvents[stream.streamid].mediaElement : null\r\n                    };\r\n                }\r\n\r\n                if (isRemote && connection.peers[streamEvent.userid]) {\r\n                    // reset remote \"streams\"\r\n                    var peer = connection.peers[streamEvent.userid].peer;\r\n                    var streams = [];\r\n                    peer.getRemoteStreams().forEach(function(s) {\r\n                        if (s.id != stream.id) {\r\n                            streams.push(s);\r\n                        }\r\n                    });\r\n                    connection.peers[streamEvent.userid].streams = streams;\r\n                }\r\n\r\n                if (streamEvent.userid === connection.userid && streamEvent.type === 'remote') {\r\n                    return;\r\n                }\r\n\r\n                if (connection.peersBackup[streamEvent.userid]) {\r\n                    streamEvent.extra = connection.peersBackup[streamEvent.userid].extra;\r\n                }\r\n\r\n                connection.onstreamended(streamEvent);\r\n\r\n                delete connection.streamEvents[stream.streamid];\r\n            }, false);\r\n        };\r\n\r\n        connection.onMediaError = function(error, constraints) {\r\n            if (!!connection.enableLogs) {\r\n                console.error(error, constraints);\r\n            }\r\n        };\r\n\r\n        connection.autoCloseEntireSession = false;\r\n\r\n        connection.filesContainer = connection.videosContainer = document.body || document.documentElement;\r\n        connection.isInitiator = false;\r\n\r\n        connection.shareFile = mPeer.shareFile;\r\n        if (typeof FileProgressBarHandler !== 'undefined') {\r\n            FileProgressBarHandler.handle(connection);\r\n        }\r\n\r\n        if (typeof TranslationHandler !== 'undefined') {\r\n            TranslationHandler.handle(connection);\r\n        }\r\n\r\n        connection.token = getRandomString;\r\n\r\n        connection.onNewParticipant = function(participantId, userPreferences) {\r\n            connection.acceptParticipationRequest(participantId, userPreferences);\r\n        };\r\n\r\n        connection.acceptParticipationRequest = function(participantId, userPreferences) {\r\n            if (userPreferences.successCallback) {\r\n                userPreferences.successCallback();\r\n                delete userPreferences.successCallback;\r\n            }\r\n\r\n            mPeer.createNewPeer(participantId, userPreferences);\r\n        };\r\n\r\n        if (typeof StreamsHandler !== 'undefined') {\r\n            connection.StreamsHandler = StreamsHandler;\r\n        }\r\n\r\n        connection.onleave = function(userid) {};\r\n\r\n        connection.invokeSelectFileDialog = function(callback) {\r\n            var selector = new FileSelector();\r\n            selector.accept = '*.*';\r\n            selector.selectSingleFile(callback);\r\n        };\r\n\r\n        connection.onmute = function(e) {\r\n            if (!e || !e.mediaElement) {\r\n                return;\r\n            }\r\n\r\n            if (e.muteType === 'both' || e.muteType === 'video') {\r\n                e.mediaElement.src = null;\r\n                var paused = e.mediaElement.pause();\r\n                if (typeof paused !== 'undefined') {\r\n                    paused.then(function() {\r\n                        e.mediaElement.poster = e.snapshot || 'https://cdn.webrtc-experiment.com/images/muted.png';\r\n                    });\r\n                } else {\r\n                    e.mediaElement.poster = e.snapshot || 'https://cdn.webrtc-experiment.com/images/muted.png';\r\n                }\r\n            } else if (e.muteType === 'audio') {\r\n                e.mediaElement.muted = true;\r\n            }\r\n        };\r\n\r\n        connection.onunmute = function(e) {\r\n            if (!e || !e.mediaElement || !e.stream) {\r\n                return;\r\n            }\r\n\r\n            if (e.unmuteType === 'both' || e.unmuteType === 'video') {\r\n                e.mediaElement.poster = null;\r\n                e.mediaElement.srcObject = e.stream;\r\n                e.mediaElement.play();\r\n            } else if (e.unmuteType === 'audio') {\r\n                e.mediaElement.muted = false;\r\n            }\r\n        };\r\n\r\n        connection.onExtraDataUpdated = function(event) {\r\n            event.status = 'online';\r\n            connection.onUserStatusChanged(event, true);\r\n        };\r\n\r\n        connection.getAllParticipants = function(sender) {\r\n            return connection.peers.getAllParticipants(sender);\r\n        };\r\n\r\n        if (typeof StreamsHandler !== 'undefined') {\r\n            StreamsHandler.onSyncNeeded = function(streamid, action, type) {\r\n                connection.peers.getAllParticipants().forEach(function(participant) {\r\n                    mPeer.onNegotiationNeeded({\r\n                        streamid: streamid,\r\n                        action: action,\r\n                        streamSyncNeeded: true,\r\n                        type: type || 'both'\r\n                    }, participant);\r\n                });\r\n            };\r\n        }\r\n\r\n        connection.connectSocket = function(callback) {\r\n            connectSocket(callback);\r\n        };\r\n\r\n        connection.closeSocket = function() {\r\n            try {\r\n                io.sockets = {};\r\n            } catch (e) {};\r\n\r\n            if (!connection.socket) return;\r\n\r\n            if (typeof connection.socket.disconnect === 'function') {\r\n                connection.socket.disconnect();\r\n            }\r\n\r\n            if (typeof connection.socket.resetProps === 'function') {\r\n                connection.socket.resetProps();\r\n            }\r\n\r\n            connection.socket = null;\r\n        };\r\n\r\n        connection.getSocket = function(callback) {\r\n            if (!callback && connection.enableLogs) {\r\n                console.warn('getSocket.callback paramter is required.');\r\n            }\r\n\r\n            callback = callback || function() {};\r\n\r\n            if (!connection.socket) {\r\n                connectSocket(function() {\r\n                    callback(connection.socket);\r\n                });\r\n            } else {\r\n                callback(connection.socket);\r\n            }\r\n\r\n            return connection.socket; // callback is preferred over return-statement\r\n        };\r\n\r\n        connection.getRemoteStreams = mPeer.getRemoteStreams;\r\n\r\n        var skipStreams = ['selectFirst', 'selectAll', 'forEach'];\r\n\r\n        connection.streamEvents = {\r\n            selectFirst: function(options) {\r\n                return connection.streamEvents.selectAll(options)[0];\r\n            },\r\n            selectAll: function(options) {\r\n                if (!options) {\r\n                    // default will always be all streams\r\n                    options = {\r\n                        local: true,\r\n                        remote: true,\r\n                        isScreen: true,\r\n                        isAudio: true,\r\n                        isVideo: true\r\n                    };\r\n                }\r\n\r\n                if (options == 'local') {\r\n                    options = {\r\n                        local: true\r\n                    };\r\n                }\r\n\r\n                if (options == 'remote') {\r\n                    options = {\r\n                        remote: true\r\n                    };\r\n                }\r\n\r\n                if (options == 'screen') {\r\n                    options = {\r\n                        isScreen: true\r\n                    };\r\n                }\r\n\r\n                if (options == 'audio') {\r\n                    options = {\r\n                        isAudio: true\r\n                    };\r\n                }\r\n\r\n                if (options == 'video') {\r\n                    options = {\r\n                        isVideo: true\r\n                    };\r\n                }\r\n\r\n                var streams = [];\r\n                Object.keys(connection.streamEvents).forEach(function(key) {\r\n                    var event = connection.streamEvents[key];\r\n\r\n                    if (skipStreams.indexOf(key) !== -1) return;\r\n                    var ignore = true;\r\n\r\n                    if (options.local && event.type === 'local') {\r\n                        ignore = false;\r\n                    }\r\n\r\n                    if (options.remote && event.type === 'remote') {\r\n                        ignore = false;\r\n                    }\r\n\r\n                    if (options.isScreen && event.stream.isScreen) {\r\n                        ignore = false;\r\n                    }\r\n\r\n                    if (options.isVideo && event.stream.isVideo) {\r\n                        ignore = false;\r\n                    }\r\n\r\n                    if (options.isAudio && event.stream.isAudio) {\r\n                        ignore = false;\r\n                    }\r\n\r\n                    if (options.userid && event.userid === options.userid) {\r\n                        ignore = false;\r\n                    }\r\n\r\n                    if (ignore === false) {\r\n                        streams.push(event);\r\n                    }\r\n                });\r\n\r\n                return streams;\r\n            }\r\n        };\r\n\r\n        connection.socketURL = '/'; // generated via config.json\r\n        connection.socketMessageEvent = 'RTCMultiConnection-Message'; // generated via config.json\r\n        connection.socketCustomEvent = 'RTCMultiConnection-Custom-Message'; // generated via config.json\r\n        connection.DetectRTC = DetectRTC;\r\n\r\n        connection.setCustomSocketEvent = function(customEvent) {\r\n            if (customEvent) {\r\n                connection.socketCustomEvent = customEvent;\r\n            }\r\n\r\n            if (!connection.socket) {\r\n                return;\r\n            }\r\n\r\n            connection.socket.emit('set-custom-socket-event-listener', connection.socketCustomEvent);\r\n        };\r\n\r\n        connection.getNumberOfBroadcastViewers = function(broadcastId, callback) {\r\n            if (!connection.socket || !broadcastId || !callback) return;\r\n\r\n            connection.socket.emit('get-number-of-users-in-specific-broadcast', broadcastId, callback);\r\n        };\r\n\r\n        connection.onNumberOfBroadcastViewersUpdated = function(event) {\r\n            if (!connection.enableLogs || !connection.isInitiator) return;\r\n            console.info('Number of broadcast (', event.broadcastId, ') viewers', event.numberOfBroadcastViewers);\r\n        };\r\n\r\n        connection.onUserStatusChanged = function(event, dontWriteLogs) {\r\n            if (!!connection.enableLogs && !dontWriteLogs) {\r\n                console.info(event.userid, event.status);\r\n            }\r\n        };\r\n\r\n        connection.getUserMediaHandler = getUserMediaHandler;\r\n        connection.multiPeersHandler = mPeer;\r\n        connection.enableLogs = true;\r\n        connection.setCustomSocketHandler = function(customSocketHandler) {\r\n            if (typeof SocketConnection !== 'undefined') {\r\n                SocketConnection = customSocketHandler;\r\n            }\r\n        };\r\n\r\n        // default value should be 15k because [old]Firefox's receiving limit is 16k!\r\n        // however 64k works chrome-to-chrome\r\n        connection.chunkSize = 40 * 1000;\r\n\r\n        connection.maxParticipantsAllowed = 1000;\r\n\r\n        // eject or leave single user\r\n        connection.disconnectWith = mPeer.disconnectWith;\r\n\r\n        // check if room exist on server\r\n        // we will pass roomid to the server and wait for callback (i.e. server's response)\r\n        connection.checkPresence = function(roomid, callback) {\r\n            roomid = roomid || connection.sessionid;\r\n\r\n            if (SocketConnection.name === 'SSEConnection') {\r\n                SSEConnection.checkPresence(roomid, function(isRoomExist, _roomid, extra) {\r\n                    if (!connection.socket) {\r\n                        if (!isRoomExist) {\r\n                            connection.userid = _roomid;\r\n                        }\r\n\r\n                        connection.connectSocket(function() {\r\n                            callback(isRoomExist, _roomid, extra);\r\n                        });\r\n                        return;\r\n                    }\r\n                    callback(isRoomExist, _roomid);\r\n                });\r\n                return;\r\n            }\r\n\r\n            if (!connection.socket) {\r\n                connection.connectSocket(function() {\r\n                    connection.checkPresence(roomid, callback);\r\n                });\r\n                return;\r\n            }\r\n\r\n            connection.socket.emit('check-presence', roomid + '', function(isRoomExist, _roomid, extra) {\r\n                if (connection.enableLogs) {\r\n                    console.log('checkPresence.isRoomExist: ', isRoomExist, ' roomid: ', _roomid);\r\n                }\r\n                callback(isRoomExist, _roomid, extra);\r\n            });\r\n        };\r\n\r\n        connection.onReadyForOffer = function(remoteUserId, userPreferences) {\r\n            connection.multiPeersHandler.createNewPeer(remoteUserId, userPreferences);\r\n        };\r\n\r\n        connection.setUserPreferences = function(userPreferences) {\r\n            if (connection.dontAttachStream) {\r\n                userPreferences.dontAttachLocalStream = true;\r\n            }\r\n\r\n            if (connection.dontGetRemoteStream) {\r\n                userPreferences.dontGetRemoteStream = true;\r\n            }\r\n\r\n            return userPreferences;\r\n        };\r\n\r\n        connection.updateExtraData = function() {\r\n            connection.socket.emit('extra-data-updated', connection.extra);\r\n        };\r\n\r\n        connection.enableScalableBroadcast = false;\r\n        connection.maxRelayLimitPerUser = 3; // each broadcast should serve only 3 users\r\n\r\n        connection.dontCaptureUserMedia = false;\r\n        connection.dontAttachStream = false;\r\n        connection.dontGetRemoteStream = false;\r\n\r\n        connection.onReConnecting = function(event) {\r\n            if (connection.enableLogs) {\r\n                console.info('ReConnecting with', event.userid, '...');\r\n            }\r\n        };\r\n\r\n        connection.beforeAddingStream = function(stream) {\r\n            return stream;\r\n        };\r\n\r\n        connection.beforeRemovingStream = function(stream) {\r\n            return stream;\r\n        };\r\n\r\n        if (typeof isChromeExtensionAvailable !== 'undefined') {\r\n            connection.checkIfChromeExtensionAvailable = isChromeExtensionAvailable;\r\n        }\r\n\r\n        if (typeof isFirefoxExtensionAvailable !== 'undefined') {\r\n            connection.checkIfChromeExtensionAvailable = isFirefoxExtensionAvailable;\r\n        }\r\n\r\n        if (typeof getChromeExtensionStatus !== 'undefined') {\r\n            connection.getChromeExtensionStatus = getChromeExtensionStatus;\r\n        }\r\n\r\n        connection.modifyScreenConstraints = function(screen_constraints) {\r\n            return screen_constraints;\r\n        };\r\n\r\n        connection.onPeerStateChanged = function(state) {\r\n            if (connection.enableLogs) {\r\n                if (state.iceConnectionState.search(/closed|failed/gi) !== -1) {\r\n                    console.error('Peer connection is closed between you & ', state.userid, state.extra, 'state:', state.iceConnectionState);\r\n                }\r\n            }\r\n        };\r\n\r\n        connection.isOnline = true;\r\n\r\n        listenEventHandler('online', function() {\r\n            connection.isOnline = true;\r\n        });\r\n\r\n        listenEventHandler('offline', function() {\r\n            connection.isOnline = false;\r\n        });\r\n\r\n        connection.isLowBandwidth = false;\r\n        if (navigator && navigator.connection && navigator.connection.type) {\r\n            connection.isLowBandwidth = navigator.connection.type.toString().toLowerCase().search(/wifi|cell/g) !== -1;\r\n            if (connection.isLowBandwidth) {\r\n                connection.bandwidth = {\r\n                    audio: false,\r\n                    video: false,\r\n                    screen: false\r\n                };\r\n\r\n                if (connection.mediaConstraints.audio && connection.mediaConstraints.audio.optional && connection.mediaConstraints.audio.optional.length) {\r\n                    var newArray = [];\r\n                    connection.mediaConstraints.audio.optional.forEach(function(opt) {\r\n                        if (typeof opt.bandwidth === 'undefined') {\r\n                            newArray.push(opt);\r\n                        }\r\n                    });\r\n                    connection.mediaConstraints.audio.optional = newArray;\r\n                }\r\n\r\n                if (connection.mediaConstraints.video && connection.mediaConstraints.video.optional && connection.mediaConstraints.video.optional.length) {\r\n                    var newArray = [];\r\n                    connection.mediaConstraints.video.optional.forEach(function(opt) {\r\n                        if (typeof opt.bandwidth === 'undefined') {\r\n                            newArray.push(opt);\r\n                        }\r\n                    });\r\n                    connection.mediaConstraints.video.optional = newArray;\r\n                }\r\n            }\r\n        }\r\n\r\n        connection.getExtraData = function(remoteUserId, callback) {\r\n            if (!remoteUserId) throw 'remoteUserId is required.';\r\n\r\n            if (typeof callback === 'function') {\r\n                connection.socket.emit('get-remote-user-extra-data', remoteUserId, function(extra, remoteUserId, error) {\r\n                    callback(extra, remoteUserId, error);\r\n                });\r\n                return;\r\n            }\r\n\r\n            if (!connection.peers[remoteUserId]) {\r\n                if (connection.peersBackup[remoteUserId]) {\r\n                    return connection.peersBackup[remoteUserId].extra;\r\n                }\r\n                return {};\r\n            }\r\n\r\n            return connection.peers[remoteUserId].extra;\r\n        };\r\n\r\n        if (!!forceOptions.autoOpenOrJoin) {\r\n            connection.openOrJoin(connection.sessionid);\r\n        }\r\n\r\n        connection.onUserIdAlreadyTaken = function(useridAlreadyTaken, yourNewUserId) {\r\n            // via #683\r\n            connection.close();\r\n            connection.closeSocket();\r\n\r\n            connection.isInitiator = false;\r\n            connection.userid = connection.token();\r\n\r\n            connection.join(connection.sessionid);\r\n\r\n            if (connection.enableLogs) {\r\n                console.warn('Userid already taken.', useridAlreadyTaken, 'Your new userid:', connection.userid);\r\n            }\r\n        };\r\n\r\n        connection.trickleIce = true;\r\n        connection.version = '3.7.0';\r\n\r\n        connection.onSettingLocalDescription = function(event) {\r\n            if (connection.enableLogs) {\r\n                console.info('Set local description for remote user', event.userid);\r\n            }\r\n        };\r\n\r\n        connection.resetScreen = function() {\r\n            sourceId = null;\r\n            if (DetectRTC && DetectRTC.screen) {\r\n                delete DetectRTC.screen.sourceId;\r\n            }\r\n\r\n            currentUserMediaRequest = {\r\n                streams: [],\r\n                mutex: false,\r\n                queueRequests: []\r\n            };\r\n        };\r\n\r\n        // if disabled, \"event.mediaElement\" for \"onstream\" will be NULL\r\n        connection.autoCreateMediaElement = true;\r\n\r\n        // set password\r\n        connection.password = null;\r\n\r\n        // set password\r\n        connection.setPassword = function(password, callback) {\r\n            callback = callback || function() {};\r\n            if (connection.socket) {\r\n                connection.socket.emit('set-password', password, callback);\r\n            } else {\r\n                connection.password = password;\r\n                callback(true, connection.sessionid, null);\r\n            }\r\n        };\r\n\r\n        connection.onSocketDisconnect = function(event) {\r\n            if (connection.enableLogs) {\r\n                console.warn('socket.io connection is closed');\r\n            }\r\n        };\r\n\r\n        connection.onSocketError = function(event) {\r\n            if (connection.enableLogs) {\r\n                console.warn('socket.io connection is failed');\r\n            }\r\n        };\r\n\r\n        // error messages\r\n        connection.errors = {\r\n            ROOM_NOT_AVAILABLE: 'Room not available',\r\n            INVALID_PASSWORD: 'Invalid password',\r\n            USERID_NOT_AVAILABLE: 'User ID does not exist',\r\n            ROOM_PERMISSION_DENIED: 'Room permission denied',\r\n            ROOM_FULL: 'Room full',\r\n            DID_NOT_JOIN_ANY_ROOM: 'Did not join any room yet',\r\n            INVALID_SOCKET: 'Invalid socket',\r\n            PUBLIC_IDENTIFIER_MISSING: 'publicRoomIdentifier is required',\r\n            INVALID_ADMIN_CREDENTIAL: 'Invalid username or password attempted'\r\n        };\r\n    })(this);\r\n\r\n};\r\n\r\nif (typeof module !== 'undefined' /* && !!module.exports*/ ) {\r\n    module.exports = exports = RTCMultiConnection;\r\n}\r\n\r\nif (typeof define === 'function' && define.amd) {\r\n    define('RTCMultiConnection', [], function() {\r\n        return RTCMultiConnection;\r\n    });\r\n}\n","var supported = !!(\n  window.AudioContext &&\n  window.MediaStreamAudioSourceNode &&\n  window.AnalyserNode &&\n  window.ScriptProcessorNode\n);\n\nmodule.exports = function (media, options, callback) {\n  if (!callback) {\n    callback = options;\n    options = null;\n  }\n\n  options = options || {};\n\n  var that = {};\n  var context = options.context || new AudioContext();\n  var source = context.createMediaStreamSource(media);\n  var analyser = context.createAnalyser();\n  var processor = null;\n\n  if (callback) {\n    processor = context.createScriptProcessor(2048, 1, 1);\n    processor.onaudioprocess = function () {\n      callback(that.get());\n    };\n  }\n\n  analyser.smoothingTimeConstant = 0.3;\n  analyser.fftSize = 1024;\n\n  source.connect(analyser);\n\n  that.get = function () {\n    var sum = 0;\n    var data = new Uint8Array(analyser.frequencyBinCount);\n    analyser.getByteFrequencyData(data);\n\n    for (var i = 0; i < data.length; i++) {\n      sum += data[i];\n    }\n\n    return sum / data.length / 255;\n  };\n\n  that.destroy = function () {\n    if (processor) {\n      processor.disconnect();\n      analyser.disconnect();\n    }\n\n    source.disconnect();\n\n    if (!options.context) context.close();\n  };\n\n  source.connect(analyser);\n\n  if (processor) {\n    analyser.connect(processor);\n    processor.connect(context.destination);\n  }\n\n  return that;\n};\n\nmodule.exports.supported = supported;\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../node_modules/css-loader/dist/cjs.js??clonedRuleSet-19[0].rules[0].use[1]!../../../node_modules/@vue/vue-loader-v15/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-19[0].rules[0].use[2]!../../../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-19[0].rules[0].use[3]!../../../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-19[0].rules[0].use[4]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./AudioEqualizer.vue?vue&type=style&index=0&id=56c3da71&lang=scss&scoped=true&\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"ee68cfe6\", content, true, {\"sourceMap\":false,\"shadowMode\":false});","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../node_modules/css-loader/dist/cjs.js??clonedRuleSet-19[0].rules[0].use[1]!../../../node_modules/@vue/vue-loader-v15/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-19[0].rules[0].use[2]!../../../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-19[0].rules[0].use[3]!../../../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-19[0].rules[0].use[4]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./CaptureEffects.vue?vue&type=style&index=0&id=03babde1&lang=scss&scoped=true&\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"1e772d05\", content, true, {\"sourceMap\":false,\"shadowMode\":false});","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../node_modules/css-loader/dist/cjs.js??clonedRuleSet-19[0].rules[0].use[1]!../../../node_modules/@vue/vue-loader-v15/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-19[0].rules[0].use[2]!../../../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-19[0].rules[0].use[3]!../../../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-19[0].rules[0].use[4]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./CaptureSettings.vue?vue&type=style&index=0&id=75a82b24&lang=scss&scoped=true&\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"3434e076\", content, true, {\"sourceMap\":false,\"shadowMode\":false});","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../node_modules/css-loader/dist/cjs.js??clonedRuleSet-19[0].rules[0].use[1]!../../../node_modules/@vue/vue-loader-v15/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-19[0].rules[0].use[2]!../../../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-19[0].rules[0].use[3]!../../../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-19[0].rules[0].use[4]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./CaptureView.vue?vue&type=style&index=0&id=265b2e52&lang=scss&scoped=true&\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"0c970310\", content, true, {\"sourceMap\":false,\"shadowMode\":false});","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../node_modules/css-loader/dist/cjs.js??clonedRuleSet-19[0].rules[0].use[1]!../../../node_modules/@vue/vue-loader-v15/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-19[0].rules[0].use[2]!../../../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-19[0].rules[0].use[3]!../../../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-19[0].rules[0].use[4]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./CaptureView.vue?vue&type=style&index=1&lang=scss&\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"7b594f82\", content, true, {\"sourceMap\":false,\"shadowMode\":false});","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../node_modules/css-loader/dist/cjs.js??clonedRuleSet-19[0].rules[0].use[1]!../../../node_modules/@vue/vue-loader-v15/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-19[0].rules[0].use[2]!../../../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-19[0].rules[0].use[3]!../../../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-19[0].rules[0].use[4]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./LinesMode.vue?vue&type=style&index=0&lang=scss&\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"82db7644\", content, true, {\"sourceMap\":false,\"shadowMode\":false});","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../node_modules/css-loader/dist/cjs.js??clonedRuleSet-19[0].rules[0].use[1]!../../../node_modules/@vue/vue-loader-v15/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-19[0].rules[0].use[2]!../../../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-19[0].rules[0].use[3]!../../../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-19[0].rules[0].use[4]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./MediaPreviewBeforeValidation.vue?vue&type=style&index=0&id=0f193272&lang=scss&scoped=true&\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"6226b4dd\", content, true, {\"sourceMap\":false,\"shadowMode\":false});","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../node_modules/css-loader/dist/cjs.js??clonedRuleSet-19[0].rules[0].use[1]!../../../node_modules/@vue/vue-loader-v15/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-19[0].rules[0].use[2]!../../../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-19[0].rules[0].use[3]!../../../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-19[0].rules[0].use[4]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./MediaPreviewBeforeValidation.vue?vue&type=style&index=1&lang=scss&\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"61c98d65\", content, true, {\"sourceMap\":false,\"shadowMode\":false});","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../node_modules/css-loader/dist/cjs.js??clonedRuleSet-19[0].rules[0].use[1]!../../../node_modules/@vue/vue-loader-v15/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-19[0].rules[0].use[2]!../../../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-19[0].rules[0].use[3]!../../../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-19[0].rules[0].use[4]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./MediaValidationButtons.vue?vue&type=style&index=0&id=485c2ab5&lang=scss&scoped=true&\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"0f08d81e\", content, true, {\"sourceMap\":false,\"shadowMode\":false});","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../node_modules/css-loader/dist/cjs.js??clonedRuleSet-19[0].rules[0].use[1]!../../../node_modules/@vue/vue-loader-v15/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-19[0].rules[0].use[2]!../../../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-19[0].rules[0].use[3]!../../../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-19[0].rules[0].use[4]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./StopmotionList.vue?vue&type=style&index=0&id=5e50c66c&lang=scss&scoped=true&\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"c5ac9f04\", content, true, {\"sourceMap\":false,\"shadowMode\":false});","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../node_modules/css-loader/dist/cjs.js??clonedRuleSet-19[0].rules[0].use[1]!../../../node_modules/@vue/vue-loader-v15/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-19[0].rules[0].use[2]!../../../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-19[0].rules[0].use[3]!../../../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-19[0].rules[0].use[4]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./StopmotionList.vue?vue&type=style&index=1&lang=scss&\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"3d48fbce\", content, true, {\"sourceMap\":false,\"shadowMode\":false});","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../node_modules/css-loader/dist/cjs.js??clonedRuleSet-19[0].rules[0].use[1]!../../../node_modules/@vue/vue-loader-v15/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-19[0].rules[0].use[2]!../../../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-19[0].rules[0].use[3]!../../../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-19[0].rules[0].use[4]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./VectoMode.vue?vue&type=style&index=0&lang=scss&\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"50b3dade\", content, true, {\"sourceMap\":false,\"shadowMode\":false});"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","class","collapse_capture_pane","directives","name","rawName","value","expression","attrs","audio_output_deviceId","on","$event","setStream","hasFinishedLoading","show_capture_settings","enable_effects","$refs","videoElement","canvasElement","setImageData","show_effects_pane","media_to_validate","is_recording","is_making_stopmotion","delay_event","_e","available_modes","length","stopPropagation","preventDefault","previousMode","staticStyle","_l","mode","key","id","domProps","_q","selected_mode","$t","available_mode_picto","_v","_s","nextMode","is_validating_stopmotion_video","stream_sharing_informations_status","enabled","stream_access_informations_status","style","show_videos","ref","stream_type","stream","actual_camera_resolution","width","height","e","updateSelectedColor","type","last_frame_from_video","vecto_number_of_colors","lines_angle","lines_brightness","lines_contrast","lines_density","timer_recording_in_seconds","timelapse_mode_enabled","timelapse_event","modifiers","target","composing","timelapse_interval","_n","$forceUpdate","peers_connected","callee","delay_mode_enabled","toLowerCase","delay_seconds","delay_before_picture","time_before_next_picture","enable_grid","enable_video","grids","current_grid_type","index","x1","y1","x2","y2","must_validate_media","Object","keys","grid_type","validated_media_href_blob","temp_name","$root","formatBytes","rawData","size","read_only","can_add_to_fav","media_is_being_sent","media_being_sent_percent","cancelValidation","sendMedia","fav","video_recording_is_paused","is_sending_image","pauseOrResumeCapture","stopStopmotion","stopRecording","includes","setCaptureInit","publicPath","Array","isArray","enable_audio_recording_in_video","_i","$$a","$$el","$$c","checked","$$v","$$i","concat","slice","stopmotion","onion_skin_img","show_live_feed","onion_skin_opacity","$set","show_stopmotion_list","show_lines_settings","slugFolderName","loadStopmotion","staticRenderFns","objectURL","plyr_options","linkToVideoThumb","preview","updatePaused","play","props","components","data","is_paused","controls","iconUrl","created","mounted","beforeDestroy","watch","handler","computed","methods","setSinkId","component","selectedMoveLeft","selected_button","validateButton","selectedMoveRight","cancelButtonIsBackButton","default","document","captureKeyListener","console","evt","is_loading_available_devices","is_loading_feed","$emit","current_mode","status","refreshAvailableDevices","all_video_input_devices","selected_devices","$$selectedVal","prototype","filter","call","options","o","selected","map","val","_value","multiple","d","deviceId","label","video_input_device","advanced_capture_options","cursor","supported","all_audio_input_devices","echoCancellation","noiseSuppression","all_audio_output_devices","chromeMediaSource","predefined_resolutions","custom_camera_resolution","res","unavailable_camera_resolutions","desired_camera_resolution","ratio","access_distant_stream","indexOf","_k","keyCode","callStream","apply","arguments","trim","share_this_stream","setCameraStreamFromDefaults","calling","hangupStream","current_stream","local_stream","remote_stream","stream_current_settings","last_working_resolution","audio_input_device","audio_output_device","connected_devices","rtcmulti_connection","loading","navigator","getUserMedia","audio","video","then","catch","closeLogOnClick","delay","error","err","alert","deep","current_settings","_settings","listDevices","enumerateDevices","devices","setCurrentStream","setSupportedConstraints","supported_constraints","setDefaultInputsAndOutputs","devices_list","r","getDefaultDevice","startMediaDeviceFeed","processFeeds","getDisplayMedia","Promise","s","tracks","resolve","getDesktopCapturer","window","desktopCapturer","types","sources","kind","setTimeout","startLocalStream","createConstraintsFromSelected","_constraints","exact","undefined","mandatory","chromeMediaSourceId","setStreamSharing","participantId","userPreferences","newParticipantOnStream","success","onParticipantLeave","event","clearTimeout","initRTCMulti","urls","oneway","stopSharingStream","closeMultiRTC","enable","flip_horizontally","flip_vertically","chroma_key_settings","chroma_key_color_hex","setTogglePickColorFromVideo","enable_pick_color_from_video","replacement_mode","project_slug","newChromaKeyImage","chroma_key_replacement_color_hex","entries","image_filters_settings","min","max","step","ImageSelect","source_stream_resolution","key_color","g","b","similarity","smoothness","spill","replacement_color","replacement_image","brightness","order","contrast","hue","saturation","lightness","dotscreen","offscreen_canvas","fragment_shader","updated","get","set","hexToRgb","rgbToHex","pixelColorUnderMouse","px_color","startWebGL","premultipliedAlpha","gl","vs","prog","acc","keyColorLoc","replacementColorLoc","similarityLoc","parseFloat","smoothnessLoc","loc","chromaKeyMode","destination_canvas","stopWebGL","imageElement","ctx","canvas","img_ratio","coverImg","loadReplacementImageInShader","stopmotions","date_created","show_detail","values","medias","removeStopmotion","has_loaded_stopmotions_content","loadStopmotionMedias","mediasPreviewed","okBtn","cancelBtn","confirm","audio_activity","current_audio_level","current_audio_level_smoothed","current_draw_percentage","startEqualizer","drawVolume","bar_height","bar_pos","bar_width","clearCanvas","svgstr","number_of_colors","is_processing_image","vectoImage","ImageTracer","URL","colorsampling","numberofcolors","colorquantcycles","scale","strokewidth","blurradius","blurdelta","viewbox","svg_width","svg_height","line","angle","boost_brightness","boost_contrast","density","pixel_array","lines_array","p","posX","posY","drawBlobToImage","img","pos_x","pos_y","imgData","_pixel_array","x","y","t1","getImageDataFaster","i","arr","path","return_temp_media","MediaPreviewBeforeValidation","MediaValidationButtons","CaptureSettings","CaptureEffects","StopmotionList","AudioEqualizer","VectoMode","LinesMode","invisible_canvas","ask_before_leaving_capture","photo","vecto","lines","capture_button_pressed","mode_just_changed","current_stopmotion","halfs","thirds","fourths","recording_timer_interval","timelapse_start_time","delay_start_time","recorder","displayed_video_size","frameGrabber","update_last_video_imageData","getColorInCanvasFromPixelCount","videoWidth","videoHeight","offsetX","offsetY","getContext","getImageData","updateStreamSharing","updateDistantStream","refreshVideoActualSize","getVideoActualSize","wait_period_if_necessary","wait","checkCapturePanelSize","startFrameGrabber","getFrame","stopFrameGrabber","addStopmotionImage","linked_project","linked_type","authors","createFolder","addImageToStopmotion","createMedia","additionalMeta","closeStopmotionPanel","startDelay","cancelDelay","startTimelapseInterval","stopTimelapseInterval","setCapture","videoBitsPerSecond","querySelector","toDataURL","startTimer","Number","pauseTimer","unpauseTimer","eraseTimer","getImageDataFromFeed","from_element","_canvas","invisible_ctx","startRecordFeed","video_source","finalStream","getAudioTracks","forEach","Math","image","svg","extensions","formData","post","headers","onUploadProgress","updateSingleImage","___CSS_LOADER_EXPORT___","push","module","_this","versionnumber","imageToSVG","url","callback","checkoptions","loadImage","imagedataToSVG","getImgdata","imgd","td","imagedataToTracedata","getsvgstring","imageToTracedata","ii","colorquantization","layering","tracedata","layers","palette","array","colornum","tracedlayer","batchtracepaths","internodes","pathscan","layeringstep","pathomit","ltres","qtres","ls","layercontainerid","drawLayers","specpalette","bps","batchpathscan","bis","batchinternodes","batchtracelayers","optionpresets","corsenabled","rightangleenhance","mincolorratio","linefilter","roundcoords","desc","lcpr","qcpr","pal","a","ok","k","hasOwnProperty","cd","cdl","ci","j","cnt","idx","paletteacc","pixelnum","newimgddata","Uint8ClampedArray","pxcnt","generatepalette","samplepalette","samplepalette2","blur","n","floor","random","abs","ni","ceil","sqrt","nj","vx","vy","rcnt","gcnt","bcnt","graystep","colorqnum","pow","colorstep","rndnum","n1","n2","n3","n4","n5","n6","n7","n8","ah","aw","cnum","layer","pointinpoly","pa","isin","pathscan_combined_lookup","lookuprow","paths","pacnt","pcnt","px","py","w","h","dir","pathfinished","holepath","points","boundingbox","holechildren","t","pop","isholepath","parentidx","parentbbox","parentcnt","boundingboxincludes","childbbox","bpaths","ins","palen","nextidx","nextidx2","previdx","previdx2","testrightangle","linesegment","getdirection","idx1","idx2","idx3","idx4","idx5","binternodes","tracepath","segtype1","segtype2","seqend","smp","segments","fitseq","seqstart","dist2","errorpoint","errorval","curvepass","tl","pl","fitpoint","t2","t3","cpx","cpy","x3","y3","splitpoint","internodepaths","btracedpaths","btbis","roundtodec","places","toFixed","svgpathstring","lnum","pathnum","str","tosvgcolorstr","hcnt","hsmp","lcnt","compareNumbers","torgbastr","c","appendSVGString","parentid","div","getElementById","createElement","body","appendChild","innerHTML","gks","radius","delta","racc","gacc","bacc","aacc","wacc","imgd2","thisgk","himgd","Image","crossOrigin","onload","context","drawImage","src","fillStyle","fillRect","define","RecordRTC","mediaStream","config","RecordRTCConfiguration","self","startRecording","config2","disableLogs","log","version","mediaRecorder","clearRecordedData","record","setState","recordingDuration","handleRecordingDuration","initRecorder","initCallback","Recorder","GetRecorderType","constructor","state","resumeRecording","warn","stop","_callback","warningLog","__blob","blob","bytesToSize","createObjectURL","autoWriteToDisk","getDataURL","dataURL","parameter","DiskStorage","Store","pauseRecording","pause","resume","readFile","_blob","postMessage","FileReaderSync","readAsDataURL","_mediaRecorder","Worker","mozGetUserMedia","reader","FileReader","result","webWorker","processInWebWorker","onmessage","_function","Blob","toString","worker","revokeObjectURL","counter","onRecordingStopped","onStateChanged","WARNING","returnObject","setRecordingDuration","getBlob","toURL","getInternalRecorder","save","fileName","invokeSaveAsDialog","getFromDisk","setAdvertisementArray","arrayOfWebPImages","advertisement","duration","bufferSize","sampleRate","buffer","reset","getState","destroy","disableLogsCache","Storage","AudioContextConstructor","close","prop","recorderType","WhammyRecorder","CanvasRecorder","WebAssemblyRecorder","GifRecorder","StereoAudioRecorder","MediaStreamRecorder","getTracks","MediaRecorder","mimeType","split","bitsPerSecond","isChrome","isEdge","isOpera","ReadableStream","isMediaRecorderCompatible","isTypeSupported","MultiStreamRecorder","isSafari","MRecordRTC","addStream","_mediaStream","mediaType","gif","audioRecorder","numberOfAudioChannels","timeSlice","onTimeStamp","newStream","videoTrack","isFirefox","MediaStream","addTrack","videoRecorder","frameInterval","workerPath","webAssemblyPath","frameRate","bitrate","isSingleRecorder","gifRecorder","quality","blobURL","output","callback00","webkitURL","_audioDataURL","_videoDataURL","writeToDisk","args","exports","Fetch","_type","replace","audioDataURL","videoDataURL","gifDataURL","audioBlob","videoBlob","gifBlob","browserFakeUserAgent","that","global","userAgent","documentElement","captureStream","mozCaptureStream","obj","HTMLVideoElement","location","protocol","href","hash","screen","requestAnimationFrame","webkitRequestAnimationFrame","mozRequestAnimationFrame","msRequestAnimationFrame","lastTime","element","currTime","Date","getTime","timeToCall","cancelAnimationFrame","webkitCancelAnimationFrame","mozCancelAnimationFrame","msCancelAnimationFrame","AudioContext","webkitAudioContext","mozAudioContext","webkitGetUserMedia","msSaveBlob","msSaveOrOpenBlob","opera","test","isElectron","bytes","sizes","parseInt","toPrecision","file","fileExtension","splitted","fileFullName","round","hyperlink","download","click","dispatchEvent","MouseEvent","view","bubbles","cancelable","process","versions","electron","setSrcObject","srcObject","mozSrcObject","getSeekableBlob","inputBlob","EBML","Error","Reader","decoder","Decoder","tools","fileReader","ebmlElms","decode","read","refinedMetadataBuf","makeMetadataSeekable","metadatas","cues","metadataSize","newBlob","readAsArrayBuffer","webkitMediaStream","track","appVersion","verOffset","ix","nAgt","fullVersion","majorVersion","substring","isNaN","arrayOfBlobs","updateTimeStamp","timestamps","getMimeType","secondObject","clearRecordedDataCB","isMediaStreamActive","active","ended","getArrayOfBlobs","allStates","recorderHints","canRecordMimeType","ondataavailable","recordingCallback","getNativeBlob","onstart","onpause","onresume","onstop","onerror","looper","manuallyStopped","timeslice","start","getAllStates","checkForInactiveTracks","jsAudioNode","leftchannel","rightchannel","recording","recordingLength","desiredSampRate","mergeLeftRightBuffers","mergeAudioBuffers","cb","interleaved","leftBuffers","rightBuffers","internalInterleavedLength","interpolateArray","newSampleRate","oldSampleRate","fitCount","newData","springFactor","tmp","before","after","atPoint","linearInterpolate","mergeBuffers","channelBuffer","rLength","Float64Array","offset","lng","interleave","leftChannel","rightChannel","inputIndex","writeUTFBytes","string","setUint8","charCodeAt","interleavedLength","resultingBufferLength","ArrayBuffer","DataView","setUint32","setUint16","volume","setInt16","noWorker","workerURL","terminate","resetVariables","isAudioProcessStarted","isPaused","byteLength","audioInput","createMediaStreamSource","legalBufferValues","JSON","stringify","createJavaScriptNode","createScriptProcessor","connect","intervalsBasedBuffers","left","right","onaudioprocess","disconnect","onAudioProcessDataAvailable","onAudioProcessStarted","inputBuffer","getChannelData","chLeft","Float32Array","chRight","createMediaStreamDestination","destination","htmlElement","html2canvas","isCanvasSupportsStreamCapturing","item","globalCanvas","mediaStreamRecorder","isRecording","_isChrome","webkitRTCPeerConnection","chrome","chromeVersion","matchArray","match","useWhammyRecorder","HTMLCanvasElement","CanvasRenderingContext2D","canvasMediaStream","webkitCaptureStream","mdStream","whammy","frames","drawCanvasFrame","getWebPImages","nodeName","framesLength","frame","framesRemaining","onEncodingCallback","webp","compile","isPausedRecording","cloneCanvas","newCanvas","grabMouse","showMousePointer","onrendered","Whammy","Video","drawFrames","paused","isStopDrawing","asyncLoop","loop","functionToLoop","dropBlackFrames","_frames","_framesToCheck","_pixTolerance","_frameTolerance","localCanvas","context2d","resultFrames","checkUntilNotBlack","endCheckFrame","sampleColor","maxColorDifference","pixTolerance","frameTolerance","doNotCheckNext","f","matchPixCount","endPixCheck","maxPixCount","finishImage","imageData","pix","currentColor","colorDifference","cloneNode","onloadedmetadata","muted","WhammyVideo","whammyInWebWorker","ArrayToWebM","info","checkFrames","clusterMaxDuration","doubleToString","frameNumber","clusterTimecode","clusterFrames","clusterDuration","clusterCounter","cluster","getClusterData","generateEBML","block","makeSimpleBlock","discardable","invisible","keyframe","lacing","trackNum","timecode","numToBuffer","num","parts","Uint8Array","reverse","strToBuffer","bitsToBuffer","bits","pad","join","substr","json","ebml","len","zeroes","sizeToString","padded","flags","out","String","fromCharCode","parseWebP","riff","VP8","RIFF","WEBP","frameStart","getStrLength","unpadded","parseRIFF","chunks","webm","atob","add","init","indexedDB","open","db","dbVersion","dbName","request","onError","onsuccess","setVersion","createObjectStore","putInDB","onupgradeneeded","dataBase","dataStoreName","transaction","getFromStore","portionName","objectStore","put","GIFEncoder","script","isHTMLObject","drawVideoFrame","time","clearedRecordedData","lastAnimationFrame","lastFrameTime","onGifPreview","gifEncoder","addFrame","isLoadedMetaData","offsetWidth","offsetHeight","setRepeat","setDelay","setQuality","onGifRecordingStarted","now","bin","autoplay","playsInline","MultiStreamsMixer","arrayOfMediaStreams","elementClass","videos","isStopDrawingFrames","opacity","position","zIndex","top","className","useGainNode","drawVideosToCanvas","videosLength","fullcanvas","remaining","onRender","getMixedStream","mixedVideoStream","getMixedVideoStream","mixedAudioStream","getMixedAudioStream","capturedStream","resetVideoStreams","videoStream","audioContext","audioSources","gainNode","createGain","gain","audioTracksLength","audioSource","audioDestination","getVideo","streams","startDrawingFrames","appendStreams","releaseStreams","source","clearRect","mixer","getAllVideoTracks","previewStream","addStreams","getMixer","RecordRTCPromisesHandler","recordRTC","reject","finished","cameraStream","controller","cvs","first","onplaying","frameTimeout","cameraTimer","setInterval","clearInterval","onVideoProcessStarted","_controlledReadableStream","enqueue","fetch","arrayBuffer","addEventListener","timebaseDen","realtime","pipeTo","WritableStream","write","arrayOfBuffers","RTCMultiConnection","roomid","forceOptions","SocketConnection","connection","connectCallback","isData","session","parameters","userid","sessionid","socketMessageEvent","socketCustomEvent","autoCloseEntireSession","broadcast","maxParticipantsAllowed","enableScalableBroadcast","maxRelayLimitPerUser","extra","socketCustomParameters","io","sockets","socketURL","enableLogs","origin","socket","socketOptions","mPeer","multiPeersHandler","updateExtraBackup","remoteUserId","peersBackup","onMessageEvent","message","peers","sender","onExtraDataUpdated","streamSyncNeeded","streamEvents","streamid","action","onstreamended","allParticipants","participant","localPeerSdpConstraints","OfferToReceiveAudio","sdpConstraints","OfferToReceiveVideo","remotePeerSdpConstraints","isOneWay","direction","isDataOnly","newParticipant","createNewPeer","readyForOffer","attachStreams","waitingForLocalMedia","newParticipationRequest","deletePeer","dontGetRemoteStream","dontAttachLocalStream","connectionDescription","successCallback","onNewParticipant","changedUUID","oldUUID","newUUID","userLeft","onUserLeft","leave","addNegotiatedMessage","alreadyConnected","resetProps","emit","onSocketDisconnect","onSocketError","onUserStatusChanged","onEntireSessionClosed","useridAlreadyTaken","yourNewUserId","onUserIdAlreadyTaken","debug","onNumberOfBroadcastViewersUpdated","isInitiator","MultiPeers","skipPeers","initFileBufferReader","fbr","FileBufferReader","onProgress","chunk","onFileProgress","onBegin","onFileStart","onEnd","onFileEnd","getLength","numberOfPeers","peer","selectFirst","firstPeer","getAllParticipants","allPeers","send","isNull","enableFileSharing","shareFile","remoteUser","channels","channel","createDataChannel","renegotiate","TextSender","text","uuid","getLocalConfig","remoteSdp","streamsToShare","rtcMultiConnection","renegotiatingPeer","peerRef","onLocalSdp","localSdp","onNegotiationNeeded","onLocalCandidate","localCandidate","OnIceCandidateHandler","processCandidates","onDataChannelMessage","convertToObject","object","readyForNextChunk","getNextChunk","nextChunk","isLastChunk","chunkMissing","addChunk","promptNextChunk","onDataChannelError","onDataChannelOpened","onDataChannelClosed","onRemoteStream","onGettingRemoteMedia","onRemoteStreamRemoved","onRemovingRemoteMedia","onPeerStateChanged","states","iceConnectionState","onNegotiationStarted","onNegotiationCompleted","search","disconnectWith","enableMedia","setUserPreferences","localConfig","PeerInitiator","createAnsweringPeer","renegotiatePeer","replaceTrack","isVideoTrack","getSenders","rtpSender","lastVideoTrack","lastAudioTrack","sdp","addRemoteSdp","candidate","addRemoteCandidate","isAudio","isVideo","isScreen","onReadyForOffer","onGettingLocalMedia","localStream","onLocalMediaError","constraints","onMediaError","arrayOfUsers","chunkSize","DetectRTC","browser","textReceiver","TextReceiver","receive","parse","onclose","onopen","getRemoteStreams","fireEvent","eventName","CustomEvent","eventDetail","__exposedProps__","setHarkEvents","streamEvent","onspeaking","onsilence","hark","onvolumechange","threshold","merge","setMuteHandlers","muteType","onmute","unmuteType","onunmute","getRandomString","crypto","getRandomValues","Uint32Array","token","l","getRMCMediaElement","autoCreateMediaElement","isAudioOnly","mediaElement","setAttribute","streamEndedEvent","currentUserMediaRequest","remove","idInstance","StreamsHandler","onSyncNeeded","aStream","newStreamsArray","parentNode","removeChild","played","cbFired","listenEventHandler","eventHandler","removeEventListener","removeNullEntries","newArray","isString","HTMLMediaElement","isNodejs","node","isMobileDevice","InstallTrigger","isIE","documentMode","getBrowserInfo","nameOffset","browserName","appName","lastIndexOf","toUpperCase","isPrivateBrowsing","retry","isDone","next","currentTrial","maxRetry","isTimeout","isIE10OrLater","ua","exec","detectPrivateMode","isPrivate","webkitRequestFileSystem","TEMPORARY","readyState","localStorage","setItem","removeItem","isMobile","Android","BlackBerry","iOS","Opera","Windows","any","getOsName","osName","detectDesktopOS","cs","unknown","nVer","os","clientStrings","osVersion","getAndroidVersion","osInfo","isVideoSupportsStreamCapturing","regexIpv4Local","regexIpv4","regexIpv6","DetectLocalIPAddress","isWebRTCSupported","isPublic","isIpv4","getIPs","ip","ipDuplicates","RTCPeerConnection","mozRTCPeerConnection","iframe","win","contentWindow","peerConfig","optional","RtpDataChannels","servers","iceServers","pc","onicecandidate","handleCandidate","isPromisesSupported","createOffer","setLocalDescription","afterCreateOffer","ipAddress","localDescription","MediaDevices","audioInputDevices","audioOutputDevices","videoInputDevices","mediaDevices","canEnumerate","MediaStreamTrack","hasMicrophone","hasSpeakers","hasWebcam","isWebsiteHasMicrophonePermissions","isWebsiteHasWebcamPermissions","checkDeviceSupport","getSources","bind","alreadyUsedDevices","_device","device","isCustomLabel","domain","isORTCSupported","RTCIceGatherer","isScreenCapturingSupported","isNonLocalHost","webAudio","isSupported","isCreateMediaStreamSourceSupported","isAudioContextSupported","isRtpDataChannelsSupported","isSCTPSupportd","isSctpDataChannelsSupported","isGetUserMediaSupported","displayResolution","getAspectRatio","gcd","displayAspectRatio","isWebSocketsSupported","WebSocket","CLOSING","isWebSocketsBlocked","checkWebSocketsSupport","starttime","websocket","WebsocketLatency","load","isSetSinkIdSupported","isRTPSenderReplaceTracksSupported","isRemoteStreamProcessingSupported","isApplyConstraintsSupported","isMultiMonitorScreenCapturingSupported","cordova","el","attachEvent","attachEventListener","listener","useCapture","isAudioPlusTab","audioPlusTab","isUnifiedPlanSupportedDefault","canAddTransceiver","RTCRtpTransceiver","tempPc","addTransceiver","isUnifiedPlanSuppored","isUnifiedPlanSupported","sdpSemantics","getConfiguration","setCordovaAPIs","plugins","iosrtc","RTCSessionDescription","RTCIceCandidate","selectAudioOutput","iOSDefaultAudioOutputDevice","registerGlobals","defaults","setSdpConstraints","mozRTCSessionDescription","mozRTCIceCandidate","removeStream","allRemoteStreams","localStreams","iceTransports","candidates","turn","relay","stun","reflexive","host","params","iceTransportPolicy","iceCandidatePoolSize","bundlePolicy","rtcpMuxPolicy","optionalArgument","getReceivers","receiver","getLocalStreams","trickleIce","sdpMid","sdpMLineIndex","beforeAddingStream","oniceconnectionstatechange","onsignalingstatechange","iceGatheringState","signalingState","dontDuplicate","ontrack","onended","onremovestream","streamToShare","onremovetrack","removeTrack","remoteCandidate","addIceCandidate","processSdp","setRemoteDescription","isOfferer","setChannelEvents","binaryType","internalSend","ondatachannel","enableDisableVideoEncoding","rtcp","getParameters","encodings","setParameters","createOfferOrAnswer","_method","onSettingLocalDescription","nativeClose","CodecsHandler","preferCodec","codecName","splitLines","videoCodecNumbers","vp8LineNumber","vp9LineNumber","h264LineNumber","preferCodecHelper","codec","ignore","preferCodecNumber","newLine","videoCodecNumbersOriginal","newOrder","codecNumber","removeVPX","disableNACK","prioritize","codecMimeType","codecs","unshift","splice","removeNonG722","setBAS","bandwidth","findLine","sdpLines","prefix","findLineInRange","startLine","endLine","realEndLine","getCodecPayloadType","sdpLine","pattern","RegExp","setVideoBitrates","vp8Payload","xgoogle_min_bitrate","xgoogle_max_bitrate","vp8Index","rtxPayload","rtxIndex","rtxFmtpLineIndex","appendrtxNext","setOpusAttributes","opusPayload","opusIndex","opusFmtpLineIndex","appendOpusNext","stereo","maxaveragebitrate","maxplaybackrate","cbr","useinbandfec","usedtx","maxptime","forceStereoAudio","fmtpLineIndex","extractSdp","payload","setApplicationSpecificBandwidth","preferVP9","BandwidthHandler","icePair","iceRestrictions","iceProtocols","udp","tcp","IceServersHandler","getIceServers","setStreamType","mozMediaSource","mediaSource","getUserMediaHandler","mutex","localMediaConstraints","streaming","isBlackBerry","getUserMediaStream","getUserMediaError","getUserMediaFailure","hints","getUserMediaSuccess","successCB","failureCB","queueRequests","returnBack","shift","currentUserMediaRequestOptions","handleType","setHandlers","syncAction","mute","isSyncAction","isAudioMuted","unmute","graduallyIncreaseVolume","times","afterEach","setTimeoutInteval","numberOfTimes","startedTimes","content","last","isobject","receivingTime","latency","sendingTime","autoTranslateText","original","Translator","TranslateText","translatedText","initialText","packetSize","textToTransfer","sendText","textMessage","packets","chunkInterval","FileProgressBarHandler","handle","progressHelper","updateLabel","progress","title","filesContainer","insertBefore","firstChild","maxChunks","helper","currentPosition","TranslationHandler","language","googKey","newScript","sourceText","encodeURIComponent","randomNumber","response","translations","getElementsByTagName","getListOfLanguages","xhr","XMLHttpRequest","onreadystatechange","DONE","responseText","languages","useDefaultDevices","preventDuplicateOnStreamEvents","connectSocket","socketAutoReConnect","FirebaseConnection","PubNubConnection","joinRoom","mediaConstraints","getStreamInfoForAdmin","password","isRoomJoined","openRoom","identifier","publicRoomIdentifier","isRoomOpened","selectAll","beforeJoin","dontCaptureUserMedia","invokeGetUserMedia","applyConstraints","setStreamEndHandler","onstream","messageToDeliver","openOrJoin","checkPresence","isRoomExist","captureUserMedia","eventObject","onleave","rejoin","onReConnecting","sessionForced","nonScreenSession","onbeforeunload","arg1","dontCloseSocket","closeBeforeUnload","closeSocket","ignoreBeforeUnload","changeUserId","newUserId","facingMode","lastAudioDevice","lastVideoDevice","sourceId","VoiceActivityDetection","DtlsSrtpKeyAgreement","googImprovedWifiBwe","googScreencastMinBitrate","googIPv6","googDscp","googCpuUnderuseThreshold","googCpuOveruseThreshold","googSuspendBelowMinBitrate","googCpuOveruseDetection","closeEntireSession","videosContainer","user","gumCallback","streamCallback","videoConstraints","resetTrack","remoteUsersIds","isRemote","alreadySetEndHandler","acceptParticipationRequest","invokeSelectFileDialog","selector","FileSelector","accept","selectSingleFile","poster","snapshot","getSocket","skipStreams","local","remote","setCustomSocketEvent","customEvent","getNumberOfBroadcastViewers","broadcastId","numberOfBroadcastViewers","dontWriteLogs","setCustomSocketHandler","customSocketHandler","_roomid","SSEConnection","dontAttachStream","updateExtraData","beforeRemovingStream","isChromeExtensionAvailable","checkIfChromeExtensionAvailable","isFirefoxExtensionAvailable","getChromeExtensionStatus","modifyScreenConstraints","screen_constraints","isOnline","isLowBandwidth","opt","getExtraData","autoOpenOrJoin","resetScreen","setPassword","errors","ROOM_NOT_AVAILABLE","INVALID_PASSWORD","USERID_NOT_AVAILABLE","ROOM_PERMISSION_DENIED","ROOM_FULL","DID_NOT_JOIN_ANY_ROOM","INVALID_SOCKET","PUBLIC_IDENTIFIER_MISSING","INVALID_ADMIN_CREDENTIAL","MediaStreamAudioSourceNode","AnalyserNode","ScriptProcessorNode","media","analyser","createAnalyser","processor","smoothingTimeConstant","fftSize","sum","frequencyBinCount","getByteFrequencyData","__esModule","locals"],"sourceRoot":""}