{"version":3,"file":"js/PublicationView.js","mappings":"mJAAA,IAAIA,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACE,YAAY,mBAAmBC,MAAM,CAC3I,wBAAyBP,EAAIQ,uBAC5B,CAACJ,EAAG,QAAQ,CAACK,IAAI,aAAa,CAACT,EAAIU,GAAG,IAAIV,EAAIW,GAAGX,EAAIY,mBAAmB,OAAOR,EAAG,aAAa,CAACS,MAAM,CAAC,KAAO,YAAY,KAAO,WAAW,CAAEb,EAAIc,MAAgB,WAAEV,EAAG,MAAM,CAACW,IAAI,SAAST,YAAY,iBAAiB,CAACF,EAAG,kBAAkB,GAAGA,EAAG,MAAM,CAACW,IAAI,cAAcC,IAAI,eAAe,CAA+B,wBAA7BhB,EAAIiB,YAAYC,SAAoCd,EAAG,MAAM,CAACA,EAAG,mBAAmB,CAACS,MAAM,CAAC,YAAcb,EAAIiB,gBAAgB,GAAGjB,EAAImB,UAAU,IAClbC,EAAkB,G,UCoDtB,GACAC,MAAAA,GACAC,WAAAA,CAMAC,iBAAAA,IACA,gCAIAC,OACA,OACAC,QAAAA,KACAR,YAAAA,KAEAS,eAAAA,EACAlB,sBAAAA,IAGAmB,UACAC,QAAAA,IAAAA,4BAEA,gBACA,2CACA,8BAEA,iCACAC,gBAAAA,CACAC,KAAAA,KAAAA,mBAEAC,OAAAA,IACA,wCACA,4BAOA,0BAEAC,kBAIAC,MAAAA,CACAP,mBAMAQ,SAAAA,CACAC,eACA,wBACAC,WAAAA,KAAAA,OAAAA,OAAAA,WACAC,aAAAA,KAAAA,OAAAA,OAAAA,gBAGAC,mBACA,kFAEA1B,oBACA,SAGA,OAFA,+DACA2B,EAAAA,GACA,oCAEkBA,0BAKlBC,QAAAA,CACA,qBACA,oCACA,sBACAC,EAAAA,EAAAA,UAAAA,KACA,8CAGA,sBACA,WACA,uBAEA,iBACA,kCACA,iBCjJ2Q,I,8BCSvQC,GAAY,OACd,EACA3C,EACAqB,GACA,EACA,KACA,WACA,MAIF,EAAesB,EAAiB,S,qFCjB5BC,EAA0B,IAA4B,KAE1DA,EAAwBC,KAAK,CAACC,EAAOC,GAAI,sDAAuD,KAEhG,gB,qFCJIH,EAA0B,IAA4B,KAE1DA,EAAwBC,KAAK,CAACC,EAAOC,GAAI,qUAAsU,KAE/W,gB,sBCJA,IAAIC,EAAU,EAAQ,OACnBA,EAAQC,aAAYD,EAAUA,EAAQE,SACnB,kBAAZF,IAAsBA,EAAU,CAAC,CAACF,EAAOC,GAAIC,EAAS,MAC7DA,EAAQG,SAAQL,EAAOM,QAAUJ,EAAQG,QAE5C,IAAIE,EAAM,WACGA,EAAI,WAAYL,GAAS,EAAM,CAAC,WAAY,EAAM,YAAa,K,sBCN5E,IAAIA,EAAU,EAAQ,OACnBA,EAAQC,aAAYD,EAAUA,EAAQE,SACnB,kBAAZF,IAAsBA,EAAU,CAAC,CAACF,EAAOC,GAAIC,EAAS,MAC7DA,EAAQG,SAAQL,EAAOM,QAAUJ,EAAQG,QAE5C,IAAIE,EAAM,WACGA,EAAI,WAAYL,GAAS,EAAM,CAAC,WAAY,EAAM,YAAa","sources":["webpack://app/./src/views/PublicationView.vue?35cf","webpack://app/src/views/PublicationView.vue","webpack://app/./src/views/PublicationView.vue?d192","webpack://app/./src/views/PublicationView.vue","webpack://app/./src/views/PublicationView.vue?dd10","webpack://app/./src/views/PublicationView.vue?59f1","webpack://app/./src/views/PublicationView.vue?5398","webpack://app/./src/views/PublicationView.vue?cf9f"],"sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"_publicationView\",class:{\n    'is--serversidepreview': _vm.is_serversidepreview,\n  }},[_c('style',{tag:\"component\"},[_vm._v(\" \"+_vm._s(_vm.set_print_margins)+\" \")]),_c('transition',{attrs:{\"name\":\"fade_fast\",\"mode\":\"out-in\"}},[(_vm.$root.is_loading)?_c('div',{key:\"loader\",staticClass:\"u-divCentered\"},[_c('LoaderSpinner')],1):_c('div',{key:\"publication\",ref:\"fsContainer\"},[(_vm.publication.template === 'story_with_sections')?_c('div',[_c('SectionWithPrint',{attrs:{\"publication\":_vm.publication}})],1):_vm._e()])])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div\n    class=\"_publicationView\"\n    :class=\"{\n      'is--serversidepreview': is_serversidepreview,\n    }\"\n  >\n    <component :is=\"'style'\">\n      {{ set_print_margins }}\n    </component>\n    <transition name=\"fade_fast\" mode=\"out-in\">\n      <div class=\"u-divCentered\" v-if=\"$root.is_loading\" key=\"loader\">\n        <LoaderSpinner />\n      </div>\n      <div v-else key=\"publication\" ref=\"fsContainer\">\n        <!-- <div\n          class=\"_pubTopbar\"\n          v-if=\"!is_serversidepreview && !is_fullscreen && false\"\n        >\n          <PublicationTopbar\n            :publication=\"publication\"\n            :no_back_button=\"true\"\n            :can_edit=\"false\"\n          />\n        </div> -->\n        <!-- <template v-if=\"publication.template === 'page_by_page'\">\n          <PageSlides\n            :publication=\"publication\"\n            :is_serversidepreview=\"is_serversidepreview\"\n            @toggleFs=\"toggleFs\"\n          />\n        </template>\n        <div v-else-if=\"publication.template === 'story'\">\n          <StoryTemplate\n            class=\"_storyTemplate\"\n            :publication=\"publication\"\n            :can_edit=\"false\"\n          />\n        </div> -->\n        <div v-if=\"publication.template === 'story_with_sections'\">\n          <SectionWithPrint :publication=\"publication\" />\n        </div>\n        <!-- <div v-else-if=\"publication.template === 'cartography'\">\n          <MapForPrint :publication=\"publication\" />\n        </div> -->\n      </div>\n    </transition>\n  </div>\n</template>\n\n<script>\nimport screenfull from \"screenfull\";\n\n// import PublicationTopbar from \"@/components/publications/PublicationTopbar.vue\";\n\nexport default {\n  props: {},\n  components: {\n    // PublicationTopbar,\n    // PageSlides: () =>\n    //   import(\"@/components/publications/page_by_page/PageSlides.vue\"),\n    // StoryTemplate: () =>\n    //   import(\"@/components/publications/templates/StoryTemplate.vue\"),\n    SectionWithPrint: () =>\n      import(\"@/components/publications/story/SectionWithPrint.vue\"),\n    // MapForPrint: () =>\n    //   import(\"@/components/publications/cartography/MapForPrint.vue\"),\n  },\n  data() {\n    return {\n      project: null,\n      publication: null,\n\n      is_fullscreen: false,\n      is_serversidepreview: false,\n    };\n  },\n  created() {\n    console.log(\"Loading PublicationView\");\n  },\n  async mounted() {\n    if (this.$route.query?.make_preview === \"true\")\n      this.is_serversidepreview = true;\n\n    this.publication = await this.$api\n      .getPublicFolder({\n        path: this.publication_path,\n      })\n      .catch((err) => {\n        this.fetch_publication_error = err.response;\n        this.$root.is_loading = false;\n      });\n\n    // not pushing changes to presentation for performance reasons â€“ though this could be useful at some point?\n    // this.$api.join({ room: this.project.$path });\n    // this.$api.join({ room: this.publication_path });\n\n    this.$root.is_loading = false;\n  },\n  beforeDestroy() {\n    // this.$api.leave({ room: this.project.$path });\n    // this.$api.leave({ room: this.publication_path });\n  },\n  watch: {\n    is_fullscreen() {\n      // this.$nextTick(() => {\n      // this.fitZoomToPage();\n      // });\n    },\n  },\n  computed: {\n    project_path() {\n      return this.createPath({\n        space_slug: this.$route.params.space_slug,\n        project_slug: this.$route.params.project_slug,\n      });\n    },\n    publication_path() {\n      return `${this.project_path}/publications/${this.$route.params.publication_slug}`;\n    },\n    set_print_margins() {\n      let margins = 15;\n      if (this.publication && this.publication.template === \"page_by_page\")\n        margins = 0;\n      return `\n      @page {\n        margin: ${margins}mm;\n      }\n      `;\n    },\n  },\n  methods: {\n    async openFs() {\n      await screenfull.request(this.$refs.fsContainer);\n      this.is_fullscreen = true;\n      screenfull.onchange(() => {\n        if (!screenfull.isFullscreen) this.is_fullscreen = false;\n      });\n    },\n    async closeFs() {\n      await screenfull.exit();\n      this.is_fullscreen = false;\n    },\n    async toggleFs() {\n      if (this.is_fullscreen) this.closeFs();\n      else this.openFs();\n    },\n  },\n};\n</script>\n<style lang=\"scss\" scoped>\n._publicationView {\n  background: white;\n}\n</style>\n<style lang=\"scss\">\n.alertify-logs {\n  display: none !important;\n}\nhtml,\nbody {\n  @media print {\n    background: white !important;\n  }\n}\n._storyTemplate {\n  padding: calc(var(--spacing) / 1);\n}\n\n._pubTopbar ._topbar {\n  margin: var(--spacing) auto;\n}\n\n._pubTopbar {\n  margin: 0 auto;\n  max-width: 86ch;\n\n  @media print {\n    display: none;\n  }\n}\n._sectionsSummary {\n  @media print {\n    display: none;\n  }\n}\n._storyContent {\n  @media print {\n    box-shadow: none !important;\n  }\n}\n</style>\n","import mod from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-37[0].rules[0].use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./PublicationView.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-37[0].rules[0].use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./PublicationView.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./PublicationView.vue?vue&type=template&id=68cf1e64&scoped=true&\"\nimport script from \"./PublicationView.vue?vue&type=script&lang=js&\"\nexport * from \"./PublicationView.vue?vue&type=script&lang=js&\"\nimport style0 from \"./PublicationView.vue?vue&type=style&index=0&id=68cf1e64&lang=scss&scoped=true&\"\nimport style1 from \"./PublicationView.vue?vue&type=style&index=1&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"68cf1e64\",\n  null\n  \n)\n\nexport default component.exports","// Imports\nimport ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/noSourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \"._publicationView[data-v-68cf1e64]{background:#fff}\", \"\"]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/noSourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".alertify-logs{display:none!important}@media print{body,html{background:#fff!important}}._storyTemplate{padding:calc(var(--spacing)/1)}._pubTopbar ._topbar{margin:var(--spacing) auto}._pubTopbar{margin:0 auto;max-width:86ch}@media print{._pubTopbar,._sectionsSummary{display:none}._storyContent{box-shadow:none!important}}\", \"\"]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../node_modules/css-loader/dist/cjs.js??clonedRuleSet-19[0].rules[0].use[1]!../../node_modules/@vue/vue-loader-v15/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-19[0].rules[0].use[2]!../../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-19[0].rules[0].use[3]!../../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-19[0].rules[0].use[4]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./PublicationView.vue?vue&type=style&index=0&id=68cf1e64&lang=scss&scoped=true&\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"69f021f7\", content, true, {\"sourceMap\":false,\"shadowMode\":false});","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../node_modules/css-loader/dist/cjs.js??clonedRuleSet-19[0].rules[0].use[1]!../../node_modules/@vue/vue-loader-v15/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-19[0].rules[0].use[2]!../../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-19[0].rules[0].use[3]!../../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-19[0].rules[0].use[4]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./PublicationView.vue?vue&type=style&index=1&lang=scss&\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"0a781bbe\", content, true, {\"sourceMap\":false,\"shadowMode\":false});"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","class","is_serversidepreview","tag","_v","_s","set_print_margins","attrs","$root","key","ref","publication","template","_e","staticRenderFns","props","components","SectionWithPrint","data","project","is_fullscreen","created","console","getPublicFolder","path","catch","beforeDestroy","watch","computed","project_path","space_slug","project_slug","publication_path","margins","methods","screenfull","component","___CSS_LOADER_EXPORT___","push","module","id","content","__esModule","default","locals","exports","add"],"sourceRoot":""}