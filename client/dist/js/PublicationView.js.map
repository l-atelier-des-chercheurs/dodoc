{"version":3,"file":"js/PublicationView.js","mappings":"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","sources":["webpack://app/./src/components/publications/PublicationTopbar.vue?ae8e","webpack://app/./src/components/publications/DuplicatePublication.vue?a3f6","webpack://app/src/components/publications/DuplicatePublication.vue","webpack://app/./src/components/publications/DuplicatePublication.vue?da85","webpack://app/./src/components/publications/DuplicatePublication.vue","webpack://app/src/components/publications/PublicationTopbar.vue","webpack://app/./src/components/publications/PublicationTopbar.vue?9024","webpack://app/./src/components/publications/PublicationTopbar.vue","webpack://app/./src/views/PublicationView.vue?5422","webpack://app/src/views/PublicationView.vue","webpack://app/./src/views/PublicationView.vue?d192","webpack://app/./src/views/PublicationView.vue","webpack://app/./src/components/publications/PublicationTopbar.vue?23b3","webpack://app/./src/views/PublicationView.vue?5116","webpack://app/./src/components/publications/PublicationTopbar.vue?ce8e","webpack://app/./src/views/PublicationView.vue?ba11"],"sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"_topbar\"},[(_vm.no_back_button !== true)?_c('button',{staticClass:\"u-button u-button_icon _backPubli\",attrs:{\"type\":\"button\"},on:{\"click\":function($event){return _vm.$emit('close')}}},[_c('b-icon',{attrs:{\"icon\":\"arrow-left-circle-fill\",\"aria-label\":_vm.$t('back_to_publications')}})],1):_vm._e(),_c('div',{staticClass:\"_publiTitle\"},[_c('TitleField',{attrs:{\"field_name\":'title',\"tag\":'h2',\"maxlength\":40,\"required\":true,\"content\":_vm.publication.title,\"path\":_vm.publication.$path,\"can_edit\":_vm.can_edit}})],1),(_vm.can_edit)?_c('StatusTag',{attrs:{\"status\":_vm.publication.$status || 'public',\"status_options\":['public', 'private'],\"path\":_vm.publication.$path,\"can_edit\":_vm.can_edit}}):_vm._e(),_c('div',{staticClass:\"_buttonRow\"},[(_vm.can_edit && _vm.publication.$admins !== 'parent_contributors')?_c('div',{},[_c('small',[_c('button',{staticClass:\"u-buttonLink\",attrs:{\"type\":\"button\"},on:{\"click\":_vm.setCorrectPermForAdmins}},[_vm._v(\" set perm to parent \")]),_vm._v(\" \"+_vm._s(_vm.publication.$admins)+\" \")])]):_vm._e(),(_vm.can_edit && _vm.publication.template !== 'cartography')?_c('sl-button',{attrs:{\"caret\":\"\"},on:{\"click\":_vm.openSettings}},[_c('b-icon',{attrs:{\"slot\":\"prefix\",\"icon\":\"gear\",\"aria-label\":_vm.$t('settings')},slot:\"prefix\"}),_vm._v(\" \"+_vm._s(_vm.$t(\"settings\"))+\" \")],1):_vm._e(),(_vm.can_edit)?_c('sl-dropdown',{on:{\"sl-show\":_vm.closeSettings}},[_c('sl-button',{attrs:{\"slot\":\"trigger\",\"caret\":\"\"},slot:\"trigger\"},[_vm._v(\" \"+_vm._s(_vm.$t(\"options\"))+\" \")]),_c('sl-menu',[_c('sl-menu-item',[_c('DuplicatePublication',{attrs:{\"path\":_vm.publication.$path,\"source_title\":_vm.publication.title,\"publication\":_vm.publication},on:{\"close\":function($event){return _vm.$emit('close')}}})],1),_c('sl-menu-item',[_c('RemoveMenu',{attrs:{\"remove_text\":_vm.$t('remove')},on:{\"remove\":_vm.removePublication}})],1)],1)],1):_vm._e(),_c('sl-dropdown',{on:{\"sl-show\":_vm.closeSettings}},[_c('sl-button',{attrs:{\"slot\":\"trigger\",\"caret\":\"\"},slot:\"trigger\"},[_c('b-icon',{attrs:{\"slot\":\"prefix\",\"icon\":\"box-arrow-up-right\"},slot:\"prefix\"}),_vm._v(\" \"+_vm._s(_vm.$t(\"share\"))+\" \")],1),_c('sl-menu',[_c('sl-menu-item',[_c('button',{staticClass:\"u-buttonLink _exportBtn\",attrs:{\"type\":\"button\",\"disabled\":!_vm.can_edit || _vm.is_exporting},on:{\"click\":_vm.exportPublication}},[_c('sl-icon',{attrs:{\"name\":\"filetype-pdf\"}}),_vm._v(\" \"+_vm._s(_vm.$t(\"export_in_pdf\"))+\" \"),_c('transition',{attrs:{\"name\":\"fade_fast\",\"duration\":150,\"mode\":\"out-in\"}},[(_vm.is_exporting)?_c('LoaderSpinner'):_vm._e()],1)],1)]),_c('sl-menu-item',[_c('button',{staticClass:\"u-buttonLink\",attrs:{\"type\":\"button\"},on:{\"click\":function($event){_vm.show_qr_code_modal = true}}},[_c('sl-icon',{attrs:{\"name\":\"qr-code\"}}),_vm._v(\" \"+_vm._s(_vm.$t(\"direct_link\"))+\" \")],1),(_vm.show_qr_code_modal)?_c('QRModal',{attrs:{\"url_to_access\":_vm.share_url},on:{\"close\":function($event){_vm.show_qr_code_modal = false}}}):_vm._e()],1)],1)],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('button',{staticClass:\"u-buttonLink\",attrs:{\"type\":\"button\"},on:{\"click\":function($event){_vm.show_modal = true}}},[_c('sl-icon',{attrs:{\"name\":\"file-plus\"}}),_vm._v(\" \"+_vm._s(_vm.$t(\"duplicate_or_move\"))+\" \")],1),(_vm.show_modal)?_c('BaseModal2',{attrs:{\"title\":_vm.$t('duplicate_or_move')},on:{\"close\":function($event){_vm.show_modal = false}}},[(!_vm.navigation_to_copy)?[_c('div',{staticClass:\"u-spacingBottom\"},[_c('div',{staticClass:\"u-instructions\"},[_c('small',[_vm._v(\" \"+_vm._s(_vm.$t(\"dmp_instr\"))+\" \")])]),_c('br'),_c('SpaceProjectPicker',{staticClass:\"u-spacingBottom\",attrs:{\"path\":_vm.path},on:{\"newProjectSelected\":function($event){_vm.destination_project_path = $event}}}),_c('div',{staticClass:\"u-spacingBottom\"},[_c('DLabel',{attrs:{\"str\":_vm.$t('title_of_copy')}}),_c('TextInput',{ref:\"titleInput\",attrs:{\"content\":_vm.new_title,\"maxlength\":40,\"required\":true},on:{\"update:content\":function($event){_vm.new_title=$event}}})],1),_c('div',{},[_c('ToggleInput',{attrs:{\"content\":_vm.remove_original,\"label\":_vm.$t('remove_original'),\"options\":{\n              true: _vm.$t('remove_original_after_copy'),\n              false: _vm.$t('keep_original_after_copy'),\n            }},on:{\"update:content\":function($event){_vm.remove_original=$event}}})],1)],1),_c('div',{staticClass:\"u-sameRow\",attrs:{\"slot\":\"footer\"},slot:\"footer\"},[(!_vm.is_copying)?[_c('button',{staticClass:\"u-buttonLink\",attrs:{\"type\":\"button\"},on:{\"click\":function($event){_vm.show_modal = false}}},[_vm._v(\" \"+_vm._s(_vm.$t(\"cancel\"))+\" \")]),_c('button',{staticClass:\"u-button u-button_red\",attrs:{\"type\":\"button\",\"autofocus\":\"\",\"disabled\":!_vm.destination_project_path},on:{\"click\":_vm.confirm}},[(_vm.remove_original)?[_vm._v(\" \"+_vm._s(_vm.$t(\"move\"))+\" \")]:[_vm._v(\" \"+_vm._s(_vm.$t(\"duplicate\"))+\" \")]],2)]:_c('LoaderSpinner')],2)]:[_c('router-link',{staticClass:\"u-button u-button_bleumarine\",attrs:{\"to\":_vm.navigation_to_copy}},[_vm._v(\" \"+_vm._s(_vm.$t(\"open_copy\"))+\" \")])]],2):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div>\n    <button type=\"button\" class=\"u-buttonLink\" @click=\"show_modal = true\">\n      <sl-icon name=\"file-plus\" />\n      {{ $t(\"duplicate_or_move\") }}\n    </button>\n\n    <BaseModal2\n      v-if=\"show_modal\"\n      :title=\"$t('duplicate_or_move')\"\n      @close=\"show_modal = false\"\n    >\n      <template v-if=\"!navigation_to_copy\">\n        <div class=\"u-spacingBottom\">\n          <div class=\"u-instructions\">\n            <small>\n              {{ $t(\"dmp_instr\") }}\n            </small>\n          </div>\n\n          <br />\n\n          <SpaceProjectPicker\n            class=\"u-spacingBottom\"\n            :path=\"path\"\n            @newProjectSelected=\"destination_project_path = $event\"\n          />\n\n          <div class=\"u-spacingBottom\">\n            <DLabel :str=\"$t('title_of_copy')\" />\n            <TextInput\n              :content.sync=\"new_title\"\n              :maxlength=\"40\"\n              :required=\"true\"\n              ref=\"titleInput\"\n            />\n          </div>\n\n          <div class=\"\">\n            <ToggleInput\n              :content.sync=\"remove_original\"\n              :label=\"$t('remove_original')\"\n              :options=\"{\n                true: $t('remove_original_after_copy'),\n                false: $t('keep_original_after_copy'),\n              }\"\n            />\n          </div>\n\n          <!-- <br />\n          <details>\n            <summary>{{ $t(\"more_informations\") }}</summary>\n            <pre>\n              project_medias_to_copy = {{ project_medias_to_copy.length }}\n              {{ project_medias_to_copy }}\n            </pre>\n          </details> -->\n        </div>\n\n        <div class=\"u-sameRow\" slot=\"footer\">\n          <template v-if=\"!is_copying\">\n            <button\n              type=\"button\"\n              class=\"u-buttonLink\"\n              @click=\"show_modal = false\"\n            >\n              {{ $t(\"cancel\") }}\n            </button>\n            <button\n              class=\"u-button u-button_red\"\n              type=\"button\"\n              autofocus\n              :disabled=\"!destination_project_path\"\n              @click=\"confirm\"\n            >\n              <template v-if=\"remove_original\">\n                {{ $t(\"move\") }}\n              </template>\n              <template v-else>\n                {{ $t(\"duplicate\") }}\n              </template>\n            </button>\n          </template>\n          <LoaderSpinner v-else />\n        </div>\n      </template>\n      <template v-else>\n        <router-link\n          :to=\"navigation_to_copy\"\n          class=\"u-button u-button_bleumarine\"\n        >\n          {{ $t(\"open_copy\") }}\n        </router-link>\n      </template>\n    </BaseModal2>\n  </div>\n</template>\n<script>\nimport SpaceProjectPicker from \"@/components/fields/SpaceProjectPicker.vue\";\n\nexport default {\n  props: {\n    path: String,\n    source_title: String,\n    publication: Object,\n  },\n  components: { SpaceProjectPicker },\n  data() {\n    return {\n      navigation_to_copy: false,\n      show_modal: false,\n\n      destination_project_path: undefined,\n\n      remove_original: false,\n      new_title: this.$t(\"copy_of\") + \" \" + this.source_title,\n\n      is_copying: false,\n    };\n  },\n  created() {},\n  async mounted() {},\n  beforeDestroy() {},\n  watch: {},\n  computed: {\n    project_medias_to_copy() {\n      // we get all references medias projects\n      return this.publication.$files.reduce((acc, f) => {\n        if (Object.prototype.hasOwnProperty.call(f, \"source_medias\")) {\n          f.source_medias.map((source_media) => {\n            const _linked_media = this.getSourceMedia({\n              source_media,\n              folder_path: this.publication.$path,\n            });\n            if (!acc.includes(_linked_media.$path))\n              acc.push(_linked_media.$path);\n          });\n        }\n        return acc;\n      }, []);\n    },\n  },\n  methods: {\n    async confirm() {\n      // const parent_type = this.getParent(this.path);\n\n      this.is_copying = true;\n\n      const path_to_destination_type =\n        this.destination_project_path + \"/publications\";\n\n      // multiple cases :\n      // - same project, copyfolder\n      // - other project, copyfolder then check for included medias in project, which we'll also copy. If their meta filename needs to be changed\n      // during copy, update all modules that uses it\n\n      const copy_publication_path = await this.$api\n        .copyFolder({\n          path: this.path,\n          path_to_destination_type,\n          new_meta: {\n            title: this.new_title,\n          },\n        })\n        .catch((err_code) => {\n          if (err_code === \"unique_field_taken\") {\n            this.$alertify\n              .delay(4000)\n              .error(this.$t(\"notifications.title_taken\"));\n            this.$refs.titleInput.$el.querySelector(\"input\").select();\n          } else if (err_code === \"not_allowed_to_copy_to_space\") {\n            this.$alertify\n              .delay(4000)\n              .error(this.$t(\"notifications.not_allowed_to_copy_to_space\"));\n          }\n          this.is_copying = false;\n          throw \"fail\";\n        });\n\n      const copy_publication = await this.$api.getFolder({\n        path: copy_publication_path,\n      });\n\n      this.$alertify\n        .closeLogOnClick(true)\n        .delay(4000)\n        .success(\"publication_copy_success\");\n\n      // publication changed project, so we need to copy medias aswell\n      if (\n        this.getParent(this.path) !==\n        this.destination_project_path + \"/publications\"\n      ) {\n        this.$alertify\n          .closeLogOnClick(true)\n          .delay(4000)\n          .log(\"has_linked_media_to_copy\");\n        for (let media_path of this.project_medias_to_copy) {\n          const copy_file_meta = await this.$api\n            .copyFile({\n              path: media_path,\n              path_to_destination_folder: this.destination_project_path,\n              new_meta: {\n                group: \"imported_from_\" + copy_publication_path,\n              },\n            })\n            .catch((err_code) => {\n              this.$alertify.delay(4000).error(err_code);\n            });\n\n          const original_file_meta = this.getFilename(media_path);\n          if (copy_file_meta !== original_file_meta) {\n            for (let publication_file of copy_publication.$files) {\n              if (\n                !Object.prototype.hasOwnProperty.call(\n                  publication_file,\n                  \"source_medias\"\n                )\n              )\n                continue;\n\n              if (\n                !publication_file.source_medias.some(\n                  (sm) =>\n                    sm.meta_filename_in_project &&\n                    sm.meta_filename_in_project === original_file_meta\n                )\n              )\n                continue;\n\n              const source_medias = publication_file.source_medias.map((sm) => {\n                if (sm.meta_filename_in_project === original_file_meta) {\n                  sm.meta_filename_in_project = copy_file_meta;\n                }\n                return sm;\n              });\n\n              // update publication file in new folder\n              await this.$api.updateMeta({\n                path: publication_file.$path,\n                new_meta: {\n                  source_medias,\n                },\n              });\n            }\n          }\n        }\n        this.$alertify\n          .closeLogOnClick(true)\n          .delay(4000)\n          .success(\"linked media copied\");\n      }\n\n      let query = {};\n      query.projectpanes = JSON.stringify([\n        {\n          type: \"publish\",\n          size: 100,\n          folder: this.getFilename(copy_publication.$path),\n        },\n      ]);\n      const navigation = {\n        path: this.createURLFromPath(this.destination_project_path),\n        query,\n      };\n\n      if (!this.remove_original) {\n        this.is_copying = false;\n        this.navigation_to_copy = navigation;\n      } else {\n        this.is_copying = false;\n        await this.$api.deleteItem({\n          path: this.path,\n        });\n        this.$emit(\"close\");\n      }\n    },\n  },\n};\n</script>\n<style lang=\"scss\" scoped></style>\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-37[0].rules[0].use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./DuplicatePublication.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-37[0].rules[0].use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./DuplicatePublication.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./DuplicatePublication.vue?vue&type=template&id=08436319&scoped=true&\"\nimport script from \"./DuplicatePublication.vue?vue&type=script&lang=js&\"\nexport * from \"./DuplicatePublication.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"08436319\",\n  null\n  \n)\n\nexport default component.exports","<template>\n  <div class=\"_topbar\">\n    <button\n      v-if=\"no_back_button !== true\"\n      type=\"button\"\n      class=\"u-button u-button_icon _backPubli\"\n      @click=\"$emit('close')\"\n    >\n      <b-icon\n        icon=\"arrow-left-circle-fill\"\n        :aria-label=\"$t('back_to_publications')\"\n      />\n    </button>\n\n    <div class=\"_publiTitle\">\n      <TitleField\n        :field_name=\"'title'\"\n        :tag=\"'h2'\"\n        :maxlength=\"40\"\n        :required=\"true\"\n        :content=\"publication.title\"\n        :path=\"publication.$path\"\n        :can_edit=\"can_edit\"\n      />\n    </div>\n    <!-- <TitleField\n          :label=\"$t('template')\"\n          :field_name=\"'template'\"\n          :content=\"publication.template\"\n          :path=\"publication.$path\"\n          :can_edit=\"false\"\n        /> -->\n    <!-- <AuthorField\n          :label=\"$t('contributors')\"\n          :authors_paths=\"publication.$authors\"\n          :path=\"publication.$path\"\n          :can_edit=\"can_edit\"\n        /> -->\n\n    <StatusTag\n      v-if=\"can_edit\"\n      :status=\"publication.$status || 'public'\"\n      :status_options=\"['public', 'private']\"\n      :path=\"publication.$path\"\n      :can_edit=\"can_edit\"\n    />\n\n    <div class=\"_buttonRow\">\n      <div\n        class=\"\"\n        v-if=\"can_edit && publication.$admins !== 'parent_contributors'\"\n      >\n        <small>\n          <button\n            class=\"u-buttonLink\"\n            type=\"button\"\n            @click=\"setCorrectPermForAdmins\"\n          >\n            set perm to parent\n            <!-- // legacy button -->\n          </button>\n          {{ publication.$admins }}\n        </small>\n      </div>\n\n      <sl-button\n        v-if=\"can_edit && publication.template !== 'cartography'\"\n        @click=\"openSettings\"\n        caret\n      >\n        <b-icon icon=\"gear\" slot=\"prefix\" :aria-label=\"$t('settings')\" />\n        {{ $t(\"settings\") }}\n      </sl-button>\n\n      <sl-dropdown v-if=\"can_edit\" @sl-show=\"closeSettings\">\n        <sl-button slot=\"trigger\" caret>\n          {{ $t(\"options\") }}\n        </sl-button>\n        <sl-menu>\n          <sl-menu-item>\n            <DuplicatePublication\n              :path=\"publication.$path\"\n              :source_title=\"publication.title\"\n              :publication=\"publication\"\n              @close=\"$emit('close')\"\n            />\n          </sl-menu-item>\n          <sl-menu-item>\n            <RemoveMenu\n              :remove_text=\"$t('remove')\"\n              @remove=\"removePublication\"\n            />\n          </sl-menu-item>\n        </sl-menu>\n      </sl-dropdown>\n\n      <sl-dropdown @sl-show=\"closeSettings\">\n        <sl-button slot=\"trigger\" caret>\n          <b-icon slot=\"prefix\" icon=\"box-arrow-up-right\" />\n          {{ $t(\"share\") }}\n        </sl-button>\n        <sl-menu>\n          <sl-menu-item>\n            <button\n              type=\"button\"\n              class=\"u-buttonLink _exportBtn\"\n              :disabled=\"!can_edit || is_exporting\"\n              @click=\"exportPublication\"\n            >\n              <sl-icon name=\"filetype-pdf\" />\n              {{ $t(\"export_in_pdf\") }}\n              <transition name=\"fade_fast\" :duration=\"150\" mode=\"out-in\">\n                <LoaderSpinner v-if=\"is_exporting\" />\n              </transition>\n            </button>\n          </sl-menu-item>\n          <sl-menu-item>\n            <button\n              type=\"button\"\n              class=\"u-buttonLink\"\n              @click=\"show_qr_code_modal = true\"\n            >\n              <sl-icon name=\"qr-code\" />\n              {{ $t(\"direct_link\") }}\n            </button>\n\n            <QRModal\n              v-if=\"show_qr_code_modal\"\n              :url_to_access=\"share_url\"\n              @close=\"show_qr_code_modal = false\"\n            />\n          </sl-menu-item>\n        </sl-menu>\n      </sl-dropdown>\n    </div>\n  </div>\n</template>\n<script>\nimport DuplicatePublication from \"@/components/publications/DuplicatePublication.vue\";\n\nexport default {\n  props: {\n    publication: Object,\n    no_back_button: Boolean,\n    can_edit: Boolean,\n  },\n  components: {\n    DuplicatePublication,\n  },\n  data() {\n    return {\n      show_qr_code_modal: false,\n      is_exporting: false,\n    };\n  },\n  created() {},\n  mounted() {},\n  beforeDestroy() {},\n  watch: {},\n  computed: {\n    share_url() {\n      let query = {};\n      if (this.publication.template === \"page_by_page\")\n        query = { display: \"slides\" };\n      else if (this.publication.template === \"story_with_sections\")\n        query = { display: \"section\" };\n\n      const route = this.$router.resolve({\n        path: this.createURLFromPath(this.publication.$path),\n        query,\n      });\n\n      return window.location.origin + route.href;\n    },\n  },\n  methods: {\n    async exportPublication() {\n      let instructions = {\n        recipe: \"pdf\",\n        page_width: this.publication.page_width,\n        page_height: this.publication.page_height,\n        layout_mode: this.publication.layout_mode || \"print\",\n        suggested_file_name: this.publication.title,\n        additional_meta: {\n          $origin: \"publish\",\n        },\n      };\n\n      if (this.publication.page_spreads === true) instructions.page_width *= 2;\n\n      const current_task_id = await this.$api.exportFolder({\n        path: this.publication.$path,\n        instructions,\n      });\n      this.$alertify.delay(4000).log(this.$t(\"compilation_started\"));\n\n      this.is_exporting = true;\n\n      const checkIfEnded = ({ task_id }) => {\n        if (task_id !== current_task_id) return;\n        this.is_exporting = false;\n        this.$eventHub.$off(\"task.ended\", checkIfEnded);\n      };\n      this.$eventHub.$on(\"task.ended\", checkIfEnded);\n    },\n    async removePublication() {\n      this.fetch_status = \"pending\";\n      this.fetch_error = null;\n      try {\n        const response = await this.$api.deleteItem({\n          path: this.publication.$path,\n        });\n        this.response = response.data;\n        this.fetch_status = \"success\";\n      } catch (e) {\n        this.fetch_status = \"error\";\n        this.fetch_error = e.response.data;\n        // this.$alertify.delay(4000).error(err);\n      }\n    },\n    async setCorrectPermForAdmins() {\n      await this.$api.updateMeta({\n        path: this.publication.$path,\n        new_meta: {\n          $admins: \"parent_contributors\",\n        },\n      });\n    },\n    openSettings() {\n      this.$eventHub.$emit(\"publication.settings.toggle\");\n    },\n    closeSettings() {\n      this.$eventHub.$emit(\"publication.settings.close\");\n    },\n  },\n};\n</script>\n<style lang=\"scss\" scoped>\n._topbar {\n  display: flex;\n  flex-flow: row wrap;\n  gap: calc(var(--spacing) / 2);\n  align-items: center;\n  width: 100%;\n  background: white;\n\n  padding: calc(var(--spacing) / 2);\n  margin: 0;\n  // border-top: 1px solid var(--c-gris);\n  border-bottom: 1px solid var(--c-gris);\n}\n\n._publiTitle {\n  flex: 10 1 auto;\n}\n\n._buttonRow {\n  display: flex;\n  flex-flow: row wrap;\n\n  flex: 1 1 auto;\n  justify-content: flex-end;\n  gap: calc(var(--spacing) / 2);\n}\n._exportBtn {\n  position: relative;\n}\n\n._backPubli {\n  font-size: 1.1rem;\n}\n</style>\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-37[0].rules[0].use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./PublicationTopbar.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-37[0].rules[0].use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./PublicationTopbar.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./PublicationTopbar.vue?vue&type=template&id=1b0d039b&scoped=true&\"\nimport script from \"./PublicationTopbar.vue?vue&type=script&lang=js&\"\nexport * from \"./PublicationTopbar.vue?vue&type=script&lang=js&\"\nimport style0 from \"./PublicationTopbar.vue?vue&type=style&index=0&id=1b0d039b&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"1b0d039b\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"_publicationView\",class:{\n    'is--serversidepreview': _vm.is_serversidepreview,\n  }},[_c('style',{tag:\"component\"},[_vm._v(\" \"+_vm._s(_vm.set_print_margins)+\" \")]),_c('transition',{attrs:{\"name\":\"fade_fast\",\"mode\":\"out-in\"}},[(!_vm.project || !_vm.publication)?_c('div',{key:\"loader\",staticClass:\"u-divCentered\"},[_c('LoaderSpinner')],1):(_vm.fetch_project_error)?_c('div',{key:\"err\"},[_vm._v(\" \"+_vm._s(_vm.fetch_project_error)+\" \")]):_c('div',{key:\"publication\",ref:\"fsContainer\"},[(!_vm.is_serversidepreview && !_vm.is_fullscreen && false)?_c('div',{staticClass:\"_pubTopbar\"},[_c('PublicationTopbar',{attrs:{\"publication\":_vm.publication,\"no_back_button\":true,\"can_edit\":false}})],1):_vm._e(),(_vm.publication.template === 'page_by_page')?[_c('PageSlides',{attrs:{\"publication\":_vm.publication,\"is_serversidepreview\":_vm.is_serversidepreview},on:{\"toggleFs\":_vm.toggleFs}})]:(_vm.publication.template === 'story')?_c('div',[_c('StoryTemplate',{staticClass:\"_storyTemplate\",attrs:{\"publication\":_vm.publication,\"can_edit\":false}})],1):(_vm.publication.template === 'story_with_sections')?_c('div',[_c('SectionWithPrint',{attrs:{\"publication\":_vm.publication}})],1):(_vm.publication.template === 'cartography')?_c('div',[_c('MapForPrint',{attrs:{\"publication\":_vm.publication}})],1):_vm._e()],2)])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div\n    class=\"_publicationView\"\n    :class=\"{\n      'is--serversidepreview': is_serversidepreview,\n    }\"\n  >\n    <component :is=\"'style'\">\n      {{ set_print_margins }}\n    </component>\n    <transition name=\"fade_fast\" mode=\"out-in\">\n      <div class=\"u-divCentered\" v-if=\"!project || !publication\" key=\"loader\">\n        <LoaderSpinner />\n      </div>\n      <div v-else-if=\"fetch_project_error\" key=\"err\">\n        {{ fetch_project_error }}\n      </div>\n      <div v-else key=\"publication\" ref=\"fsContainer\">\n        <div\n          class=\"_pubTopbar\"\n          v-if=\"!is_serversidepreview && !is_fullscreen && false\"\n        >\n          <PublicationTopbar\n            :publication=\"publication\"\n            :no_back_button=\"true\"\n            :can_edit=\"false\"\n          />\n        </div>\n        <!-- Publication view project = {{ project }} <br />\n        publication = {{ publication }} -->\n        <template v-if=\"publication.template === 'page_by_page'\">\n          <PageSlides\n            :publication=\"publication\"\n            :is_serversidepreview=\"is_serversidepreview\"\n            @toggleFs=\"toggleFs\"\n          />\n        </template>\n        <div v-else-if=\"publication.template === 'story'\">\n          <StoryTemplate\n            class=\"_storyTemplate\"\n            :publication=\"publication\"\n            :can_edit=\"false\"\n          />\n        </div>\n        <div v-else-if=\"publication.template === 'story_with_sections'\">\n          <SectionWithPrint :publication=\"publication\" />\n        </div>\n        <div v-else-if=\"publication.template === 'cartography'\">\n          <MapForPrint :publication=\"publication\" />\n        </div>\n      </div>\n    </transition>\n  </div>\n</template>\n\n<script>\nimport screenfull from \"screenfull\";\n\nimport PublicationTopbar from \"@/components/publications/PublicationTopbar.vue\";\n\nexport default {\n  props: {},\n  components: {\n    PublicationTopbar,\n    PageSlides: () =>\n      import(\"@/components/publications/page_by_page/PageSlides.vue\"),\n    StoryTemplate: () =>\n      import(\"@/components/publications/templates/StoryTemplate.vue\"),\n    SectionWithPrint: () =>\n      import(\"@/components/publications/story/SectionWithPrint.vue\"),\n    MapForPrint: () =>\n      import(\"@/components/publications/cartography/MapForPrint.vue\"),\n  },\n  data() {\n    return {\n      fetch_project_error: null,\n      project: null,\n      publication: null,\n\n      is_fullscreen: false,\n      is_serversidepreview: false,\n    };\n  },\n  created() {},\n  async mounted() {\n    if (this.$route.query?.make_preview === \"true\")\n      this.is_serversidepreview = true;\n\n    await this.listProject();\n    this.$eventHub.$emit(\"received.project\", this.project);\n\n    await this.listPublication();\n    // not pushing changes to presentation for performance reasons â€“ though this could be useful at some point?\n    // this.$api.join({ room: this.project.$path });\n    // this.$api.join({ room: this.publication_path });\n  },\n  beforeDestroy() {\n    // this.$api.leave({ room: this.project.$path });\n    // this.$api.leave({ room: this.publication_path });\n  },\n  watch: {\n    is_fullscreen() {\n      // this.$nextTick(() => {\n      // this.fitZoomToPage();\n      // });\n    },\n  },\n  computed: {\n    project_path() {\n      return this.createPath({\n        space_slug: this.$route.params.space_slug,\n        project_slug: this.$route.params.project_slug,\n      });\n    },\n    publication_path() {\n      return `${this.project_path}/publications/${this.$route.params.publication_slug}`;\n    },\n    set_print_margins() {\n      let margins = 15;\n      if (this.publication && this.publication.template === \"page_by_page\")\n        margins = 0;\n      return `\n      @page {\n        margin: ${margins}mm;\n      }\n      `;\n    },\n  },\n  methods: {\n    async openFs() {\n      await screenfull.request(this.$refs.fsContainer);\n      this.is_fullscreen = true;\n      screenfull.onchange(() => {\n        if (!screenfull.isFullscreen) this.is_fullscreen = false;\n      });\n    },\n    async closeFs() {\n      await screenfull.exit();\n      this.is_fullscreen = false;\n    },\n    async toggleFs() {\n      if (this.is_fullscreen) this.closeFs();\n      else this.openFs();\n    },\n    async listProject() {\n      const project = await this.$api\n        .getFolder({\n          path: this.project_path,\n        })\n        .catch((err) => {\n          this.fetch_project_error = err.response;\n          this.is_loading = false;\n        });\n      this.project = project;\n    },\n    async listPublication() {\n      const publication = await this.$api\n        .getFolder({\n          path: this.publication_path,\n        })\n        .catch((err) => {\n          this.fetch_publication_error = err.response;\n        });\n      this.publication = publication;\n    },\n  },\n};\n</script>\n<style lang=\"scss\">\n.alertify-logs {\n  display: none !important;\n}\nhtml,\nbody {\n  @media print {\n    background: white !important;\n  }\n}\n._storyTemplate {\n  padding: calc(var(--spacing) / 1);\n}\n\n._pubTopbar ._topbar {\n  margin: var(--spacing) auto;\n}\n\n._pubTopbar {\n  margin: 0 auto;\n  max-width: 86ch;\n\n  @media print {\n    display: none;\n  }\n}\n._sectionsSummary {\n  @media print {\n    display: none;\n  }\n}\n._storyContent {\n  @media print {\n    box-shadow: none !important;\n  }\n}\n</style>\n","import mod from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-37[0].rules[0].use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./PublicationView.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-37[0].rules[0].use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./PublicationView.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./PublicationView.vue?vue&type=template&id=26e2e361&\"\nimport script from \"./PublicationView.vue?vue&type=script&lang=js&\"\nexport * from \"./PublicationView.vue?vue&type=script&lang=js&\"\nimport style0 from \"./PublicationView.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","// Imports\nimport ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/noSourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \"._topbar[data-v-1b0d039b]{display:flex;flex-flow:row wrap;gap:calc(var(--spacing)/2);align-items:center;width:100%;background:#fff;padding:calc(var(--spacing)/2);margin:0;border-bottom:1px solid var(--c-gris)}._publiTitle[data-v-1b0d039b]{flex:10 1 auto}._buttonRow[data-v-1b0d039b]{display:flex;flex-flow:row wrap;flex:1 1 auto;justify-content:flex-end;gap:calc(var(--spacing)/2)}._exportBtn[data-v-1b0d039b]{position:relative}._backPubli[data-v-1b0d039b]{font-size:1.1rem}\", \"\"]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/noSourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".alertify-logs{display:none!important}@media print{body,html{background:#fff!important}}._storyTemplate{padding:calc(var(--spacing)/1)}._pubTopbar ._topbar{margin:var(--spacing) auto}._pubTopbar{margin:0 auto;max-width:86ch}@media print{._pubTopbar,._sectionsSummary{display:none}._storyContent{box-shadow:none!important}}\", \"\"]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../node_modules/css-loader/dist/cjs.js??clonedRuleSet-19[0].rules[0].use[1]!../../../node_modules/@vue/vue-loader-v15/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-19[0].rules[0].use[2]!../../../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-19[0].rules[0].use[3]!../../../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-19[0].rules[0].use[4]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./PublicationTopbar.vue?vue&type=style&index=0&id=1b0d039b&lang=scss&scoped=true&\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"23a67e6e\", content, true, {\"sourceMap\":false,\"shadowMode\":false});","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../node_modules/css-loader/dist/cjs.js??clonedRuleSet-19[0].rules[0].use[1]!../../node_modules/@vue/vue-loader-v15/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-19[0].rules[0].use[2]!../../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-19[0].rules[0].use[3]!../../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-19[0].rules[0].use[4]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./PublicationView.vue?vue&type=style&index=0&lang=scss&\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"5ea50c42\", content, true, {\"sourceMap\":false,\"shadowMode\":false});"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","no_back_button","attrs","on","$event","$emit","$t","_e","publication","title","$path","can_edit","$status","$admins","setCorrectPermForAdmins","_v","_s","template","openSettings","slot","closeSettings","removePublication","is_exporting","exportPublication","show_qr_code_modal","share_url","staticRenderFns","show_modal","navigation_to_copy","path","destination_project_path","ref","new_title","remove_original","true","false","is_copying","confirm","props","source_title","components","SpaceProjectPicker","data","created","beforeDestroy","watch","computed","project_medias_to_copy","f","source_media","folder_path","acc","methods","copyFolder","path_to_destination_type","new_meta","catch","delay","error","closeLogOnClick","success","log","copyFile","path_to_destination_folder","group","publication_file","sm","source_medias","query","type","size","folder","component","DuplicatePublication","mounted","display","recipe","page_width","page_height","layout_mode","suggested_file_name","additional_meta","$origin","instructions","task_id","class","is_serversidepreview","tag","set_print_margins","project","key","fetch_project_error","is_fullscreen","toggleFs","PublicationTopbar","PageSlides","StoryTemplate","SectionWithPrint","MapForPrint","project_path","space_slug","project_slug","publication_path","margins","screenfull","getFolder","___CSS_LOADER_EXPORT___","push","module","id","content","__esModule","default","locals","exports","add"],"sourceRoot":""}