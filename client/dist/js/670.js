(self["webpackChunkapp"]=self["webpackChunkapp"]||[]).push([[670],{85670:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return it}});i(74423);var o=function(){var e=this,t=e._self._c;return t("div",{staticClass:"m_captureview"},[t("CapturePane",{directives:[{name:"show",rawName:"v-show",value:e.show_capture_settings,expression:"show_capture_settings"}],attrs:{label:e.$t("settings"),pane_type:"settings"},on:{close:function(t){e.show_capture_settings=!1}}},[t("CaptureSettings",{attrs:{audio_output_deviceId:e.audio_output_deviceId},on:{"update:audio_output_deviceId":function(t){e.audio_output_deviceId=t},"update:audio_output_device-id":function(t){e.audio_output_deviceId=t},setStream:e.setStream,hasFinishedLoading:e.hasFinishedLoading,show:function(t){e.show_capture_settings=!0}}})],1),t("CapturePane",{directives:[{name:"show",rawName:"v-show",value:e.show_effects_pane,expression:"show_effects_pane"}],attrs:{label:e.$t("effects"),pane_type:"effects"},on:{close:function(t){e.show_effects_pane=!1}}},[t("CaptureEffects",{attrs:{enable_effects:e.enable_effects,videoElement:e.$refs.videoElement,canvasElement:e.$refs.canvasElement,project_path:e.path},on:{"update:enable_effects":function(t){e.enable_effects=t}}})],1),t("div",{staticClass:"m_captureview--videoPane"},[t("transition",{attrs:{name:"slidedown",duration:500}},[e.show_mode_selector?t("ModeSelector",{attrs:{available_modes:e.available_modes,selected_mode:e.selected_mode,disable_change_mode:e.is_recording||e.media_to_validate||e.mode_just_changed||e.is_making_stopmotion},on:{changeMode:function(t){return e.$emit("changeMode",t)}}}):e._e()],1),t("div",{directives:[{name:"show",rawName:"v-show",value:!e.is_validating_stopmotion_video,expression:"!is_validating_stopmotion_video"}],staticClass:"m_captureview--videoPane--top",class:{"is--being_streamed":e.stream_sharing_informations_status&&e.stream_sharing_informations_status.enabled||e.stream_access_informations_status&&e.stream_access_informations_status.enabled}},[t("div",{staticClass:"m_captureview--videoPane--top--videoContainer"},[t("div",{staticClass:"_videoEl",style:"opacity: "+(e.show_videos?1:0)},[t("video",{ref:"videoElement",style:"opacity: "+(e.enable_effects?"0":"1"),attrs:{autoplay:"",playsinline:"",controls:"RemoteSources"===e.stream_type,muted:""},domProps:{srcObject:e.stream,muted:!0}}),t("canvas",{directives:[{name:"show",rawName:"v-show",value:e.enable_effects,expression:"enable_effects"}],ref:"canvasElement",attrs:{width:e.actual_camera_resolution.width,height:e.actual_camera_resolution.height},on:{click:t=>e.updateSelectedColor({e:t,type:"click"})}})]),"vecto"!==e.selected_mode||e.media_to_validate?e._e():t("VectoMode",{ref:"vectoElement",attrs:{last_frame_from_video:e.last_frame_from_video,number_of_colors:e.vecto_number_of_colors}}),"lines"!==e.selected_mode||e.media_to_validate?e._e():t("LinesMode",{ref:"vectoElement",attrs:{last_frame_from_video:e.last_frame_from_video,angle:e.lines_angle,boost_brightness:e.lines_brightness,boost_contrast:e.lines_contrast,density:e.lines_density}}),"audio"!==e.selected_mode||e.media_to_validate?e._e():t("AudioEqualizer",{ref:"equalizerElement",attrs:{stream:e.stream,is_recording:e.is_recording}}),t("transition-group",{staticClass:"_capture_options",attrs:{tag:"div",name:"slideFromTop",mode:"out-in"}},["stopmotion"!==e.selected_mode&&e.is_recording&&!1!==e.timer_recording_in_seconds?t("div",{key:"duration",staticClass:"_duration_timer",domProps:{innerHTML:e._s(e.timer_recording_in_seconds)}}):e._e(),"stopmotion"===e.selected_mode&&e.timelapse_mode_enabled&&!e.timelapse_event?t("div",{key:"timelapse_interval",staticClass:"record_options"},[t("div",[t("span",[e._v(e._s(e.$t("interval_between_pictures")))]),t("input",{directives:[{name:"model",rawName:"v-model.number",value:e.timelapse_interval,expression:"timelapse_interval",modifiers:{number:!0}}],attrs:{type:"number",min:"1"},domProps:{value:e.timelapse_interval},on:{input:function(t){t.target.composing||(e.timelapse_interval=e._n(t.target.value))},blur:function(t){return e.$forceUpdate()}}}),t("span",[e._v(e._s(e.$t("seconds")))])])]):e._e(),e.stream_sharing_informations_status&&e.stream_sharing_informations_status.enabled&&"LocalSources"===e.stream_type?t("div",{key:"stream_share_name-"+e.stream_sharing_informations_status.name},[t("label",{staticClass:"u-label"},[t("span",{domProps:{innerHTML:e._s(e.$t("stream_currently_shared_with_name:"))}}),t("span",[t("strong",[e._v(e._s(e.stream_sharing_informations_status.name))])]),t("br"),e.stream_sharing_informations_status.peers_connected&&e.stream_sharing_informations_status.peers_connected.length>0?t("span",[e._v(" "+e._s(e.$t("other_users_connected"))+" = "+e._s(e.stream_sharing_informations_status.peers_connected.length)+" ")]):e._e()])]):e.stream_access_informations_status&&e.stream_access_informations_status.enabled&&"RemoteSources"===e.stream_type?t("div",{key:"stream_share_name-"+e.stream_access_informations_status.callee},[t("label",{staticClass:"u-label"},[t("span",{domProps:{innerHTML:e._s(e.$t("stream_shown:"))}}),t("span",[t("strong",[e._v(e._s(e.stream_access_informations_status.callee))])])])]):e._e(),!e.delay_mode_enabled||e.is_recording||e.media_to_validate||e.delay_event?e._e():t("div",{key:"delay_interval",staticClass:"record_options"},[t("div",[t("span",[e._v(e._s(e.$t("delay")))]),t("input",{directives:[{name:"model",rawName:"v-model.number",value:e.delay_seconds,expression:"delay_seconds",modifiers:{number:!0}}],attrs:{type:"number",min:"1",max:"60"},domProps:{value:e.delay_seconds},on:{input:function(t){t.target.composing||(e.delay_seconds=e._n(t.target.value))},blur:function(t){return e.$forceUpdate()}}}),t("span",[e._v(e._s(e.$t("seconds")))])])])]),t("transition",{attrs:{name:"scaleInFade",mode:"out-in"}},[e.delay_remaining_time?t("label",{key:"delay_before_"+e.delay_remaining_time,staticClass:"_delay_timer",class:{"is--small":e.capture_pane_is_small},domProps:{innerHTML:e._s(e.delay_remaining_time)}}):e.timelapse_time_before_next_picture?t("label",{key:"timelapse_before_"+e.timelapse_time_before_next_picture,staticClass:"_delay_timer is--small is--timelapse",domProps:{innerHTML:e._s(e.timelapse_time_before_next_picture)}}):e._e()]),t("transition",{attrs:{name:"onionSkin",mode:"in-out"}},["stopmotion"!==e.selected_mode||!e.onion_skin_img||!e.stopmotion_slug||e.is_validating_stopmotion_video||e.show_live_feed&&0===e.onion_skin_opacity?e._e():t("MediaContent",{key:!e.show_live_feed&&e.onion_skin_img.$path,staticClass:"_onion_skin",class:{"is--onionskin":e.show_live_feed},style:e.show_live_feed?`--onionskin-opacity: ${e.onion_skin_opacity}`:"",attrs:{file:e.onion_skin_img,resolution:1600}})],1),e.current_grid_type&&e.enable_video&&!e.media_to_validate?t("div",{staticClass:"_video_grid_overlay"},[t("svg",{attrs:{width:e.actual_camera_resolution.width,height:e.actual_camera_resolution.height,viewBox:`0 0 ${e.actual_camera_resolution.width} ${e.actual_camera_resolution.height}`}},e._l(e.grids[e.current_grid_type],(function([e,i,o,n],a){return t("line",{key:a,attrs:{x1:e+"%",y1:i+"%",x2:o+"%",y2:n+"%","vector-effect":"non-scaling-stroke"}})})),0)]):e._e(),t("transition",{attrs:{name:"fade_fast"}},[e.is_recording?e._e():t("div",{staticClass:"_settingsTag"},[e.must_validate_media&&e.media_to_validate||"audio"===e.selected_mode?e._e():[e.enable_video?t("button",{staticClass:"u-button u-button_small",attrs:{type:"button"},on:{click:function(t){e.show_capture_settings=!e.show_capture_settings}}},[e._v(" "+e._s(e.actual_camera_resolution.width)+" × "+e._s(e.actual_camera_resolution.height)+" ")]):e._e(),e.enable_video&&"audio"!==e.selected_mode?t("select",{directives:[{name:"model",rawName:"v-model",value:e.current_grid_type,expression:"current_grid_type"}],class:{"is--active":!1!==e.current_grid_type},attrs:{size:"small"},on:{change:function(t){var i=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.current_grid_type=t.target.multiple?i:i[0]}}},[t("option",{domProps:{value:!1}},[e._v(" --"+e._s(e.$t("grid").toLowerCase())+"-- ")]),e._l(Object.keys(e.grids),(function(i){return t("option",{key:i,domProps:{value:i}},[e._v(" "+e._s(e.$t(i).toLowerCase())+" ")])}))],2):e._e()],t("button",{staticClass:"u-button u-button_small",class:{"is--active":e.has_location_to_add_to_medias},attrs:{type:"button"},on:{click:function(t){e.show_position_modal=!0}}},[t("b-icon",{attrs:{icon:e.has_location_to_add_to_medias?"pin-map-fill":"pin-map"}})],1),e.show_position_modal?t("PickLocationForCaptures",{attrs:{location_to_add_to_medias:e.location_to_add_to_medias},on:{"update:location_to_add_to_medias":function(t){e.location_to_add_to_medias=t},close:function(t){e.show_position_modal=!1}}}):e._e()],2)]),t("transition",{attrs:{name:"enableMode",duration:800}},[e.mode_just_changed&&!e.is_loading_stream?t("div",{staticClass:"_mode_indicator",domProps:{innerHTML:e._s(e.$t(e.selected_mode))}}):e._e()]),t("transition",{attrs:{name:"justCaptured"}},[e.media_to_validate&&e.must_validate_media?t("MediaPreviewBeforeValidation",{attrs:{media_to_validate:e.media_to_validate,audio_output_deviceId:e.audio_output_deviceId}}):e._e()],1),t("transition",{attrs:{name:"fade_fast"}},[e.is_loading_stream?t("LoaderSpinner",{staticClass:"_loader"}):e._e()],1)],1)]),e.stopmotion_slug?t("StopmotionPanel",{attrs:{current_stopmotion_path:`${e.path}/stopmotions/${e.stopmotion_slug}`,stream:e.stream,show_live_feed:e.show_live_feed,is_validating_stopmotion_video:e.is_validating_stopmotion_video,onion_skin_opacity:e.onion_skin_opacity,stopmotion_frame_rate:e.stopmotion_frame_rate},on:{"update:show_live_feed":function(t){e.show_live_feed=t},"update:is_validating_stopmotion_video":function(t){e.is_validating_stopmotion_video=t},"update:onion_skin_opacity":function(t){e.onion_skin_opacity=t},"update:stopmotion_frame_rate":function(t){e.stopmotion_frame_rate=t},insertMedia:t=>e.$emit("insertMedia",t),close:e.closeStopmotionPanel,showPreviousImage:function(t){e.onion_skin_img=t}}}):e._e(),t("transition",{attrs:{name:"slideup",duration:150,mode:"out-in"}},[t("div",{staticClass:"m_captureview--videoPane--bottom"},[t("transition",{attrs:{name:"fade_fast",duration:150}},[e.is_sending_image?t("LoaderSpinner"):e._e()],1),t("transition",{attrs:{name:"slideup",duration:150,mode:"out-in"}},[e.media_to_validate.temp_name&&e.must_validate_media||e.is_validating_stopmotion_video?e.media_to_validate&&e.must_validate_media?t("div",{key:"validation"},[t("MediaValidationButtons",{attrs:{media_is_being_sent:e.media_is_being_sent,media_being_sent_percent:e.media_being_sent_percent,can_add_to_fav:!0},on:{cancel:function(t){return e.cancelValidation()},save:function(t){return e.sendMedia()},save_and_fav:function(t){return e.sendMedia({fav:!0})}}}),t("div",{staticClass:"_download_media_without_validation"},[t("small",[t("a",{ref:"",attrs:{href:e.validated_media_href_blob,download:e.media_to_validate.temp_name,target:"_blank"}},[e._v(" "+e._s(e.$t("or_download_media_on_device"))+" "),e.media_to_validate.rawData?[e._v(" — "+e._s(e.formatBytes(e.media_to_validate.rawData.size))+" ")]:e._e()],2)])])],1):e._e():t("div",{staticClass:"m_captureview--videoPane--bottom--buttons",class:{"is--recording":e.is_recording&&!e.video_recording_is_paused,"is--sending_image":e.is_sending_image}},[t("div",[e.is_recording||e.is_making_stopmotion||e.is_recording||e.delay_event?e._e():[t("button",{staticClass:"u-button u-button_red _settingsBtn",class:{"is--active":e.show_capture_settings},attrs:{type:"button",content:e.$t("settings")},on:{click:function(t){e.show_capture_settings=!e.show_capture_settings}}},[t("svg",{staticClass:"inline-svg inline-svg_larger",attrs:{version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",x:"0px",y:"0px",viewBox:"15 15 140 140","xml:space":"preserve"}},[t("path",{staticStyle:{fill:"currentColor"},attrs:{d:"M122.7,88.8v-10c0-1.1,0.6-2.1,1.6-2.6l9.6-4.9l-2-5.8l-11,1.6c-1.1,0.2-2.2-0.3-2.9-1.2l-6-8.1\n                  c-0.7-0.9-0.8-2.1-0.3-3l4.8-9.6l-5.2-3.6l-7.7,7.5c-0.8,0.8-2,1-3.1,0.7l-9.9-3c-1.1-0.3-1.9-1.3-2.1-2.4L86.8,34h-6.4l-1.7,10.4\n                  c-0.2,1.1-0.9,2-2,2.4L66.8,50c-1.1,0.3-2.2,0.1-3.1-0.7L55.9,42l-5.1,3.7l4.9,9.4c0.5,1,0.4,2.1-0.2,3l-6,8.2\n                  c-0.6,0.9-1.8,1.4-2.9,1.2L35.8,66L34,71.8l9.7,4.8c1,0.5,1.7,1.5,1.7,2.6v10c0,1.1-0.6,2.1-1.6,2.6l-9.6,4.9l2,5.9l10.9-1.6\n                  c1.1-0.2,2.2,0.3,2.9,1.2l6,8.1c0.7,0.9,0.8,2.1,0.3,3l-4.8,9.6l5.1,3.6l7.7-7.5c0.8-0.8,2-1,3.1-0.7l9.9,3\n                  c1.1,0.3,1.9,1.3,2.1,2.4l1.9,10.4h6.4l1.7-10.4c0.2-1.1,0.9-2,2-2.4l9.9-3.2c1.1-0.3,2.2-0.1,3.1,0.7l7.8,7.3l5.1-3.7l-4.9-9.4\n                  c-0.5-1-0.4-2.1,0.2-3l6-8.1c0.7-0.9,1.8-1.4,2.9-1.2l10.8,1.5l1.8-5.9l-9.7-4.8C123.3,90.9,122.7,89.9,122.7,88.8z M84,104.5\n                  c-11.7,0-21.1-9.2-21.1-20.5c0-11.3,9.5-20.5,21.1-20.5s21.1,9.2,21.1,20.5C105.1,95.3,95.7,104.5,84,104.5z"}})])]),"audio"!==e.selected_mode?t("button",{staticClass:"u-button u-button_bleumarine _settingsBtn",class:{"is--active":e.show_effects_pane},attrs:{type:"button",content:e.$t("effects")},on:{click:function(t){e.show_effects_pane=!e.show_effects_pane}}},[t("svg",{staticClass:"inline-svg inline-svg_larger",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 168 168"}},[t("path",{staticStyle:{fill:"#fc4b60",stroke:"#fc4b60","stroke-miterlimit":"10","stroke-width":"2.8346456692913384px"},attrs:{d:"M110.3488,72.0093,114.6377,59.36a4.4236,4.4236,0,0,0-1.07-4.59,4.4946,4.4946,0,0,0-4.59-1.0745L96.3334,57.9846,85.62,50a4.5219,4.5219,0,0,0-4.6965-.4029,4.4316,4.4316,0,0,0-2.4409,4.0388l.1714,13.3577L67.7468,74.7049A4.4686,4.4686,0,0,0,68.9974,82.62L79.2565,85.807,38.1043,126.9546a2.3155,2.3155,0,1,0,3.2745,3.2746L82.5311,89.0769l3.1865,10.2638a4.4571,4.4571,0,0,0,3.5664,3.08c.12.0185.579.0556.704.0556a4.4844,4.4844,0,0,0,3.6451-1.88L101.35,89.6883l13.6078.1621a4.6074,4.6074,0,0,0,3.784-2.4316,4.4328,4.4328,0,0,0-.3983-4.6965ZM100.1869,85.0381a2.5322,2.5322,0,0,0-1.9221.9773L90.039,97.6409,85.8149,84.0423a2.3238,2.3238,0,0,0-1.5192-1.5238l-13.8764-4.03,11.8987-8.42a2.3208,2.3208,0,0,0,.9773-1.9221L82.846,53.71l11.6764,8.7168a2.3569,2.3569,0,0,0,2.1259.3381l13.5986-4.8911L105.56,71.6758a2.3135,2.3135,0,0,0,.3428,2.1259l8.8464,11.417Z"}}),t("path",{staticStyle:{fill:"#fc4b60",stroke:"#fc4b60","stroke-miterlimit":"10","stroke-width":"2.8346456692913384px"},attrs:{d:"M58.9467,42.2277h2.3158v2.3158a2.3159,2.3159,0,1,0,4.6317,0V42.2277H68.21a2.3159,2.3159,0,0,0,0-4.6317H65.8942V35.28a2.3159,2.3159,0,0,0-4.6317,0V37.596H58.9467a2.3159,2.3159,0,0,0,0,4.6317Z"}}),t("path",{staticStyle:{fill:"#fc4b60",stroke:"#fc4b60","stroke-miterlimit":"10","stroke-width":"2.8346456692913384px"},attrs:{d:"M49.6834,65.386h2.3158v2.3158a2.3159,2.3159,0,0,0,4.6317,0V65.386h2.3158a2.3159,2.3159,0,0,0,0-4.6317H56.6309V58.4385a2.3159,2.3159,0,0,0-4.6317,0v2.3158H49.6834a2.3159,2.3159,0,0,0,0,4.6317Z"}}),t("path",{staticStyle:{fill:"#fc4b60",stroke:"#fc4b60","stroke-miterlimit":"10","stroke-width":"2.8346456692913384px"},attrs:{d:"M133.0531,102.4392h-2.3158v-2.3158a2.3159,2.3159,0,0,0-4.6317,0v2.3158H123.79a2.3159,2.3159,0,0,0,0,4.6317h2.3158v2.3158a2.3159,2.3159,0,1,0,4.6317,0v-2.3158h2.3158a2.3159,2.3159,0,0,0,0-4.6317Z"}}),t("path",{staticStyle:{fill:"#fc4b60",stroke:"#fc4b60","stroke-miterlimit":"10","stroke-width":"2.8346456692913384px"},attrs:{d:"M109.8949,111.7026H107.579v-2.3159a2.3158,2.3158,0,1,0-4.6316,0v2.3159h-2.3158a2.3158,2.3158,0,1,0,0,4.6316h2.3158V118.65a2.3158,2.3158,0,1,0,4.6316,0v-2.3158h2.3159a2.3158,2.3158,0,0,0,0-4.6316Z"}}),t("path",{staticStyle:{fill:"#fc4b60",stroke:"#fc4b60","stroke-miterlimit":"10","stroke-width":"2.8346456692913384px"},attrs:{d:"M119.1582,46.8594h2.3158v2.3158a2.3158,2.3158,0,1,0,4.6316,0V46.8594h2.3159a2.3159,2.3159,0,0,0,0-4.6317h-2.3159V39.9119a2.3158,2.3158,0,1,0-4.6316,0v2.3158h-2.3158a2.3159,2.3159,0,1,0,0,4.6317Z"}})])]):e._e()],"video"===e.selected_mode&&e.is_recording?t("button",{key:e.selected_mode+"_pause",staticClass:"u-button u-button_orange u-button_inline _captureButton",attrs:{type:"button"},on:{mousedown:function(t){return t.stopPropagation(),t.preventDefault(),e.pauseOrResumeCapture()},touchstart:function(t){return t.stopPropagation(),t.preventDefault(),e.pauseOrResumeCapture()}}},[e.video_recording_is_paused?[t("svg",{staticClass:"inline-svg inline-svg_larger",staticStyle:{"enable-background":"new 0 0 168 168"},attrs:{version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",x:"0px",y:"0px",viewBox:"0 0 168 168","xml:space":"preserve"}},[t("path",{staticStyle:{fill:"#ffbe32"},attrs:{id:"FOND_3_",d:"M84,0C37.6,0,0,37.6,0,84c0,46.4,37.6,84,84,84c46.4,0,84-37.6,84-84\n\t\t\tC168,37.6,130.4,0,84,0z"}}),t("polygon",{staticStyle:{fill:"#ff3e51"},attrs:{points:"45 40, 130 84.7, 45 128"}})]),e._v("   "),t("span",[e._v(" "+e._s(e.$t("unpause_recording"))+" ")])]:[t("svg",{staticClass:"inline-svg inline-svg_larger",staticStyle:{"enable-background":"new 0 0 168 168"},attrs:{version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",x:"0px",y:"0px",viewBox:"0 0 168 168","xml:space":"preserve"}},[t("path",{staticStyle:{fill:"#ffbe32"},attrs:{id:"FOND_3_",d:"M84,0C37.6,0,0,37.6,0,84c0,46.4,37.6,84,84,84c46.4,0,84-37.6,84-84\n\t\t\tC168,37.6,130.4,0,84,0z"}}),t("rect",{staticStyle:{fill:"#ff3e51"},attrs:{id:"CENTRE_3_",x:"35",y:"46.7",width:"38",height:"76"}}),t("rect",{staticStyle:{fill:"#ff3e51"},attrs:{id:"CENTRE_3_",x:"93",y:"46.7",width:"38",height:"76"}})]),e._v("   "),t("span",[e._v(" "+e._s(e.$t("pause_recording"))+" ")])]],2):e._e(),"stopmotion"===e.selected_mode&&e.is_making_stopmotion&&!e.timelapse_event?t("button",{key:e.selected_mode+"_pause",staticClass:"u-button u-button_transparent u-button_inline _captureButton",attrs:{type:"button"},on:{mousedown:function(t){return t.stopPropagation(),t.preventDefault(),e.stopStopmotion()},touchstart:function(t){return t.stopPropagation(),t.preventDefault(),e.stopStopmotion()}}},[e._v(" "+e._s(e.$t("back"))+" ")]):e._e()],2),t("div",[t("transition",{attrs:{name:"fade_fast",mode:"out-in"}},[e.is_recording?e.is_recording?t("button",{key:e.selected_mode+e.is_recording,staticClass:"u-button u-button_orange u-button_inline _captureButton",attrs:{type:"button",disabled:e.is_sending_image},on:{mousedown:function(t){return t.stopPropagation(),t.preventDefault(),e.stopRecording()},touchstart:function(t){return t.stopPropagation(),t.preventDefault(),e.stopRecording()}}},[(e.is_sending_image,[t("img",{staticClass:"inline-svg inline-svg_larger",attrs:{src:`${e.$root.publicPath}images/i_stop.svg`}}),e._v("   "),["video","audio"].includes(e.selected_mode)?t("span",[e._v(" "+e._s(e.$t("stop_recording"))+" ")]):"stopmotion"===e.selected_mode?t("span",[e.timelapse_mode_enabled?[e._v(" "+e._s(e.$t("stop_timelapse"))+" ")]:e._e()],2):t("span",[e._v(" "+e._s(e.$t("stop"))+" ")])])],2):e._e():t("button",{key:e.selected_mode+e.is_recording,staticClass:"u-button u-button_orange _captureButton",class:{"is--active":e.capture_button_pressed},attrs:{type:"button",disabled:e.is_sending_image},on:{mousedown:function(t){return t.stopPropagation(),t.preventDefault(),e.setCaptureInit()},touchstart:function(t){return t.stopPropagation(),t.preventDefault(),e.setCaptureInit()}}},[e.delay_event?t("span",[e._v(" "+e._s(e.$t("cancel"))+" ")]):[t("img",{staticClass:"inline-svg inline-svg_larger",attrs:{src:e.$root.publicPath+"images/i_record.svg"}}),e._v("   "),["photo","vecto","lines"].includes(e.selected_mode)?t("span",{domProps:{innerHTML:e._s(e.$t("take_picture"))}}):"video"===e.selected_mode?t("span",{domProps:{innerHTML:e._s(e.$t("record_video"))}}):"audio"===e.selected_mode?t("span",{domProps:{innerHTML:e._s(e.$t("record_audio"))}}):"stopmotion"===e.selected_mode?t("span",{domProps:{innerHTML:e._s(e.timelapse_mode_enabled?e.$t("start_timelapse"):e.$t("take_picture"))}}):e._e()]],2)]),t("transition",{attrs:{name:"fade_fast",mode:"out-in"}},["stopmotion"!==e.selected_mode||e.timelapse_event||e.delay_event?e._e():t("button",{staticClass:"_enable_timelapse_button",class:{"is--active":e.timelapse_mode_enabled},attrs:{type:"button",content:e.$t("timelapse")},on:{click:function(t){e.timelapse_mode_enabled=!e.timelapse_mode_enabled}}},[t("svg",{staticClass:"inline-svg margin-right-verysmall",staticStyle:{"enable-background":"new 0 0 81 81"},attrs:{version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",x:"0px",y:"0px",width:"81px",height:"81px",viewBox:"0 0 81 81","xml:space":"preserve"}},[t("path",{attrs:{d:"M69.6,20.8c-0.9,0.6-1.7,1.1-2.6,1.7c-6-8.8-15.9-14-26.5-14c-17.6,0-32,14.4-32,32s14.4,32,32,32\n                  c3.1,0,6.2-0.4,9.1-1.3l-1.7-5.8c-2.4,0.7-4.9,1.1-7.4,1.1c-14.3,0-26-11.7-26-26s11.7-26,26-26c8.6,0,16.6,4.2,21.5,11.4\n                  c-0.8,0.5-1.6,1.1-2.4,1.6c-0.7,0.4-0.9,1.1-0.8,1.7c0,0.7,0.4,1.4,1.2,1.6c0.2,0.1,0.3,0.1,0.5,0.1c2.7,0.5,5.3,1.1,8,1.6\n                  c1,0.2,2-0.4,2.3-1.4c0.6-2.8,1.1-5.5,1.7-8.3C72.8,21.3,71,19.9,69.6,20.8z"}}),t("path",{attrs:{d:"M23,49.4c-1.3,0-2.4-0.8-2.9-2.1c-0.5-1.6,0.4-3.3,1.9-3.8L39,38.3V27.2c0-1.7,1.3-3,3-3s3,1.3,3,3v13.3\n                  c0,1.3-0.8,2.5-2.1,2.9l-19,5.9C23.6,49.4,23.3,49.4,23,49.4z"}})])])]),t("transition",{attrs:{name:"fade_fast",mode:"out-in"}},[e.is_recording||e.delay_event?e._e():t("button",{staticClass:"_enable_timelapse_button",class:{"is--active":e.delay_mode_enabled},attrs:{type:"button",content:e.$t("delay")},on:{click:function(t){e.delay_mode_enabled=!e.delay_mode_enabled}}},[t("svg",{staticClass:"inline-svg margin-right-verysmall",staticStyle:{"enable-background":"new 0 0 81 81"},attrs:{version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",x:"0px",y:"0px",width:"81px",height:"81px",viewBox:"0 0 81 81","xml:space":"preserve"}},[t("path",{attrs:{d:"M40.5,72.3c-15,0-27.1-12.2-27.1-27.1c0-15,12.2-27.1,27.1-27.1s27.1,12.2,27.1,27.1C67.6,60.2,55.5,72.3,40.5,72.3z\n\t M40.5,23.7C28.7,23.7,19,33.4,19,45.2s9.6,21.5,21.5,21.5S62,57,62,45.2S52.3,23.7,40.5,23.7z"}}),t("path",{attrs:{d:"M40.5,48c-1.6,0-2.8-1.3-2.8-2.8l0-16.8c0-1.6,1.3-2.8,2.8-2.8s2.8,1.3,2.8,2.8l0,16.8C43.3,46.8,42.1,48,40.5,48z"}}),t("rect",{attrs:{x:"32.1",y:"10.7",width:"16.8",height:"5.7"}}),t("rect",{attrs:{x:"57.9",y:"22.4",transform:"matrix(0.7069 -0.7073 0.7073 0.7069 2.864400e-02 50.6141)",width:"6.3",height:"5.7"}})])])])],1),t("div",["video"===e.selected_mode?t("div",{staticClass:"_videoEq"},[e.enable_audio_recording_in_video?t("div",{staticClass:"_tiny_equalizer"},[t("AudioEqualizer",{attrs:{stream:e.stream,is_recording:e.is_recording,type:"Tiny"}})],1):e._e(),e.is_recording?e._e():t("span",{staticClass:"u-switch u-switch-xs"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.enable_audio_recording_in_video,expression:"enable_audio_recording_in_video"}],staticClass:"switch",attrs:{id:"recordVideoWithAudio",type:"checkbox",disabled:e.is_recording},domProps:{checked:Array.isArray(e.enable_audio_recording_in_video)?e._i(e.enable_audio_recording_in_video,null)>-1:e.enable_audio_recording_in_video},on:{change:function(t){var i=e.enable_audio_recording_in_video,o=t.target,n=!!o.checked;if(Array.isArray(i)){var a=null,r=e._i(i,a);o.checked?r<0&&(e.enable_audio_recording_in_video=i.concat([a])):r>-1&&(e.enable_audio_recording_in_video=i.slice(0,r).concat(i.slice(r+1)))}else e.enable_audio_recording_in_video=n}}}),t("label",{staticClass:"u-label",attrs:{for:"recordVideoWithAudio"}},[e._v(e._s(e.$t("with_sound")))])])]):e._e(),"stopmotion"===e.selected_mode?[e.is_making_stopmotion?t("div",{staticClass:"_stopmotionValidation"},[t("div",{staticClass:"_stopmotionValidation--fpscounter"},[t("label",{staticClass:"u-label"},[e._v(e._s(e.$t("img_per_second")))]),t("select",{directives:[{name:"model",rawName:"v-model.number",value:e.stopmotion_frame_rate,expression:"stopmotion_frame_rate",modifiers:{number:!0}}],attrs:{size:"small"},on:{change:function(t){var i=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(t){var i="_value"in t?t._value:t.value;return e._n(i)}));e.stopmotion_frame_rate=t.target.multiple?i:i[0]}}},[t("option",[e._v("2")]),t("option",[e._v("4")]),t("option",[e._v("8")]),t("option",[e._v("15")]),t("option",[e._v("24")]),t("option",[e._v("30")])])]),t("div",{},[t("button",{staticClass:"u-button u-button_bleuvert u-button_small",attrs:{type:"button"},on:{click:e.testStopmotion}},[t("img",{attrs:{src:`${e.$root.publicPath}images/i_play.svg`,width:"48",height:"48",draggable:"false"}}),e._v(" "+e._s(e.$t("assemble"))+" ")])])]):t("button",{staticClass:"u-button u-button_bleumarine",attrs:{type:"button"},on:{click:function(t){e.show_stopmotion_list=!e.show_stopmotion_list}}},[t("span",{},[e._v(e._s(e.$t("stopmotion_list")))])])]:e._e(),"vecto"===e.selected_mode?t("div",{staticClass:"_mode_accessory_range"},[t("label",{staticClass:"u-label"},[e._v(e._s(e.$t("number_of_colors"))+" = "+e._s(e.vecto_number_of_colors))]),t("input",{directives:[{name:"model",rawName:"v-model.number",value:e.vecto_number_of_colors,expression:"vecto_number_of_colors",modifiers:{number:!0}}],attrs:{type:"range",min:"2",max:"7",step:"1"},domProps:{value:e.vecto_number_of_colors},on:{__r:function(t){e.vecto_number_of_colors=e._n(t.target.value)},blur:function(t){return e.$forceUpdate()}}})]):e._e(),"lines"===e.selected_mode?t("button",{staticClass:"u-buttonLink",class:{"is--active":e.show_lines_settings},attrs:{type:"button"},on:{click:function(t){e.show_lines_settings=!e.show_lines_settings}}},[e._v(" "+e._s(e.$t("advanced_options"))+" ")]):e._e(),e.show_lines_settings?["lines"===e.selected_mode?t("div",{staticClass:"_mode_accessory_range"},[t("label",{staticClass:"u-label"},[e._v(e._s(e.$t("lines_angle"))+" = "+e._s(e.lines_angle))]),t("input",{directives:[{name:"model",rawName:"v-model.number",value:e.lines_angle,expression:"lines_angle",modifiers:{number:!0}}],attrs:{type:"range",min:"0",max:"359",step:"1"},domProps:{value:e.lines_angle},on:{__r:function(t){e.lines_angle=e._n(t.target.value)},blur:function(t){return e.$forceUpdate()}}})]):e._e(),"lines"===e.selected_mode?t("div",{staticClass:"_mode_accessory_range"},[t("label",{staticClass:"u-label"},[e._v(e._s(e.$t("brightness"))+" = "+e._s(e.lines_brightness))]),t("input",{directives:[{name:"model",rawName:"v-model.number",value:e.lines_brightness,expression:"lines_brightness",modifiers:{number:!0}}],staticClass:"margin-none",attrs:{type:"range",min:".1",max:"5",step:".1"},domProps:{value:e.lines_brightness},on:{__r:function(t){e.lines_brightness=e._n(t.target.value)},blur:function(t){return e.$forceUpdate()}}})]):e._e(),"lines"===e.selected_mode?t("div",{staticClass:"_mode_accessory_range"},[t("label",{staticClass:"u-label"},[e._v(e._s(e.$t("contrast"))+" = "+e._s(e.lines_contrast))]),t("input",{directives:[{name:"model",rawName:"v-model.number",value:e.lines_contrast,expression:"lines_contrast",modifiers:{number:!0}}],staticClass:"margin-none",attrs:{type:"range",min:".1",max:"5",step:".1"},domProps:{value:e.lines_contrast},on:{__r:function(t){e.lines_contrast=e._n(t.target.value)},blur:function(t){return e.$forceUpdate()}}})]):e._e(),"lines"===e.selected_mode?t("div",{staticClass:"_mode_accessory_range"},[t("label",{staticClass:"u-label"},[e._v(e._s(e.$t("lines_density"))+" = "+e._s(e.lines_density))]),t("input",{directives:[{name:"model",rawName:"v-model.number",value:e.lines_density,expression:"lines_density",modifiers:{number:!0}}],staticClass:"margin-none",attrs:{type:"range",min:"0.2",max:"0.3",step:".01"},domProps:{value:e.lines_density},on:{__r:function(t){e.lines_density=e._n(t.target.value)},blur:function(t){return e.$forceUpdate()}}})]):e._e()]:e._e()],2)])])],1)])],1),e.show_stopmotion_list&&!e.is_making_stopmotion?t("StopmotionList",{attrs:{project_path:e.path},on:{loadStopmotion:e.loadStopmotion}}):e._e()],1)},n=[],a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"_modeSelector"},[e.available_modes.length>1?t("div",{staticClass:"_arrows"},[t("button",{staticClass:"u-button u-button_transparent",attrs:{type:"button"},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.previousMode.apply(null,arguments)}}},[t("svg",{staticStyle:{"enable-background":"new 0 0 169 169"},attrs:{version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",x:"0px",y:"0px",width:"169px",height:"169px",viewBox:"0 0 169 169","xml:space":"preserve"}},[t("path",{attrs:{fill:"currentColor",stroke:"currentColor","stroke-width":"10","stroke-linejoin":"round",d:"M60.2,84.5l48.6-24.3l0,48.6L60.2,84.5z"}})])])]):e._e(),e._l(e.available_modes,(function(i){return t("div",{key:i},[t("input",{attrs:{type:"radio",id:e.id+"_"+i},domProps:{value:i,checked:e.selected_mode===i},on:{click:function(t){return e.$emit("changeMode",i)}}}),t("label",{attrs:{for:e.id+"_"+i}},[t("div",{staticClass:"_picto",attrs:{content:e.$t(i)}},[t("img",{attrs:{src:e.available_mode_picto[i]}})]),e.selected_mode===i?t("span",[e._v(e._s(e.$t(i)))]):e._e()])])})),e.available_modes.length>1?t("div",{staticClass:"_arrows"},[t("button",{staticClass:"u-button u-button_transparent",attrs:{type:"button"},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.nextMode.apply(null,arguments)}}},[t("svg",{staticStyle:{"enable-background":"new 0 0 169 169"},attrs:{version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",x:"0px",y:"0px",width:"169px",height:"169px",viewBox:"0 0 169 169","xml:space":"preserve"}},[t("path",{attrs:{fill:"currentColor",stroke:"currentColor","stroke-width":"10","stroke-linejoin":"round",d:"M108.8,84.5l-48.6,24.3V60.2L108.8,84.5z"}})])])]):e._e()],2)},r=[],s={props:{available_modes:Array,selected_mode:String,disable_change_mode:Boolean},components:{},data(){return{id:(Math.random().toString(36)+"00000000000000000").slice(2,8),available_mode_picto:{photo:this.$root.publicPath+"images/i_icone-dodoc_image.svg",video:this.$root.publicPath+"images/i_icone-dodoc_video.svg",stopmotion:this.$root.publicPath+"images/i_icone-dodoc_anim.svg",audio:this.$root.publicPath+"images/i_icone-dodoc_audio.svg",vecto:this.$root.publicPath+"images/i_icone-dodoc_vecto.svg",lines:this.$root.publicPath+"images/i_icone-dodoc_lines.svg"}}},created(){},mounted(){this.$eventHub.$on("mode.set.previous",this.previousMode),this.$eventHub.$on("mode.set.next",this.nextMode)},beforeDestroy(){this.$eventHub.$off("mode.set.previous",this.previousMode),this.$eventHub.$off("mode.set.next",this.nextMode)},watch:{},computed:{},methods:{previousMode(){if(this.disable_change_mode)return;let e=this.available_modes.indexOf(this.selected_mode);e>0?this.$emit("changeMode",this.available_modes[e-1]):this.$emit("changeMode",this.available_modes[this.available_modes.length-1])},nextMode(){if(this.disable_change_mode)return;let e=this.available_modes.indexOf(this.selected_mode);e<this.available_modes.length-1?this.$emit("changeMode",this.available_modes[e+1]):this.$emit("changeMode",this.available_modes[0])}}},d=s,c=(i(59775),i(81656)),l=(0,c.A)(d,a,r,!1,null,"5fc4cc80",null),u=l.exports,m=function(){var e=this,t=e._self._c;return e.media_to_validate?t("div",{staticClass:"m_previewValidation"},["image"===e.media_to_validate.type?t("img",{attrs:{src:e.media_to_validate.objectURL}}):"video"===e.media_to_validate.type||"audio"===e.media_to_validate.type?t("vue-plyr",{staticClass:"m_previewValidation--video"},[t("video",{ref:"videoElement",attrs:{src:e.media_to_validate.objectURL,poster:e.media_to_validate.preview,preload:"auto"}})]):"svg"===e.media_to_validate.type?t("div",{staticClass:"m_previewValidation--svg",domProps:{innerHTML:e._s(e.media_to_validate.preview)}}):e._e()],1):e._e()},p=[],f={props:{media_to_validate:Object,audio_output_deviceId:String},components:{},data(){return{}},created(){},mounted(){this.setSinkId()},beforeDestroy(){},watch:{audio_output_deviceId:{handler(){this.setSinkId()}}},computed:{},methods:{setSinkId(){this.audio_output_deviceId&&("video"!==this.media_to_validate.type&&"audio"!==this.media_to_validate.type||this.$refs.videoElement.setSinkId(this.audio_output_deviceId))}}},h=f,v=(i(82460),(0,c.A)(h,m,p,!1,null,"40d4ba5e",null)),g=v.exports,_=function(){var e=this,t=e._self._c;return t("div",{staticClass:"m_mediaValidationButtons"},[t("button",{staticClass:"u-button u-button_transparent _arrows",attrs:{type:"button"},on:{click:e.selectedMoveLeft}},[t("svg",{staticStyle:{"enable-background":"new 0 0 169 169"},attrs:{version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",x:"0px",y:"0px",width:"169px",height:"169px",viewBox:"0 0 169 169","xml:space":"preserve"}},[t("path",{attrs:{fill:"currentColor",d:"M60.2,84.5l48.6-24.3l0,48.6L60.2,84.5z"}})])]),t("button",{staticClass:"u-button u-button_black",class:{"is--active":0===e.selected_button},attrs:{type:"button"},on:{mousedown:function(t){return t.stopPropagation(),t.preventDefault(),e.validateButton(0)},touchstart:function(t){return t.stopPropagation(),t.preventDefault(),e.validateButton(0)},mouseover:function(t){e.selected_button=0}}},[e.cancelButtonIsBackButton?[t("span",{},[e._v("‹ "+e._s(e.$t("back")))])]:[t("svg",{staticStyle:{"enable-background":"new 0 0 168 168"},attrs:{version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",x:"0px",y:"0px",viewBox:"0 0 168 168","xml:space":"preserve"}},[t("polygon",{attrs:{fill:"currentColor",points:"42.6,57.2 57.5,42.4 84.1,69 110.8,42.4 125.6,57.2 99,83.9 125.6,110.5 110.8,125.4 \n      84.1,98.7 57.5,125.4 42.6,110.5 69.3,83.9"}})]),t("span",{},[e._v(e._s(e.$t("cancel")))])]],2),t("div",{staticClass:"_valStarBtns"},[t("button",{staticClass:"u-button u-button_red _checkBtn",class:{"is--active":1===e.selected_button},attrs:{type:"button",title:e.$t("save")},on:{click:function(t){return e.validateButton(1)},mouseover:function(t){e.selected_button=1}}},[t("svg",{staticStyle:{"enable-background":"new 0 0 168 168"},attrs:{version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",x:"0px",y:"0px",viewBox:"0 0 168 168","xml:space":"preserve"}},[t("rect",{attrs:{x:"51.4",y:"73.1",transform:"matrix(0.7071 -0.7071 0.7071 0.7071 -53.857 72.9892)",width:"19.5",height:"56.8",fill:"currentColor"}}),t("rect",{attrs:{x:"53.2",y:"77.3",transform:"matrix(0.7071 -0.7071 0.7071 0.7071 -31.6875 97.6563)",width:"97.6",height:"19.5",fill:"currentColor"}})]),t("span",{staticClass:"c-rouge"},[e._v(e._s(e.$t("save")))]),t("span",{staticClass:"u-icon",domProps:{innerHTML:e._s(e.dodoc_icon_collect)}})]),e.can_add_to_fav?t("button",{staticClass:"u-button u-button_red _favBtn",class:{"is--active":2===e.selected_button},attrs:{type:"button",title:e.$t("add_to_fav")},on:{click:function(t){return e.validateButton(2)},mouseover:function(t){e.selected_button=2}}},[t("b-icon",{attrs:{icon:2===e.selected_button?"star-fill":"star"}})],1):e._e()]),t("button",{staticClass:"u-button u-button_transparent u-colorOrange _arrows",attrs:{type:"button"},on:{click:e.selectedMoveRight}},[t("svg",{staticStyle:{"enable-background":"new 0 0 169 169"},attrs:{version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",x:"0px",y:"0px",width:"169px",height:"169px",viewBox:"0 0 169 169","xml:space":"preserve"}},[t("path",{attrs:{fill:"currentColor",d:"M108.8,84.5l-48.6,24.3V60.2L108.8,84.5z"}})])]),e.media_is_being_sent?t("div",{staticClass:"m_mediaValidationButtons--overlay"},[t("transition",{attrs:{name:"fade_fast",duration:150}},[t("LoaderSpinner")],1),t("span",{staticClass:"m_mediaValidationButtons--overlay--percent",domProps:{textContent:e._s(e.media_being_sent_percent+"%")}})],1):e._e()])},b=[],y={props:{media_is_being_sent:Boolean,media_being_sent_percent:Number,can_add_to_fav:Boolean,cancelButtonIsBackButton:{type:Boolean,default:!1}},components:{},data(){return{selected_button:1}},created(){},mounted(){document.addEventListener("keyup",this.captureKeyListener)},beforeDestroy(){document.removeEventListener("keyup",this.captureKeyListener)},watch:{},computed:{},methods:{captureKeyListener(e){switch(console.log("METHODS • MediaValidationButtons: captureKeyListener"),e.key){case"w":case"z":case"ArrowLeft":this.selectedMoveLeft();break;case"s":case"ArrowRight":this.selectedMoveRight();break;case"a":case"q":case" ":this.validateButton(this.selected_button);break}return e.preventDefault(),!1},selectedMoveLeft(){console.log("METHODS • MediaValidationButtons: captureKeyListener / goleft"),this.selected_button+=this.selected_button>0?-1:0},selectedMoveRight(){console.log("METHODS • MediaValidationButtons: captureKeyListener / goright"),this.selected_button+=this.selected_button<2?1:0},validateButton(e){0===e?this.$emit("cancel"):1===e?this.$emit("save"):2===e&&this.$emit("save_and_fav")}}},w=y,C=(i(10136),(0,c.A)(w,_,b,!1,null,"7e4a586a",null)),S=C.exports,x=function(){var e=this,t=e._self._c;return t("div",{staticClass:"m_stopmotionpanel",class:{"is--showing_video_validation":e.validating_video_preview}},[e.stopmotion?e.fetch_stopmotion_error?t("div",[e._v(" "+e._s(e.fetch_stopmotion_error)+" ")]):[e.validating_video_preview?t("div",{ref:"videoPreview",staticClass:"m_stopmotionpanel--videopreview"},[t("PreviewStopmotion",{attrs:{medias:e.medias,frame_rate:e.frame_rate,output_format:e.output_format,created_stopmotion:e.created_stopmotion},on:{"update:frame_rate":function(t){e.frame_rate=t},"update:output_format":function(t){e.output_format=t}}}),t("transition",{attrs:{name:"fade_fast",duration:150,mode:"out-in"}},[e.compilation_in_progress?t("LoaderSpinner"):e._e()],1)],1):[t("div",{staticClass:"m_stopmotionpanel--toprowbuttons"},[t("button",{staticClass:"u-button u-button_black",attrs:{type:"button",disabled:0===e.image_index_currently_shown&&!e.show_live_feed},on:{click:e.firstImage}},[t("b-icon",{attrs:{icon:"chevron-double-left","aria-label":e.$t("first_image")}})],1),t("button",{staticClass:"u-button u-button_black",attrs:{type:"button",disabled:0===e.image_index_currently_shown&&!e.show_live_feed},on:{click:e.prevImage}},[t("b-icon",{attrs:{icon:"chevron-left","aria-label":e.$t("previous_image")}})],1),t("div",{},[e.preview_playing_event?t("button",{staticClass:"u-button u-button_black",attrs:{type:"button",disabled:e.show_live_feed},on:{click:e.pausePreview}},[t("b-icon",{attrs:{icon:"pause-fill"}}),e._v("   "+e._s(e.$t("pause"))+" ")],1):[t("button",{staticClass:"u-button u-button_black",attrs:{type:"button",disabled:e.medias.length<=1},on:{click:e.previewPlay}},[t("b-icon",{attrs:{icon:"play-fill"}}),e._v("   "+e._s(e.$t("play"))+" ")],1),t("button",{staticClass:"u-button u-button_black",attrs:{type:"button",disabled:e.medias.length<=1},on:{click:function(t){return e.previewPlay({loop:!0})}}},[t("b-icon",{attrs:{icon:"play-circle-fill"}}),e._v("   "+e._s(e.$t("loop"))+" ")],1)]],2),t("button",{staticClass:"u-button u-button_black",attrs:{type:"button",disabled:e.show_live_feed},on:{click:e.nextImage}},[t("b-icon",{attrs:{icon:"chevron-right","aria-label":e.$t("next_image")}})],1),t("button",{staticClass:"u-button u-button_black",attrs:{type:"button",disabled:e.show_live_feed},on:{click:e.lastImage}},[t("b-icon",{attrs:{icon:"chevron-double-right","aria-label":e.$t("last_image")}})],1)]),t("div",{staticClass:"m_stopmotionpanel--medias"},[t("transition-group",{ref:"mediaPreviews",staticClass:"m_stopmotionpanel--medias--list",attrs:{name:"listComplete"}},[e._l(e.medias,(function({media:i,duration:o},n){return t("div",{key:i.$path,staticClass:"m_stopmotionpanel--medias--list--items",class:{"is--current_single":e.previous_photo_to_show&&e.previous_photo_to_show.$path===i.$path&&!e.show_live_feed},on:{click:function(t){e.previous_photo_to_show=i,e.$emit("update:show_live_feed",!1)}}},[t("MediaContent",{attrs:{file:i,resolution:240}}),t("div",{staticClass:"_optionBtns"},[o>1||e.photoIsActive(i.$path)?t("button",{staticClass:"u-button u-button_small u-button_bleumarine",attrs:{type:"button",title:e.$t("duration")},on:{click:function(t){e.show_duration_menu=!e.show_duration_menu}}},[t("b-icon",{attrs:{icon:"clock"}}),e._v(" "+e._s(o)+" ")],1):e._e(),e.show_duration_menu&&e.photoIsActive(i.$path)?t("ImageDurationPicker",{attrs:{value:e.current_photo_duration,frame_rate:e.stopmotion_frame_rate},on:{close:function(t){e.show_duration_menu=!1},save:function(t){return e.updateMediaDurationForCurrentPreviousPhoto(t,n)}}}):e._e(),e.photoIsActive(i.$path)?[t("RemoveMenu",{attrs:{modal_title:e.$t("remove_this_image")},on:{remove:function(t){return e.removeMedia(i.$path)}}},[t("button",{staticClass:"u-button u-button_small u-button_red",attrs:{slot:"trigger",type:"button",title:e.$t("remove_this_image")},slot:"trigger"},[t("b-icon",{attrs:{icon:"trash"}})],1)]),t("button",{staticClass:"u-button u-button_small",attrs:{type:"button"},on:{click:function(t){e.show_options_menu=!e.show_options_menu}}},[t("b-icon",{attrs:{icon:"three-dots"}})],1),e.show_options_menu?t("BaseModal2",{attrs:{title:e.$t("options")},on:{close:function(t){e.show_options_menu=!1}}},[t("MediaContent",{attrs:{file:i,resolution:1600}}),t("div",{staticClass:"u-spacingBottom"}),t("div",{staticClass:"u-sameRow"},[t("div",[t("DownloadFile",{attrs:{file:i}})],1),t("button",{staticClass:"u-button u-button_orange",attrs:{type:"button"},on:{click:function(t){return e.saveToProject(i.$path)}}},[t("span",{staticClass:"u-icon",domProps:{innerHTML:e._s(e.dodoc_icon_collect)}}),e._v(" "+e._s(e.$t("save_to_project"))+" ")])]),e.status_saving_to_project?t("div",{staticClass:"_saveNotice"},["saving"===e.status_saving_to_project?t("div",[t("LoaderSpinner"),e._v(" "+e._s(e.$t("saving"))+" ")],1):"saved"===e.status_saving_to_project?t("div",[e._v(" "+e._s(e.$t("media_was_saved_to_project"))+" ")]):e._e()]):e._e()],1):e._e()]:e._e()],2)],1)})),t("div",{key:"live_feed",staticClass:"m_stopmotionpanel--medias--list--items",class:{"is--current_single":e.show_live_feed},attrs:{"data-content":e.$t("live")},on:{click:e.showVideoFeed}},[t("video",{ref:"videoElement",attrs:{autoplay:"",playsinline:"",muted:""},domProps:{muted:!0,srcObject:e.stream}}),e.show_live_feed?t("div",{key:"_onion_skin",staticClass:"_onion_skin"},[t("label",{},[t("span",[e._v(e._s(e.$t("onion_skin").toLowerCase()))]),t("input",{staticClass:"_onion_skin_range",attrs:{type:"range",min:"0",max:".9",step:"0.01","data-use":"onionskin"},domProps:{value:e.onion_skin_opacity},on:{input:function(t){return e.$emit("update:onion_skin_opacity",+t.target.value)}}})])]):e._e()])],2)],1)],e.validating_video_preview?t("MediaValidationButtons",{attrs:{media_is_being_sent:e.media_is_being_sent,can_add_to_fav:!0,cancelButtonIsBackButton:!0},on:{cancel:e.backToStopmotion,save:function(t){return e.exportStopmotion()},save_and_fav:function(t){return e.exportStopmotion({fav:!0})}}}):e._e(),e.media_is_being_sent?t("div",{staticClass:"_loader"},[t("LoaderSpinner")],1):e._e()]:t("LoaderSpinner")],2)},k=[],T=(i(44114),function(){var e=this,t=e._self._c;return t("div",[t("div",{staticClass:"_player"},[e.created_stopmotion?[t("MediaContent",{key:e.created_stopmotion.$path,attrs:{context:"full",file:e.created_stopmotion,resolution:1600}})]:[e.current_media?t("MediaContent",{attrs:{file:e.current_media.media,resolution:1600}}):e._e(),e.is_playing?e._e():t("div",{staticClass:"_miniListPreview"},e._l(e.medias,(function({media:e}){return t("MediaContent",{key:"previews-"+e.$path,attrs:{file:e,resolution:1600}})})),1),t("div",{staticClass:"_imgCount"},[e._v(" "+e._s(e.current_media_index+1)+"/"+e._s(e.medias.length)+" ")]),t("button",{staticClass:"_playPauseBtn",attrs:{type:"button"},on:{click:e.playPausePreview}},[e.is_playing?e._e():t("img",{attrs:{src:`${e.$root.publicPath}images/i_play.svg`,width:"48",height:"48",draggable:"false"}})]),t("transition",{attrs:{name:"fade"}},[e.is_playing?e._e():t("div",{staticClass:"_fps"},[t("div",{staticClass:"u-sameRow"},[t("div",[t("label",{staticClass:"u-label",attrs:{for:"fps_select"}},[e._v(e._s(e.$t("img_per_second")))]),t("select",{directives:[{name:"model",rawName:"v-model.number",value:e.new_frame_rate,expression:"new_frame_rate",modifiers:{number:!0}}],attrs:{size:"small",name:"fps_select",id:"fps_select"},on:{change:function(t){var i=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(t){var i="_value"in t?t._value:t.value;return e._n(i)}));e.new_frame_rate=t.target.multiple?i:i[0]}}},[t("option",[e._v("2")]),t("option",[e._v("4")]),t("option",[e._v("8")]),t("option",[e._v("15")]),t("option",[e._v("24")]),t("option",[e._v("30")])])]),t("div",[t("label",{staticClass:"u-label",attrs:{for:"output_format"}},[e._v(e._s(e.$t("format")))]),t("select",{directives:[{name:"model",rawName:"v-model",value:e.new_output_format,expression:"new_output_format"}],attrs:{size:"small",name:"output_format",id:e.output_format},on:{change:function(t){var i=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.new_output_format=t.target.multiple?i:i[0]}}},[t("option",{domProps:{value:"gif"}},[e._v(e._s(e.$t("gif")))]),t("option",{domProps:{value:"mp4"}},[e._v(e._s(e.$t("video")))])])])])])])]],2)])}),R=[],M={props:{medias:Array,frame_rate:Number,output_format:String,created_stopmotion:[Boolean,Object]},components:{},data(){return{current_media_index:0,is_playing:!1,new_frame_rate:this.frame_rate,new_output_format:this.output_format,next_image_timeout:null}},created(){},mounted(){},beforeDestroy(){},watch:{new_frame_rate(){this.$emit("update:frame_rate",this.new_frame_rate)},new_output_format(){this.$emit("update:output_format",this.new_output_format)}},computed:{current_media(){return this.medias[this.current_media_index]}},methods:{playPausePreview(){this.is_playing?this.stopPreview():this.playPreview()},stopPreview(){this.is_playing=!1,window.clearTimeout(this.next_image_timeout)},playPreview(){this.is_playing=!0;const e=()=>{const t=this.current_media.duration,i=1e3/this.frame_rate,o=t*i;this.next_image_timeout=window.setTimeout((()=>{this.current_media_index<this.medias.length-1?(this.current_media_index++,e()):this.is_playing=!1}),o)};this.current_media_index=0,e(this.current_media_index)}}},E=M,P=(i(22646),(0,c.A)(E,T,R,!1,null,"66c7c3e6",null)),D=P.exports,L=function(){var e=this,t=e._self._c;return t("BaseModal2",{attrs:{title:e.$t("duration")},on:{close:function(t){return e.$emit("close")}}},[t("div",{staticClass:"u-inputGroup u-spacingBottom"},[t("input",{directives:[{name:"model",rawName:"v-model.number",value:e.local_value,expression:"local_value",modifiers:{number:!0}}],staticClass:"_input",attrs:{type:"number",name:e.$t("duration"),id:"_input_"+e.$t("duration"),size:"medium",min:1,max:3600,step:1},domProps:{value:e.local_value},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.$emit("save",e.local_value)},input:function(t){t.target.composing||(e.local_value=e._n(t.target.value))},blur:function(t){return e.$forceUpdate()}}}),t("span",{staticClass:"u-suffix"},[e._v(" "+e._s((e.local_value>1?e.$t("images"):e.$t("image")).toLowerCase())+" ")])]),t("p",{staticClass:"u-instructions"},[e._v(" "+e._s(e.$t("duration_explanation",{seconds_equivalent:e.seconds_equivalent,frame_rate:e.frame_rate}))+" ")]),t("div",{staticClass:"u-spacingBottom"}),t("template",{slot:"footer"},[t("div"),t("SaveCancelButtons",{staticClass:"_scb",attrs:{allow_save:!0},on:{save:function(t){return e.$emit("save",e.local_value)},cancel:function(t){return e.$emit("close")}}})],1)],2)},U=[],A={props:{value:Number,frame_rate:Number},components:{},data(){return{local_value:this.value}},created(){},mounted(){},beforeDestroy(){},watch:{},computed:{seconds_equivalent(){return parseFloat((this.local_value/this.frame_rate).toFixed(2)).toLocaleString(this.$i18n.locale)}},methods:{}},$=A,I=(i(79939),(0,c.A)($,L,U,!1,null,"d2daf70e",null)),O=I.exports,B=(i(66707),{props:{current_stopmotion_path:String,stream:MediaStream,show_live_feed:Boolean,is_validating_stopmotion_video:Boolean,onion_skin_opacity:Number,stopmotion_frame_rate:Number},components:{MediaValidationButtons:S,PreviewStopmotion:D,ImageDurationPicker:O},data(){return{stopmotion:null,fetch_stopmotion_error:void 0,show_options_menu:!1,frame_rate:this.stopmotion_frame_rate,output_format:"mp4",validating_video_preview:!1,previous_photo_to_show:!1,media_is_being_sent:!1,show_advanced_menu:!1,compilation_in_progress:!1,created_stopmotion:!1,preview_playing_event:void 0,show_duration_menu:!1,status_saving_to_project:!1}},created(){},async mounted(){this.$eventHub.$on("stopmotion.addImage",this.appendToStopMotion),this.$eventHub.$on("stopmotion.test",this.testStopmotion);const e=await this.$api.getFolder({path:this.current_stopmotion_path}).catch((e=>{this.fetch_stopmotion_error=e.response}));this.stopmotion=e,this.$api.join({room:this.current_stopmotion_path})},beforeDestroy(){this.$api.leave({room:this.current_stopmotion_path}),this.$eventHub.$off("stopmotion.addImage",this.appendToStopMotion)},watch:{frame_rate(){this.$emit("update:stopmotion_frame_rate",this.frame_rate)},stopmotion_frame_rate(){this.frame_rate=this.stopmotion_frame_rate},medias(){this.medias.length>0&&this.show_live_feed&&(this.previous_photo_to_show=this.medias[this.medias.length-1].media,this.$nextTick((()=>{this.$nextTick((()=>{this.$refs.mediaPreviews.$el.scrollLeft=1e6}))})))},stream:{handler(){},immediate:!0},previous_photo_to_show(){this.$emit("showPreviousImage",this.previous_photo_to_show),this.$nextTick((()=>{const e=document.querySelector(".m_stopmotionpanel--medias--list--items.is--current_single");e&&e.scrollIntoView({behavior:"smooth",inline:"nearest"})}))},validating_video_preview(){this.$emit("update:is_validating_stopmotion_video",this.validating_video_preview)}},computed:{medias(){if(this.stopmotion?.images_list&&this.stopmotion?.$files?.length>0){const e=this.stopmotion.images_list.reduce(((e,t)=>{const i=t.m||t,o=t.d||1,n=this.stopmotion.$files.find((e=>e.$path.endsWith(i)));return n&&e.push({media:n,duration:o}),e}),[]);return e}return[]},images_list(){return this.medias.map((e=>({m:this.getFilename(e.media.$path),d:e.duration})))},image_index_currently_shown(){return!!this.previous_photo_to_show&&this.medias.findIndex((e=>e.media.$path===this.previous_photo_to_show.$path))},current_photo_duration(){return this.medias.find((e=>e.media.$path===this.previous_photo_to_show.$path))?.duration}},methods:{async appendToStopMotion({imageData:e}){const t={$origin:"capture"},{meta_filename:i}=await this.$api.uploadFile({path:this.current_stopmotion_path,filename:+new Date+".jpeg",file:e,additional_meta:t}).catch((e=>{throw this.$alertify.delay(4e3).error(e),e}));let o=this.images_list.slice();o.push({m:i,d:1}),await this.$api.updateMeta({path:this.current_stopmotion_path,new_meta:{images_list:o}})},previewPlay({loop:e=!1}={}){(this.show_live_feed||this.image_index_currently_shown===this.medias.length-1)&&this.firstImage();const t=i=>{if(i>this.medias.length-1)return e?t(0):this.pausePreview();this.previous_photo_to_show=this.medias[i].media;const o=this.medias[i].duration;this.preview_playing_event=window.setTimeout((()=>t(i+1)),1e3/this.frame_rate*o)};t(this.image_index_currently_shown)},pausePreview(){window.clearTimeout(this.preview_playing_event),this.preview_playing_event=void 0},testStopmotion(){this.validating_video_preview=!0,this.$nextTick((()=>{this.$nextTick((()=>{}))}))},photoIsActive(e){return this.previous_photo_to_show?.$path===e&&!this.show_live_feed},showVideoFeed(){this.previous_photo_to_show=this.medias[this.medias.length-1].media,this.$emit("update:show_live_feed",!0)},firstImage(){this.previous_photo_to_show=this.medias[0].media,this.$emit("update:show_live_feed",!1)},prevImage(){if(this.show_live_feed)return this.previous_photo_to_show=this.medias.at(-1).media,void this.$emit("update:show_live_feed",!1);this.previous_photo_to_show=this.medias[this.image_index_currently_shown-1].media},nextImage(){if(this.image_index_currently_shown===this.medias.length-1)return this.showVideoFeed();this.previous_photo_to_show=this.medias[this.image_index_currently_shown+1].media},lastImage(){this.showVideoFeed()},async updateMediaDurationForCurrentPreviousPhoto(e){const t=this.images_list.slice();t[this.image_index_currently_shown].d=e,await this.$api.updateMeta({path:this.current_stopmotion_path,new_meta:{images_list:t}}),this.show_duration_menu=!1},backToStopmotion(){console.log("METHODS • StopmotionPanel: backToStopmotion"),this.validating_video_preview=!1,this.created_stopmotion=!1,this.$emit("update:show_live_feed",!0)},async exportStopmotion({fav:e=!1}={}){this.compilation_in_progress=!0;const t={fav:e,$origin:"capture"};this.connected_as?.$path&&(t.$authors=[this.connected_as.$path]);const i=await this.$api.exportFolder({path:this.current_stopmotion_path,instructions:{recipe:"stopmotion",field:"images_list",frame_rate:this.frame_rate,output_format:this.output_format,additional_meta:t}});this.$alertify.delay(4e3).log(this.$t("compilation_started")),this.backToStopmotion();const o=({task_id:e,message:t})=>{if(e===i)if(this.$eventHub.$off("task.ended",o),this.compilation_in_progress=!1,"completed"===t.event){const e=this.getFilename(t.file?.$path);e&&this.$emit("insertMedia",e),this.$emit("close")}else this.$alertify.delay(4e3).error(t.info)};this.$eventHub.$on("task.ended",o)},async saveToProject(e){let{space_slug:t,project_slug:i}=this.decomposePath(e);const o=this.createPath({space_slug:t,project_slug:i});this.status_saving_to_project="saving";await this.$api.copyFile({path:e,path_to_destination_folder:o,new_meta:{$origin:"capture"}}).catch((e=>{this.$alertify.delay(4e3).error(e)}));this.status_saving_to_project="saved",setTimeout((()=>{this.status_saving_to_project=!1}),3e3)},async removeMedia(e){let t=this.images_list.slice();t=t.filter((t=>!e.endsWith(t.m))),this.nextImage(),await this.$api.updateMeta({path:this.current_stopmotion_path,new_meta:{images_list:t}}),await this.$api.deleteItem({path:e})}}}),F=B,N=(i(85499),(0,c.A)(F,x,k,!1,null,"422abd54",null)),V=N.exports,H=function(){var e=this,t=e._self._c;return t("BaseModal2",{attrs:{title:e.$t("location")},on:{close:function(t){return e.$emit("close")}}},[t("div",{staticClass:"u-instructions u-spacingBottom"},[e._v(" "+e._s(e.$t("location_stored_in_localstorage"))+" ")]),t("PositionPicker",{attrs:{field_name:"$location",content:e.location_to_add_to_medias,can_edit:!0},on:{newPosition:e.newPosition}})],1)},j=[],z={props:{location_to_add_to_medias:Object},components:{},data(){return{}},created(){},mounted(){},beforeDestroy(){},watch:{},computed:{},methods:{newPosition(e){this.$emit("update:location_to_add_to_medias",e),setTimeout((()=>{this.$emit("close")}),1e3)}}},q=z,W=(0,c.A)(q,H,j,!1,null,"54dfbd98",null),G=W.exports,K=function(){var e=this,t=e._self._c;return t("div",{staticClass:"_capturePane",attrs:{"data-type":e.pane_type}},[t("div",{staticClass:"_topbar"},[t("div",{staticClass:"_topbar--title"},[t("h3",{},[e._v(" "+e._s(e.label)+" ")]),t("button",{staticClass:"u-button u-button_icon _close_button",attrs:{type:"button"},on:{click:function(t){return e.$emit("close")}}},[t("b-icon",{attrs:{icon:"x-lg",label:e.$t("close")}})],1)])]),e._t("default")],2)},X=[],J={props:{label:String,pane_type:String},components:{},data(){return{}},created(){},mounted(){},beforeDestroy(){},watch:{},computed:{},methods:{}},Y=J,Q=(i(18774),(0,c.A)(Y,K,X,!1,null,"5cdbfa5a",null)),Z=Q.exports,ee=function(){var e=this,t=e._self._c;return t("div",{staticClass:"m_captureSettings"},[t("transition",{attrs:{name:"fade_fast",duration:400}},[e.is_loading_available_devices||e.is_loading_feed?t("LoaderSpinner",{staticClass:"_loader"}):e._e()],1),t("div",{staticClass:"m_captureSettings--settings"},["LocalSources"===e.current_mode?t("div",{},["not_allowed"===e.status?t("div",[t("div",{staticClass:"padding-top-verysmall"},[e._v(" "+e._s(e.$t("camera_access_refused"))+" ")])]):e._e(),t("label",{staticClass:"u-label _sourcesTitle"},[e._v(" "+e._s(e.$t("sources"))+" "),t("button",{staticClass:"u-buttonLink margin-none margin-left padding-bottom-none",attrs:{type:"button"},on:{click:e.refreshAvailableDevices}},[e._v(" "+e._s(e.$t("reload"))+" ")])]),t("div",{},[t("div",{},[t("label",{staticClass:"u-label"},[e._v(e._s(e.$t("camera")))]),t("div",[0===e.all_video_input_devices.length?t("small",[e._v(" "+e._s(e.$t("no_video_input_available"))+" ")]):t("select",{directives:[{name:"model",rawName:"v-model",value:e.selected_devices.video_input_device,expression:"selected_devices.video_input_device"}],attrs:{id:"devices",name:"Video devices",title:"devices"},on:{change:function(t){var i=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.selected_devices,"video_input_device",t.target.multiple?i:i[0])}}},e._l(e.all_video_input_devices,(function(i){return t("option",{key:i.deviceId,domProps:{value:i}},[e._v(" "+e._s(i.label)+" ")])})),0)]),e.selected_devices.video_input_device&&"screen_capture"===e.selected_devices.video_input_device.deviceId?t("div",{staticClass:"margin-top-veryverysmall"},[t("span",{staticClass:"u-switch u-switch-xs"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.advanced_capture_options.cursor.enabled,expression:"advanced_capture_options.cursor.enabled"}],attrs:{id:"show_cursor",type:"checkbox",disabled:!e.advanced_capture_options.cursor.supported,"true-value":"always","false-value":"never"},domProps:{checked:Array.isArray(e.advanced_capture_options.cursor.enabled)?e._i(e.advanced_capture_options.cursor.enabled,null)>-1:e._q(e.advanced_capture_options.cursor.enabled,"always")},on:{change:function(t){var i=e.advanced_capture_options.cursor.enabled,o=t.target,n=o.checked?"always":"never";if(Array.isArray(i)){var a=null,r=e._i(i,a);o.checked?r<0&&e.$set(e.advanced_capture_options.cursor,"enabled",i.concat([a])):r>-1&&e.$set(e.advanced_capture_options.cursor,"enabled",i.slice(0,r).concat(i.slice(r+1)))}else e.$set(e.advanced_capture_options.cursor,"enabled",n)}}}),t("label",{staticClass:"u-label",attrs:{for:"show_cursor"}},[e._v(e._s(e.$t("show_cursor")))]),e.advanced_capture_options.cursor.supported?e._e():t("small",[e._v(" "+e._s(e.$t("not_supported_on_this_device"))+" ")])])]):e._e()]),t("div",[t("label",{staticClass:"u-label"},[e._v(e._s(e.$t("audioinput")))]),t("div",[0===e.all_audio_input_devices.length?t("small",[e._v(" "+e._s(e.$t("no_audio_input_available"))+" ")]):t("select",{directives:[{name:"model",rawName:"v-model",value:e.selected_devices.audio_input_device,expression:"selected_devices.audio_input_device"}],attrs:{id:"devices",name:"Video devices",title:"devices"},on:{change:function(t){var i=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.selected_devices,"audio_input_device",t.target.multiple?i:i[0])}}},e._l(e.all_audio_input_devices,(function(i){return t("option",{key:i.deviceId,domProps:{value:i}},[e._v(" "+e._s(i.label)+" ")])})),0)]),e.selected_devices.audio_input_device?t("div",{staticClass:"margin-top-veryverysmall"},[t("span",{staticClass:"u-switch u-switch-xs"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.advanced_capture_options.echoCancellation.enabled,expression:"advanced_capture_options.echoCancellation.enabled"}],attrs:{id:"echoCancellation",type:"checkbox",disabled:!e.advanced_capture_options.echoCancellation.supported},domProps:{checked:Array.isArray(e.advanced_capture_options.echoCancellation.enabled)?e._i(e.advanced_capture_options.echoCancellation.enabled,null)>-1:e.advanced_capture_options.echoCancellation.enabled},on:{change:function(t){var i=e.advanced_capture_options.echoCancellation.enabled,o=t.target,n=!!o.checked;if(Array.isArray(i)){var a=null,r=e._i(i,a);o.checked?r<0&&e.$set(e.advanced_capture_options.echoCancellation,"enabled",i.concat([a])):r>-1&&e.$set(e.advanced_capture_options.echoCancellation,"enabled",i.slice(0,r).concat(i.slice(r+1)))}else e.$set(e.advanced_capture_options.echoCancellation,"enabled",n)}}}),t("label",{staticClass:"u-label",attrs:{for:"echoCancellation"}},[e._v(e._s(e.$t("echoCancellation")))]),e.advanced_capture_options.echoCancellation.supported?e._e():t("small",[e._v(" "+e._s(e.$t("not_supported_on_this_device"))+" ")])])]):e._e(),e.selected_devices.audio_input_device?t("div",{staticClass:"margin-top-veryverysmall"},[t("span",{staticClass:"u-switch u-switch-xs"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.advanced_capture_options.noiseSuppression.enabled,expression:"advanced_capture_options.noiseSuppression.enabled"}],attrs:{id:"noiseSuppression",type:"checkbox",disabled:!e.advanced_capture_options.noiseSuppression.supported},domProps:{checked:Array.isArray(e.advanced_capture_options.noiseSuppression.enabled)?e._i(e.advanced_capture_options.noiseSuppression.enabled,null)>-1:e.advanced_capture_options.noiseSuppression.enabled},on:{change:function(t){var i=e.advanced_capture_options.noiseSuppression.enabled,o=t.target,n=!!o.checked;if(Array.isArray(i)){var a=null,r=e._i(i,a);o.checked?r<0&&e.$set(e.advanced_capture_options.noiseSuppression,"enabled",i.concat([a])):r>-1&&e.$set(e.advanced_capture_options.noiseSuppression,"enabled",i.slice(0,r).concat(i.slice(r+1)))}else e.$set(e.advanced_capture_options.noiseSuppression,"enabled",n)}}}),t("label",{staticClass:"u-label",attrs:{for:"noiseSuppression"}},[e._v(e._s(e.$t("noiseSuppression")))]),e.advanced_capture_options.noiseSuppression.supported?e._e():t("small",[e._v(" "+e._s(e.$t("not_supported_on_this_device"))+" ")])])]):e._e()]),t("div",[t("label",{staticClass:"u-label"},[e._v(e._s(e.$t("audiooutput")))]),t("div",[0===e.all_audio_output_devices.length?t("small",[e._v(" "+e._s(e.$t("no_audio_output_available"))+" ")]):t("select",{directives:[{name:"model",rawName:"v-model",value:e.selected_devices.audio_output_device,expression:"selected_devices.audio_output_device"}],attrs:{id:"devices",name:"Video devices",title:"devices"},on:{change:function(t){var i=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.selected_devices,"audio_output_device",t.target.multiple?i:i[0])}}},e._l(e.all_audio_output_devices,(function(i){return t("option",{key:i.deviceId,domProps:{value:i}},[e._v(" "+e._s(i.label)+" ")])})),0)])])]),t("div",{staticClass:"u-spacingBottom"}),t("label",{staticClass:"u-label"},[e._v(e._s(e.$t("resolutions")))]),t("div",[e.selected_devices.video_input_device&&e.selected_devices.video_input_device.deviceId?e._e():t("div",[t("small",[e._v(" "+e._s(e.$t("pick_a_camera"))+" ")])]),e.selected_devices.video_input_device&&("screen_capture"===e.selected_devices.video_input_device.deviceId||e.selected_devices.video_input_device.chromeMediaSource)?t("div",[t("small",[e._v(" "+e._s(e.$t("cant_pick_resolution_when_screen_capture"))+" ")])]):t("div",{staticClass:"m_captureSettings--settings--resolutions"},[e._l(e.predefined_resolutions.concat(e.custom_camera_resolution),(function(i){return t("div",{key:i.name},[t("label",{attrs:{for:i.label}},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.desired_camera_resolution,expression:"desired_camera_resolution"}],attrs:{type:"radio",id:i.label,disabled:e.unavailable_camera_resolutions.includes(i.label)},domProps:{value:i,checked:e._q(e.desired_camera_resolution,i)},on:{change:function(t){e.desired_camera_resolution=i}}}),t("span",{staticClass:"_resolutionLabel"},[t("DLabel",{attrs:{str:i.label,tag:"div",instructions:e.resInstructions(i)}})],1)])])})),e.desired_camera_resolution&&"custom"===e.desired_camera_resolution.type?t("div",{staticClass:"u-sameRow _customResolution"},[t("label",{staticClass:"u-label",attrs:{for:"custom_width"}},[t("input",{directives:[{name:"model",rawName:"v-model.number",value:e.desired_camera_resolution.width,expression:"desired_camera_resolution.width",modifiers:{number:!0}}],attrs:{name:"custom_width",type:"number",min:"2",max:"4096",step:"2"},domProps:{value:e.desired_camera_resolution.width},on:{input:function(t){t.target.composing||e.$set(e.desired_camera_resolution,"width",e._n(t.target.value))},blur:function(t){return e.$forceUpdate()}}})]),t("span",{staticClass:"u-padding_verysmall _customResolutionX"},[e._v(" × ")]),t("label",{staticClass:"u-label",attrs:{for:"custom_height"}},[t("input",{directives:[{name:"model",rawName:"v-model.number",value:e.desired_camera_resolution.height,expression:"desired_camera_resolution.height",modifiers:{number:!0}}],attrs:{name:"custom_height",type:"number",min:"2",max:"2160",step:"2"},domProps:{value:e.desired_camera_resolution.height},on:{input:function(t){t.target.composing||e.$set(e.desired_camera_resolution,"height",e._n(t.target.value))},blur:function(t){return e.$forceUpdate()}}}),e._v(" "+e._s(e.$t("pixels"))+" ")])]):e._e()],2)])]):"RemoteSources"===e.current_mode?t("div",[t("div",[e._v(" "+e._s(e.$t("feature_not_yet_implemented"))+" ")]),t("div",{staticClass:"u-disabled"},[t("small",[e._v(e._s(e.$t("connect_to_other_users")))]),t("div",{staticClass:"padding-vert-small padding-bottom-small"},[t("label",{staticClass:"u-label",domProps:{innerHTML:e._s(e.$t("name_of_stream"))}}),t("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.access_distant_stream.callee,expression:"access_distant_stream.callee",modifiers:{trim:!0}},{name:"uppercase",rawName:"v-uppercase"}],attrs:{type:"text",required:"",disabled:e.access_distant_stream.status.enabled,autofocus:"autofocus",onfocus:"this.select()"},domProps:{value:e.access_distant_stream.callee},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:(t.preventDefault(),e.callStream.apply(null,arguments))},input:function(t){t.target.composing||e.$set(e.access_distant_stream,"callee",t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}})])])]):e._e()]),e._e()],1)},te=[],ie=i(5503),oe=i.n(ie),ne={props:{audio_output_deviceId:String},components:{},data(){return{is_loading_available_devices:!1,is_loading_feed:!1,status:void 0,current_mode:"LocalSources",current_stream:void 0,local_stream:void 0,remote_stream:void 0,stream_current_settings:void 0,desired_camera_resolution:void 0,last_working_resolution:void 0,selected_devices:{video_input_device:void 0,audio_input_device:void 0,audio_output_device:void 0},connected_devices:[],predefined_resolutions:[{label:this.$t("very_high"),label_detail:"4K(UHD)",width:3840,height:2160,ratio:"16:9"},{label:this.$t("high"),label_detail:"1080p(FHD)",width:1920,height:1080,ratio:"16:9"},{label:this.$t("medium"),label_detail:"720p(HD)",width:1280,height:720,ratio:"16:9"},{label:this.$t("low"),label_detail:"VGA",width:640,height:480,ratio:"4:3"}],unavailable_camera_resolutions:[],custom_camera_resolution:{label:this.$t("custom_f"),type:"custom",width:1280,height:720},advanced_capture_options:{echoCancellation:{supported:void 0,enabled:!1},noiseSuppression:{supported:void 0,enabled:!1},cursor:{supported:void 0,enabled:!1}},rtcmulti_connection:void 0,share_this_stream:{enabled:!1,name:`DODOC-${(Math.random().toString(36)+"00000000000000000").slice(2,5)}`,status:{loading:!1,enabled:void 0,name:void 0,peers_connected:[]}},access_distant_stream:{calling:!1,callee:"",status:{enabled:!1,callee:void 0}}}},created(){},mounted(){navigator.mediaDevices.getUserMedia?(this.is_loading_feed=!0,this.is_loading_available_devices=!0,navigator.mediaDevices.getUserMedia({audio:!0,video:!0}).then((e=>{this.local_stream=e})).catch((e=>{this.$alertify.closeLogOnClick(!0).delay(4e3).error(this.$t("couldnt_load_getusermedia")+"<br>"+e.name+": "+e.message),this.is_loading_feed=!1,this.$emit("hasFinishedLoading"),this.$emit("show")})).then(this.refreshAvailableDevices).then((()=>{this.setDefaultInputsAndOutputs()})).catch((e=>{this.is_loading_feed=!1,this.$alertify.closeLogOnClick(!0).delay(4e3).error(this.$t("failed_listing_devices")+"<br>"+e.name+": "+e.message)})).then((()=>this.setCameraStreamFromDefaults())).then((()=>{this.is_loading_feed=!1,this.$emit("hasFinishedLoading")})).catch((()=>{this.is_loading_feed=!1,this.$emit("hasFinishedLoading")}))):alert("You need a browser that supports WebRTC")},beforeDestroy(){this.local_stream&&this.local_stream.getTracks().forEach((e=>e.stop())),this.remote_stream&&this.remote_stream.getTracks().forEach((e=>e.stop())),this.closeMultiRTC()},watch:{"selected_devices.video_input_device":function(){this.unavailable_camera_resolutions=[],this.last_working_resolution=!1},local_stream:function(){this.setCurrentStream()},remote_stream:function(){this.setCurrentStream()},current_mode:function(){this.setCurrentStream()},current_stream:function(){this.$emit("setStream",{stream:this.current_stream,type:this.current_mode})},selected_devices:{handler(){localStorage.setItem("selected_devices",JSON.stringify(this.selected_devices)),this.setCameraStreamFromDefaults()},deep:!0},desired_camera_resolution:{handler(){this.setCameraStreamFromDefaults()},deep:!0},last_working_resolution:{handler(){},deep:!0},share_this_stream:{handler(){this.$eventHub.$emit("stream.newSharingInformations",this.share_this_stream.status)},deep:!0},access_distant_stream:{handler(){this.$eventHub.$emit("stream.newDistantAccessInformations",this.access_distant_stream.status)},deep:!0}},computed:{all_video_input_devices(){return this.connected_devices.filter((e=>"videoinput"===e.kind))},all_audio_input_devices(){return this.connected_devices.filter((e=>"audioinput"===e.kind))},all_audio_output_devices(){return this.connected_devices.filter((e=>"audiooutput"===e.kind))},current_settings(){let e="";return this.selected_devices.video_input_device&&(e+=this.selected_devices.video_input_device.deviceId+"-","screen_capture"===this.selected_devices.video_input_device.deviceId&&(e+=this.advanced_capture_options.cursor.enabled+"-")),this.desired_camera_resolution&&this.desired_camera_resolution.width&&this.desired_camera_resolution.height&&(e+=this.desired_camera_resolution.width+"x"+this.desired_camera_resolution.height+"-"),this.selected_devices.audio_input_device&&(e+=this.selected_devices.audio_input_device.deviceId+"-",e+=this.noiseSuppression+"-",e+=this.echoCancellation+"-"),this.share_this_stream.enabled&&(e+=this.share_this_stream.name+"-"),this.selected_devices.audio_output_device&&(e+=this.selected_devices.audio_output_device.deviceId+"-"),e}},methods:{listDevices(){return new Promise(((e,t)=>{!0===this.$root.debug_mode&&console.log("CaptureSettings • METHODS : listDevices"),navigator.mediaDevices.enumerateDevices().then((t=>e(t))).catch((e=>t(e)))}))},setCurrentStream(){!0===this.$root.debug_mode&&console.log("CaptureSettings • METHODS : setCurrentStream"),"RemoteSources"===this.current_mode?this.current_stream=this.remote_stream:"LocalSources"===this.current_mode&&(this.current_stream=this.local_stream)},resInstructions(e){if("custom"!==e.type)return`${e.label_detail} • ${e.ratio} • ${e.width}×${e.height} ${this.$t("pixels")}`},setSupportedConstraints(){return new Promise((e=>{!0===this.$root.debug_mode&&console.log("CaptureSettings • METHODS : setSupportedConstraints");const t=navigator.mediaDevices.getSupportedConstraints();return t?(Object.entries(this.advanced_capture_options).map((([e])=>{this.advanced_capture_options[e].supported=this.advanced_capture_options[e].enabled=!0===t[e]})),e()):e()}))},setDefaultInputsAndOutputs(){!0===this.$root.debug_mode&&console.log("CaptureSettings • METHODS : setDefaultInputsAndOutputs"),0!==this.connected_devices.length&&(this.all_video_input_devices.length>0&&(this.selected_devices.video_input_device=this.getDefaultDevice({key:"video_input_device",option_preference:{key:"facingMode",value:"environment"},devices_list:this.all_video_input_devices})),this.all_audio_input_devices.length>0&&(this.selected_devices.audio_input_device=this.getDefaultDevice({key:"audio_input_device",devices_list:this.all_audio_input_devices})),this.all_audio_output_devices.length>0&&(this.selected_devices.audio_output_device=this.getDefaultDevice({key:"audio_output_device",devices_list:this.all_audio_output_devices})),this.desired_camera_resolution=this.predefined_resolutions.find((e=>720===e.height)))},getDefaultDevice({key:e,option_preference:t,devices_list:i}){!0===this.$root.debug_mode&&console.log("CaptureSettings • METHODS : getDefaultDevice");let o=!1;if(localStorage.getItem("selected_devices"))try{if(o=JSON.parse(localStorage.getItem("selected_devices")),o?.[e]){const t=i.find((t=>t.deviceId===o[e].deviceId));if(t)return t}}catch(n){}if(t){const e=i.find((e=>e[t.key]===t.value));if(e)return e}return!0===this.$root.debug_mode&&console.log("CaptureSettings • METHODS : getDefaultDevice — settings first available device for "+e),i[0]},startMediaDeviceFeed(e){return new Promise(((t,i)=>{!0===this.$root.debug_mode&&console.log("CaptureSettings • METHODS : startMediaDeviceFeed");let o=[];o.push(new Promise(((t,i)=>{if(!e.video)return t();!0===e._is_webrtc_screen_capture?navigator.mediaDevices.getDisplayMedia({video:e.video,audio:!1}).then((e=>t({type:"videoStream",stream:e}))).catch((e=>i(e))):navigator.mediaDevices.getUserMedia({video:e.video,audio:!1}).then((e=>t({type:"videoStream",stream:e}))).catch((e=>i(e)))}))),o.push(new Promise(((t,i)=>{if(!e.audio)return t();navigator.mediaDevices.getUserMedia({video:!1,audio:e.audio}).then((e=>t({type:"audioStream",stream:e}))).catch((e=>i(e)))}))),Promise.all(o).then((e=>{e||i("no feed available");let o=[];const n=e.find((e=>e&&"videoStream"===e.type));n&&o.push(...n.stream.getTracks());const a=e.find((e=>e&&"audioStream"===e.type));a&&o.push(...a.stream.getAudioTracks());let r=new MediaStream(o);t(r)})).catch((e=>i(e)))}))},getDesktopCapturer(){return new Promise(((e,t)=>{window.electronAPI.desktopCapturer&&(!0===this.$root.debug_mode&&console.log("CaptureSettings • METHODS : getDesktopCapturer"),window.electronAPI.desktopCapturer({types:["window","screen"]}).then((t=>(t=t.map((e=>({chromeMediaSource:"desktop",deviceId:e.id,kind:"videoinput",label:"🖥️ "+e.name}))),e(t)))).catch((e=>t(e))))}))},refreshAvailableDevices(){return new Promise((e=>{!0===this.$root.debug_mode&&console.log("CaptureSettings • METHODS : refreshAvailableDevices"),this.connected_devices=[],this.is_loading_available_devices=!0,this.setSupportedConstraints().then((()=>this.listDevices())).then((t=>(this.connected_devices=t.map((e=>{const{label:t,kind:i,deviceId:o,chromeMediaSource:n=!1}=e;let a={};try{a=e.getCapabilities()?.facingMode?.[0]}catch(r){}return{label:t,kind:i,deviceId:o,facingMode:a,chromeMediaSource:n}})),this.connected_devices.push({deviceId:"screen_capture",kind:"videoinput",label:"🖥️ "+this.$t("screen_capture")}),this.is_loading_available_devices=!1,e())))}))},setCameraStreamFromDefaults(){return new Promise(((e,t)=>{!0===this.$root.debug_mode&&console.log("CaptureSettings • METHODS : setCameraStreamFromDefaults"),this.is_loading_feed=!0,this.selected_devices.audio_output_device&&this.$emit("update:audio_output_deviceId",this.selected_devices.audio_output_device.deviceId),this.startLocalStream().then((()=>{this.stream_current_settings=this.current_settings,this.last_working_resolution=this.desired_camera_resolution,this.is_loading_feed=!1})).catch((i=>{if(this.is_loading_feed=!1,this.$alertify.closeLogOnClick(!0).delay(4e3).error(this.$t("failed_to_start_streams_change_source_or_res")+"<br>"+i.name),"custom"!==this.desired_camera_resolution.type){if(this.unavailable_camera_resolutions.push(this.desired_camera_resolution.label),!this.last_working_resolution)return t();this.desired_camera_resolution=this.last_working_resolution,this.last_working_resolution=!1,setTimeout((()=>{this.setCameraStreamFromDefaults().then((()=>e())).catch((()=>t()))}),500)}})).then((()=>(this.share_this_stream.status.loading=!0,this.setStreamSharing()))).then((()=>(this.share_this_stream.status.loading=!1,this.is_loading_feed=!1,e()))).catch((e=>{this.share_this_stream.status.loading=!1,this.is_loading_feed=!1,this.$alertify.closeLogOnClick(!0).delay(4e3).error(this.$t("failed_to_share_stream")+"<br>"+e.name)}))}))},startLocalStream(){return new Promise(((e,t)=>{!0===this.$root.debug_mode&&console.log("CaptureSettings • METHODS : startLocalStream"),this.local_stream&&this.local_stream.getTracks().forEach((e=>e.stop()));let i=this.createConstraintsFromSelected();setTimeout((()=>{this.startMediaDeviceFeed(i).then((t=>(this.local_stream=t,e()))).catch((e=>(console.log("getUserMedia error : ",e),this.$emit("show"),"NotAllowedError"===e.name&&(this.status="not_allowed"),t(e))))}),this.local_stream?200:0)}))},createConstraintsFromSelected(){!0===this.$root.debug_mode&&console.log("CaptureSettings • METHODS : createConstraintsFromSelected");let e={audio:!1,video:!1};return e.audio={deviceId:this.selected_devices.audio_input_device.deviceId?{exact:this.selected_devices.audio_input_device.deviceId}:void 0,echoCancellation:this.advanced_capture_options.echoCancellation.enabled,noiseSuppression:this.advanced_capture_options.noiseSuppression.enabled},this.selected_devices.video_input_device?.chromeMediaSource?(e._is_electron_screen_capture=!0,e.video={mandatory:{chromeMediaSource:this.selected_devices.video_input_device.chromeMediaSource,chromeMediaSourceId:this.selected_devices.video_input_device.deviceId}}):this.selected_devices.video_input_device&&"screen_capture"===this.selected_devices.video_input_device.deviceId?(e._is_webrtc_screen_capture=!0,e.video={cursor:this.advanced_capture_options.cursor.enabled}):e.video={deviceId:this.selected_devices.video_input_device.deviceId?{exact:this.selected_devices.video_input_device.deviceId}:void 0,width:{exact:this.desired_camera_resolution.width},height:{exact:this.desired_camera_resolution.height}},console.log("Constraints = "+JSON.stringify(e,null,4)),e},setStreamSharing(){return new Promise(((e,t)=>(!0===this.$root.debug_mode&&console.log("CaptureSettings • METHODS : setStreamSharing"),this.share_this_stream.enabled?0===this.share_this_stream.name.length?t("missing_stream_name"):(this.local_stream||this.$alertify.closeLogOnClick(!0).delay(4e3).error(this.$t("no_stream_found_while_sharing")),this.rtcmulti_connection||this.initRTCMulti(),this.rtcmulti_connection.addStream(this.local_stream),this.rtcmulti_connection.open(this.share_this_stream.name,((e,t,i)=>{!0===this.$root.debug_mode&&console.log(`CaptureSettings • METHODS : setStreamSharing • opened room ${t}`),this.share_this_stream.status.enabled=!0,this.share_this_stream.status.name=t,this.rtcmulti_connection.onNewParticipant=(e,t)=>this.newParticipantOnStream({participantId:e,userPreferences:t}),this.rtcmulti_connection.onleave=e=>this.onParticipantLeave({participantId:e}),i&&this.$alertify.closeLogOnClick(!0).delay(4e3).error(this.$t("failed_to_start_stream_sharing")+" "+i.message)})),e()):(this.stopSharingStream(),e()))))},newParticipantOnStream({participantId:e,userPreferences:t}){this.share_this_stream.status.peers_connected.push(e),this.$alertify.closeLogOnClick(!0).delay(8e3).success(this.$t("new_user_connected_to_stream")),this.rtcmulti_connection.acceptParticipationRequest(e,t)},onParticipantLeave(e){!0===this.$root.debug_mode&&console.log(`CaptureSettings • METHODS : onParticipantLeave ${e}`),this.share_this_stream.status.peers_connected.filter((t=>t!==e))},callStream(){!0===this.$root.debug_mode&&console.log("CaptureSettings • METHODS : callStream"),this.access_distant_stream.calling=!0,this.rtcmulti_connection||this.initRTCMulti();const e=setTimeout((()=>{this.access_distant_stream.calling=!1,this.$alertify.closeLogOnClick(!0).delay(4e3).error("Failed to call timeout")}),5e3);this.rtcmulti_connection.onstream=t=>{!0===this.$root.debug_mode&&console.log("CaptureSettings • METHODS : callStream • onstream"),t.mediaElement.removeAttribute("src"),t.mediaElement.removeAttribute("srcObject"),t.mediaElement.muted=!0,t.mediaElement.volume=0,this.access_distant_stream.calling&&(this.remote_stream=t.stream,this.access_distant_stream.calling=!1,this.access_distant_stream.status.enabled=!0,clearTimeout(e))},this.rtcmulti_connection.checkPresence(this.access_distant_stream.callee,((t,i)=>{if(!0===this.$root.debug_mode&&console.log(`CaptureSettings • METHODS : username • for ${i} and ${t}`),!t)return this.$alertify.closeLogOnClick(!0).delay(4e3).error(i+" is not online."),this.access_distant_stream.calling=!1,void clearTimeout(e);this.$alertify.closeLogOnClick(!0).delay(4e3).success(i+" is online."),this.access_distant_stream.status.callee=i,this.rtcmulti_connection.join(i)}))},hangupStream(){!0===this.$root.debug_mode&&console.log("CaptureSettings • METHODS : hangupStream"),this.rtcmulti_connection.leave(),this.access_distant_stream.status.enabled=!1},initRTCMulti(){!0===this.$root.debug_mode&&console.log("CaptureSettings • METHODS : initRTCMulti"),window.rtcmulti_connection||(window.rtcmulti_connection=new(oe())),this.rtcmulti_connection=window.rtcmulti_connection,this.rtcmulti_connection.iceServers=[{urls:["stun:stun.l.google.com:19302","stun:stun1.l.google.com:19302","stun:stun2.l.google.com:19302","stun:stun.l.google.com:19302?transport=udp"]}],navigator.connection&&"cellular"===navigator.connection.type&&navigator.connection.downlinkMax<=.115&&this.$alertify.closeLogOnClick(!0).delay(4e3).error(this.$t("bandwidth_very_low_for_stream_sharing")),this.rtcmulti_connection.socketURL="https://rtcmulticonnection.herokuapp.com:443/",this.rtcmulti_connection.dontCaptureUserMedia=!0,this.rtcmulti_connection.session={video:!0,audio:!0,oneway:!0},this.rtcmulti_connection.onstream=e=>{console.log("CaptureSettings: onstream"),e.mediaElement.volume=0},this.rtcmulti_connection.onstreamended=()=>{console.log("CaptureSettings: onstreamended"),this.$alertify.closeLogOnClick(!0).delay(4e3).error("onstreamended")},this.rtcmulti_connection.onMediaError=e=>{console.log("CaptureSettings: onMediaError"),this.$alertify.closeLogOnClick(!0).delay(4e3).error(this.$t("stream_sharing_media_error")+e.message)}},stopSharingStream(){!0===this.$root.debug_mode&&console.log("CaptureSettings • METHODS : stopSharingStream"),this.rtcmulti_connection&&this.share_this_stream.status.peers_connected.map((e=>{this.rtcmulti_connection.disconnectWith(e)}))},closeMultiRTC(){!0===this.$root.debug_mode&&console.log("CaptureSettings • METHODS : closeMultiRTC"),this.rtcmulti_connection&&(this.stopSharingStream(),this.rtcmulti_connection.closeSocket())}}},ae=ne,re=(i(17270),(0,c.A)(ae,ee,te,!1,null,"47274ab5",null)),se=re.exports,de=function(){var e=this,t=e._self._c;return t("div",{staticClass:"m_captureEffects"},[t("div",{staticClass:"_content"},[t("div",{staticClass:"_options"},[t("ToggleInput",{attrs:{content:e.flip_horizontally,label:e.$t("flip_horizontally")},on:{"update:content":function(t){e.flip_horizontally=t}}}),t("ToggleInput",{attrs:{content:e.flip_vertically,label:e.$t("flip_vertically")},on:{"update:content":function(t){e.flip_vertically=t}}}),t("ToggledSection",{attrs:{label:e.$t("chroma_key"),show_toggle:e.chroma_key_settings.enable},on:{"update:show_toggle":function(t){return e.$set(e.chroma_key_settings,"enable",t)}}},[t("fieldset",[t("legend",{staticClass:"u-label"},[e._v(e._s(e.$t("chroma_key_color")))]),t("ColorInput",{attrs:{label:e.$t("color"),can_toggle:!1,value:e.chroma_key_color_hex},on:{save:function(t){e.chroma_key_color_hex=t}}}),t("div",[t("button",{staticClass:"u-buttonLink",attrs:{type:"button"},on:{click:e.setTogglePickColorFromVideo}},[e.enable_pick_color_from_video?[e._v(" "+e._s(e.$t("click_in_video…"))+" ")]:[e._v(" "+e._s(e.$t("pick_color_in_video"))+" ")]],2)]),t("br"),t("div",[t("div",{},[t("label",[e._v(e._s(e.$t("similarity")))]),t("input",{directives:[{name:"model",rawName:"v-model.number",value:e.chroma_key_settings.similarity,expression:"chroma_key_settings.similarity",modifiers:{number:!0}}],staticClass:"margin-none",attrs:{type:"range",min:"0",max:"1",step:"0.001"},domProps:{value:e.chroma_key_settings.similarity},on:{__r:function(t){e.$set(e.chroma_key_settings,"similarity",e._n(t.target.value))},blur:function(t){return e.$forceUpdate()}}})]),t("div",{},[t("label",[e._v(e._s(e.$t("smoothness")))]),t("input",{directives:[{name:"model",rawName:"v-model.number",value:e.chroma_key_settings.smoothness,expression:"chroma_key_settings.smoothness",modifiers:{number:!0}}],staticClass:"margin-none",attrs:{type:"range",min:"0",max:"1",step:"0.001"},domProps:{value:e.chroma_key_settings.smoothness},on:{__r:function(t){e.$set(e.chroma_key_settings,"smoothness",e._n(t.target.value))},blur:function(t){return e.$forceUpdate()}}})]),t("div",{},[t("label",[e._v(e._s(e.$t("spill")))]),t("input",{directives:[{name:"model",rawName:"v-model.number",value:e.chroma_key_settings.spill,expression:"chroma_key_settings.spill",modifiers:{number:!0}}],staticClass:"margin-none",attrs:{type:"range",min:"0",max:"1",step:"0.001",value:"0.1"},domProps:{value:e.chroma_key_settings.spill},on:{__r:function(t){e.$set(e.chroma_key_settings,"spill",e._n(t.target.value))},blur:function(t){return e.$forceUpdate()}}})])])],1),t("fieldset",[t("legend",{staticClass:"u-label"},[e._v(e._s(e.$t("replace_color_with")))]),t("RadioCheckboxInput",{attrs:{value:e.chroma_key_settings.replacement_mode,options:[{label:e.$t("color"),key:"color"},{label:e.$t("image"),key:"image"}],can_edit:!0},on:{"update:value":function(t){e.chroma_key_settings.replacement_mode=t}}}),"image"===e.chroma_key_settings.replacement_mode?t("div",[t("img",{staticClass:"_imgPreview",attrs:{src:e.chroma_key_replacement_image_url}}),t("EditBtn",{attrs:{label:e.chroma_key_replacement_image_url?e.$t("edit"):e.$t("select"),is_unfolded:!0},on:{click:function(t){e.select_image=!0}}}),e.select_image?t("ImageSelect",{attrs:{label:e.$t("image"),project_path:e.project_path},on:{newPreview:e.newChromaKeyImage,close:function(t){e.select_image=!1}}}):e._e()],1):t("div",[t("ColorInput",{attrs:{can_toggle:!1,value:e.chroma_key_replacement_color_hex},on:{save:function(t){e.chroma_key_replacement_color_hex=t}}})],1)],1)]),e._l(Object.entries(e.image_filters_settings),(function([i,o]){return t("div",{key:i},[t("RangeValueInput",{attrs:{label:e.$t(i),value:e.image_filters_settings[i].value,can_toggle:!0,min:o.min,max:o.max,step:o.step,ticks:o.ticks,default_value:o.default},on:{save:function(t){e.image_filters_settings[i].value=t}}})],1)}))],2)])])},ce=[],le=(i(21903),i(91134),{props:{enable_effects:Boolean,videoElement:HTMLVideoElement,canvasElement:HTMLCanvasElement,project_path:String},components:{},data(){return{source_stream_resolution:{width:void 0,height:void 0},flip_horizontally:!1,flip_vertically:!1,select_image:!1,chroma_key_replacement_image_url:void 0,chroma_key_settings:{enable:!1,key_color:{r:0,g:255,b:0},similarity:.02,smoothness:.08,spill:.1,replacement_color:{r:252,g:75,b:96},replacement_mode:"color",replacement_image:void 0},image_filters_settings:{brightness:{value:1,order:0,default:1,min:0,max:2,step:.01},contrast:{value:1,order:1,default:1,min:0,max:3,step:.01},hue:{value:0,order:2,default:0,min:-.5,max:.5,step:.01},saturation:{value:0,order:3,default:0,min:-1,max:1,step:.01},lightness:{value:0,order:4,default:0,min:-1,max:1,step:.01},dotscreen:{value:10,order:6,default:10,min:3,max:20,step:.01}},enable_pick_color_from_video:!1,offscreen_canvas:void 0,fragment_shader:"\nprecision mediump float;\n#define PI 3.1415926538\n\nuniform sampler2D videoTex;\nuniform float texWidth;\nuniform float texHeight;\n\n\nuniform int flipHorizontally;\nuniform int flipVertically;\n\nuniform vec3 keyColor;\nuniform vec3 replacementColor;\nuniform sampler2D replacementImage;\n\nuniform float similarity;\nuniform float smoothness;\nuniform float spill;\nuniform int chromaKeyMode;\n\nuniform float brightness;\nuniform float contrast;\nuniform float mid;\n\nuniform float hue;\nuniform float saturation;\nuniform float lightness;\n\nuniform float dotscreen;\n\n\n// From https://github.com/libretro/glsl-shaders/blob/master/nnedi3/shaders/rgb-to-yuv.glsl\nvec2 RGBtoUV(vec3 rgb) {\n  return vec2(\n    rgb.r * -0.169 + rgb.g * -0.331 + rgb.b *  0.5    + 0.5,\n    rgb.r *  0.5   + rgb.g * -0.419 + rgb.b * -0.081  + 0.5\n  );\n}\n\nvec4 ProcessChromaKey(vec2 texCoord, vec4 videoColor) {\n  float chromaDist = distance(RGBtoUV(videoColor.rgb), RGBtoUV(keyColor));\n\n  float baseMask = chromaDist - similarity;\n  float fullMask = pow(clamp(baseMask / smoothness, 0., 1.), 1.5);\n  videoColor.a = fullMask;\n\n  float spillVal = pow(clamp(baseMask / spill, 0., 1.), 1.5);\n  float desat = clamp(videoColor.r * 0.2126 + videoColor.g * 0.7152 + videoColor.b * 0.0722, 0., 1.);\n  videoColor.rgb = mix(vec3(desat, desat, desat), videoColor.rgb, spillVal);\n\n  return videoColor;\n}\nvec4 ApplyChromaKey(vec2 texCoord, vec4 videoColor)  {\n  vec4 chromaVideoColor = ProcessChromaKey(texCoord, videoColor);\n\n  vec4 replaceWith = vec4(0.0);\n  if(chromaKeyMode == 0) {\n    // color\n    replaceWith = vec4(replacementColor, 1.0);\n  } else if(chromaKeyMode == 1) {\n    // image\n    replaceWith = vec4(texture2D(replacementImage, texCoord));\n  }\n\n  vec4 result = mix(vec4(chromaVideoColor.rgb, 1.0), replaceWith, 1.0 - chromaVideoColor.a);\n  return result;\n}\n\nvec3 RGBtoHCV(vec3 RGB) {\n  float Epsilon = 0.00000000001;\n  // Based on work by Sam Hocevar and Emil Persson\n  vec4 P = (RGB.g < RGB.b) ? vec4(RGB.bg, -1.0, 2.0/3.0) : vec4(RGB.gb, 0.0, -1.0/3.0);\n  vec4 Q = (RGB.r < P.x) ? vec4(P.xyw, RGB.r) : vec4(RGB.r, P.yzx);\n  float C = Q.x - min(Q.w, Q.y);\n  float H = abs((Q.w - Q.y) / (6.0 * C + Epsilon) + Q.z);\n  return vec3(H, C, Q.x);\n}\nvec3 HUEtoRGB(float h) {\n  float r = abs(h * 6.0 - 3.0) - 1.0;\n  float g = 2.0 - abs(h * 6.0 - 2.0);\n  float b = 2.0 - abs(h * 6.0 - 4.0);\n  return clamp(vec3(r, g, b), 0.0, 1.0);\n}\n\nvec3 RGBtoHSL(vec3 RGB) {\n  float Epsilon = 0.00000000001;\n  vec3 HCV = RGBtoHCV(RGB);\n  float L = HCV.z - HCV.y * 0.5;\n  float S = HCV.y / (1.0 - abs(L * 2.0 - 1.0) + Epsilon);\n  return vec3(HCV.x, S, L);\n}\nvec3 HSLtoRGB(vec3 HSL) {\n  vec3 RGB = HUEtoRGB(HSL.x);\n  float C = (1.0 - abs(2.0 * HSL.z - 1.0)) * HSL.y;\n  return (RGB - 0.5) * C + HSL.z;\n}\nfloat clamp_continuous(float value) {\n  float unit = value;\n\n  if (unit > 1.0) {\n    unit = mod(unit, 1.0);\n  } else if (unit < 0.0) {\n    unit = 1.0 + unit;\n  }\n\n  return unit;\n}\n\nfloat mix_factor(vec4 range, vec3 hsl) {\n  float mix_factor = 0.0;\n\n  if (hsl.x >= range.x && hsl.x <= range.w) {\n    // lower range\n    if (hsl.x >= range.x && hsl.x < range.y) {\n      mix_factor = smoothstep(range.x, range.y, hsl.x);\n    }\n\n    // target range\n    if (hsl.x >= range.y && hsl.x <= range.z) {\n      mix_factor = 1.0;\n    }\n\n    // upper range\n    if (hsl.x > range.z && hsl.x <= range.w) {\n      mix_factor = 1.0 - smoothstep(range.z, range.w, hsl.x);\n    }\n  }\n\n  vec2 lightness_range = vec2(0.0, 0.08333);\n  vec2 saturation_range = vec2(0.0, 0.08333);\n  mix_factor *= smoothstep(saturation_range.x, saturation_range.y, hsl.y);\n  mix_factor *= smoothstep(lightness_range.x, lightness_range.y, hsl.z);\n\n  return mix_factor;\n}\n\nfloat pattern(vec2 texCoord) {\n  float angle = PI / 8.0;\n  float s = sin(angle), c = cos(angle);\n  vec2 tex = texCoord * vec2(texWidth, texHeight) - vec2(0.5, 0.5);\n  vec2 point = vec2(\n      c * tex.x - s * tex.y,\n      s * tex.x + c * tex.y\n  ) * (PI / dotscreen);\n  return (sin(point.x) * sin(point.y)) * 4.0;\n}\n\nvoid main(void) {\n  // get video image\n  vec2 texCoord = vec2(gl_FragCoord.x/texWidth, 1.0 - (gl_FragCoord.y/texHeight));\n\n  if(flipVertically == 1)\n    texCoord.y = 1.0 - texCoord.y;\n  if(flipHorizontally == 1)\n    texCoord.x = 1.0 - texCoord.x;\n\n  vec4 videoColor = texture2D(videoTex, texCoord);\n\n  // apply chroma key if necessary\n  if (chromaKeyMode != -1000) {\n    videoColor = ApplyChromaKey(texCoord, videoColor);\n  }\n\n  // apply brightness, from https://github.com/actionnick/exposure/blob/master/src/shaders/exposure.frag\n  if(brightness != -1000.0) {\n    videoColor = mix(videoColor, vec4(1.0, 1.0, 1.0, 1.0), brightness - 1.0);\n    videoColor.a = 1.0;\n  }\n\n  // contrast\n  if(contrast != -1000.0) {\n    videoColor.r = ((videoColor.r - mid) * contrast) + mid;\n    videoColor.g = ((videoColor.g - mid) * contrast) + mid;\n    videoColor.b = ((videoColor.b - mid) * contrast) + mid;\n    videoColor.a = 1.0;\n  }\n\n  // hue, saturation, lightness\n  if(hue != -1000.0 || saturation != -1000.0 || lightness != -1000.0) {\n    vec3 hsl = RGBtoHSL(videoColor.rgb);\n    vec4 MASTER_RANGE = vec4(0.0, 0.0, 1.0, 1.0);\n\n    float master_mix_factor = mix_factor(MASTER_RANGE, hsl);\n    // hue\n    if(hue != -1000.0) {\n      hsl.x = clamp_continuous(hsl.x + (hue * master_mix_factor));\n    }\n    // saturation\n    if(saturation != -1000.0) {\n      hsl.y = clamp(hsl.y + (saturation * master_mix_factor), 0.0, 1.0);\n    }\n    // lightness\n    if(lightness != -1000.0) {\n      hsl.z = clamp(mix(hsl.z, 1.0, max(0.0, lightness)), 0.0, 1.0);\n      hsl.z = clamp(mix(hsl.z, 0.0, abs(min(0.0, lightness))), 0.0, 1.0);\n    }\n\n    videoColor.rgb = HSLtoRGB(hsl);\n  }\n\n  if(dotscreen != -1000.0) {\n    float average = (videoColor.r + videoColor.g + videoColor.b) / 3.0;\n    videoColor = vec4(vec3(average * 10.0 - 5.0 + pattern(texCoord)), videoColor.a);\n  }\n\n  gl_FragColor = videoColor;\n\n}\n      "}},created(){},updated(){},mounted(){this.$eventHub.$on("captureCanvas.pixelColorUnderMouse",this.pixelColorUnderMouse)},beforeDestroy(){this.$eventHub.$off("captureCanvas.pixelColorUnderMouse",this.pixelColorUnderMouse),this.stopWebGL()},watch:{enable_effects(){this.enable_effects||this.disableAllEffects()},enable__(){this.$emit("update:enable_effects",this.enable__),this.enable__&&this.$nextTick((()=>{this.startWebGL()}))},"chroma_key_settings.replacement_mode"(){"image"===this.chroma_key_settings.replacement_mode&&(this.chroma_key_replacement_image_url=void 0,this.select_image=!0)}},computed:{enable__(){return!0===this.flip_vertically||!0===this.flip_horizontally||!0===this.chroma_key_settings.enable||Object.keys(this.image_filters_settings).some((e=>this.image_filters_settings[e].value!==this.image_filters_settings[e].default))},chroma_key_color_hex:{get(){return this.rgbToHex(this.chroma_key_settings.key_color)},set(e){this.chroma_key_settings.key_color=this.hexToRgb(e)}},chroma_key_replacement_color_hex:{get(){return this.rgbToHex(this.chroma_key_settings.replacement_color)},set(e){this.chroma_key_settings.replacement_color=this.hexToRgb(e)}}},methods:{disableAllEffects(){this.flip_vertically=!1,this.flip_horizontally=!1,this.chroma_key_settings.enable=!1,Object.keys(this.image_filters_settings).map((e=>{this.image_filters_settings[e].value=this.image_filters_settings[e].default}))},hexToRgb(e){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null},rgbToHex({r:e,g:t,b:i}){return e=e.toString(16),t=t.toString(16),i=i.toString(16),1==e.length&&(e="0"+e),1==t.length&&(t="0"+t),1==i.length&&(i="0"+i),"#"+e+t+i},setTogglePickColorFromVideo(){this.enable_pick_color_from_video?this.enable_pick_color_from_video=!1:this.enable_pick_color_from_video=!0},pixelColorUnderMouse({px_color:e,type:t}){this.enable_pick_color_from_video&&(this.chroma_key_settings.key_color=e,"click"===t&&this.setTogglePickColorFromVideo())},startWebGL(){console.log("CaptureEffects • METHODS : startWebGL"),this.offscreen_canvas&&this.stopWebGL(),this.offscreen_canvas=document.createElement("canvas"),this.offscreen_canvas.classList.add("offscreenCanvas");var e=this.canvasElement.getContext("2d");const t=this.offscreen_canvas.getContext("webgl",{premultipliedAlpha:!1}),i=t.createShader(t.VERTEX_SHADER);t.shaderSource(i,"attribute vec2 c; void main(void) { gl_Position=vec4(c, 0.0, 1.0); }"),t.compileShader(i);const o=t.createShader(t.FRAGMENT_SHADER);t.shaderSource(o,this.fragment_shader),t.compileShader(o),t.getShaderParameter(o,t.COMPILE_STATUS)||console.error(t.getShaderInfoLog(o));const n=t.createProgram();t.attachShader(n,i),t.attachShader(n,o),t.linkProgram(n),t.useProgram(n);const a=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,a),t.bufferData(t.ARRAY_BUFFER,new Float32Array([-1,1,-1,-1,1,-1,1,1]),t.STATIC_DRAW);const r=t.getAttribLocation(n,"c");t.vertexAttribPointer(r,2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(r),t.activeTexture(t.TEXTURE0+0);const s=t.createTexture();t.bindTexture(t.TEXTURE_2D,s),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR);const d=t.getUniformLocation(n,"videoTex");t.uniform1i(d,0);const c=t.getUniformLocation(n,"texWidth"),l=t.getUniformLocation(n,"texHeight"),u=t.getUniformLocation(n,"flipHorizontally"),m=t.getUniformLocation(n,"flipVertically"),p=t.getUniformLocation(n,"keyColor"),f=t.getUniformLocation(n,"replacementColor"),h=t.getUniformLocation(n,"replacementImage");t.uniform1i(h,1);const v=t.getUniformLocation(n,"similarity"),g=t.getUniformLocation(n,"smoothness"),_=t.getUniformLocation(n,"spill"),b=t.getUniformLocation(n,"chromaKeyMode"),y=t.getUniformLocation(n,"mid"),w=Object.keys(this.image_filters_settings).reduce(((e,i)=>(e[i]=t.getUniformLocation(n,i),e)),{});this.loadReplacementImageInShader();const C=()=>{if(!this.offscreen_canvas||!this.enable__)return;console.log("CaptureEffects • METHODS : startWebGL • processFrame"),this.offscreen_canvas.width=this.videoElement.videoWidth,this.offscreen_canvas.height=this.videoElement.videoHeight,t.activeTexture(t.TEXTURE0+0),t.viewport(0,0,this.videoElement.videoWidth,this.videoElement.videoHeight),t.texImage2D(t.TEXTURE_2D,0,t.RGB,t.RGB,t.UNSIGNED_BYTE,this.videoElement),t.uniform1f(c,this.videoElement.videoWidth),t.uniform1f(l,this.videoElement.videoHeight),t.uniform1i(u,this.flip_horizontally?1:0),t.uniform1i(m,this.flip_vertically?1:0),t.uniform3f(p,this.chroma_key_settings.key_color.r/255,this.chroma_key_settings.key_color.g/255,this.chroma_key_settings.key_color.b/255),t.uniform3f(f,this.chroma_key_settings.replacement_color.r/255,this.chroma_key_settings.replacement_color.g/255,this.chroma_key_settings.replacement_color.b/255),t.uniform1f(v,parseFloat(this.chroma_key_settings.similarity)),t.uniform1f(g,parseFloat(this.chroma_key_settings.smoothness)),t.uniform1f(_,parseFloat(this.chroma_key_settings.spill)),Object.entries(w).map((([e,i])=>{t.uniform1f(i,parseFloat(this.image_filters_settings[e].value!==this.image_filters_settings[e].default?this.image_filters_settings[e].value:-1e3))})),t.uniform1f(y,parseFloat(.5));let i=-1e3;this.chroma_key_settings.enable&&("color"===this.chroma_key_settings.replacement_mode?i=0:"image"===this.chroma_key_settings.replacement_mode&&(i=1)),t.uniform1i(b,parseInt(i)),t.drawArrays(t.TRIANGLE_FAN,0,4),e.drawImage(this.offscreen_canvas,0,0),window.requestAnimationFrame(C)};window.requestAnimationFrame(C)},stopWebGL(){this.offscreen_canvas=void 0},async newChromaKeyImage(e){if(console.log("CaptureEffects • METHODS : newChromaKeyImage"),!e)return this.chroma_key_settings.replacement_image=void 0,this.chroma_key_replacement_image_url=void 0,void this.loadReplacementImageInShader();const t=await createImageBitmap(e);this.chroma_key_replacement_image_url=URL.createObjectURL(e);const i=document.createElement("canvas"),o=i.getContext("2d");i.width=this.videoElement.videoWidth,i.height=this.videoElement.videoHeight;const n="cover",a=t.height/t.width,r=i.height/i.width;if(a<r&&"contain"===n||a>r&&"cover"===n){const e=i.width*a;o.drawImage(t,0,(i.height-e)/2,i.width,e)}if(a>r&&"contain"===n||a<r&&"cover"===n){const e=i.width*r/a;o.drawImage(t,(i.width-e)/2,0,e,i.height)}this.chroma_key_settings.replacement_image=o.getImageData(0,0,i.width,i.height),this.loadReplacementImageInShader(),i.remove()},getMediaSrcFromPath(e){const t=this.getMediaInFolder({path_to_source_media_meta:e}),i=this.getParent(t.$path);return this.makeRelativeURLFromThumbs({$thumbs:t.$thumbs,$type:t.$type,$path:i,resolution:1600})},loadReplacementImageInShader(){const e=this.offscreen_canvas.getContext("webgl",{premultipliedAlpha:!1});e.activeTexture(e.TEXTURE1);const t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t),this.chroma_key_settings.replacement_image&&e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,this.chroma_key_settings.replacement_image),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR)}}}),ue=le,me=(i(36524),(0,c.A)(ue,de,ce,!1,null,"a1467d96",null)),pe=me.exports,fe=function(){var e=this,t=e._self._c;return t("BaseModal2",{attrs:{title:e.$t("stopmotion_list")},on:{close:function(t){return e.$emit("close")}}},[t("transition",{attrs:{name:"fade_fast",duration:150,mode:"out-in"}},[e.is_loading?t("LoaderSpinner"):t("div",{staticClass:"m_stopmotionList"},[0===e.sorted_stopmotions.length?t("div",{staticClass:"u-instructions"},[e._v(" "+e._s(e.$t("no_stopmotion_created_yet"))+" ")]):t("div",[t("transition-group",{attrs:{tag:"div",name:"listComplete"}},e._l(e.sorted_stopmotions,(function(i){return t("div",{key:i.$path},[t("StopmotionPreview",{attrs:{stopmotion_path:i.$path},on:{load:function(t){return e.$emit("loadStopmotion",i.$path)},remove:function(t){return e.removeStopmotion(i.$path)}}})],1)})),0)],1)])],1)],1)},he=[],ve=function(){var e=this,t=e._self._c;return e.stopmotion?t("div",{staticClass:"_preview"},[t("div",{staticClass:"_topRow"},[t("DateDisplay",{attrs:{title:e.$t("date_created"),date:e.stopmotion.$date_created,show_detail_initially:!0}}),t("div",{staticClass:"_btns"},[t("button",{staticClass:"u-button u-button_bleumarine",attrs:{type:"button"},on:{click:function(t){return e.$emit("load")}}},[e._v(" "+e._s(e.$t("open"))+" ")]),t("RemoveMenu",{on:{remove:function(t){return e.$emit("remove")}}})],1)],1),t("br"),t("div",{staticClass:"_images"},[t("label",{staticClass:"u-label"},[e._v(" "+e._s(e.$t("images").toUpperCase())+" = "+e._s(e.images.length)+" ")]),t("div",{staticClass:"_imagesCont"},e._l(e.images,(function(e){return t("div",{key:e.$path},[t("MediaContent",{attrs:{file:e,resolution:240}})],1)})),0)])]):e._e()},ge=[],_e=i(39321),be={props:{stopmotion_path:String},components:{RemoveMenu:_e.A},data(){return{stopmotion:void 0,fetch_stopmotion_error:void 0}},created(){},async mounted(){const e=await this.$api.getFolder({path:this.stopmotion_path}).catch((e=>{this.fetch_stopmotion_error=e.response}));this.stopmotion=e},beforeDestroy(){},watch:{},computed:{images(){if(this.stopmotion?.images_list&&this.stopmotion?.$files?.length>0){const e=this.stopmotion.images_list.reduce(((e,t)=>{const i=t.m||t,o=this.stopmotion.$files.find((e=>e.$path.endsWith("/"+i)));return o&&!e.find((e=>e.$path===o.$path))&&e.push(o),e}),[]);return e}return[]}},methods:{}},ye=be,we=(i(28610),(0,c.A)(ye,ve,ge,!1,null,"2ed71ab5",null)),Ce=we.exports,Se={props:{project_path:String},components:{StopmotionPreview:Ce},data(){return{path:`${this.project_path}/stopmotions`,is_loading:!0,stopmotions:[]}},created(){},async mounted(){this.is_loading=!0,this.stopmotions=await this.$api.getFolders({path:this.path}),this.is_loading=!1,this.$api.join({room:this.path})},beforeDestroy(){this.$api.leave({room:this.path})},watch:{},computed:{sorted_stopmotions(){const e=this.stopmotions.slice();return e.sort(((e,t)=>+new Date(t.$date_created)-+new Date(e.$date_created)))}},methods:{async removeStopmotion(e){try{await this.$api.deleteItem({path:e})}catch(t){}}}},xe=Se,ke=(i(5076),(0,c.A)(xe,fe,he,!1,null,"2cfb19ff",null)),Te=ke.exports,Re=function(){var e=this,t=e._self._c;return t("div",{staticClass:"m_audioEqualizer"},[t("canvas",{ref:"canvas",attrs:{width:"1280",height:"720"}})])},Me=[],Ee=i(34007),Pe=i.n(Ee),De={props:{stream:MediaStream,is_recording:Boolean,type:{type:String,default:"Full"}},components:{},data(){return{audio_activity:void 0,current_audio_level:0,audioHistory:[],maxHistoryPoints:1e3}},created(){},mounted(){this.startEqualizer()},beforeDestroy(){this.audio_activity.destroy()},watch:{stream(){this.startEqualizer()},is_recording(){this.audioHistory=[]}},computed:{},methods:{startEqualizer(){this.audio_activity&&this.audio_activity.destroy(),"object"===typeof this.stream&&(this.audio_activity=Pe()(this.stream,(e=>{this.current_audio_level=e})),this.drawVolume())},drawVolume(){const e=this.$refs.canvas;if(!e)return;const t=1,i=this.$el.clientWidth*t,o=this.$el.clientHeight*t;i===e.width&&o===e.height||(e.width=i,e.height=o);const n=this.maxHistoryPoints;this.audioHistory.push(this.current_audio_level),this.audioHistory.length>n&&this.audioHistory.shift();const a=e.getContext("2d");a.fillStyle="white",a.fillRect(0,0,e.width,e.height),this.is_recording?a.fillStyle="#fc4b60":a.fillStyle="#333";const r=e.width/this.audioHistory.length,s=1.6*e.height;this.audioHistory.forEach(((t,i)=>{const o=i*r,n=r,d=Math.max(t*s,2),c=e.height/2-d/2;a.fillRect(o,c,n,d)})),window.requestAnimationFrame(this.drawVolume)}}},Le=De,Ue=(i(87976),(0,c.A)(Le,Re,Me,!1,null,"c9cf908c",null)),Ae=Ue.exports,$e=function(){var e=this,t=e._self._c;return t("div",{staticClass:"m_vecto",domProps:{innerHTML:e._s(e.svgstr)}})},Ie=[],Oe=i(28001),Be=i.n(Oe),Fe={props:{last_frame_from_video:Blob,number_of_colors:Number},components:{},data(){return{svgstr:"",is_processing_image:!1}},created(){},mounted(){},beforeDestroy(){},watch:{last_frame_from_video(){this.last_frame_from_video&&this.vectoImage()}},computed:{},methods:{vectoImage(){this.is_processing_image||(this.is_processing_image=!0,Be().imageToSVG(URL.createObjectURL(this.last_frame_from_video),(e=>{this.is_processing_image=!1,this.svgstr=e}),{colorsampling:0,numberofcolors:this.number_of_colors,colorquantcycles:1,scale:1,strokewidth:1,blurradius:5,blurdelta:64,viewbox:!0}))}}},Ne=Fe,Ve=(i(75224),(0,c.A)(Ne,$e,Ie,!1,null,null,null)),He=Ve.exports,je=function(){var e=this,t=e._self._c;return t("div",{staticClass:"m_lines"},[t("svg",{ref:"pattern",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:`0 0 ${e.svg_width} ${e.svg_height}`,"stroke-linecap":"round",stroke:"#000","stroke-width":"1"}},[t("rect",{attrs:{x:"0",y:"0",width:"100%",height:"100%",fill:"#ffffff",stroke:"#ff0000"}}),e._l(e.lines_array,(function(i){return t("line",{key:`${i.posX}_${i.posY}`,attrs:{x1:-i.length/2,y1:0,x2:i.length/2,y2:0,transform:`translate(${i.posX}, ${i.posY}) rotate(${e.angle} 0 0)`}})}))],2),t("canvas",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"invisible_canvas"})])},ze=[],qe={props:{last_frame_from_video:Blob,angle:{type:Number,default:116},boost_brightness:{type:Number,default:1},boost_contrast:{type:Number,default:1},density:{type:Number,default:.2}},components:{},data(){return{pixel_array:[],is_processing_image:!1,svg_width:600,svg_height:400}},created(){},mounted(){},beforeDestroy(){},watch:{last_frame_from_video(){this.last_frame_from_video&&"image/jpeg"===this.last_frame_from_video.type&&this.drawBlobToImage()}},computed:{lines_array(){const e=(e,t,i,o,n)=>(e-t)*(n-o)/(i-t)+o,t=1/this.density/2,i=this.svg_width-2*t,o=this.svg_height-2*t,n=this.svg_width*this.density,a=this.svg_height*this.density;return this.pixel_array.reduce(((r,s)=>{let d=s.b;d*=this.boost_brightness;let c=this.boost_contrast+1,l=128*(1-c);d=d*c+l;const u=e(d,0,234,10,0);if("number"!==typeof u||u>20)return r;const m=s.x/n*i+t,p=s.y/a*o+t;return r.push({posX:m,posY:p,length:u}),r}),[])}},methods:{drawBlobToImage(){if(!this.is_processing_image){this.is_processing_image=!0;var e=performance.now(),t=new Image;t.onload=()=>{var i=this.$refs.invisible_canvas;i.width=t.width,i.height=t.height,this.svg_width=t.width,this.svg_height=t.height;var o=i.getContext("2d");o.drawImage(t,0,0);var n=o.getImageData(0,0,i.width,i.height).data;let a=[];const r=Math.round(i.width*this.density),s=Math.round(i.height*this.density);for(let e=0;e<=r;e++)for(let t=0;t<=s;t++){const o=Math.floor(i.width/r*e),u=Math.floor(i.height/s*t);var[d,c,l]=this.getImageDataFaster(o,u,1,1,i.width,i.height,n);const m=d+d+d+l+c+c+c+c>>3;a.push({x:e,y:t,b:m})}this.pixel_array=a,this.is_processing_image=!1;var u=performance.now();!0===this.$root.debug_mode&&console.log("Lines • METHODS : drawBlobToImage = took "+(u-e)+" milliseconds.")},t.src=URL.createObjectURL(this.last_frame_from_video)}},getImageDataFaster(e,t,i,o,n,a,r){for(var s=new Uint32Array(i*o*4),d=0,c=t;c<o+t;c+=1)for(var l=e;l<i+e;l+=1)for(var u=4*(c*n+l),m=0;m<4;m++)s[d++]=l<0||l>=n||c<0||c>=a?0:r[u+m];return s}}},We=qe,Ge=(i(60092),(0,c.A)(We,je,ze,!1,null,null,null)),Ke=Ge.exports,Xe=i(16858),Je=i.n(Xe),Ye=i(64898),Qe=i.n(Ye),Ze={props:{type:String,path:String,selected_mode:String,stopmotion_slug:String,available_modes:{type:Array,default:()=>["photo","video","stopmotion","audio","vecto","lines"]},origin:{type:String,default:"capture"},return_temp_media:{type:Boolean,default:!1},must_validate_media:{type:Boolean,default:!0}},components:{PickLocationForCaptures:G,ModeSelector:u,MediaPreviewBeforeValidation:g,MediaValidationButtons:S,StopmotionPanel:V,CapturePane:Z,CaptureSettings:se,CaptureEffects:pe,StopmotionList:Te,AudioEqualizer:Ae,VectoMode:He,LinesMode:Ke},data(){return{is_sending_image:!1,is_loading_stream:!0,invisible_canvas:void 0,ask_before_leaving_capture:!1,capture_pane_is_small:!1,media_to_validate:!1,media_is_being_sent:!1,media_being_sent_percent:0,capture_button_pressed:!1,mode_just_changed:!1,is_validating_stopmotion_video:!1,video_recording_is_paused:!1,grids:{halfs:[[50,0,50,100],[0,50,100,50]],thirds:[[33,0,33,100],[66,0,66,100],[0,33,100,33],[0,66,100,66]],fourths:[[25,0,25,100],[50,0,50,100],[75,0,75,100],[0,25,100,25],[0,50,100,50],[0,75,100,75]]},current_grid_type:!1,location_to_add_to_medias:void 0,show_position_modal:!1,stream:void 0,stream_type:void 0,audio_output_deviceId:void 0,show_capture_settings:!1,show_effects_pane:!1,enable_audio_recording_in_video:!0,enable_video:!0,is_recording:!1,timer_recording_in_seconds:!1,recording_timer_interval:void 0,stopmotion_frame_rate:4,timelapse_mode_enabled:!1,timelapse_interval:2,timelapse_event:!1,timelapse_time_before_next_picture:!1,delay_mode_enabled:!1,delay_seconds:5,delay_event:!1,delay_remaining_time:!1,recorder:null,actual_camera_resolution:{width:void 0,height:void 0},displayed_video_size:{width:void 0,height:void 0},show_live_feed:!1,show_stopmotion_list:!1,onion_skin_img:!1,onion_skin_opacity:0,last_frame_from_video:void 0,frameGrabber:void 0,show_lines_settings:!1,vecto_number_of_colors:2,lines_angle:108,lines_brightness:1,lines_contrast:1,lines_density:.25,stream_sharing_informations_status:{},stream_access_informations_status:{},enable_effects:!1,update_last_video_imageData:void 0}},created(){try{const e=localStorage.getItem("location_to_add_to_medias");e&&"undefined"!==e&&(this.location_to_add_to_medias=JSON.parse(e))}catch(e){console.error(e),this.location_to_add_to_medias=void 0}},mounted(){this.selected_mode||this.$emit("changeMode",this.available_modes[0]),document.addEventListener("keyup",this.captureKeyListener),this.checkCapturePanelSize(),this.$eventHub.$on("activity_panels_resized",this.checkCapturePanelSize),this.$eventHub.$on("window.resized",this.checkCapturePanelSize),this.$eventHub.$on("stream.newSharingInformations",this.updateStreamSharing),this.$eventHub.$on("stream.newDistantAccessInformations",this.updateDistantStream),this.$eventHub.$on("capture.stopRecording",this.stopRecording),this.$refs.videoElement.volume=0,this.$refs.videoElement.addEventListener("loadedmetadata",this.refreshVideoActualSize)},beforeDestroy(){this.$eventHub.$off("activity_panels_resized",this.checkCapturePanelSize),this.$eventHub.$off("window.resized",this.checkCapturePanelSize),this.$eventHub.$off("stream.newSharingInformations",this.updateStreamSharing),this.$eventHub.$off("stream.newDistantAccessInformations",this.updateDistantStream),this.$eventHub.$off("capture.stopRecording",this.stopRecording),document.removeEventListener("keyup",this.captureKeyListener),this.ask_before_leaving_capture=!1,this.stopFrameGrabber(),this.stopTimelapseInterval(),this.cancelDelay(),this.eraseTimer(),this.update_last_video_imageData&&window.cancelAnimationFrame(this.update_last_video_imageData),this.$refs.videoElement.removeEventListener("loadedmetadata",this.refreshVideoActualSize)},watch:{selected_mode(e,t){e?(this.mode_just_changed=!0,window.setTimeout((()=>{this.mode_just_changed=!1}),300),"audio"===this.selected_mode?(this.enable_audio=!0,this.enable_video=!1):this.enable_video=!0,this.stopFrameGrabber(),"vecto"!==this.selected_mode&&"lines"!==this.selected_mode||this.startFrameGrabber(),"stopmotion"!==this.selected_mode&&(this.show_stopmotion_list=!1)):this.$emit("changeMode",t)},location_to_add_to_medias(){this.has_location_to_add_to_medias?localStorage.setItem("location_to_add_to_medias",JSON.stringify(this.location_to_add_to_medias)):localStorage.removeItem("location_to_add_to_medias")},is_validating_stopmotion_video(){this.is_validating_stopmotion_video?this.$refs.videoElement.pause():(this.$refs.videoElement.play(),this.show_live_feed=!0)},is_making_stopmotion(){this.is_making_stopmotion&&(this.show_capture_settings=!1)},audio_output_deviceId(){},media_to_validate(){console.log(`WATCH • Capture: media_to_validate = ${!!this.media_to_validate}`),!this.media_to_validate||this.must_validate_media?this.media_to_validate?(this.$refs.videoElement&&this.$refs.videoElement.pause(),this.$refs.audioElement&&this.$refs.audioElement.pause(),this.ask_before_leaving_capture=!0):(this.$refs.videoElement&&this.$refs.videoElement.play(),this.$refs.audioElement&&this.$refs.audioElement.play(),this.ask_before_leaving_capture=!1):this.sendMedia()}},computed:{show_mode_selector(){return!this.media_to_validate&&!this.is_recording&&!this.is_making_stopmotion&&!this.delay_event},has_location_to_add_to_medias(){return this.location_to_add_to_medias?.longitude&&this.location_to_add_to_medias?.latitude},is_making_stopmotion(){const e=!!this.stopmotion_slug;return e},validated_media_href_blob(){return!!this.media_to_validate&&window.URL.createObjectURL(this.media_to_validate.rawData)},show_videos(){return this.stream&&["photo","video","stopmotion"].includes(this.selected_mode)&&this.show_live_feed&&!(this.must_validate_media&&this.media_to_validate)}},methods:{hasFinishedLoading(){this.is_loading_stream=!1,this.show_live_feed=!0},setStream({stream:e,type:t}){this.stream=e,this.stream_type=t,this.$refs.videoElement.volume=0,this.enable_effects=!1},updateSelectedColor({e:e,type:t}){if(!this.$refs.canvasElement)return;console.log("CaptureView: METHODS • updateSelectedColor");const i=this.getColorInCanvasFromPixelCount(e);this.$eventHub.$emit("captureCanvas.pixelColorUnderMouse",{px_color:i,type:t})},getColorInCanvasFromPixelCount(e){const t=(e,t,i,o)=>{let n,a,r;return t/o>e/i?(n=t/o,a=(e-i*n)/2,r=0):(n=e/i,r=(t-o*n)/2,a=0),{scale:n,offsetX:a,offsetY:r}},i=t(this.actual_camera_resolution.width,this.actual_camera_resolution.height,this.$refs.canvasElement.getBoundingClientRect().width,this.$refs.canvasElement.getBoundingClientRect().height),o=e.offsetX*i.scale+i.offsetX,n=e.offsetY*i.scale+i.offsetY,a=this.$refs.canvasElement.getContext("2d").getImageData(o,n,1,1);return{r:a.data[0],g:a.data[1],b:a.data[2]}},updateStreamSharing(e){this.stream_sharing_informations_status=e},updateDistantStream(e){this.stream_access_informations_status=e},refreshVideoActualSize(){this.getVideoActualSize().then((({width:e,height:t})=>{this.actual_camera_resolution.width=e,this.actual_camera_resolution.height=t})).catch((e=>{!0===this.$root.debug_mode&&console.log("CaptureView • METHODS : refreshVideoActualSize — couldnt get video size: "+e)}))},testStopmotion(){this.$eventHub.$emit("stopmotion.test")},getVideoActualSize(){return new Promise(((e,t)=>{let i=0;this.$refs.videoElement.videoWidth||(i=500);const o=e=>new Promise((t=>window.setTimeout(t,e)));o(i).then((()=>!this.$refs.videoElement||this.$refs.videoElement.videoWidth*this.$refs.videoElement.videoHeight>0?e({width:this.$refs.videoElement.videoWidth,height:this.$refs.videoElement.videoHeight}):t("couldn’t get video dimensions")))}))},loadStopmotion(e){const t=e.substring(e.lastIndexOf("/")+1);this.$emit("openStopmotion",t),this.show_stopmotion_list=!1},checkCapturePanelSize(){this.$el?.offsetHeight<=400?this.capture_pane_is_small=!0:this.capture_pane_is_small=!1},stopStopmotion(){this.closeStopmotionPanel()},startFrameGrabber(){const e=()=>{if(!0===this.$root.debug_mode&&console.log("CaptureView • METHODS : startFrameGrabber"),this.media_to_validate)return;const e=this.actual_camera_resolution.width/this.actual_camera_resolution.height;this.getImageDataFromFeed({width:240*e,height:240}).then((e=>this.last_frame_from_video=e))};e(),this.frameGrabber=window.setInterval(e,300)},stopFrameGrabber(){!0===this.$root.debug_mode&&console.log("CaptureView • METHODS : stopFrameGrabber  "),this.frameGrabber&&window.clearInterval(this.frameGrabber),this.last_frame_from_video=void 0},async addStopmotionImage(){if(this.show_live_feed=!0,this.$refs.videoElement.pause(),this.is_sending_image=!0,!this.stopmotion_slug){this.ask_before_leaving_capture=!0;const e=await this.$api.createFolder({path:`${this.path}/stopmotions`,additional_meta:{name:(new Date).getTime(),$admins:"parent_contributors"}});this.$emit("openStopmotion",e)}const e=await this.getImageDataFromFeed();this.$eventHub.$emit("stopmotion.addImage",{imageData:e}),this.media_to_validate={rawData:e,objectURL:URL.createObjectURL(e),type:"image"},setTimeout((()=>{this.media_to_validate=!1}),500),this.is_sending_image=!1,this.$refs.videoElement.play()},closeStopmotionPanel(){this.$emit("openStopmotion",void 0),this.media_is_being_sent=!1,this.media_being_sent_percent=100,this.media_to_validate=!1,this.is_recording=!1,this.ask_before_leaving_capture=!1,this.show_live_feed=!0},captureKeyListener(e){if(console.log("METHODS • CaptureView: captureKeyListener"),this.media_to_validate||this.is_validating_stopmotion_video)return!1;if(!(this.$root.modal_is_opened||"select"===e.target.tagName.toLowerCase()||"input"===e.target.tagName.toLowerCase()||"textarea"===e.target.tagName.toLowerCase()||e.target.className.includes("ql-editor")||e.target.hasAttribute("contenteditable")))switch(e.key){case"w":case"z":case"ArrowLeft":this.$eventHub.$emit("mode.set.previous");break;case"s":case"ArrowRight":this.$eventHub.$emit("mode.set.next");break;case"a":case"q":case" ":this.is_recording?this.stopRecording():this.setCaptureInit();break}},setCaptureInit(){!0===this.$root.debug_mode&&console.log("CaptureView / setCaptureInit"),this.ask_before_leaving_capture=!0,this.delay_mode_enabled&&this.delay_event?this.cancelDelay():this.delay_mode_enabled?this.startDelay():this.setCapture()},startDelay(){let e=0;this.delay_remaining_time=this.delay_seconds,this.delay_event=window.setInterval((()=>{e+=1,e===this.delay_seconds?(this.setCapture(),this.cancelDelay()):this.delay_remaining_time=this.delay_seconds-e}),1e3)},cancelDelay(){this.delay_remaining_time=!1,window.clearInterval(this.delay_event),this.delay_event=!1},startTimelapseInterval(){let e=0;this.timelapse_time_before_next_picture=this.timelapse_interval,this.timelapse_event=window.setInterval((()=>{e+=1,e===this.timelapse_interval?(this.setCapture(),this.stopTimelapseInterval(),this.startTimelapseInterval()):this.timelapse_time_before_next_picture=this.timelapse_interval-e}),1e3)},stopTimelapseInterval(){window.clearInterval(this.timelapse_event),this.timelapse_event=!1,this.timelapse_time_before_next_picture=!1},setCapture(){if(this.capture_button_pressed=!0,window.setTimeout((()=>{this.capture_button_pressed=!1}),400),this.show_capture_settings=!1,"photo"===this.selected_mode)this.getImageDataFromFeed().then((e=>{this.media_to_validate={rawData:e,objectURL:URL.createObjectURL(e),temp_name:"image.jpeg",type:"image"}}));else if("video"===this.selected_mode)this.video_recording_is_paused=!1,this.startRecordFeed({type:"video",mimeType:"video/webm;codecs=vp8,opus",videoBitsPerSecond:4112e3,enable_audio_recording_in_video:this.enable_audio_recording_in_video});else if("audio"===this.selected_mode)this.startRecordFeed({type:"audio"});else if("stopmotion"===this.selected_mode)this.addStopmotionImage(),this.timelapse_mode_enabled&&!this.is_recording&&(this.is_recording=!0,this.startTimelapseInterval());else if("vecto"===this.selected_mode){const e=this.$refs.vectoElement.svgstr;this.media_to_validate={preview:e,rawData:new Blob([e],{type:"image/svg+xml"}),temp_name:"vecto.svg",type:"svg"}}else if("lines"===this.selected_mode){const e=this.$refs.vectoElement.$el.querySelector("svg").outerHTML;this.media_to_validate={preview:e,rawData:new Blob([e],{type:"image/svg+xml"}),temp_name:"lines.svg",type:"svg"}}},stopRecording(){if(!this.is_recording)return;const e=this.timer_recording_in_seconds;if("stopmotion"===this.selected_mode&&this.timelapse_mode_enabled)return this.is_recording=!1,void this.stopTimelapseInterval();"video"===this.selected_mode?this.recorder.stopRecording((()=>{this.is_recording=!1,this.eraseTimer();let t=this.recorder.getBlob();this.recorder.destroy(),this.recorder=null,Qe()(t,1e3*e,{logger:!1}).then((e=>{this.media_to_validate={rawData:e,objectURL:URL.createObjectURL(e),temp_name:"video.webm",type:"video"}}))})):"audio"===this.selected_mode&&this.recorder.stopRecording((()=>{this.is_recording=!1,this.eraseTimer();let t=this.recorder.getBlob();this.recorder.destroy(),this.recorder=null;const i=this.$refs.equalizerElement.$el.querySelector("canvas").toDataURL("image/png");Qe()(t,1e3*e,{logger:!1}).then((e=>{this.media_to_validate={preview:i,rawData:e,objectURL:URL.createObjectURL(e),temp_name:"audio.wav",type:"audio"}}))}))},pauseOrResumeCapture(){"paused"!==this.recorder.state?(this.video_recording_is_paused=!0,this.pauseTimer(),this.recorder.pauseRecording()):(this.video_recording_is_paused=!1,this.unpauseTimer(),this.recorder.resumeRecording())},startTimer(){this.recording_timer_interval=window.setInterval((()=>{this.timer_recording_in_seconds=Number(Number(this.timer_recording_in_seconds)+.1).toFixed(1)}),100)},pauseTimer(){window.clearInterval(this.recording_timer_interval)},unpauseTimer(){this.startTimer()},eraseTimer(){this.timer_recording_in_seconds=!1,window.clearInterval(this.recording_timer_interval)},getImageDataFromFeed({width:e,height:t}={}){return new Promise(((i,o)=>{this.enable_effects&&this.$refs.canvasElement?this.getStaticImageFromVideoElement({width:e,height:t,from_element:this.$refs.canvasElement}).then(i).catch(o):this.getStaticImageFromVideoElement({width:e,height:t}).then(i).catch(o)}))},async getStaticImageFromVideoElement({width:e,height:t,from_element:i=this.$refs.videoElement}={}){if(!0===this.$root.debug_mode&&console.log("CaptureView • METHODS : getStaticImageFromVideoElement"),!i)throw new Error("missing video element");let o;if("VIDEO"===i.tagName){this.invisible_canvas||(this.invisible_canvas=document.createElement("canvas")),o=this.invisible_canvas,o.width=e||i.videoWidth,o.height=t||i.videoHeight;let n=o.getContext("2d");n.drawImage(i,0,0,o.width,o.height)}else"CANVAS"===i.tagName&&(o=i);const n=await new Promise((e=>{o.toBlob(e,"image/jpeg",.95)}));return n},startRecordFeed(e){return new Promise((()=>{const t=new MediaStream;if("video"===e.type){const e=this.enable_effects&&this.$refs.canvasElement?this.$refs.canvasElement.captureStream():this.stream;e.getVideoTracks().forEach((e=>{t.addTrack(e)}))}!0!==e?.enable_audio_recording_in_video&&"audio"!==e.type||this.stream.getAudioTracks().forEach((e=>t.addTrack(e))),this.recorder=Je()(t,e);try{this.recorder.startRecording(),this.is_recording=!0,this.timer_recording_in_seconds=0,this.$eventHub.$emit("capture.isRecording",e.type),this.startTimer()}catch(i){this.$alertify.closeLogOnClick(!0).delay(4e3).error(this.$t("failed_to_start_record")+"<br>"+i.message)}}))},async sendMedia({fav:e=!1}={}){if(console.log(`METHODS • CaptureView: sendMedia with fav=${e}`),!0===this.$root.debug_mode&&console.log("METHODS • CaptureView / sendMedia"),this.return_temp_media)return void this.$emit("tempMedia",this.media_to_validate);const t=+new Date,i=(Math.random().toString(36)+"00000000000000000").slice(2,5),o={image:"jpeg",video:"webm",audio:"wav",svg:"svg"},n=`${this.media_to_validate.type}-${t}-${i}.${o[this.media_to_validate.type]}`,a=this.media_to_validate.rawData;this.media_is_being_sent=!0,this.media_being_sent_percent=0;let r={fav:e,$origin:this.origin};this.connected_as?.$path&&(r.$authors=[this.connected_as.$path]),this.has_location_to_add_to_medias&&(r.$location=this.location_to_add_to_medias);const s=e=>{console.log(`METHODS • CaptureView: onUploadProgress for name = ${n} / ${parseInt(Math.round(100*e.loaded/e.total))}% `),this.media_being_sent_percent=parseInt(Math.round(100*e.loaded/e.total))},{meta_filename:d}=await this.$api.uploadFile({path:this.path,filename:n,file:a,additional_meta:r,onProgress:s}).catch((e=>{throw console.log(`METHODS • sendThisFile: name = ${n} / failed uploading ${e}`),this.media_is_being_sent=!1,this.media_being_sent_percent=0,this.$alertify.closeLogOnClick(!0).delay(4e3).error(this.$t("media_couldnt_be_sent")),e}));this.$alertify.closeLogOnClick(!0).delay(4e3).success(this.$t("media_was_saved")),this.media_is_being_sent=!1,this.media_being_sent_percent=100,this.media_to_validate=!1,this.$eventHub.$emit("pane.animate","collect"),this.$emit("insertMedia",d)},cancelValidation(){this.media_to_validate=!1}}},et=Ze,tt=(i(23212),(0,c.A)(et,o,n,!1,null,"36c214a2",null)),it=tt.exports},64898:function(e,t,i){var o,n;i(21903),i(91134),i(44114),function(a,r){o=r,n="function"===typeof o?o.call(t,i,t,e):o,void 0===n||(e.exports=n)}(0,(function(){var e={172351395:{name:"EBML",type:"Container"},646:{name:"EBMLVersion",type:"Uint"},759:{name:"EBMLReadVersion",type:"Uint"},754:{name:"EBMLMaxIDLength",type:"Uint"},755:{name:"EBMLMaxSizeLength",type:"Uint"},642:{name:"DocType",type:"String"},647:{name:"DocTypeVersion",type:"Uint"},645:{name:"DocTypeReadVersion",type:"Uint"},108:{name:"Void",type:"Binary"},63:{name:"CRC-32",type:"Binary"},190023271:{name:"SignatureSlot",type:"Container"},16010:{name:"SignatureAlgo",type:"Uint"},16026:{name:"SignatureHash",type:"Uint"},16037:{name:"SignaturePublicKey",type:"Binary"},16053:{name:"Signature",type:"Binary"},15963:{name:"SignatureElements",type:"Container"},15995:{name:"SignatureElementList",type:"Container"},9522:{name:"SignedElement",type:"Binary"},139690087:{name:"Segment",type:"Container"},21863284:{name:"SeekHead",type:"Container"},3515:{name:"Seek",type:"Container"},5035:{name:"SeekID",type:"Binary"},5036:{name:"SeekPosition",type:"Uint"},88713574:{name:"Info",type:"Container"},13220:{name:"SegmentUID",type:"Binary"},13188:{name:"SegmentFilename",type:"String"},1882403:{name:"PrevUID",type:"Binary"},1868715:{name:"PrevFilename",type:"String"},2013475:{name:"NextUID",type:"Binary"},1999803:{name:"NextFilename",type:"String"},1092:{name:"SegmentFamily",type:"Binary"},10532:{name:"ChapterTranslate",type:"Container"},10748:{name:"ChapterTranslateEditionUID",type:"Uint"},10687:{name:"ChapterTranslateCodec",type:"Uint"},10661:{name:"ChapterTranslateID",type:"Binary"},710577:{name:"TimecodeScale",type:"Uint"},1161:{name:"Duration",type:"Float"},1121:{name:"DateUTC",type:"Date"},15273:{name:"Title",type:"String"},3456:{name:"MuxingApp",type:"String"},5953:{name:"WritingApp",type:"String"},103:{name:"Timecode",type:"Uint"},6228:{name:"SilentTracks",type:"Container"},6359:{name:"SilentTrackNumber",type:"Uint"},39:{name:"Position",type:"Uint"},43:{name:"PrevSize",type:"Uint"},35:{name:"SimpleBlock",type:"Binary"},32:{name:"BlockGroup",type:"Container"},33:{name:"Block",type:"Binary"},34:{name:"BlockVirtual",type:"Binary"},13729:{name:"BlockAdditions",type:"Container"},38:{name:"BlockMore",type:"Container"},110:{name:"BlockAddID",type:"Uint"},37:{name:"BlockAdditional",type:"Binary"},27:{name:"BlockDuration",type:"Uint"},122:{name:"ReferencePriority",type:"Uint"},123:{name:"ReferenceBlock",type:"Int"},125:{name:"ReferenceVirtual",type:"Int"},36:{name:"CodecState",type:"Binary"},13730:{name:"DiscardPadding",type:"Int"},14:{name:"Slices",type:"Container"},104:{name:"TimeSlice",type:"Container"},76:{name:"LaceNumber",type:"Uint"},77:{name:"FrameNumber",type:"Uint"},75:{name:"BlockAdditionID",type:"Uint"},78:{name:"Delay",type:"Uint"},79:{name:"SliceDuration",type:"Uint"},72:{name:"ReferenceFrame",type:"Container"},73:{name:"ReferenceOffset",type:"Uint"},74:{name:"ReferenceTimeCode",type:"Uint"},47:{name:"EncryptedBlock",type:"Binary"},106212971:{name:"Tracks",type:"Container"},46:{name:"TrackEntry",type:"Container"},87:{name:"TrackNumber",type:"Uint"},13253:{name:"TrackUID",type:"Uint"},3:{name:"TrackType",type:"Uint"},57:{name:"FlagEnabled",type:"Uint"},8:{name:"FlagDefault",type:"Uint"},5546:{name:"FlagForced",type:"Uint"},28:{name:"FlagLacing",type:"Uint"},11751:{name:"MinCache",type:"Uint"},11768:{name:"MaxCache",type:"Uint"},254851:{name:"DefaultDuration",type:"Uint"},216698:{name:"DefaultDecodedFieldDuration",type:"Uint"},209231:{name:"TrackTimecodeScale",type:"Float"},4991:{name:"TrackOffset",type:"Int"},5614:{name:"MaxBlockAdditionID",type:"Uint"},4974:{name:"Name",type:"String"},177564:{name:"Language",type:"String"},6:{name:"CodecID",type:"String"},9122:{name:"CodecPrivate",type:"Binary"},362120:{name:"CodecName",type:"String"},13382:{name:"AttachmentLink",type:"Uint"},1742487:{name:"CodecSettings",type:"String"},1785920:{name:"CodecInfoURL",type:"String"},438848:{name:"CodecDownloadURL",type:"String"},42:{name:"CodecDecodeAll",type:"Uint"},12203:{name:"TrackOverlay",type:"Uint"},5802:{name:"CodecDelay",type:"Uint"},5819:{name:"SeekPreRoll",type:"Uint"},9764:{name:"TrackTranslate",type:"Container"},9980:{name:"TrackTranslateEditionUID",type:"Uint"},9919:{name:"TrackTranslateCodec",type:"Uint"},9893:{name:"TrackTranslateTrackID",type:"Binary"},96:{name:"Video",type:"Container"},26:{name:"FlagInterlaced",type:"Uint"},5048:{name:"StereoMode",type:"Uint"},5056:{name:"AlphaMode",type:"Uint"},5049:{name:"OldStereoMode",type:"Uint"},48:{name:"PixelWidth",type:"Uint"},58:{name:"PixelHeight",type:"Uint"},5290:{name:"PixelCropBottom",type:"Uint"},5307:{name:"PixelCropTop",type:"Uint"},5324:{name:"PixelCropLeft",type:"Uint"},5341:{name:"PixelCropRight",type:"Uint"},5296:{name:"DisplayWidth",type:"Uint"},5306:{name:"DisplayHeight",type:"Uint"},5298:{name:"DisplayUnit",type:"Uint"},5299:{name:"AspectRatioType",type:"Uint"},963876:{name:"ColourSpace",type:"Binary"},1029411:{name:"GammaValue",type:"Float"},230371:{name:"FrameRate",type:"Float"},97:{name:"Audio",type:"Container"},53:{name:"SamplingFrequency",type:"Float"},14517:{name:"OutputSamplingFrequency",type:"Float"},31:{name:"Channels",type:"Uint"},15739:{name:"ChannelPositions",type:"Binary"},8804:{name:"BitDepth",type:"Uint"},98:{name:"TrackOperation",type:"Container"},99:{name:"TrackCombinePlanes",type:"Container"},100:{name:"TrackPlane",type:"Container"},101:{name:"TrackPlaneUID",type:"Uint"},102:{name:"TrackPlaneType",type:"Uint"},105:{name:"TrackJoinBlocks",type:"Container"},109:{name:"TrackJoinUID",type:"Uint"},64:{name:"TrickTrackUID",type:"Uint"},65:{name:"TrickTrackSegmentUID",type:"Binary"},70:{name:"TrickTrackFlag",type:"Uint"},71:{name:"TrickMasterTrackUID",type:"Uint"},68:{name:"TrickMasterTrackSegmentUID",type:"Binary"},11648:{name:"ContentEncodings",type:"Container"},8768:{name:"ContentEncoding",type:"Container"},4145:{name:"ContentEncodingOrder",type:"Uint"},4146:{name:"ContentEncodingScope",type:"Uint"},4147:{name:"ContentEncodingType",type:"Uint"},4148:{name:"ContentCompression",type:"Container"},596:{name:"ContentCompAlgo",type:"Uint"},597:{name:"ContentCompSettings",type:"Binary"},4149:{name:"ContentEncryption",type:"Container"},2017:{name:"ContentEncAlgo",type:"Uint"},2018:{name:"ContentEncKeyID",type:"Binary"},2019:{name:"ContentSignature",type:"Binary"},2020:{name:"ContentSigKeyID",type:"Binary"},2021:{name:"ContentSigAlgo",type:"Uint"},2022:{name:"ContentSigHashAlgo",type:"Uint"},206814059:{name:"Cues",type:"Container"},59:{name:"CuePoint",type:"Container"},51:{name:"CueTime",type:"Uint"},55:{name:"CueTrackPositions",type:"Container"},119:{name:"CueTrack",type:"Uint"},113:{name:"CueClusterPosition",type:"Uint"},112:{name:"CueRelativePosition",type:"Uint"},50:{name:"CueDuration",type:"Uint"},4984:{name:"CueBlockNumber",type:"Uint"},106:{name:"CueCodecState",type:"Uint"},91:{name:"CueReference",type:"Container"},22:{name:"CueRefTime",type:"Uint"},23:{name:"CueRefCluster",type:"Uint"},4959:{name:"CueRefNumber",type:"Uint"},107:{name:"CueRefCodecState",type:"Uint"},155296873:{name:"Attachments",type:"Container"},8615:{name:"AttachedFile",type:"Container"},1662:{name:"FileDescription",type:"String"},1646:{name:"FileName",type:"String"},1632:{name:"FileMimeType",type:"String"},1628:{name:"FileData",type:"Binary"},1710:{name:"FileUID",type:"Uint"},1653:{name:"FileReferral",type:"Binary"},1633:{name:"FileUsedStartTime",type:"Uint"},1634:{name:"FileUsedEndTime",type:"Uint"},4433776:{name:"Chapters",type:"Container"},1465:{name:"EditionEntry",type:"Container"},1468:{name:"EditionUID",type:"Uint"},1469:{name:"EditionFlagHidden",type:"Uint"},1499:{name:"EditionFlagDefault",type:"Uint"},1501:{name:"EditionFlagOrdered",type:"Uint"},54:{name:"ChapterAtom",type:"Container"},13252:{name:"ChapterUID",type:"Uint"},5716:{name:"ChapterStringUID",type:"String"},17:{name:"ChapterTimeStart",type:"Uint"},18:{name:"ChapterTimeEnd",type:"Uint"},24:{name:"ChapterFlagHidden",type:"Uint"},1432:{name:"ChapterFlagEnabled",type:"Uint"},11879:{name:"ChapterSegmentUID",type:"Binary"},11964:{name:"ChapterSegmentEditionUID",type:"Uint"},9155:{name:"ChapterPhysicalEquiv",type:"Uint"},15:{name:"ChapterTrack",type:"Container"},9:{name:"ChapterTrackNumber",type:"Uint"},0:{name:"ChapterDisplay",type:"Container"},5:{name:"ChapString",type:"String"},892:{name:"ChapLanguage",type:"String"},894:{name:"ChapCountry",type:"String"},10564:{name:"ChapProcess",type:"Container"},10581:{name:"ChapProcessCodecID",type:"Uint"},1293:{name:"ChapProcessPrivate",type:"Binary"},10513:{name:"ChapProcessCommand",type:"Container"},10530:{name:"ChapProcessTime",type:"Uint"},10547:{name:"ChapProcessData",type:"Binary"},39109479:{name:"Tags",type:"Container"},13171:{name:"Tag",type:"Container"},9152:{name:"Targets",type:"Container"},10442:{name:"TargetTypeValue",type:"Uint"},9162:{name:"TargetType",type:"String"},9157:{name:"TagTrackUID",type:"Uint"},9161:{name:"TagEditionUID",type:"Uint"},9156:{name:"TagChapterUID",type:"Uint"},9158:{name:"TagAttachmentUID",type:"Uint"},10184:{name:"SimpleTag",type:"Container"},1443:{name:"TagName",type:"String"},1146:{name:"TagLanguage",type:"String"},1156:{name:"TagDefault",type:"Uint"},1159:{name:"TagString",type:"String"},1157:{name:"TagBinary",type:"Binary"}};function t(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e}function i(e,t){this.name=e||"Unknown",this.type=t||"Unknown"}function o(e,t){i.call(this,e,t||"Uint")}function n(e){return e.length%2===1?"0"+e:e}function a(e,t){i.call(this,e,t||"Float")}function r(e,t){i.call(this,e,t||"Container")}function s(e){r.call(this,"File","File"),this.setSource(e)}function d(e,t,i,o){if("object"===typeof i&&(o=i,i=void 0),!i)return new Promise((function(i){d(e,t,i,o)}));try{var n=new FileReader;n.onloadend=function(){try{var a=new s(new Uint8Array(n.result));a.fixDuration(t,o)&&(e=a.toBlob(e.type))}catch(r){}i(e)},n.readAsArrayBuffer(e)}catch(a){i(e)}}return i.prototype.updateBySource=function(){},i.prototype.setSource=function(e){this.source=e,this.updateBySource()},i.prototype.updateByData=function(){},i.prototype.setData=function(e){this.data=e,this.updateByData()},t(o,i),o.prototype.updateBySource=function(){this.data="";for(var e=0;e<this.source.length;e++){var t=this.source[e].toString(16);this.data+=n(t)}},o.prototype.updateByData=function(){var e=this.data.length/2;this.source=new Uint8Array(e);for(var t=0;t<e;t++){var i=this.data.substr(2*t,2);this.source[t]=parseInt(i,16)}},o.prototype.getValue=function(){return parseInt(this.data,16)},o.prototype.setValue=function(e){this.setData(n(e.toString(16)))},t(a,i),a.prototype.getFloatArrayType=function(){return this.source&&4===this.source.length?Float32Array:Float64Array},a.prototype.updateBySource=function(){var e=this.source.reverse(),t=this.getFloatArrayType(),i=new t(e.buffer);this.data=i[0]},a.prototype.updateByData=function(){var e=this.getFloatArrayType(),t=new e([this.data]),i=new Uint8Array(t.buffer);this.source=i.reverse()},a.prototype.getValue=function(){return this.data},a.prototype.setValue=function(e){this.setData(e)},t(r,i),r.prototype.readByte=function(){return this.source[this.offset++]},r.prototype.readUint=function(){for(var e=this.readByte(),t=8-e.toString(2).length,i=e-(1<<7-t),o=0;o<t;o++)i*=256,i+=this.readByte();return i},r.prototype.updateBySource=function(){for(this.data=[],this.offset=0;this.offset<this.source.length;this.offset=s){var t=this.readUint(),n=this.readUint(),s=Math.min(this.offset+n,this.source.length),d=this.source.slice(this.offset,s),c=e[t]||{name:"Unknown",type:"Unknown"},l=i;switch(c.type){case"Container":l=r;break;case"Uint":l=o;break;case"Float":l=a;break}var u=new l(c.name,c.type);u.setSource(d),this.data.push({id:t,idHex:t.toString(16),data:u})}},r.prototype.writeUint=function(e,t){for(var i=1,o=128;e>=o&&i<8;i++,o*=128);if(!t)for(var n=o+e,a=i-1;a>=0;a--){var r=n%256;this.source[this.offset+a]=r,n=(n-r)/256}this.offset+=i},r.prototype.writeSections=function(e){this.offset=0;for(var t=0;t<this.data.length;t++){var i=this.data[t],o=i.data.source,n=o.length;this.writeUint(i.id,e),this.writeUint(n,e),e||this.source.set(o,this.offset),this.offset+=n}return this.offset},r.prototype.updateByData=function(){var e=this.writeSections("draft");this.source=new Uint8Array(e),this.writeSections()},r.prototype.getSectionById=function(e){for(var t=0;t<this.data.length;t++){var i=this.data[t];if(i.id===e)return i.data}return null},t(s,r),s.prototype.fixDuration=function(e,t){var i=t&&t.logger;void 0===i?i=function(e){console.log(e)}:i||(i=function(){});var o=this.getSectionById(139690087);if(!o)return i("[fix-webm-duration] Segment section is missing"),!1;var n=o.getSectionById(88713574);if(!n)return i("[fix-webm-duration] Info section is missing"),!1;var r=n.getSectionById(710577);if(!r)return i("[fix-webm-duration] TimecodeScale section is missing"),!1;var s=n.getSectionById(1161);if(s){if(!(s.getValue()<=0))return i(`[fix-webm-duration] Duration section is present, and the value is ${s.getValue()}`),!1;i(`[fix-webm-duration] Duration section is present, but the value is ${s.getValue()}`),s.setValue(e)}else i("[fix-webm-duration] Duration section is missing"),s=new a("Duration","Float"),s.setValue(e),n.data.push({id:1161,data:s});return r.setValue(1e6),n.updateByData(),o.updateByData(),this.updateByData(),!0},s.prototype.toBlob=function(e){return new Blob([this.source.buffer],{type:e||"video/webm"})},d.default=d,d}))},28001:function(e,t,i){var o;i(44114),i(21903),i(91134),function(){"use strict";function n(){var e=this;this.versionnumber="1.2.6",this.imageToSVG=function(t,i,o){o=e.checkoptions(o),e.loadImage(t,(function(t){i(e.imagedataToSVG(e.getImgdata(t),o))}),o)},this.imagedataToSVG=function(t,i){i=e.checkoptions(i);var o=e.imagedataToTracedata(t,i);return e.getsvgstring(o,i)},this.imageToTracedata=function(t,i,o){o=e.checkoptions(o),e.loadImage(t,(function(t){i(e.imagedataToTracedata(e.getImgdata(t),o))}),o)},this.imagedataToTracedata=function(t,i){i=e.checkoptions(i);var o=e.colorquantization(t,i);if(0===i.layering)for(var n={layers:[],palette:o.palette,width:o.array[0].length-2,height:o.array.length-2},a=0;a<o.palette.length;a++){var r=e.batchtracepaths(e.internodes(e.pathscan(e.layeringstep(o,a),i.pathomit),i),i.ltres,i.qtres);n.layers.push(r)}else{var s=e.layering(o);i.layercontainerid&&e.drawLayers(s,e.specpalette,i.scale,i.layercontainerid);var d=e.batchpathscan(s,i.pathomit),c=e.batchinternodes(d,i);n={layers:e.batchtracelayers(c,i.ltres,i.qtres),palette:o.palette,width:t.width,height:t.height}}return n},this.optionpresets={default:{corsenabled:!1,ltres:1,qtres:1,pathomit:8,rightangleenhance:!0,colorsampling:2,numberofcolors:16,mincolorratio:0,colorquantcycles:3,layering:0,strokewidth:1,linefilter:!1,scale:1,roundcoords:1,viewbox:!1,desc:!1,lcpr:0,qcpr:0,blurradius:0,blurdelta:20},posterized1:{colorsampling:0,numberofcolors:2},posterized2:{numberofcolors:4,blurradius:5},curvy:{ltres:.01,linefilter:!0,rightangleenhance:!1},sharp:{qtres:.01,linefilter:!1},detailed:{pathomit:0,roundcoords:2,ltres:.5,qtres:.5,numberofcolors:64},smoothed:{blurradius:5,blurdelta:64},grayscale:{colorsampling:0,colorquantcycles:1,numberofcolors:7},fixedpalette:{colorsampling:0,colorquantcycles:1,numberofcolors:27},randomsampling1:{colorsampling:1,numberofcolors:8},randomsampling2:{colorsampling:1,numberofcolors:64},artistic1:{colorsampling:0,colorquantcycles:1,pathomit:0,blurradius:5,blurdelta:64,ltres:.01,linefilter:!0,numberofcolors:16,strokewidth:2},artistic2:{qtres:.01,colorsampling:0,colorquantcycles:1,numberofcolors:4,strokewidth:0},artistic3:{qtres:10,ltres:10,numberofcolors:8},artistic4:{qtres:10,ltres:10,numberofcolors:64,blurradius:5,blurdelta:256,strokewidth:2},posterized3:{ltres:1,qtres:1,pathomit:20,rightangleenhance:!0,colorsampling:0,numberofcolors:3,mincolorratio:0,colorquantcycles:3,blurradius:3,blurdelta:20,strokewidth:0,linefilter:!1,roundcoords:1,pal:[{r:0,g:0,b:100,a:255},{r:255,g:255,b:255,a:255}]}},this.checkoptions=function(t){t=t||{},"string"===typeof t&&(t=t.toLowerCase(),t=e.optionpresets[t]?e.optionpresets[t]:{});for(var i=Object.keys(e.optionpresets["default"]),o=0;o<i.length;o++)t.hasOwnProperty(i[o])||(t[i[o]]=e.optionpresets["default"][i[o]]);return t},this.colorquantization=function(t,i){var o,n,a,r,s,d,c,l,u=[],m=0,p=[],f=t.width*t.height;if(t.data.length<4*f){for(var h=new Uint8ClampedArray(4*f),v=0;v<f;v++)h[4*v]=t.data[3*v],h[4*v+1]=t.data[3*v+1],h[4*v+2]=t.data[3*v+2],h[4*v+3]=255;t.data=h}for(s=0;s<t.height+2;s++)for(u[s]=[],r=0;r<t.width+2;r++)u[s][r]=-1;for(l=i.pal?i.pal:0===i.colorsampling?e.generatepalette(i.numberofcolors):1===i.colorsampling?e.samplepalette(i.numberofcolors,t):e.samplepalette2(i.numberofcolors,t),i.blurradius>0&&(t=e.blur(t,i.blurradius,i.blurdelta)),c=0;c<i.colorquantcycles;c++){if(c>0)for(d=0;d<l.length;d++)p[d].n>0&&(l[d]={r:Math.floor(p[d].r/p[d].n),g:Math.floor(p[d].g/p[d].n),b:Math.floor(p[d].b/p[d].n),a:Math.floor(p[d].a/p[d].n)}),p[d].n/f<i.mincolorratio&&c<i.colorquantcycles-1&&(l[d]={r:Math.floor(255*Math.random()),g:Math.floor(255*Math.random()),b:Math.floor(255*Math.random()),a:Math.floor(255*Math.random())});for(r=0;r<l.length;r++)p[r]={r:0,g:0,b:0,a:0,n:0};for(s=0;s<t.height;s++)for(r=0;r<t.width;r++){for(m=4*(s*t.width+r),a=0,n=1024,d=0;d<l.length;d++)o=Math.abs(l[d].r-t.data[m])+Math.abs(l[d].g-t.data[m+1])+Math.abs(l[d].b-t.data[m+2])+Math.abs(l[d].a-t.data[m+3]),o<n&&(n=o,a=d);p[a].r+=t.data[m],p[a].g+=t.data[m+1],p[a].b+=t.data[m+2],p[a].a+=t.data[m+3],p[a].n++,u[s+1][r+1]=a}}return{array:u,palette:l}},this.samplepalette=function(e,t){for(var i,o=[],n=0;n<e;n++)i=4*Math.floor(Math.random()*t.data.length/4),o.push({r:t.data[i],g:t.data[i+1],b:t.data[i+2],a:t.data[i+3]});return o},this.samplepalette2=function(e,t){for(var i,o=[],n=Math.ceil(Math.sqrt(e)),a=Math.ceil(e/n),r=t.width/(n+1),s=t.height/(a+1),d=0;d<a;d++)for(var c=0;c<n;c++){if(o.length===e)break;i=4*Math.floor((d+1)*s*t.width+(c+1)*r),o.push({r:t.data[i],g:t.data[i+1],b:t.data[i+2],a:t.data[i+3]})}return o},this.generatepalette=function(e){var t,i,o,n=[];if(e<8)for(var a=Math.floor(255/(e-1)),r=0;r<e;r++)n.push({r:r*a,g:r*a,b:r*a,a:255});else{var s=Math.floor(Math.pow(e,1/3)),d=Math.floor(255/(s-1)),c=e-s*s*s;for(t=0;t<s;t++)for(i=0;i<s;i++)for(o=0;o<s;o++)n.push({r:t*d,g:i*d,b:o*d,a:255});for(t=0;t<c;t++)n.push({r:Math.floor(255*Math.random()),g:Math.floor(255*Math.random()),b:Math.floor(255*Math.random()),a:Math.floor(255*Math.random())})}return n},this.layering=function(e){var t,i,o,n,a,r,s,d,c,l,u,m=[],p=0,f=e.array.length,h=e.array[0].length;for(u=0;u<e.palette.length;u++)for(m[u]=[],l=0;l<f;l++)for(m[u][l]=[],c=0;c<h;c++)m[u][l][c]=0;for(l=1;l<f-1;l++)for(c=1;c<h-1;c++)p=e.array[l][c],t=e.array[l-1][c-1]===p?1:0,i=e.array[l-1][c]===p?1:0,o=e.array[l-1][c+1]===p?1:0,n=e.array[l][c-1]===p?1:0,a=e.array[l][c+1]===p?1:0,r=e.array[l+1][c-1]===p?1:0,s=e.array[l+1][c]===p?1:0,d=e.array[l+1][c+1]===p?1:0,m[p][l+1][c+1]=1+2*a+4*d+8*s,n||(m[p][l+1][c]=2+4*s+8*r),i||(m[p][l][c+1]=0+2*o+4*a+8),t||(m[p][l][c]=0+2*i+4+8*n);return m},this.layeringstep=function(e,t){var i,o,n=[],a=e.array.length,r=e.array[0].length;for(o=0;o<a;o++)for(n[o]=[],i=0;i<r;i++)n[o][i]=0;for(o=1;o<a;o++)for(i=1;i<r;i++)n[o][i]=(e.array[o-1][i-1]===t?1:0)+(e.array[o-1][i]===t?2:0)+(e.array[o][i-1]===t?8:0)+(e.array[o][i]===t?4:0);return n},this.pointinpoly=function(e,t){for(var i=!1,o=0,n=t.length-1;o<t.length;n=o++)i=t[o].y>e.y!==t[n].y>e.y&&e.x<(t[n].x-t[o].x)*(e.y-t[o].y)/(t[n].y-t[o].y)+t[o].x?!i:i;return i},this.pathscan_combined_lookup=[[[-1,-1,-1,-1],[-1,-1,-1,-1],[-1,-1,-1,-1],[-1,-1,-1,-1]],[[0,1,0,-1],[-1,-1,-1,-1],[-1,-1,-1,-1],[0,2,-1,0]],[[-1,-1,-1,-1],[-1,-1,-1,-1],[0,1,0,-1],[0,0,1,0]],[[0,0,1,0],[-1,-1,-1,-1],[0,2,-1,0],[-1,-1,-1,-1]],[[-1,-1,-1,-1],[0,0,1,0],[0,3,0,1],[-1,-1,-1,-1]],[[13,3,0,1],[13,2,-1,0],[7,1,0,-1],[7,0,1,0]],[[-1,-1,-1,-1],[0,1,0,-1],[-1,-1,-1,-1],[0,3,0,1]],[[0,3,0,1],[0,2,-1,0],[-1,-1,-1,-1],[-1,-1,-1,-1]],[[0,3,0,1],[0,2,-1,0],[-1,-1,-1,-1],[-1,-1,-1,-1]],[[-1,-1,-1,-1],[0,1,0,-1],[-1,-1,-1,-1],[0,3,0,1]],[[11,1,0,-1],[14,0,1,0],[14,3,0,1],[11,2,-1,0]],[[-1,-1,-1,-1],[0,0,1,0],[0,3,0,1],[-1,-1,-1,-1]],[[0,0,1,0],[-1,-1,-1,-1],[0,2,-1,0],[-1,-1,-1,-1]],[[-1,-1,-1,-1],[-1,-1,-1,-1],[0,1,0,-1],[0,0,1,0]],[[0,1,0,-1],[-1,-1,-1,-1],[-1,-1,-1,-1],[0,2,-1,0]],[[-1,-1,-1,-1],[-1,-1,-1,-1],[-1,-1,-1,-1],[-1,-1,-1,-1]]],this.pathscan=function(t,i){for(var o,n=[],a=0,r=0,s=0,d=0,c=t[0].length,l=t.length,u=0,m=!0,p=!1,f=0;f<l;f++)for(var h=0;h<c;h++)if(4==t[f][h]||11==t[f][h]){s=h,d=f,n[a]={},n[a].points=[],n[a].boundingbox=[s,d,s,d],n[a].holechildren=[],m=!1,r=0,p=11==t[f][h],u=1;while(!m){if(n[a].points[r]={},n[a].points[r].x=s-1,n[a].points[r].y=d-1,n[a].points[r].t=t[d][s],s-1<n[a].boundingbox[0]&&(n[a].boundingbox[0]=s-1),s-1>n[a].boundingbox[2]&&(n[a].boundingbox[2]=s-1),d-1<n[a].boundingbox[1]&&(n[a].boundingbox[1]=d-1),d-1>n[a].boundingbox[3]&&(n[a].boundingbox[3]=d-1),o=e.pathscan_combined_lookup[t[d][s]][u],t[d][s]=o[0],u=o[1],s+=o[2],d+=o[3],s-1===n[a].points[0].x&&d-1===n[a].points[0].y)if(m=!0,n[a].points.length<i)n.pop();else{if(n[a].isholepath=!!p,p){for(var v=0,g=[-1,-1,c+1,l+1],_=0;_<a;_++)!n[_].isholepath&&e.boundingboxincludes(n[_].boundingbox,n[a].boundingbox)&&e.boundingboxincludes(g,n[_].boundingbox)&&e.pointinpoly(n[a].points[0],n[_].points)&&(v=_,g=n[_].boundingbox);n[v].holechildren.push(a)}a++}r++}}return n},this.boundingboxincludes=function(e,t){return e[0]<t[0]&&e[1]<t[1]&&e[2]>t[2]&&e[3]>t[3]},this.batchpathscan=function(t,i){var o=[];for(var n in t)t.hasOwnProperty(n)&&(o[n]=e.pathscan(t[n],i));return o},this.internodes=function(t,i){var o,n,a=[],r=0,s=0,d=0,c=0,l=0;for(o=0;o<t.length;o++)for(a[o]={},a[o].points=[],a[o].boundingbox=t[o].boundingbox,a[o].holechildren=t[o].holechildren,a[o].isholepath=t[o].isholepath,r=t[o].points.length,n=0;n<r;n++)s=(n+1)%r,d=(n+2)%r,c=(n-1+r)%r,l=(n-2+r)%r,i.rightangleenhance&&e.testrightangle(t[o],l,c,n,s,d)&&(a[o].points.length>0&&(a[o].points[a[o].points.length-1].linesegment=e.getdirection(a[o].points[a[o].points.length-1].x,a[o].points[a[o].points.length-1].y,t[o].points[n].x,t[o].points[n].y)),a[o].points.push({x:t[o].points[n].x,y:t[o].points[n].y,linesegment:e.getdirection(t[o].points[n].x,t[o].points[n].y,(t[o].points[n].x+t[o].points[s].x)/2,(t[o].points[n].y+t[o].points[s].y)/2)})),a[o].points.push({x:(t[o].points[n].x+t[o].points[s].x)/2,y:(t[o].points[n].y+t[o].points[s].y)/2,linesegment:e.getdirection((t[o].points[n].x+t[o].points[s].x)/2,(t[o].points[n].y+t[o].points[s].y)/2,(t[o].points[s].x+t[o].points[d].x)/2,(t[o].points[s].y+t[o].points[d].y)/2)});return a},this.testrightangle=function(e,t,i,o,n,a){return e.points[o].x===e.points[t].x&&e.points[o].x===e.points[i].x&&e.points[o].y===e.points[n].y&&e.points[o].y===e.points[a].y||e.points[o].y===e.points[t].y&&e.points[o].y===e.points[i].y&&e.points[o].x===e.points[n].x&&e.points[o].x===e.points[a].x},this.getdirection=function(e,t,i,o){var n=8;return n=e<i?t<o?1:t>o?7:0:e>i?t<o?3:t>o?5:4:t<o?2:t>o?6:8,n},this.batchinternodes=function(t,i){var o=[];for(var n in t)t.hasOwnProperty(n)&&(o[n]=e.internodes(t[n],i));return o},this.tracepath=function(t,i,o){var n,a,r,s=0,d={segments:[]};d.boundingbox=t.boundingbox,d.holechildren=t.holechildren,d.isholepath=t.isholepath;while(s<t.points.length){n=t.points[s].linesegment,a=-1,r=s+1;while((t.points[r].linesegment===n||t.points[r].linesegment===a||-1===a)&&r<t.points.length-1)t.points[r].linesegment!==n&&-1===a&&(a=t.points[r].linesegment),r++;r===t.points.length-1&&(r=0),d.segments=d.segments.concat(e.fitseq(t,i,o,s,r)),s=r>0?r:t.points.length}return d},this.fitseq=function(t,i,o,n,a){if(a>t.points.length||a<0)return[];var r,s,d,c=n,l=0,u=!0,m=a-n;m<0&&(m+=t.points.length);var p,f=(t.points[a].x-t.points[n].x)/m,h=(t.points[a].y-t.points[n].y)/m,v=(n+1)%t.points.length;while(v!=a)p=v-n,p<0&&(p+=t.points.length),r=t.points[n].x+f*p,s=t.points[n].y+h*p,d=(t.points[v].x-r)*(t.points[v].x-r)+(t.points[v].y-s)*(t.points[v].y-s),d>i&&(u=!1),d>l&&(c=v,l=d),v=(v+1)%t.points.length;if(u)return[{type:"L",x1:t.points[n].x,y1:t.points[n].y,x2:t.points[a].x,y2:t.points[a].y}];var g=c;u=!0,l=0;var _=(g-n)/m,b=(1-_)*(1-_),y=2*(1-_)*_,w=_*_,C=(b*t.points[n].x+w*t.points[a].x-t.points[g].x)/-y,S=(b*t.points[n].y+w*t.points[a].y-t.points[g].y)/-y;v=n+1;while(v!=a)_=(v-n)/m,b=(1-_)*(1-_),y=2*(1-_)*_,w=_*_,r=b*t.points[n].x+y*C+w*t.points[a].x,s=b*t.points[n].y+y*S+w*t.points[a].y,d=(t.points[v].x-r)*(t.points[v].x-r)+(t.points[v].y-s)*(t.points[v].y-s),d>o&&(u=!1),d>l&&(c=v,l=d),v=(v+1)%t.points.length;if(u)return[{type:"Q",x1:t.points[n].x,y1:t.points[n].y,x2:C,y2:S,x3:t.points[a].x,y3:t.points[a].y}];var x=g;return e.fitseq(t,i,o,n,x).concat(e.fitseq(t,i,o,x,a))},this.batchtracepaths=function(t,i,o){var n=[];for(var a in t)t.hasOwnProperty(a)&&n.push(e.tracepath(t[a],i,o));return n},this.batchtracelayers=function(t,i,o){var n=[];for(var a in t)t.hasOwnProperty(a)&&(n[a]=e.batchtracepaths(t[a],i,o));return n},this.roundtodec=function(e,t){return+e.toFixed(t)},this.svgpathstring=function(t,i,o,n){var a,r=t.layers[i],s=r[o],d="";if(n.linefilter&&s.segments.length<3)return d;if(d="<path "+(n.desc?'desc="l '+i+" p "+o+'" ':"")+e.tosvgcolorstr(t.palette[i],n)+'d="',-1===n.roundcoords){for(d+="M "+s.segments[0].x1*n.scale+" "+s.segments[0].y1*n.scale+" ",a=0;a<s.segments.length;a++)d+=s.segments[a].type+" "+s.segments[a].x2*n.scale+" "+s.segments[a].y2*n.scale+" ",s.segments[a].hasOwnProperty("x3")&&(d+=s.segments[a].x3*n.scale+" "+s.segments[a].y3*n.scale+" ");d+="Z "}else{for(d+="M "+e.roundtodec(s.segments[0].x1*n.scale,n.roundcoords)+" "+e.roundtodec(s.segments[0].y1*n.scale,n.roundcoords)+" ",a=0;a<s.segments.length;a++)d+=s.segments[a].type+" "+e.roundtodec(s.segments[a].x2*n.scale,n.roundcoords)+" "+e.roundtodec(s.segments[a].y2*n.scale,n.roundcoords)+" ",s.segments[a].hasOwnProperty("x3")&&(d+=e.roundtodec(s.segments[a].x3*n.scale,n.roundcoords)+" "+e.roundtodec(s.segments[a].y3*n.scale,n.roundcoords)+" ");d+="Z "}for(var c=0;c<s.holechildren.length;c++){var l=r[s.holechildren[c]];if(-1===n.roundcoords)for(l.segments[l.segments.length-1].hasOwnProperty("x3")?d+="M "+l.segments[l.segments.length-1].x3*n.scale+" "+l.segments[l.segments.length-1].y3*n.scale+" ":d+="M "+l.segments[l.segments.length-1].x2*n.scale+" "+l.segments[l.segments.length-1].y2*n.scale+" ",a=l.segments.length-1;a>=0;a--)d+=l.segments[a].type+" ",l.segments[a].hasOwnProperty("x3")&&(d+=l.segments[a].x2*n.scale+" "+l.segments[a].y2*n.scale+" "),d+=l.segments[a].x1*n.scale+" "+l.segments[a].y1*n.scale+" ";else for(l.segments[l.segments.length-1].hasOwnProperty("x3")?d+="M "+e.roundtodec(l.segments[l.segments.length-1].x3*n.scale)+" "+e.roundtodec(l.segments[l.segments.length-1].y3*n.scale)+" ":d+="M "+e.roundtodec(l.segments[l.segments.length-1].x2*n.scale)+" "+e.roundtodec(l.segments[l.segments.length-1].y2*n.scale)+" ",a=l.segments.length-1;a>=0;a--)d+=l.segments[a].type+" ",l.segments[a].hasOwnProperty("x3")&&(d+=e.roundtodec(l.segments[a].x2*n.scale)+" "+e.roundtodec(l.segments[a].y2*n.scale)+" "),d+=e.roundtodec(l.segments[a].x1*n.scale)+" "+e.roundtodec(l.segments[a].y1*n.scale)+" ";d+="Z "}if(d+='" />',n.lcpr||n.qcpr){for(a=0;a<s.segments.length;a++)s.segments[a].hasOwnProperty("x3")&&n.qcpr&&(d+='<circle cx="'+s.segments[a].x2*n.scale+'" cy="'+s.segments[a].y2*n.scale+'" r="'+n.qcpr+'" fill="cyan" stroke-width="'+.2*n.qcpr+'" stroke="black" />',d+='<circle cx="'+s.segments[a].x3*n.scale+'" cy="'+s.segments[a].y3*n.scale+'" r="'+n.qcpr+'" fill="white" stroke-width="'+.2*n.qcpr+'" stroke="black" />',d+='<line x1="'+s.segments[a].x1*n.scale+'" y1="'+s.segments[a].y1*n.scale+'" x2="'+s.segments[a].x2*n.scale+'" y2="'+s.segments[a].y2*n.scale+'" stroke-width="'+.2*n.qcpr+'" stroke="cyan" />',d+='<line x1="'+s.segments[a].x2*n.scale+'" y1="'+s.segments[a].y2*n.scale+'" x2="'+s.segments[a].x3*n.scale+'" y2="'+s.segments[a].y3*n.scale+'" stroke-width="'+.2*n.qcpr+'" stroke="cyan" />'),!s.segments[a].hasOwnProperty("x3")&&n.lcpr&&(d+='<circle cx="'+s.segments[a].x2*n.scale+'" cy="'+s.segments[a].y2*n.scale+'" r="'+n.lcpr+'" fill="white" stroke-width="'+.2*n.lcpr+'" stroke="black" />');for(c=0;c<s.holechildren.length;c++){l=r[s.holechildren[c]];for(a=0;a<l.segments.length;a++)l.segments[a].hasOwnProperty("x3")&&n.qcpr&&(d+='<circle cx="'+l.segments[a].x2*n.scale+'" cy="'+l.segments[a].y2*n.scale+'" r="'+n.qcpr+'" fill="cyan" stroke-width="'+.2*n.qcpr+'" stroke="black" />',d+='<circle cx="'+l.segments[a].x3*n.scale+'" cy="'+l.segments[a].y3*n.scale+'" r="'+n.qcpr+'" fill="white" stroke-width="'+.2*n.qcpr+'" stroke="black" />',d+='<line x1="'+l.segments[a].x1*n.scale+'" y1="'+l.segments[a].y1*n.scale+'" x2="'+l.segments[a].x2*n.scale+'" y2="'+l.segments[a].y2*n.scale+'" stroke-width="'+.2*n.qcpr+'" stroke="cyan" />',d+='<line x1="'+l.segments[a].x2*n.scale+'" y1="'+l.segments[a].y2*n.scale+'" x2="'+l.segments[a].x3*n.scale+'" y2="'+l.segments[a].y3*n.scale+'" stroke-width="'+.2*n.qcpr+'" stroke="cyan" />'),!l.segments[a].hasOwnProperty("x3")&&n.lcpr&&(d+='<circle cx="'+l.segments[a].x2*n.scale+'" cy="'+l.segments[a].y2*n.scale+'" r="'+n.lcpr+'" fill="white" stroke-width="'+.2*n.lcpr+'" stroke="black" />')}}return d},this.getsvgstring=function(t,i){i=e.checkoptions(i);for(var o=t.width*i.scale,n=t.height*i.scale,a="<svg "+(i.viewbox?'viewBox="0 0 '+o+" "+n+'" ':'width="'+o+'" height="'+n+'" ')+'version="1.1" xmlns="http://www.w3.org/2000/svg" desc="Created with imagetracer.js version '+e.versionnumber+'" >',r=0;r<t.layers.length;r++)for(var s=0;s<t.layers[r].length;s++)t.layers[r][s].isholepath||(a+=e.svgpathstring(t,r,s,i));return a+="</svg>",a},this.compareNumbers=function(e,t){return e-t},this.torgbastr=function(e){return"rgba("+e.r+","+e.g+","+e.b+","+e.a+")"},this.tosvgcolorstr=function(e,t){return'fill="rgb('+e.r+","+e.g+","+e.b+')" stroke="rgb('+e.r+","+e.g+","+e.b+')" stroke-width="'+t.strokewidth+'" opacity="'+e.a/255+'" '},this.appendSVGString=function(e,t){var i;t?(i=document.getElementById(t),i||(i=document.createElement("div"),i.id=t,document.body.appendChild(i))):(i=document.createElement("div"),document.body.appendChild(i)),i.innerHTML+=e},this.gks=[[.27901,.44198,.27901],[.135336,.228569,.272192,.228569,.135336],[.086776,.136394,.178908,.195843,.178908,.136394,.086776],[.063327,.093095,.122589,.144599,.152781,.144599,.122589,.093095,.063327],[.049692,.069304,.089767,.107988,.120651,.125194,.120651,.107988,.089767,.069304,.049692]],this.blur=function(t,i,o){var n,a,r,s,d,c,l,u,m,p,f={width:t.width,height:t.height,data:[]};if(i=Math.floor(i),i<1)return t;i>5&&(i=5),o=Math.abs(o),o>1024&&(o=1024);var h=e.gks[i-1];for(a=0;a<t.height;a++)for(n=0;n<t.width;n++){for(c=0,l=0,u=0,m=0,p=0,r=-i;r<i+1;r++)n+r>0&&n+r<t.width&&(d=4*(a*t.width+n+r),c+=t.data[d]*h[r+i],l+=t.data[d+1]*h[r+i],u+=t.data[d+2]*h[r+i],m+=t.data[d+3]*h[r+i],p+=h[r+i]);d=4*(a*t.width+n),f.data[d]=Math.floor(c/p),f.data[d+1]=Math.floor(l/p),f.data[d+2]=Math.floor(u/p),f.data[d+3]=Math.floor(m/p)}var v=new Uint8ClampedArray(f.data);for(a=0;a<t.height;a++)for(n=0;n<t.width;n++){for(c=0,l=0,u=0,m=0,p=0,r=-i;r<i+1;r++)a+r>0&&a+r<t.height&&(d=4*((a+r)*t.width+n),c+=v[d]*h[r+i],l+=v[d+1]*h[r+i],u+=v[d+2]*h[r+i],m+=v[d+3]*h[r+i],p+=h[r+i]);d=4*(a*t.width+n),f.data[d]=Math.floor(c/p),f.data[d+1]=Math.floor(l/p),f.data[d+2]=Math.floor(u/p),f.data[d+3]=Math.floor(m/p)}for(a=0;a<t.height;a++)for(n=0;n<t.width;n++)d=4*(a*t.width+n),s=Math.abs(f.data[d]-t.data[d])+Math.abs(f.data[d+1]-t.data[d+1])+Math.abs(f.data[d+2]-t.data[d+2])+Math.abs(f.data[d+3]-t.data[d+3]),s>o&&(f.data[d]=t.data[d],f.data[d+1]=t.data[d+1],f.data[d+2]=t.data[d+2],f.data[d+3]=t.data[d+3]);return f},this.loadImage=function(e,t,i){var o=new Image;i&&i.corsenabled&&(o.crossOrigin="Anonymous"),o.onload=function(){var e=document.createElement("canvas");e.width=o.width,e.height=o.height;var i=e.getContext("2d");i.drawImage(o,0,0),t(e)},o.src=e},this.getImgdata=function(e){var t=e.getContext("2d");return t.getImageData(0,0,e.width,e.height)},this.specpalette=[{r:0,g:0,b:0,a:255},{r:128,g:128,b:128,a:255},{r:0,g:0,b:128,a:255},{r:64,g:64,b:128,a:255},{r:192,g:192,b:192,a:255},{r:255,g:255,b:255,a:255},{r:128,g:128,b:192,a:255},{r:0,g:0,b:192,a:255},{r:128,g:0,b:0,a:255},{r:128,g:64,b:64,a:255},{r:128,g:0,b:128,a:255},{r:168,g:168,b:168,a:255},{r:192,g:128,b:128,a:255},{r:192,g:0,b:0,a:255},{r:255,g:255,b:255,a:255},{r:0,g:128,b:0,a:255}],this.drawLayers=function(t,i,o,n){var a,r,s,d,c,l;for(c in o=o||1,n?(l=document.getElementById(n),l||(l=document.createElement("div"),l.id=n,document.body.appendChild(l))):(l=document.createElement("div"),document.body.appendChild(l)),t)if(t.hasOwnProperty(c)){a=t[c][0].length,r=t[c].length;var u=document.createElement("canvas");u.width=a*o,u.height=r*o;var m=u.getContext("2d");for(d=0;d<r;d++)for(s=0;s<a;s++)m.fillStyle=e.torgbastr(i[t[c][d][s]%i.length]),m.fillRect(s*o,d*o,o,o);l.appendChild(u)}}}o=function(){return new n}.call(t,i,t,e),void 0===o||(e.exports=o)}()},16858:function(e,t,i){"use strict";var o,n;function a(e,t){if(!e)throw"First parameter is required.";t=t||{type:"video"},t=new r(e,t);var i=this;function o(o){return t.disableLogs||console.log("RecordRTC version: ",i.version),o&&(t=new r(e,o)),t.disableLogs||console.log("started recording "+t.type+" stream."),v?(v.clearRecordedData(),v.record(),h("recording"),i.recordingDuration&&p(),i):(n((function(){i.recordingDuration&&p()})),i)}function n(i){i&&(t.initCallback=function(){i(),i=t.initCallback=null});var o=new s(e,t);v=new o(e,t),v.record(),h("recording"),t.disableLogs||console.log("Initialized recorderType:",v.constructor.name,"for output-type:",t.type)}function d(e){if(e=e||function(){},v){if("paused"===i.state)return i.resumeRecording(),void setTimeout((function(){d(e)}),1);"recording"===i.state||t.disableLogs||console.warn('Recording state should be: "recording", however current state is: ',i.state),t.disableLogs||console.log("Stopped recording "+t.type+" stream."),"gif"!==t.type?v.stop(o):(v.stop(),o()),h("stopped")}else _();function o(o){if(v){Object.keys(v).forEach((function(e){"function"!==typeof v[e]&&(i[e]=v[e])}));var n=v.blob;if(!n){if(!o)throw"Recording failed.";v.blob=n=o}if(n&&!t.disableLogs&&console.log(n.type,"->",w(n.size)),e){var a;try{a=f.createObjectURL(n)}catch(r){}"function"===typeof e.call?e.call(i,a):e(a)}t.autoWriteToDisk&&m((function(e){var i={};i[t.type+"Blob"]=e,A.Store(i)}))}else"function"===typeof e.call?e.call(i,""):e("")}}function c(){v?"recording"===i.state?(h("paused"),v.pause(),t.disableLogs||console.log("Paused recording.")):t.disableLogs||console.warn("Unable to pause the recording. Recording state: ",i.state):_()}function l(){v?"paused"===i.state?(h("recording"),v.resume(),t.disableLogs||console.log("Resumed recording.")):t.disableLogs||console.warn("Unable to resume the recording. Recording state: ",i.state):_()}function u(e){postMessage((new FileReaderSync).readAsDataURL(e))}function m(e,i){if(!e)throw"Pass a callback function over getDataURL.";var o=i?i.blob:(v||{}).blob;if(!o)return t.disableLogs||console.warn("Blob encoder did not finish its job yet."),void setTimeout((function(){m(e,i)}),1e3);if("undefined"===typeof Worker||navigator.mozGetUserMedia){var n=new FileReader;n.readAsDataURL(o),n.onload=function(t){e(t.target.result)}}else{var a=r(u);a.onmessage=function(t){e(t.data)},a.postMessage(o)}function r(e){try{var t=f.createObjectURL(new Blob([e.toString(),"this.onmessage =  function (eee) {"+e.name+"(eee.data);}"],{type:"application/javascript"})),i=new Worker(t);return f.revokeObjectURL(t),i}catch(o){}}}function p(e){e=e||0,"paused"!==i.state?"stopped"!==i.state&&(e>=i.recordingDuration?d(i.onRecordingStopped):(e+=1e3,setTimeout((function(){p(e)}),1e3))):setTimeout((function(){p(e)}),1e3)}function h(e){i&&(i.state=e,"function"===typeof i.onStateChanged.call?i.onStateChanged.call(i,e):i.onStateChanged(e))}var v,g='It seems that recorder is destroyed or "startRecording" is not invoked for '+t.type+" recorder.";function _(){!0!==t.disableLogs&&console.warn(g)}var b={startRecording:o,stopRecording:d,pauseRecording:c,resumeRecording:l,initRecorder:n,setRecordingDuration:function(e,t){if("undefined"===typeof e)throw"recordingDuration is required.";if("number"!==typeof e)throw"recordingDuration must be a number.";return i.recordingDuration=e,i.onRecordingStopped=t||function(){},{onRecordingStopped:function(e){i.onRecordingStopped=e}}},clearRecordedData:function(){v?(v.clearRecordedData(),t.disableLogs||console.log("Cleared old recorded data.")):_()},getBlob:function(){if(v)return v.blob;_()},getDataURL:m,toURL:function(){if(v)return f.createObjectURL(v.blob);_()},getInternalRecorder:function(){return v},save:function(e){v?C(v.blob,e):_()},getFromDisk:function(e){v?a.getFromDisk(t.type,e):_()},setAdvertisementArray:function(e){t.advertisement=[];for(var i=e.length,o=0;o<i;o++)t.advertisement.push({duration:o,image:e[o]})},blob:null,bufferSize:0,sampleRate:0,buffer:null,reset:function(){"recording"!==i.state||t.disableLogs||console.warn("Stop an active recorder."),v&&"function"===typeof v.clearRecordedData&&v.clearRecordedData(),v=null,h("inactive"),i.blob=null},onStateChanged:function(e){t.disableLogs||console.log("Recorder state changed:",e)},state:"inactive",getState:function(){return i.state},destroy:function(){var e=t.disableLogs;t={disableLogs:!0},i.reset(),h("destroyed"),b=i=null,R.AudioContextConstructor&&(R.AudioContextConstructor.close(),R.AudioContextConstructor=null),t.disableLogs=e,t.disableLogs||console.log("RecordRTC is destroyed.")},version:"5.6.2"};if(!this)return i=b,b;for(var y in b)this[y]=b[y];return i=this,b}
/**
 * {@link RecordRTCConfiguration} is an inner/private helper for {@link RecordRTC}.
 * @summary It configures the 2nd parameter passed over {@link RecordRTC} and returns a valid "config" object.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef RecordRTCConfiguration
 * @class
 * @example
 * var options = RecordRTCConfiguration(mediaStream, options);
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {type:"video", disableLogs: true, numberOfAudioChannels: 1, bufferSize: 0, sampleRate: 0, video: HTMLVideoElement, getNativeBlob:true, etc.}
 */
function r(e,t){return t.recorderType||t.type||(t.audio&&t.video?t.type="video":t.audio&&!t.video&&(t.type="audio")),t.recorderType&&!t.type&&(t.recorderType===L||t.recorderType===D||"undefined"!==typeof F&&t.recorderType===F?t.type="video":t.recorderType===$?t.type="gif":t.recorderType===P?t.type="audio":t.recorderType===E&&(x(e,"audio").length&&x(e,"video").length||!x(e,"audio").length&&x(e,"video").length?t.type="video":x(e,"audio").length&&!x(e,"video").length&&(t.type="audio"))),"undefined"!==typeof E&&"undefined"!==typeof MediaRecorder&&"requestData"in MediaRecorder.prototype&&(t.mimeType||(t.mimeType="video/webm"),t.type||(t.type=t.mimeType.split("/")[0]),t.bitsPerSecond),t.type||(t.mimeType&&(t.type=t.mimeType.split("/")[0]),t.type||(t.type="audio")),t}
/**
 * {@link GetRecorderType} is an inner/private helper for {@link RecordRTC}.
 * @summary It returns best recorder-type available for your browser.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef GetRecorderType
 * @class
 * @example
 * var RecorderType = GetRecorderType(options);
 * var recorder = new RecorderType(options);
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {type:"video", disableLogs: true, numberOfAudioChannels: 1, bufferSize: 0, sampleRate: 0, video: HTMLVideoElement, etc.}
 */function s(e,t){var i;return(_||h||v)&&(i=P),"undefined"!==typeof MediaRecorder&&"requestData"in MediaRecorder.prototype&&!_&&(i=E),"video"===t.type&&(_||v)&&(i=L,"undefined"!==typeof F&&"undefined"!==typeof ReadableStream&&(i=F)),"gif"===t.type&&(i=$),"canvas"===t.type&&(i=D),M()&&i!==D&&i!==$&&"undefined"!==typeof MediaRecorder&&"requestData"in MediaRecorder.prototype&&(x(e,"video").length||x(e,"audio").length)&&("audio"===t.type?"function"===typeof MediaRecorder.isTypeSupported&&MediaRecorder.isTypeSupported("audio/webm")&&(i=E):"function"===typeof MediaRecorder.isTypeSupported&&MediaRecorder.isTypeSupported("video/webm")&&(i=E)),e instanceof Array&&e.length&&(i=O),t.recorderType&&(i=t.recorderType),!t.disableLogs&&i&&i.name&&console.log("Using recorderType:",i.name||i.constructor.name),!i&&b&&(i=E),i}
/**
 * MRecordRTC runs on top of {@link RecordRTC} to bring multiple recordings in a single place, by providing simple API.
 * @summary MRecordRTC stands for "Multiple-RecordRTC".
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef MRecordRTC
 * @class
 * @example
 * var recorder = new MRecordRTC();
 * recorder.addStream(MediaStream);
 * recorder.mediaType = {
 *     audio: true, // or StereoAudioRecorder or MediaStreamRecorder
 *     video: true, // or WhammyRecorder or MediaStreamRecorder or WebAssemblyRecorder or CanvasRecorder
 *     gif: true    // or GifRecorder
 * };
 * // mimeType is optional and should be set only in advance cases.
 * recorder.mimeType = {
 *     audio: 'audio/wav',
 *     video: 'video/webm',
 *     gif:   'image/gif'
 * };
 * recorder.startRecording();
 * @see For further information:
 * @see {@link https://github.com/muaz-khan/RecordRTC/tree/master/MRecordRTC|MRecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @requires {@link RecordRTC}
 */function d(e){this.addStream=function(t){t&&(e=t)},this.mediaType={audio:!0,video:!0},this.startRecording=function(){var t,i=this.mediaType,o=this.mimeType||{audio:null,video:null,gif:null};if("function"!==typeof i.audio&&M()&&!x(e,"audio").length&&(i.audio=!1),"function"!==typeof i.video&&M()&&!x(e,"video").length&&(i.video=!1),"function"!==typeof i.gif&&M()&&!x(e,"video").length&&(i.gif=!1),!i.audio&&!i.video&&!i.gif)throw"MediaStream must have either audio or video tracks.";if(i.audio&&(t=null,"function"===typeof i.audio&&(t=i.audio),this.audioRecorder=new a(e,{type:"audio",bufferSize:this.bufferSize,sampleRate:this.sampleRate,numberOfAudioChannels:this.numberOfAudioChannels||2,disableLogs:this.disableLogs,recorderType:t,mimeType:o.audio,timeSlice:this.timeSlice,onTimeStamp:this.onTimeStamp}),i.video||this.audioRecorder.startRecording()),i.video){t=null,"function"===typeof i.video&&(t=i.video);var n=e;if(M()&&i.audio&&"function"===typeof i.audio){var r=x(e,"video")[0];g?(n=new y,n.addTrack(r),t&&t===L&&(t=E)):(n=new y,n.addTrack(r))}this.videoRecorder=new a(n,{type:"video",video:this.video,canvas:this.canvas,frameInterval:this.frameInterval||10,disableLogs:this.disableLogs,recorderType:t,mimeType:o.video,timeSlice:this.timeSlice,onTimeStamp:this.onTimeStamp,workerPath:this.workerPath,webAssemblyPath:this.webAssemblyPath,frameRate:this.frameRate,bitrate:this.bitrate}),i.audio||this.videoRecorder.startRecording()}if(i.audio&&i.video){var s=this,d=!0===M();(i.audio instanceof P&&i.video||!0!==i.audio&&!0!==i.video&&i.audio!==i.video)&&(d=!1),!0===d?(s.audioRecorder=null,s.videoRecorder.startRecording()):s.videoRecorder.initRecorder((function(){s.audioRecorder.initRecorder((function(){s.videoRecorder.startRecording(),s.audioRecorder.startRecording()}))}))}i.gif&&(t=null,"function"===typeof i.gif&&(t=i.gif),this.gifRecorder=new a(e,{type:"gif",frameRate:this.frameRate||200,quality:this.quality||10,disableLogs:this.disableLogs,recorderType:t,mimeType:o.gif}),this.gifRecorder.startRecording())},this.stopRecording=function(e){e=e||function(){},this.audioRecorder&&this.audioRecorder.stopRecording((function(t){e(t,"audio")})),this.videoRecorder&&this.videoRecorder.stopRecording((function(t){e(t,"video")})),this.gifRecorder&&this.gifRecorder.stopRecording((function(t){e(t,"gif")}))},this.pauseRecording=function(){this.audioRecorder&&this.audioRecorder.pauseRecording(),this.videoRecorder&&this.videoRecorder.pauseRecording(),this.gifRecorder&&this.gifRecorder.pauseRecording()},this.resumeRecording=function(){this.audioRecorder&&this.audioRecorder.resumeRecording(),this.videoRecorder&&this.videoRecorder.resumeRecording(),this.gifRecorder&&this.gifRecorder.resumeRecording()},this.getBlob=function(e){var t={};return this.audioRecorder&&(t.audio=this.audioRecorder.getBlob()),this.videoRecorder&&(t.video=this.videoRecorder.getBlob()),this.gifRecorder&&(t.gif=this.gifRecorder.getBlob()),e&&e(t),t},this.destroy=function(){this.audioRecorder&&(this.audioRecorder.destroy(),this.audioRecorder=null),this.videoRecorder&&(this.videoRecorder.destroy(),this.videoRecorder=null),this.gifRecorder&&(this.gifRecorder.destroy(),this.gifRecorder=null)},this.getDataURL=function(e){function t(e,t){if("undefined"!==typeof Worker){var o=i((function(e){postMessage((new FileReaderSync).readAsDataURL(e))}));o.onmessage=function(e){t(e.data)},o.postMessage(e)}else{var n=new FileReader;n.readAsDataURL(e),n.onload=function(e){t(e.target.result)}}}function i(e){var t,i=f.createObjectURL(new Blob([e.toString(),"this.onmessage =  function (eee) {"+e.name+"(eee.data);}"],{type:"application/javascript"})),o=new Worker(i);if("undefined"!==typeof f)t=f;else{if("undefined"===typeof webkitURL)throw"Neither URL nor webkitURL detected.";t=webkitURL}return t.revokeObjectURL(i),o}this.getBlob((function(i){i.audio&&i.video?t(i.audio,(function(o){t(i.video,(function(t){e({audio:o,video:t})}))})):i.audio?t(i.audio,(function(t){e({audio:t})})):i.video&&t(i.video,(function(t){e({video:t})}))}))},this.writeToDisk=function(){a.writeToDisk({audio:this.audioRecorder,video:this.videoRecorder,gif:this.gifRecorder})},this.save=function(e){e=e||{audio:!0,video:!0,gif:!0},e.audio&&this.audioRecorder&&this.audioRecorder.save("string"===typeof e.audio?e.audio:""),e.video&&this.videoRecorder&&this.videoRecorder.save("string"===typeof e.video?e.video:""),e.gif&&this.gifRecorder&&this.gifRecorder.save("string"===typeof e.gif?e.gif:"")}}
/**
 * {@link https://github.com/muaz-khan/RecordRTC|RecordRTC} is a WebRTC JavaScript library for audio/video as well as screen activity recording. It supports Chrome, Firefox, Opera, Android, and Microsoft Edge. Platforms: Linux, Mac and Windows. 
 * @summary Record audio, video or screen inside the browser.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef RecordRTC
 * @class
 * @example
 * var recorder = RecordRTC(mediaStream or [arrayOfMediaStream], {
 *     type: 'video', // audio or video or gif or canvas
 *     recorderType: MediaStreamRecorder || CanvasRecorder || StereoAudioRecorder || Etc
 * });
 * recorder.startRecording();
 * @see For further information:
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - Single media-stream object, array of media-streams, html-canvas-element, etc.
 * @param {object} config - {type:"video", recorderType: MediaStreamRecorder, disableLogs: true, numberOfAudioChannels: 1, bufferSize: 0, sampleRate: 0, desiredSampRate: 16000, video: HTMLVideoElement, etc.}
 */
i(44114),i(21903),i(91134),i(64979),a.version="5.6.2",e.exports=a,o=[],n=function(){return a}.apply(t,o),void 0===n||(e.exports=n),a.getFromDisk=function(e,t){if(!t)throw"callback is mandatory.";console.log("Getting recorded "+("all"===e?"blobs":e+" blob ")+" from disk!"),A.Fetch((function(i,o){"all"!==e&&o===e+"Blob"&&t&&t(i),"all"===e&&t&&t(i,o.replace("Blob",""))}))},a.writeToDisk=function(e){console.log("Writing recorded blob(s) to disk!"),e=e||{},e.audio&&e.video&&e.gif?e.audio.getDataURL((function(t){e.video.getDataURL((function(i){e.gif.getDataURL((function(e){A.Store({audioBlob:t,videoBlob:i,gifBlob:e})}))}))})):e.audio&&e.video?e.audio.getDataURL((function(t){e.video.getDataURL((function(e){A.Store({audioBlob:t,videoBlob:e})}))})):e.audio&&e.gif?e.audio.getDataURL((function(t){e.gif.getDataURL((function(e){A.Store({audioBlob:t,gifBlob:e})}))})):e.video&&e.gif?e.video.getDataURL((function(t){e.gif.getDataURL((function(e){A.Store({videoBlob:t,gifBlob:e})}))})):e.audio?e.audio.getDataURL((function(e){A.Store({audioBlob:e})})):e.video?e.video.getDataURL((function(e){A.Store({videoBlob:e})})):e.gif&&e.gif.getDataURL((function(e){A.Store({gifBlob:e})}))},d.getFromDisk=a.getFromDisk,d.writeToDisk=a.writeToDisk,"undefined"!==typeof a&&(a.MRecordRTC=d);var c="Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45";(function(e){e&&"undefined"===typeof window&&"undefined"!==typeof i.g&&(i.g.navigator={userAgent:c,getUserMedia:function(){}},i.g.console||(i.g.console={}),"undefined"!==typeof i.g.console.log&&"undefined"!==typeof i.g.console.error||(i.g.console.error=i.g.console.log=i.g.console.log||function(){console.log(arguments)}),"undefined"===typeof document&&(e.document={documentElement:{appendChild:function(){return""}}},document.createElement=document.captureStream=document.mozCaptureStream=function(){var e={getContext:function(){return e},play:function(){},pause:function(){},drawImage:function(){},toDataURL:function(){return""},style:{}};return e},e.HTMLVideoElement=function(){}),"undefined"===typeof location&&(e.location={protocol:"file:",href:"",hash:""}),"undefined"===typeof screen&&(e.screen={width:0,height:0}),"undefined"===typeof f&&(e.URL={createObjectURL:function(){return""},revokeObjectURL:function(){return""}}),e.window=i.g)})("undefined"!==typeof i.g?i.g:null);var l=window.requestAnimationFrame;if("undefined"===typeof l)if("undefined"!==typeof webkitRequestAnimationFrame)l=webkitRequestAnimationFrame;else if("undefined"!==typeof mozRequestAnimationFrame)l=mozRequestAnimationFrame;else if("undefined"!==typeof msRequestAnimationFrame)l=msRequestAnimationFrame;else if("undefined"===typeof l){var u=0;l=function(e,t){var i=(new Date).getTime(),o=Math.max(0,16-(i-u)),n=setTimeout((function(){e(i+o)}),o);return u=i+o,n}}var m=window.cancelAnimationFrame;"undefined"===typeof m&&("undefined"!==typeof webkitCancelAnimationFrame?m=webkitCancelAnimationFrame:"undefined"!==typeof mozCancelAnimationFrame?m=mozCancelAnimationFrame:"undefined"!==typeof msCancelAnimationFrame?m=msCancelAnimationFrame:"undefined"===typeof m&&(m=function(e){clearTimeout(e)}));var p=window.AudioContext;"undefined"===typeof p&&("undefined"!==typeof webkitAudioContext&&(p=webkitAudioContext),"undefined"!==typeof mozAudioContext&&(p=mozAudioContext));var f=window.URL;"undefined"===typeof f&&"undefined"!==typeof webkitURL&&(f=webkitURL),"undefined"!==typeof navigator&&"undefined"===typeof navigator.getUserMedia&&("undefined"!==typeof navigator.webkitGetUserMedia&&(navigator.getUserMedia=navigator.webkitGetUserMedia),"undefined"!==typeof navigator.mozGetUserMedia&&(navigator.getUserMedia=navigator.mozGetUserMedia));var h=-1!==navigator.userAgent.indexOf("Edge")&&(!!navigator.msSaveBlob||!!navigator.msSaveOrOpenBlob),v=!!window.opera||-1!==navigator.userAgent.indexOf("OPR/"),g=navigator.userAgent.toLowerCase().indexOf("firefox")>-1&&"netscape"in window&&/ rv:/.test(navigator.userAgent),_=!v&&!h&&!!navigator.webkitGetUserMedia||S()||-1!==navigator.userAgent.toLowerCase().indexOf("chrome/"),b=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);b&&!_&&-1!==navigator.userAgent.indexOf("CriOS")&&(b=!1,_=!0);var y=window.MediaStream;function w(e){var t=1e3,i=["Bytes","KB","MB","GB","TB"];if(0===e)return"0 Bytes";var o=parseInt(Math.floor(Math.log(e)/Math.log(t)),10);return(e/Math.pow(t,o)).toPrecision(3)+" "+i[o]}function C(e,t){if(!e)throw"Blob object is required.";if(!e.type)try{e.type="video/webm"}catch(r){}var i=(e.type||"video/webm").split("/")[1];if(-1!==i.indexOf(";")&&(i=i.split(";")[0]),t&&-1!==t.indexOf(".")){var o=t.split(".");t=o[0],i=o[1]}var n=(t||Math.round(9999999999*Math.random())+888888888)+"."+i;if("undefined"!==typeof navigator.msSaveOrOpenBlob)return navigator.msSaveOrOpenBlob(e,n);if("undefined"!==typeof navigator.msSaveBlob)return navigator.msSaveBlob(e,n);var a=document.createElement("a");a.href=f.createObjectURL(e),a.download=n,a.style="display:none;opacity:0;color:transparent;",(document.body||document.documentElement).appendChild(a),"function"===typeof a.click?a.click():(a.target="_blank",a.dispatchEvent(new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0}))),f.revokeObjectURL(a.href)}function S(){return"undefined"!==typeof window&&"object"===typeof window.process&&"renderer"===window.process.type||(!("undefined"===typeof process||"object"!==typeof process.versions||!process.versions.electron)||"object"===typeof navigator&&"string"===typeof navigator.userAgent&&navigator.userAgent.indexOf("Electron")>=0)}function x(e,t){return e&&e.getTracks?e.getTracks().filter((function(e){return e.kind===(t||"audio")})):[]}function k(e,t){"srcObject"in t?t.srcObject=e:"mozSrcObject"in t?t.mozSrcObject=e:t.srcObject=e}function T(e,t){if("undefined"===typeof EBML)throw new Error("Please link: https://www.webrtc-experiment.com/EBML.js");var i=new EBML.Reader,o=new EBML.Decoder,n=EBML.tools,a=new FileReader;a.onload=function(e){var a=o.decode(this.result);a.forEach((function(e){i.read(e)})),i.stop();var r=n.makeMetadataSeekable(i.metadatas,i.duration,i.cues),s=this.result.slice(i.metadataSize),d=new Blob([r,s],{type:"video/webm"});t(d)},a.readAsArrayBuffer(e)}"undefined"===typeof y&&"undefined"!==typeof webkitMediaStream&&(y=webkitMediaStream),"undefined"!==typeof y&&"undefined"===typeof y.prototype.stop&&(y.prototype.stop=function(){this.getTracks().forEach((function(e){e.stop()}))}),"undefined"!==typeof a&&(a.invokeSaveAsDialog=C,a.getTracks=x,a.getSeekableBlob=T,a.bytesToSize=w,a.isElectron=S);
/**
 * Storage is a standalone object used by {@link RecordRTC} to store reusable objects e.g. "new AudioContext".
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @example
 * Storage.AudioContext === webkitAudioContext
 * @property {webkitAudioContext} AudioContext - Keeps a reference to AudioContext object.
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 */
var R={};function M(){if(g||b||h)return!0;navigator.appVersion;var e,t,i=navigator.userAgent,o=""+parseFloat(navigator.appVersion),n=parseInt(navigator.appVersion,10);return(_||v)&&(e=i.indexOf("Chrome"),o=i.substring(e+7)),-1!==(t=o.indexOf(";"))&&(o=o.substring(0,t)),-1!==(t=o.indexOf(" "))&&(o=o.substring(0,t)),n=parseInt(""+o,10),isNaN(n)&&(o=""+parseFloat(navigator.appVersion),n=parseInt(navigator.appVersion,10)),n>=49}
/**
 * MediaStreamRecorder is an abstraction layer for {@link https://w3c.github.io/mediacapture-record/MediaRecorder.html|MediaRecorder API}. It is used by {@link RecordRTC} to record MediaStream(s) in both Chrome and Firefox.
 * @summary Runs top over {@link https://w3c.github.io/mediacapture-record/MediaRecorder.html|MediaRecorder API}.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://github.com/muaz-khan|Muaz Khan}
 * @typedef MediaStreamRecorder
 * @class
 * @example
 * var config = {
 *     mimeType: 'video/webm', // vp8, vp9, h264, mkv, opus/vorbis
 *     audioBitsPerSecond : 256 * 8 * 1024,
 *     videoBitsPerSecond : 256 * 8 * 1024,
 *     bitsPerSecond: 256 * 8 * 1024,  // if this is provided, skip above two
 *     checkForInactiveTracks: true,
 *     timeSlice: 1000, // concatenate intervals based blobs
 *     ondataavailable: function() {} // get intervals based blobs
 * }
 * var recorder = new MediaStreamRecorder(mediaStream, config);
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 *
 *     // or
 *     var blob = recorder.blob;
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {disableLogs:true, initCallback: function, mimeType: "video/webm", timeSlice: 1000}
 * @throws Will throw an error if first argument "MediaStream" is missing. Also throws error if "MediaRecorder API" are not supported by the browser.
 */function E(e,t){var i=this;if("undefined"===typeof e)throw'First argument "MediaStream" is required.';if("undefined"===typeof MediaRecorder)throw"Your browser does not support the Media Recorder API. Please try other modules e.g. WhammyRecorder or StereoAudioRecorder.";if(t=t||{mimeType:"video/webm"},"audio"===t.type){var o;if(x(e,"video").length&&x(e,"audio").length)navigator.mozGetUserMedia?(o=new y,o.addTrack(x(e,"audio")[0])):o=new y(x(e,"audio")),e=o;t.mimeType&&-1!==t.mimeType.toString().toLowerCase().indexOf("audio")||(t.mimeType=_?"audio/webm":"audio/ogg"),t.mimeType&&"audio/ogg"!==t.mimeType.toString().toLowerCase()&&navigator.mozGetUserMedia&&(t.mimeType="audio/ogg")}var n,a=[];function r(){i.timestamps.push((new Date).getTime()),"function"===typeof t.onTimeStamp&&t.onTimeStamp(i.timestamps[i.timestamps.length-1],i.timestamps)}function s(e){return n&&n.mimeType?n.mimeType:e.mimeType||"video/webm"}function d(){a=[],n=null,i.timestamps=[]}function c(){if("active"in e){if(!e.active)return!1}else if("ended"in e&&e.ended)return!1;return!0}this.getArrayOfBlobs=function(){return a},this.record=function(){i.blob=null,i.clearRecordedData(),i.timestamps=[],l=[],a=[];var o=t;t.disableLogs||console.log("Passing following config over MediaRecorder API.",o),n&&(n=null),_&&!M()&&(o="video/vp8"),"function"===typeof MediaRecorder.isTypeSupported&&o.mimeType&&(MediaRecorder.isTypeSupported(o.mimeType)||(t.disableLogs||console.warn("MediaRecorder API seems unable to record mimeType:",o.mimeType),o.mimeType="audio"===t.type?"audio/webm":"video/webm"));try{n=new MediaRecorder(e,o),t.mimeType=o.mimeType}catch(d){n=new MediaRecorder(e)}o.mimeType&&!MediaRecorder.isTypeSupported&&"canRecordMimeType"in n&&!1===n.canRecordMimeType(o.mimeType)&&(t.disableLogs||console.warn("MediaRecorder API seems unable to record mimeType:",o.mimeType)),n.ondataavailable=function(e){if(e.data&&l.push("ondataavailable: "+w(e.data.size)),"number"!==typeof t.timeSlice)!e.data||!e.data.size||e.data.size<100||i.blob?i.recordingCallback&&(i.recordingCallback(new Blob([],{type:s(o)})),i.recordingCallback=null):(i.blob=t.getNativeBlob?e.data:new Blob([e.data],{type:s(o)}),i.recordingCallback&&(i.recordingCallback(i.blob),i.recordingCallback=null));else if(e.data&&e.data.size&&(a.push(e.data),r(),"function"===typeof t.ondataavailable)){var n=t.getNativeBlob?e.data:new Blob([e.data],{type:s(o)});t.ondataavailable(n)}},n.onstart=function(){l.push("started")},n.onpause=function(){l.push("paused")},n.onresume=function(){l.push("resumed")},n.onstop=function(){l.push("stopped")},n.onerror=function(e){e&&(e.name||(e.name="UnknownError"),l.push("error: "+e),t.disableLogs||(-1!==e.name.toString().toLowerCase().indexOf("invalidstate")?console.error("The MediaRecorder is not in a state in which the proposed operation is allowed to be executed.",e):-1!==e.name.toString().toLowerCase().indexOf("notsupported")?console.error("MIME type (",o.mimeType,") is not supported.",e):-1!==e.name.toString().toLowerCase().indexOf("security")?console.error("MediaRecorder security error",e):"OutOfMemory"===e.name?console.error("The UA has exhaused the available memory. User agents SHOULD provide as much additional information as possible in the message attribute.",e):"IllegalStreamModification"===e.name?console.error("A modification to the stream has occurred that makes it impossible to continue recording. An example would be the addition of a Track while recording is occurring. User agents SHOULD provide as much additional information as possible in the message attribute.",e):"OtherRecordingError"===e.name?console.error("Used for an fatal error other than those listed above. User agents SHOULD provide as much additional information as possible in the message attribute.",e):"GenericError"===e.name?console.error("The UA cannot provide the codec or recording option that has been requested.",e):console.error("MediaRecorder Error",e)),function(e){if(!i.manuallyStopped&&n&&"inactive"===n.state)return delete t.timeslice,void n.start(6e5);setTimeout(e,1e3)}(),"inactive"!==n.state&&"stopped"!==n.state&&n.stop())},"number"===typeof t.timeSlice?(r(),n.start(t.timeSlice)):n.start(36e5),t.initCallback&&t.initCallback()},this.timestamps=[],this.stop=function(e){e=e||function(){},i.manuallyStopped=!0,n&&(this.recordingCallback=e,"recording"===n.state&&n.stop(),"number"===typeof t.timeSlice&&setTimeout((function(){i.blob=new Blob(a,{type:s(t)}),i.recordingCallback(i.blob)}),100))},this.pause=function(){n&&"recording"===n.state&&n.pause()},this.resume=function(){n&&"paused"===n.state&&n.resume()},this.clearRecordedData=function(){n&&"recording"===n.state&&i.stop(d),d()},this.getInternalRecorder=function(){return n},this.blob=null,this.getState=function(){return n&&n.state||"inactive"};var l=[];this.getAllStates=function(){return l},"undefined"===typeof t.checkForInactiveTracks&&(t.checkForInactiveTracks=!1);i=this;(function e(){if(n&&!1!==t.checkForInactiveTracks)return!1===c()?(t.disableLogs||console.log("MediaStream seems stopped."),void i.stop()):void setTimeout(e,1e3)})(),this.name="MediaStreamRecorder",this.toString=function(){return this.name}}
/**
 * StereoAudioRecorder is a standalone class used by {@link RecordRTC} to bring "stereo" audio-recording in chrome.
 * @summary JavaScript standalone object for stereo audio recording.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef StereoAudioRecorder
 * @class
 * @example
 * var recorder = new StereoAudioRecorder(MediaStream, {
 *     sampleRate: 44100,
 *     bufferSize: 4096
 * });
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {sampleRate: 44100, bufferSize: 4096, numberOfAudioChannels: 1, etc.}
 */
function P(e,t){if(!x(e,"audio").length)throw"Your stream has no audio tracks.";t=t||{};var i,o=this,n=[],r=[],s=!1,d=0,c=2,l=t.desiredSampRate;function u(){if(!1===t.checkForInactiveTracks)return!0;if("active"in e){if(!e.active)return!1}else if("ended"in e&&e.ended)return!1;return!0}function m(e,t){function i(e,t){var i,o=e.numberOfAudioChannels,n=e.leftBuffers.slice(0),a=e.rightBuffers.slice(0),r=e.sampleRate,s=e.internalInterleavedLength,d=e.desiredSampRate;function c(e,t,i){var o=Math.round(e.length*(t/i)),n=[],a=Number((e.length-1)/(o-1));n[0]=e[0];for(var r=1;r<o-1;r++){var s=r*a,d=Number(Math.floor(s)).toFixed(),c=Number(Math.ceil(s)).toFixed(),u=s-d;n[r]=l(e[d],e[c],u)}return n[o-1]=e[e.length-1],n}function l(e,t,i){return e+(t-e)*i}function u(e,t){for(var i=new Float64Array(t),o=0,n=e.length,a=0;a<n;a++){var r=e[a];i.set(r,o),o+=r.length}return i}function m(e,t){for(var i=e.length+t.length,o=new Float64Array(i),n=0,a=0;a<i;)o[a++]=e[n],o[a++]=t[n],n++;return o}function p(e,t,i){for(var o=i.length,n=0;n<o;n++)e.setUint8(t+n,i.charCodeAt(n))}2===o&&(n=u(n,s),a=u(a,s),d&&(n=c(n,d,r),a=c(a,d,r))),1===o&&(n=u(n,s),d&&(n=c(n,d,r))),d&&(r=d),2===o&&(i=m(n,a)),1===o&&(i=n);var f=i.length,h=44+2*f,v=new ArrayBuffer(h),g=new DataView(v);p(g,0,"RIFF"),g.setUint32(4,36+2*f,!0),p(g,8,"WAVE"),p(g,12,"fmt "),g.setUint32(16,16,!0),g.setUint16(20,1,!0),g.setUint16(22,o,!0),g.setUint32(24,r,!0),g.setUint32(28,r*o*2,!0),g.setUint16(32,2*o,!0),g.setUint16(34,16,!0),p(g,36,"data"),g.setUint32(40,2*f,!0);for(var _=f,b=44,y=1,w=0;w<_;w++)g.setInt16(b,i[w]*(32767*y),!0),b+=2;if(t)return t({buffer:v,view:g});postMessage({buffer:v,view:g})}if(e.noWorker)i(e,(function(e){t(e.buffer,e.view)}));else{var o=p(i);o.onmessage=function(e){t(e.data.buffer,e.data.view),f.revokeObjectURL(o.workerURL),o.terminate()},o.postMessage(e)}}function p(e){var t=f.createObjectURL(new Blob([e.toString(),";this.onmessage =  function (eee) {"+e.name+"(eee.data);}"],{type:"application/javascript"})),i=new Worker(t);return i.workerURL=t,i}!0===t.leftChannel&&(c=1),1===t.numberOfAudioChannels&&(c=1),(!c||c<1)&&(c=2),t.disableLogs||console.log("StereoAudioRecorder is set to record number of channels: "+c),"undefined"===typeof t.checkForInactiveTracks&&(t.checkForInactiveTracks=!0),this.record=function(){if(!1===u())throw"Please make sure MediaStream is active.";w(),S=y=!1,s=!0,"undefined"!==typeof t.timeSlice&&R()},this.stop=function(e){e=e||function(){},s=!1,m({desiredSampRate:l,sampleRate:b,numberOfAudioChannels:c,internalInterleavedLength:d,leftBuffers:n,rightBuffers:1===c?[]:r,noWorker:t.noWorker},(function(t,i){o.blob=new Blob([i],{type:"audio/wav"}),o.buffer=new ArrayBuffer(i.buffer.byteLength),o.view=i,o.sampleRate=l||b,o.bufferSize=_,o.length=d,S=!1,e&&e(o.blob)}))},"undefined"===typeof a.Storage&&(a.Storage={AudioContextConstructor:null,AudioContext:window.AudioContext||window.webkitAudioContext}),a.Storage.AudioContextConstructor&&"closed"!==a.Storage.AudioContextConstructor.state||(a.Storage.AudioContextConstructor=new a.Storage.AudioContext);var h=a.Storage.AudioContextConstructor,v=h.createMediaStreamSource(e),g=[0,256,512,1024,2048,4096,8192,16384],_="undefined"===typeof t.bufferSize?4096:t.bufferSize;if(-1===g.indexOf(_)&&(t.disableLogs||console.log("Legal values for buffer-size are "+JSON.stringify(g,null,"\t"))),h.createJavaScriptNode)i=h.createJavaScriptNode(_,c,c);else{if(!h.createScriptProcessor)throw"WebAudio API has no support on this browser.";i=h.createScriptProcessor(_,c,c)}v.connect(i),t.bufferSize||(_=i.bufferSize);var b="undefined"!==typeof t.sampleRate?t.sampleRate:h.sampleRate||44100;(b<22050||b>96e3)&&(t.disableLogs||console.log("sample-rate must be under range 22050 and 96000.")),t.disableLogs||t.desiredSampRate&&console.log("Desired sample-rate: "+t.desiredSampRate);var y=!1;function w(){n=[],r=[],d=0,S=!1,s=!1,y=!1,h=null,o.leftchannel=n,o.rightchannel=r,o.numberOfAudioChannels=c,o.desiredSampRate=l,o.sampleRate=b,o.recordingLength=d,T={left:[],right:[],recordingLength:0}}function C(){i&&(i.onaudioprocess=null,i.disconnect(),i=null),v&&(v.disconnect(),v=null),w()}this.pause=function(){y=!0},this.resume=function(){if(!1===u())throw"Please make sure MediaStream is active.";if(!s)return t.disableLogs||console.log("Seems recording has been restarted."),void this.record();y=!1},this.clearRecordedData=function(){t.checkForInactiveTracks=!1,s&&this.stop(C),C()},this.name="StereoAudioRecorder",this.toString=function(){return this.name};var S=!1;function k(e){if(!y)if(!1===u()&&(t.disableLogs||console.log("MediaStream seems stopped."),i.disconnect(),s=!1),s){S||(S=!0,t.onAudioProcessStarted&&t.onAudioProcessStarted(),t.initCallback&&t.initCallback());var a=e.inputBuffer.getChannelData(0),l=new Float32Array(a);if(n.push(l),2===c){var m=e.inputBuffer.getChannelData(1),p=new Float32Array(m);r.push(p)}d+=_,o.recordingLength=d,"undefined"!==typeof t.timeSlice&&(T.recordingLength+=_,T.left.push(l),2===c&&T.right.push(p))}else v&&(v.disconnect(),v=null)}i.onaudioprocess=k,h.createMediaStreamDestination?i.connect(h.createMediaStreamDestination()):i.connect(h.destination),this.leftchannel=n,this.rightchannel=r,this.numberOfAudioChannels=c,this.desiredSampRate=l,this.sampleRate=b,o.recordingLength=d;var T={left:[],right:[],recordingLength:0};function R(){s&&"function"===typeof t.ondataavailable&&"undefined"!==typeof t.timeSlice&&(T.left.length?(m({desiredSampRate:l,sampleRate:b,numberOfAudioChannels:c,internalInterleavedLength:T.recordingLength,leftBuffers:T.left,rightBuffers:1===c?[]:T.right},(function(e,i){var o=new Blob([i],{type:"audio/wav"});t.ondataavailable(o),setTimeout(R,t.timeSlice)})),T={left:[],right:[],recordingLength:0}):setTimeout(R,t.timeSlice))}}
/**
 * CanvasRecorder is a standalone class used by {@link RecordRTC} to bring HTML5-Canvas recording into video WebM. It uses HTML2Canvas library and runs top over {@link Whammy}.
 * @summary HTML2Canvas recording into video WebM.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef CanvasRecorder
 * @class
 * @example
 * var recorder = new CanvasRecorder(htmlElement, { disableLogs: true, useWhammyRecorder: true });
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {HTMLElement} htmlElement - querySelector/getElementById/getElementsByTagName[0]/etc.
 * @param {object} config - {disableLogs:true, initCallback: function}
 */
function D(e,t){if("undefined"===typeof html2canvas)throw"Please link: https://www.webrtc-experiment.com/screenshot.js";t=t||{},t.frameInterval||(t.frameInterval=10);var i=!1;["captureStream","mozCaptureStream","webkitCaptureStream"].forEach((function(e){e in document.createElement("canvas")&&(i=!0)}));var o,n,a,r=(!!window.webkitRTCPeerConnection||!!window.webkitGetUserMedia)&&!!window.chrome,s=50,d=navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./);if(r&&d&&d[2]&&(s=parseInt(d[2],10)),r&&s<52&&(i=!1),t.useWhammyRecorder&&(i=!1),i)if(t.disableLogs||console.log("Your browser supports both MediRecorder API and canvas.captureStream!"),e instanceof HTMLCanvasElement)o=e;else{if(!(e instanceof CanvasRenderingContext2D))throw"Please pass either HTMLCanvasElement or CanvasRenderingContext2D.";o=e.canvas}else navigator.mozGetUserMedia&&(t.disableLogs||console.error("Canvas recording is NOT supported in Firefox."));this.record=function(){if(a=!0,i&&!t.useWhammyRecorder){var e;"captureStream"in o?e=o.captureStream(25):"mozCaptureStream"in o?e=o.mozCaptureStream(25):"webkitCaptureStream"in o&&(e=o.webkitCaptureStream(25));try{var r=new y;r.addTrack(x(e,"video")[0]),e=r}catch(s){}if(!e)throw"captureStream API are NOT available.";n=new E(e,{mimeType:t.mimeType||"video/webm"}),n.record()}else f.frames=[],p=(new Date).getTime(),m();t.initCallback&&t.initCallback()},this.getWebPImages=function(i){if("canvas"===e.nodeName.toLowerCase()){var o=f.frames.length;f.frames.forEach((function(e,i){var n=o-i;t.disableLogs||console.log(n+"/"+o+" frames remaining"),t.onEncodingCallback&&t.onEncodingCallback(n,o);var a=e.image.toDataURL("image/webp",1);f.frames[i].image=a})),t.disableLogs||console.log("Generating WebM"),i()}else i()},this.stop=function(e){a=!1;var o=this;i&&n?n.stop(e):this.getWebPImages((function(){f.compile((function(i){t.disableLogs||console.log("Recording finished!"),o.blob=i,o.blob.forEach&&(o.blob=new Blob([],{type:"video/webm"})),e&&e(o.blob),f.frames=[]}))}))};var c=!1;function l(){f.frames=[],a=!1,c=!1}function u(){var t=document.createElement("canvas"),i=t.getContext("2d");return t.width=e.width,t.height=e.height,i.drawImage(e,0,0),t}function m(){if(c)return p=(new Date).getTime(),setTimeout(m,500);if("canvas"===e.nodeName.toLowerCase()){var i=(new Date).getTime()-p;return p=(new Date).getTime(),f.frames.push({image:u(),duration:i}),void(a&&setTimeout(m,t.frameInterval))}html2canvas(e,{grabMouse:"undefined"===typeof t.showMousePointer||t.showMousePointer,onrendered:function(e){var i=(new Date).getTime()-p;if(!i)return setTimeout(m,t.frameInterval);p=(new Date).getTime(),f.frames.push({image:e.toDataURL("image/webp",1),duration:i}),a&&setTimeout(m,t.frameInterval)}})}this.pause=function(){c=!0,n instanceof E&&n.pause()},this.resume=function(){c=!1,n instanceof E?n.resume():a||this.record()},this.clearRecordedData=function(){a&&this.stop(l),l()},this.name="CanvasRecorder",this.toString=function(){return this.name};var p=(new Date).getTime(),f=new U.Video(100)}
/**
 * WhammyRecorder is a standalone class used by {@link RecordRTC} to bring video recording in Chrome. It runs top over {@link Whammy}.
 * @summary Video recording feature in Chrome.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef WhammyRecorder
 * @class
 * @example
 * var recorder = new WhammyRecorder(mediaStream);
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {disableLogs: true, initCallback: function, video: HTMLVideoElement, etc.}
 */
function L(e,t){function i(e){e="undefined"!==typeof e?e:10;var t=(new Date).getTime()-c;return t?r?(c=(new Date).getTime(),setTimeout(i,100)):(c=(new Date).getTime(),d.paused&&d.play(),m.drawImage(d,0,0,u.width,u.height),l.frames.push({duration:t,image:u.toDataURL("image/webp")}),void(a||setTimeout(i,e,e))):setTimeout(i,e,e)}function o(e){var t=-1,i=e.length;(function o(){t++,t!==i?setTimeout((function(){e.functionToLoop(o,t)}),1):e.callback()})()}function n(e,t,i,n,a){var r=document.createElement("canvas");r.width=u.width,r.height=u.height;var s=r.getContext("2d"),d=[],c=-1===t,l=t&&t>0&&t<=e.length?t:e.length,m={r:0,g:0,b:0},p=Math.sqrt(Math.pow(255,2)+Math.pow(255,2)+Math.pow(255,2)),f=i&&i>=0&&i<=1?i:0,h=n&&n>=0&&n<=1?n:0,v=!1;o({length:l,functionToLoop:function(t,i){var o,n,a,r=function(){!v&&a-o<=a*h||(c&&(v=!0),d.push(e[i])),t()};if(v)r();else{var l=new Image;l.onload=function(){s.drawImage(l,0,0,u.width,u.height);var e=s.getImageData(0,0,u.width,u.height);o=0,n=e.data.length,a=e.data.length/4;for(var t=0;t<n;t+=4){var i={r:e.data[t],g:e.data[t+1],b:e.data[t+2]},d=Math.sqrt(Math.pow(i.r-m.r,2)+Math.pow(i.g-m.g,2)+Math.pow(i.b-m.b,2));d<=p*f&&o++}r()},l.src=e[i].image}},callback:function(){d=d.concat(e.slice(l)),d.length<=0&&d.push(e[e.length-1]),a(d)}})}t=t||{},t.frameInterval||(t.frameInterval=10),t.disableLogs||console.log("Using frames-interval:",t.frameInterval),this.record=function(){t.width||(t.width=320),t.height||(t.height=240),t.video||(t.video={width:t.width,height:t.height}),t.canvas||(t.canvas={width:t.width,height:t.height}),u.width=t.canvas.width||320,u.height=t.canvas.height||240,m=u.getContext("2d"),t.video&&t.video instanceof HTMLVideoElement?(d=t.video.cloneNode(),t.initCallback&&t.initCallback()):(d=document.createElement("video"),k(e,d),d.onloadedmetadata=function(){t.initCallback&&t.initCallback()},d.width=t.video.width,d.height=t.video.height),d.muted=!0,d.play(),c=(new Date).getTime(),l=new U.Video,t.disableLogs||(console.log("canvas resolutions",u.width,"*",u.height),console.log("video width/height",d.width||u.width,"*",d.height||u.height)),i(t.frameInterval)};var a=!1;this.stop=function(e){e=e||function(){},a=!0;var i=this;setTimeout((function(){n(l.frames,-1,null,null,(function(o){l.frames=o,t.advertisement&&t.advertisement.length&&(l.frames=t.advertisement.concat(l.frames)),l.compile((function(t){i.blob=t,i.blob.forEach&&(i.blob=new Blob([],{type:"video/webm"})),e&&e(i.blob)}))}))}),10)};var r=!1;function s(){l.frames=[],a=!0,r=!1}this.pause=function(){r=!0},this.resume=function(){r=!1,a&&this.record()},this.clearRecordedData=function(){a||this.stop(s),s()},this.name="WhammyRecorder",this.toString=function(){return this.name};var d,c,l,u=document.createElement("canvas"),m=u.getContext("2d")}"undefined"!==typeof p?R.AudioContext=p:"undefined"!==typeof webkitAudioContext&&(R.AudioContext=webkitAudioContext),"undefined"!==typeof a&&(a.Storage=R),"undefined"!==typeof a&&(a.MediaStreamRecorder=E),"undefined"!==typeof a&&(a.StereoAudioRecorder=P),"undefined"!==typeof a&&(a.CanvasRecorder=D),"undefined"!==typeof a&&(a.WhammyRecorder=L);
/**
 * Whammy is a standalone class used by {@link RecordRTC} to bring video recording in Chrome. It is written by {@link https://github.com/antimatter15|antimatter15}
 * @summary A real time javascript webm encoder based on a canvas hack.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef Whammy
 * @class
 * @example
 * var recorder = new Whammy().Video(15);
 * recorder.add(context || canvas || dataURL);
 * var output = recorder.compile();
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 */
var U=function(){function e(e){this.frames=[],this.duration=e||1,this.quality=.8}function t(e){var t=f.createObjectURL(new Blob([e.toString(),"this.onmessage =  function (eee) {"+e.name+"(eee.data);}"],{type:"application/javascript"})),i=new Worker(t);return f.revokeObjectURL(t),i}function i(e){function t(e){var t=o(e);if(!t)return[];var n=3e4,a=[{id:440786851,data:[{data:1,id:17030},{data:1,id:17143},{data:4,id:17138},{data:8,id:17139},{data:"webm",id:17026},{data:2,id:17031},{data:2,id:17029}]},{id:408125543,data:[{id:357149030,data:[{data:1e6,id:2807729},{data:"whammy",id:19840},{data:"whammy",id:22337},{data:m(t.duration),id:17545}]},{id:374648427,data:[{id:174,data:[{data:1,id:215},{data:1,id:29637},{data:0,id:156},{data:"und",id:2274716},{data:"V_VP8",id:134},{data:"VP8",id:2459272},{data:1,id:131},{id:224,data:[{data:t.width,id:176},{data:t.height,id:186}]}]}]}]}],r=0,d=0;while(r<e.length){var c=[],l=0;do{c.push(e[r]),l+=e[r].duration,r++}while(r<e.length&&l<n);var u=0,p={id:524531317,data:i(d,u,c)};a[1].data.push(p),d+=l}return s(a)}function i(e,t,i){return[{data:e,id:231}].concat(i.map((function(e){var i=d({discardable:0,frame:e.data.slice(4),invisible:0,keyframe:1,lacing:0,trackNum:1,timecode:Math.round(t)});return t+=e.duration,{data:i,id:163}})))}function o(e){if(e[0]){for(var t=e[0].width,i=e[0].height,o=e[0].duration,n=1;n<e.length;n++)o+=e[n].duration;return{duration:o,width:t,height:i}}postMessage({error:"Something went wrong. Maybe WebP format is not supported in the current browser."})}function n(e){var t=[];while(e>0)t.push(255&e),e>>=8;return new Uint8Array(t.reverse())}function a(e){return new Uint8Array(e.split("").map((function(e){return e.charCodeAt(0)})))}function r(e){var t=[],i=e.length%8?new Array(9-e.length%8).join("0"):"";e=i+e;for(var o=0;o<e.length;o+=8)t.push(parseInt(e.substr(o,8),2));return new Uint8Array(t)}function s(e){for(var t=[],i=0;i<e.length;i++){var o=e[i].data;"object"===typeof o&&(o=s(o)),"number"===typeof o&&(o=r(o.toString(2))),"string"===typeof o&&(o=a(o));var d=o.size||o.byteLength||o.length,c=Math.ceil(Math.ceil(Math.log(d)/Math.log(2))/8),l=d.toString(2),u=new Array(7*c+7+1-l.length).join("0")+l,m=new Array(c).join("0")+"1"+u;t.push(n(e[i].id)),t.push(r(m)),t.push(o)}return new Blob(t,{type:"video/webm"})}function d(e){var t=0;if(e.keyframe&&(t|=128),e.invisible&&(t|=8),e.lacing&&(t|=e.lacing<<1),e.discardable&&(t|=1),e.trackNum>127)throw"TrackNumber > 127 not supported";var i=[128|e.trackNum,e.timecode>>8,255&e.timecode,t].map((function(e){return String.fromCharCode(e)})).join("")+e.frame;return i}function c(e){for(var t,i,o,n=e.RIFF[0].WEBP[0],a=n.indexOf("*"),r=0,s=[];r<4;r++)s[r]=n.charCodeAt(a+3+r);return o=s[1]<<8|s[0],t=16383&o,o=s[3]<<8|s[2],i=16383&o,{width:t,height:i,data:n,riff:e}}function l(e,t){return parseInt(e.substr(t+4,4).split("").map((function(e){var t=e.charCodeAt(0).toString(2);return new Array(8-t.length+1).join("0")+t})).join(""),2)}function u(e){var t=0,i={};while(t<e.length){var o=e.substr(t,4),n=l(e,t),a=e.substr(t+4+4,n);t+=8+n,i[o]=i[o]||[],"RIFF"===o||"LIST"===o?i[o].push(u(a)):i[o].push(a)}return i}function m(e){return[].slice.call(new Uint8Array(new Float64Array([e]).buffer),0).map((function(e){return String.fromCharCode(e)})).reverse().join("")}var p=new t(e.map((function(e){var t=c(u(atob(e.image.slice(23))));return t.duration=e.duration,t})));postMessage(p)}return e.prototype.add=function(e,t){if("canvas"in e&&(e=e.canvas),"toDataURL"in e&&(e=e.toDataURL("image/webp",this.quality)),!/^data:image\/webp;base64,/gi.test(e))throw"Input must be formatted properly as a base64 encoded DataURI of type image/webp";this.frames.push({image:e,duration:t||this.duration})},e.prototype.compile=function(e){var o=t(i);o.onmessage=function(t){t.data.error?console.error(t.data.error):e(t.data)},o.postMessage(this.frames)},{Video:e}}();"undefined"!==typeof a&&(a.Whammy=U);
/**
 * DiskStorage is a standalone object used by {@link RecordRTC} to store recorded blobs in IndexedDB storage.
 * @summary Writing blobs into IndexedDB.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @example
 * DiskStorage.Store({
 *     audioBlob: yourAudioBlob,
 *     videoBlob: yourVideoBlob,
 *     gifBlob  : yourGifBlob
 * });
 * DiskStorage.Fetch(function(dataURL, type) {
 *     if(type === 'audioBlob') { }
 *     if(type === 'videoBlob') { }
 *     if(type === 'gifBlob')   { }
 * });
 * // DiskStorage.dataStoreName = 'recordRTC';
 * // DiskStorage.onError = function(error) { };
 * @property {function} init - This method must be called once to initialize IndexedDB ObjectStore. Though, it is auto-used internally.
 * @property {function} Fetch - This method fetches stored blobs from IndexedDB.
 * @property {function} Store - This method stores blobs in IndexedDB.
 * @property {function} onError - This function is invoked for any known/unknown error.
 * @property {string} dataStoreName - Name of the ObjectStore created in IndexedDB storage.
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 */var A={init:function(){var e=this;if("undefined"!==typeof indexedDB&&"undefined"!==typeof indexedDB.open){var t,i=1,o=this.dbName||location.href.replace(/\/|:|#|%|\.|\[|\]/g,""),n=indexedDB.open(o,i);n.onerror=e.onError,n.onsuccess=function(){if(t=n.result,t.onerror=e.onError,t.setVersion)if(t.version!==i){var o=t.setVersion(i);o.onsuccess=function(){a(t),r()}}else r();else r()},n.onupgradeneeded=function(e){a(e.target.result)}}else console.error("IndexedDB API are not available in this browser.");function a(t){t.createObjectStore(e.dataStoreName)}function r(){var i=t.transaction([e.dataStoreName],"readwrite");function o(t){i.objectStore(e.dataStoreName).get(t).onsuccess=function(i){e.callback&&e.callback(i.target.result,t)}}e.videoBlob&&i.objectStore(e.dataStoreName).put(e.videoBlob,"videoBlob"),e.gifBlob&&i.objectStore(e.dataStoreName).put(e.gifBlob,"gifBlob"),e.audioBlob&&i.objectStore(e.dataStoreName).put(e.audioBlob,"audioBlob"),o("audioBlob"),o("videoBlob"),o("gifBlob")}},Fetch:function(e){return this.callback=e,this.init(),this},Store:function(e){return this.audioBlob=e.audioBlob,this.videoBlob=e.videoBlob,this.gifBlob=e.gifBlob,this.init(),this},onError:function(e){console.error(JSON.stringify(e,null,"\t"))},dataStoreName:"recordRTC",dbName:null};
/**
 * GifRecorder is standalone calss used by {@link RecordRTC} to record video or canvas into animated gif.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef GifRecorder
 * @class
 * @example
 * var recorder = new GifRecorder(mediaStream || canvas || context, { onGifPreview: function, onGifRecordingStarted: function, width: 1280, height: 720, frameRate: 200, quality: 10 });
 * recorder.record();
 * recorder.stop(function(blob) {
 *     img.src = URL.createObjectURL(blob);
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object or HTMLCanvasElement or CanvasRenderingContext2D.
 * @param {object} config - {disableLogs:true, initCallback: function, width: 320, height: 240, frameRate: 200, quality: 10}
 */
function $(e,t){if("undefined"===typeof GIFEncoder){var i=document.createElement("script");i.src="https://www.webrtc-experiment.com/gif-recorder.js",(document.body||document.documentElement).appendChild(i)}t=t||{};var o=e instanceof CanvasRenderingContext2D||e instanceof HTMLCanvasElement;this.record=function(){function e(i){if(!0!==h.clearedRecordedData){if(n)return setTimeout((function(){e(i)}),100);f=l(e),void 0===typeof u&&(u=i),i-u<90||(!o&&c.paused&&c.play(),o||s.drawImage(c,0,0,r.width,r.height),t.onGifPreview&&t.onGifPreview(r.toDataURL("image/png")),p.addFrame(s),u=i)}}"undefined"!==typeof GIFEncoder&&d?(o||(t.width||(t.width=c.offsetWidth||320),t.height||(t.height=c.offsetHeight||240),t.video||(t.video={width:t.width,height:t.height}),t.canvas||(t.canvas={width:t.width,height:t.height}),r.width=t.canvas.width||320,r.height=t.canvas.height||240,c.width=t.video.width||320,c.height=t.video.height||240),p=new GIFEncoder,p.setRepeat(0),p.setDelay(t.frameRate||200),p.setQuality(t.quality||10),p.start(),"function"===typeof t.onGifRecordingStarted&&t.onGifRecordingStarted(),Date.now(),f=l(e),t.initCallback&&t.initCallback()):setTimeout(h.record,1e3)},this.stop=function(e){e=e||function(){},f&&m(f),Date.now(),this.blob=new Blob([new Uint8Array(p.stream().bin)],{type:"image/gif"}),e(this.blob),p.stream().bin=[]};var n=!1;function a(){p&&(p.stream().bin=[])}this.pause=function(){n=!0},this.resume=function(){n=!1},this.clearRecordedData=function(){h.clearedRecordedData=!0,a()},this.name="GifRecorder",this.toString=function(){return this.name};var r=document.createElement("canvas"),s=r.getContext("2d");o&&(e instanceof CanvasRenderingContext2D?(s=e,r=s.canvas):e instanceof HTMLCanvasElement&&(s=e.getContext("2d"),r=e));var d=!0;if(!o){var c=document.createElement("video");c.muted=!0,c.autoplay=!0,c.playsInline=!0,d=!1,c.onloadedmetadata=function(){d=!0},k(e,c),c.play()}var u,p,f=null,h=this}function I(e,t){var o="Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45";(function(e){"undefined"===typeof a&&e&&"undefined"===typeof window&&"undefined"!==typeof i.g&&(i.g.navigator={userAgent:o,getUserMedia:function(){}},i.g.console||(i.g.console={}),"undefined"!==typeof i.g.console.log&&"undefined"!==typeof i.g.console.error||(i.g.console.error=i.g.console.log=i.g.console.log||function(){console.log(arguments)}),"undefined"===typeof document&&(e.document={documentElement:{appendChild:function(){return""}}},document.createElement=document.captureStream=document.mozCaptureStream=function(){var e={getContext:function(){return e},play:function(){},pause:function(){},drawImage:function(){},toDataURL:function(){return""},style:{}};return e},e.HTMLVideoElement=function(){}),"undefined"===typeof location&&(e.location={protocol:"file:",href:"",hash:""}),"undefined"===typeof screen&&(e.screen={width:0,height:0}),"undefined"===typeof u&&(e.URL={createObjectURL:function(){return""},revokeObjectURL:function(){return""}}),e.window=i.g)})("undefined"!==typeof i.g?i.g:null),t=t||"multi-streams-mixer";var n=[],r=!1,s=document.createElement("canvas"),d=s.getContext("2d");s.style.opacity=0,s.style.position="absolute",s.style.zIndex=-1,s.style.top="-1000em",s.style.left="-1000em",s.className=t,(document.body||document.documentElement).appendChild(s),this.disableLogs=!1,this.frameInterval=10,this.width=360,this.height=240,this.useGainNode=!0;var c=this,l=window.AudioContext;"undefined"===typeof l&&("undefined"!==typeof webkitAudioContext&&(l=webkitAudioContext),"undefined"!==typeof mozAudioContext&&(l=mozAudioContext));var u=window.URL;"undefined"===typeof u&&"undefined"!==typeof webkitURL&&(u=webkitURL),"undefined"!==typeof navigator&&"undefined"===typeof navigator.getUserMedia&&("undefined"!==typeof navigator.webkitGetUserMedia&&(navigator.getUserMedia=navigator.webkitGetUserMedia),"undefined"!==typeof navigator.mozGetUserMedia&&(navigator.getUserMedia=navigator.mozGetUserMedia));var m=window.MediaStream;"undefined"===typeof m&&"undefined"!==typeof webkitMediaStream&&(m=webkitMediaStream),"undefined"!==typeof m&&"undefined"===typeof m.prototype.stop&&(m.prototype.stop=function(){this.getTracks().forEach((function(e){e.stop()}))});var p={};function f(e,t){"srcObject"in t?t.srcObject=e:"mozSrcObject"in t?t.mozSrcObject=e:t.srcObject=e}function h(){if(!r){var e=n.length,t=!1,i=[];if(n.forEach((function(e){e.stream||(e.stream={}),e.stream.fullcanvas?t=e:i.push(e)})),t)s.width=t.stream.width,s.height=t.stream.height;else if(i.length){s.width=e>1?2*i[0].width:i[0].width;var o=1;3!==e&&4!==e||(o=2),5!==e&&6!==e||(o=3),7!==e&&8!==e||(o=4),9!==e&&10!==e||(o=5),s.height=i[0].height*o}else s.width=c.width||360,s.height=c.height||240;t&&t instanceof HTMLVideoElement&&v(t),i.forEach((function(e,t){v(e,t)})),setTimeout(h,c.frameInterval)}}function v(e,t){if(!r){var i=0,o=0,n=e.width,a=e.height;1===t&&(i=e.width),2===t&&(o=e.height),3===t&&(i=e.width,o=e.height),4===t&&(o=2*e.height),5===t&&(i=e.width,o=2*e.height),6===t&&(o=3*e.height),7===t&&(i=e.width,o=3*e.height),"undefined"!==typeof e.stream.left&&(i=e.stream.left),"undefined"!==typeof e.stream.top&&(o=e.stream.top),"undefined"!==typeof e.stream.width&&(n=e.stream.width),"undefined"!==typeof e.stream.height&&(a=e.stream.height),d.drawImage(e,i,o,n,a),"function"===typeof e.stream.onRender&&e.stream.onRender(d,i,o,n,a,t)}}function g(){r=!1;var t=_(),i=b();return i&&i.getTracks().filter((function(e){return"audio"===e.kind})).forEach((function(e){t.addTrack(e)})),e.forEach((function(e){e.fullcanvas&&!0})),t}function _(){var e;w(),"captureStream"in s?e=s.captureStream():"mozCaptureStream"in s?e=s.mozCaptureStream():c.disableLogs||console.error("Upgrade to latest Chrome or otherwise enable this flag: chrome://flags/#enable-experimental-web-platform-features");var t=new m;return e.getTracks().filter((function(e){return"video"===e.kind})).forEach((function(e){t.addTrack(e)})),s.stream=t,t}function b(){p.AudioContextConstructor||(p.AudioContextConstructor=new p.AudioContext),c.audioContext=p.AudioContextConstructor,c.audioSources=[],!0===c.useGainNode&&(c.gainNode=c.audioContext.createGain(),c.gainNode.connect(c.audioContext.destination),c.gainNode.gain.value=0);var t=0;if(e.forEach((function(e){if(e.getTracks().filter((function(e){return"audio"===e.kind})).length){t++;var i=c.audioContext.createMediaStreamSource(e);!0===c.useGainNode&&i.connect(c.gainNode),c.audioSources.push(i)}})),t)return c.audioDestination=c.audioContext.createMediaStreamDestination(),c.audioSources.forEach((function(e){e.connect(c.audioDestination)})),c.audioDestination.stream}function y(e){var i=document.createElement("video");return f(e,i),i.className=t,i.muted=!0,i.volume=0,i.width=e.width||c.width||360,i.height=e.height||c.height||240,i.play(),i}function w(t){n=[],t=t||e,t.forEach((function(e){if(e.getTracks().filter((function(e){return"video"===e.kind})).length){var t=y(e);t.stream=e,n.push(t)}}))}"undefined"!==typeof l?p.AudioContext=l:"undefined"!==typeof webkitAudioContext&&(p.AudioContext=webkitAudioContext),this.startDrawingFrames=function(){h()},this.appendStreams=function(t){if(!t)throw"First parameter is required.";t instanceof Array||(t=[t]),t.forEach((function(t){var i=new m;if(t.getTracks().filter((function(e){return"video"===e.kind})).length){var o=y(t);o.stream=t,n.push(o),i.addTrack(t.getTracks().filter((function(e){return"video"===e.kind}))[0])}if(t.getTracks().filter((function(e){return"audio"===e.kind})).length){var a=c.audioContext.createMediaStreamSource(t);c.audioDestination=c.audioContext.createMediaStreamDestination(),a.connect(c.audioDestination),i.addTrack(c.audioDestination.stream.getTracks().filter((function(e){return"audio"===e.kind}))[0])}e.push(i)}))},this.releaseStreams=function(){n=[],r=!0,c.gainNode&&(c.gainNode.disconnect(),c.gainNode=null),c.audioSources.length&&(c.audioSources.forEach((function(e){e.disconnect()})),c.audioSources=[]),c.audioDestination&&(c.audioDestination.disconnect(),c.audioDestination=null),c.audioContext&&c.audioContext.close(),c.audioContext=null,d.clearRect(0,0,s.width,s.height),s.stream&&(s.stream.stop(),s.stream=null)},this.resetVideoStreams=function(e){!e||e instanceof Array||(e=[e]),w(e)},this.name="MultiStreamsMixer",this.toString=function(){return this.name},this.getMixedStream=g}
/**
 * MultiStreamRecorder can record multiple videos in single container.
 * @summary Multi-videos recorder.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef MultiStreamRecorder
 * @class
 * @example
 * var options = {
 *     mimeType: 'video/webm'
 * }
 * var recorder = new MultiStreamRecorder(ArrayOfMediaStreams, options);
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 *
 *     // or
 *     var blob = recorder.blob;
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStreams} mediaStreams - Array of MediaStreams.
 * @param {object} config - {disableLogs:true, frameInterval: 1, mimeType: "video/webm"}
 */
function O(e,t){e=e||[];var i,o,n=this;function a(){var t=[];return e.forEach((function(e){x(e,"video").forEach((function(e){t.push(e)}))})),t}t=t||{elementClass:"multi-streams-mixer",mimeType:"video/webm",video:{width:360,height:240}},t.frameInterval||(t.frameInterval=10),t.video||(t.video={}),t.video.width||(t.video.width=360),t.video.height||(t.video.height=240),this.record=function(){i=new I(e,t.elementClass||"multi-streams-mixer"),a().length&&(i.frameInterval=t.frameInterval||10,i.width=t.video.width||360,i.height=t.video.height||240,i.startDrawingFrames()),t.previewStream&&"function"===typeof t.previewStream&&t.previewStream(i.getMixedStream()),o=new E(i.getMixedStream(),t),o.record()},this.stop=function(e){o&&o.stop((function(t){n.blob=t,e(t),n.clearRecordedData()}))},this.pause=function(){o&&o.pause()},this.resume=function(){o&&o.resume()},this.clearRecordedData=function(){o&&(o.clearRecordedData(),o=null),i&&(i.releaseStreams(),i=null)},this.addStreams=function(n){if(!n)throw"First parameter is required.";n instanceof Array||(n=[n]),e.concat(n),o&&i&&(i.appendStreams(n),t.previewStream&&"function"===typeof t.previewStream&&t.previewStream(i.getMixedStream()))},this.resetVideoStreams=function(e){i&&(!e||e instanceof Array||(e=[e]),i.resetVideoStreams(e))},this.getMixer=function(){return i},this.name="MultiStreamRecorder",this.toString=function(){return this.name}}
/**
 * RecordRTCPromisesHandler adds promises support in {@link RecordRTC}. Try a {@link https://github.com/muaz-khan/RecordRTC/blob/master/simple-demos/RecordRTCPromisesHandler.html|demo here}
 * @summary Promises for {@link RecordRTC}
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef RecordRTCPromisesHandler
 * @class
 * @example
 * var recorder = new RecordRTCPromisesHandler(mediaStream, options);
 * recorder.startRecording()
 *         .then(successCB)
 *         .catch(errorCB);
 * // Note: You can access all RecordRTC API using "recorder.recordRTC" e.g. 
 * recorder.recordRTC.onStateChanged = function(state) {};
 * recorder.recordRTC.setRecordingDuration(5000);
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - Single media-stream object, array of media-streams, html-canvas-element, etc.
 * @param {object} config - {type:"video", recorderType: MediaStreamRecorder, disableLogs: true, numberOfAudioChannels: 1, bufferSize: 0, sampleRate: 0, video: HTMLVideoElement, etc.}
 * @throws Will throw an error if "new" keyword is not used to initiate "RecordRTCPromisesHandler". Also throws error if first argument "MediaStream" is missing.
 * @requires {@link RecordRTC}
 */
function B(e,t){if(!this)throw'Use "new RecordRTCPromisesHandler()"';if("undefined"===typeof e)throw'First argument "MediaStream" is required.';var i=this;i.recordRTC=new a(e,t),this.startRecording=function(){return new Promise((function(e,t){try{i.recordRTC.startRecording(),e()}catch(o){t(o)}}))},this.stopRecording=function(){return new Promise((function(e,t){try{i.recordRTC.stopRecording((function(o){i.blob=i.recordRTC.getBlob(),i.blob&&i.blob.size?e(o):t("Empty blob.",i.blob)}))}catch(o){t(o)}}))},this.pauseRecording=function(){return new Promise((function(e,t){try{i.recordRTC.pauseRecording(),e()}catch(o){t(o)}}))},this.resumeRecording=function(){return new Promise((function(e,t){try{i.recordRTC.resumeRecording(),e()}catch(o){t(o)}}))},this.getDataURL=function(e){return new Promise((function(e,t){try{i.recordRTC.getDataURL((function(t){e(t)}))}catch(o){t(o)}}))},this.getBlob=function(){return new Promise((function(e,t){try{e(i.recordRTC.getBlob())}catch(o){t(o)}}))},this.getInternalRecorder=function(){return new Promise((function(e,t){try{e(i.recordRTC.getInternalRecorder())}catch(o){t(o)}}))},this.reset=function(){return new Promise((function(e,t){try{e(i.recordRTC.reset())}catch(o){t(o)}}))},this.destroy=function(){return new Promise((function(e,t){try{e(i.recordRTC.destroy())}catch(o){t(o)}}))},this.getState=function(){return new Promise((function(e,t){try{e(i.recordRTC.getState())}catch(o){t(o)}}))},this.blob=null,this.version="5.6.2"}
/**
 * WebAssemblyRecorder lets you create webm videos in JavaScript via WebAssembly. The library consumes raw RGBA32 buffers (4 bytes per pixel) and turns them into a webm video with the given framerate and quality. This makes it compatible out-of-the-box with ImageData from a CANVAS. With realtime mode you can also use webm-wasm for streaming webm videos.
 * @summary Video recording feature in Chrome, Firefox and maybe Edge.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef WebAssemblyRecorder
 * @class
 * @example
 * var recorder = new WebAssemblyRecorder(mediaStream);
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {webAssemblyPath:'webm-wasm.wasm',workerPath: 'webm-worker.js', frameRate: 30, width: 1920, height: 1080, bitrate: 1024, realtime: true}
 */
function F(e,t){var i,o,n;function a(){return new ReadableStream({start:function(o){var n=document.createElement("canvas"),a=document.createElement("video"),r=!0;a.srcObject=e,a.muted=!0,a.height=t.height,a.width=t.width,a.volume=0,a.onplaying=function(){n.width=t.width,n.height=t.height;var e=n.getContext("2d"),s=1e3/t.frameRate,d=setInterval((function(){if(i&&(clearInterval(d),o.close()),r&&(r=!1,t.onVideoProcessStarted&&t.onVideoProcessStarted()),e.drawImage(a,0,0),"closed"!==o._controlledReadableStream.state)try{o.enqueue(e.getImageData(0,0,t.width,t.height))}catch(n){}}),s)},a.play()}})}function r(e,s){if(!t.workerPath&&!s)return i=!1,void fetch("https://unpkg.com/webm-wasm@latest/dist/webm-worker.js").then((function(t){t.arrayBuffer().then((function(t){r(e,t)}))}));if(!t.workerPath&&s instanceof ArrayBuffer){var c=new Blob([s],{type:"text/javascript"});t.workerPath=f.createObjectURL(c)}t.workerPath||console.error("workerPath parameter is missing."),o=new Worker(t.workerPath),o.postMessage(t.webAssemblyPath||"https://unpkg.com/webm-wasm@latest/dist/webm-wasm.wasm"),o.addEventListener("message",(function(e){"READY"===e.data?(o.postMessage({width:t.width,height:t.height,bitrate:t.bitrate||1200,timebaseDen:t.frameRate||30,realtime:t.realtime}),a().pipeTo(new WritableStream({write:function(e){i?console.error("Got image, but recorder is finished!"):o.postMessage(e.data.buffer,[e.data.buffer])}}))):e.data&&(n||d.push(e.data))}))}function s(e){o?(o.addEventListener("message",(function(t){null===t.data&&(o.terminate(),o=null,e&&e())})),o.postMessage(null)):e&&e()}"undefined"!==typeof ReadableStream&&"undefined"!==typeof WritableStream||console.error("Following polyfill is strongly recommended: https://unpkg.com/@mattiasbuelens/web-streams-polyfill/dist/polyfill.min.js"),t=t||{},t.width=t.width||640,t.height=t.height||480,t.frameRate=t.frameRate||30,t.bitrate=t.bitrate||1200,t.realtime=t.realtime||!0,this.record=function(){d=[],n=!1,this.blob=null,r(e),"function"===typeof t.initCallback&&t.initCallback()},this.pause=function(){n=!0},this.resume=function(){n=!1};var d=[];this.stop=function(e){i=!0;var t=this;s((function(){t.blob=new Blob(d,{type:"video/webm"}),e(t.blob)}))},this.name="WebAssemblyRecorder",this.toString=function(){return this.name},this.clearRecordedData=function(){d=[],n=!1,this.blob=null},this.blob=null}"undefined"!==typeof a&&(a.DiskStorage=A),"undefined"!==typeof a&&(a.GifRecorder=$),"undefined"===typeof a&&(e.exports=I,o=[],n=function(){return I}.apply(t,o),void 0===n||(e.exports=n)),"undefined"!==typeof a&&(a.MultiStreamRecorder=O),"undefined"!==typeof a&&(a.RecordRTCPromisesHandler=B),"undefined"!==typeof a&&(a.WebAssemblyRecorder=F)},5503:function(e,t,i){"use strict";var o,n;i(44114),i(21903),i(91134),i(13609);var a=function(a,r){var s="Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45";function d(e,t){function i(e){return!e.audio&&!e.video&&!e.screen&&e.data}var o="";o+="?userid="+e.userid,o+="&sessionid="+e.sessionid,o+="&msgEvent="+e.socketMessageEvent,o+="&socketCustomEvent="+e.socketCustomEvent,o+="&autoCloseEntireSession="+!!e.autoCloseEntireSession,!0===e.session.broadcast&&(o+="&oneToMany=true"),o+="&maxParticipantsAllowed="+e.maxParticipantsAllowed,e.enableScalableBroadcast&&(o+="&enableScalableBroadcast=true",o+="&maxRelayLimitPerUser="+(e.maxRelayLimitPerUser||2)),o+="&extra="+JSON.stringify(e.extra||{}),e.socketCustomParameters&&(o+=e.socketCustomParameters);try{io.sockets={}}catch(d){}if(e.socketURL||(e.socketURL="/"),"/"!=e.socketURL.substr(e.socketURL.length-1,1))throw'"socketURL" MUST end with a slash.';e.enableLogs&&("/"==e.socketURL?console.info("socket.io url is: ",location.origin+"/"):console.info("socket.io url is: ",e.socketURL));try{e.socket=io(e.socketURL+o)}catch(d){e.socket=io.connect(e.socketURL+o,e.socketOptions)}var n=e.multiPeersHandler;function a(t,i){e.peersBackup[t]||(e.peersBackup[t]={userid:t,extra:{}}),e.peersBackup[t].extra=i}function r(t){if(t.remoteUserId==e.userid)if(e.peers[t.sender]&&e.peers[t.sender].extra!=t.message.extra&&(e.peers[t.sender].extra=t.extra,e.onExtraDataUpdated({userid:t.sender,extra:t.extra}),a(t.sender,t.extra)),t.message.streamSyncNeeded&&e.peers[t.sender]){var o=e.streamEvents[t.message.streamid];if(!o||!o.stream)return;var s=t.message.action;if("ended"===s||"inactive"===s||"stream-removed"===s)return e.peersBackup[o.userid]&&(o.extra=e.peersBackup[o.userid].extra),void e.onstreamended(o);var d="both"!=t.message.type?t.message.type:null;"function"==typeof o.stream[s]&&o.stream[s](d)}else if("dropPeerConnection"!==t.message){if(t.message.allParticipants)return-1===t.message.allParticipants.indexOf(t.sender)&&t.message.allParticipants.push(t.sender),void t.message.allParticipants.forEach((function(t){n[e.peers[t]?"renegotiatePeer":"createNewPeer"](t,{localPeerSdpConstraints:{OfferToReceiveAudio:e.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:e.sdpConstraints.mandatory.OfferToReceiveVideo},remotePeerSdpConstraints:{OfferToReceiveAudio:e.session.oneway?!!e.session.audio:e.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:e.session.oneway?!!e.session.video||!!e.session.screen:e.sdpConstraints.mandatory.OfferToReceiveVideo},isOneWay:!!e.session.oneway||"one-way"===e.direction,isDataOnly:i(e.session)})}));if(t.message.newParticipant){if(t.message.newParticipant==e.userid)return;if(e.peers[t.message.newParticipant])return;n.createNewPeer(t.message.newParticipant,t.message.userPreferences||{localPeerSdpConstraints:{OfferToReceiveAudio:e.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:e.sdpConstraints.mandatory.OfferToReceiveVideo},remotePeerSdpConstraints:{OfferToReceiveAudio:e.session.oneway?!!e.session.audio:e.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:e.session.oneway?!!e.session.video||!!e.session.screen:e.sdpConstraints.mandatory.OfferToReceiveVideo},isOneWay:!!e.session.oneway||"one-way"===e.direction,isDataOnly:i(e.session)})}else if(t.message.readyForOffer&&(e.attachStreams.length&&(e.waitingForLocalMedia=!1),e.waitingForLocalMedia))setTimeout((function(){r(t)}),1);else if(t.message.newParticipationRequest&&t.sender!==e.userid){e.peers[t.sender]&&e.deletePeer(t.sender);var c={extra:t.extra||{},localPeerSdpConstraints:t.message.remotePeerSdpConstraints||{OfferToReceiveAudio:e.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:e.sdpConstraints.mandatory.OfferToReceiveVideo},remotePeerSdpConstraints:t.message.localPeerSdpConstraints||{OfferToReceiveAudio:e.session.oneway?!!e.session.audio:e.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:e.session.oneway?!!e.session.video||!!e.session.screen:e.sdpConstraints.mandatory.OfferToReceiveVideo},isOneWay:"undefined"!==typeof t.message.isOneWay?t.message.isOneWay:!!e.session.oneway||"one-way"===e.direction,isDataOnly:"undefined"!==typeof t.message.isDataOnly?t.message.isDataOnly:i(e.session),dontGetRemoteStream:"undefined"!==typeof t.message.isOneWay?t.message.isOneWay:!!e.session.oneway||"one-way"===e.direction,dontAttachLocalStream:!!t.message.dontGetRemoteStream,connectionDescription:t,successCallback:function(){}};e.onNewParticipant(t.sender,c)}else{if(t.message.changedUUID&&e.peers[t.message.oldUUID]&&(e.peers[t.message.newUUID]=e.peers[t.message.oldUUID],delete e.peers[t.message.oldUUID]),t.message.userLeft)return n.onUserLeft(t.sender),void(t.message.autoCloseEntireSession&&e.leave());n.addNegotiatedMessage(t.message,t.sender)}}else e.deletePeer(t.sender)}e.socket.on("extra-data-updated",(function(t,i){e.peers[t]&&(e.peers[t].extra=i,e.onExtraDataUpdated({userid:t,extra:i}),a(t,i))})),e.socket.on(e.socketMessageEvent,r);var s=!1;e.socket.resetProps=function(){s=!1},e.socket.on("connect",(function(){s||(s=!0,e.enableLogs&&console.info("socket.io connection is opened."),setTimeout((function(){e.socket.emit("extra-data-updated",e.extra)}),1e3),t&&t(e.socket))})),e.socket.on("disconnect",(function(t){e.onSocketDisconnect(t)})),e.socket.on("error",(function(t){e.onSocketError(t)})),e.socket.on("user-disconnected",(function(t){t!==e.userid&&(e.onUserStatusChanged({userid:t,status:"offline",extra:e.peers[t]&&e.peers[t].extra||{}}),e.deletePeer(t))})),e.socket.on("user-connected",(function(t){t!==e.userid&&e.onUserStatusChanged({userid:t,status:"online",extra:e.peers[t]&&e.peers[t].extra||{}})})),e.socket.on("closed-entire-session",(function(t,i){e.leave(),e.onEntireSessionClosed({sessionid:t,userid:t,extra:i})})),e.socket.on("userid-already-taken",(function(t,i){e.onUserIdAlreadyTaken(t,i)})),e.socket.on("logs",(function(t){e.enableLogs&&console.debug("server-logs",t)})),e.socket.on("number-of-broadcast-viewers-updated",(function(t){e.onNumberOfBroadcastViewersUpdated(t)})),e.socket.on("set-isInitiator-true",(function(t){t==e.sessionid&&(e.isInitiator=!0)}))}function c(e){var t=this,i=["getAllParticipants","getLength","selectFirst","streams","send","forEach"];function o(){e.fbr=new FileBufferReader,e.fbr.onProgress=function(t){e.onFileProgress(t)},e.fbr.onBegin=function(t){e.onFileStart(t)},e.fbr.onEnd=function(t){e.onFileEnd(t)}}e.peers={getLength:function(){var e=0;for(var t in this)-1==i.indexOf(t)&&e++;return e},selectFirst:function(){var e;for(var t in this)-1==i.indexOf(t)&&(e=this[t]);return e},getAllParticipants:function(e){var t=[];for(var o in this)-1==i.indexOf(o)&&o!=e&&t.push(o);return t},forEach:function(t){this.getAllParticipants().forEach((function(i){t(e.peers[i])}))},send:function(i,o){var n=this;if(!_(i.size)&&!_(i.type)){if(e.enableFileSharing)return void t.shareFile(i,o);"string"!==typeof i&&(i=JSON.stringify(i))}if("text"===i.type||i instanceof ArrayBuffer||i instanceof DataView){if("text"===i.type&&(i=JSON.stringify(i)),o){var a=e.peers[o];if(a)return a.channels.length?void a.channels.forEach((function(e){e.send(i)})):(e.peers[o].createDataChannel(),e.renegotiate(o),void setTimeout((function(){n.send(i,o)}),3e3))}this.getAllParticipants().forEach((function(t){if(!n[t].channels.length)return e.peers[t].createDataChannel(),e.renegotiate(t),void setTimeout((function(){n[t].channels.forEach((function(e){e.send(i)}))}),3e3);n[t].channels.forEach((function(e){e.send(i)}))}))}else N.send({text:i,channel:this,connection:e,remoteUserId:o})}},this.uuid=e.userid,this.getLocalConfig=function(i,n,a){return a||(a={}),{streamsToShare:a.streamsToShare||{},rtcMultiConnection:e,connectionDescription:a.connectionDescription,userid:n,localPeerSdpConstraints:a.localPeerSdpConstraints,remotePeerSdpConstraints:a.remotePeerSdpConstraints,dontGetRemoteStream:!!a.dontGetRemoteStream,dontAttachLocalStream:!!a.dontAttachLocalStream,renegotiatingPeer:!!a.renegotiatingPeer,peerRef:a.peerRef,channels:a.channels||[],onLocalSdp:function(e){t.onNegotiationNeeded(e,n)},onLocalCandidate:function(i){i=A.processCandidates(e,i),i&&t.onNegotiationNeeded(i,n)},remoteSdp:i,onDataChannelMessage:function(i){if(!e.fbr&&e.enableFileSharing&&o(),"string"!=typeof i&&e.enableFileSharing){var a=this;i instanceof ArrayBuffer||i instanceof DataView?e.fbr.convertToObject(i,(function(e){a.onDataChannelMessage(e)})):i.readyForNextChunk?e.fbr.getNextChunk(i,(function(t,i){e.peers[n].channels.forEach((function(e){e.send(t)}))}),n):i.chunkMissing?e.fbr.chunkMissing(i):e.fbr.addChunk(i,(function(t){e.peers[n].peer.channel.send(t)}))}else t.onDataChannelMessage(i,n)},onDataChannelError:function(e){t.onDataChannelError(e,n)},onDataChannelOpened:function(e){t.onDataChannelOpened(e,n)},onDataChannelClosed:function(e){t.onDataChannelClosed(e,n)},onRemoteStream:function(i){e.peers[n]&&e.peers[n].streams.push(i),t.onGettingRemoteMedia(i,n)},onRemoteStreamRemoved:function(e){t.onRemovingRemoteMedia(e,n)},onPeerStateChanged:function(e){t.onPeerStateChanged(e),"new"===e.iceConnectionState&&t.onNegotiationStarted(n,e),"connected"===e.iceConnectionState&&t.onNegotiationCompleted(n,e),-1!==e.iceConnectionState.search(/closed|failed/gi)&&(t.onUserLeft(n),t.disconnectWith(n))}}},this.createNewPeer=function(t,i){if(!(e.maxParticipantsAllowed<=e.getAllParticipants().length)){if(i=i||{},e.isInitiator&&e.session.audio&&"two-way"===e.session.audio&&!i.streamsToShare&&(i.isOneWay=!1,i.isDataOnly=!1,i.session=e.session),!i.isOneWay&&!i.isDataOnly)return i.isOneWay=!0,void this.onNegotiationNeeded({enableMedia:!0,userPreferences:i},t);i=e.setUserPreferences(i,t);var o=this.getLocalConfig(null,t,i);e.peers[t]=new L(o)}},this.createAnsweringPeer=function(t,i,o){o=e.setUserPreferences(o||{},i);var n=this.getLocalConfig(t,i,o);e.peers[i]=new L(n)},this.renegotiatePeer=function(t,i,o){if(e.peers[t]){i||(i={}),i.renegotiatingPeer=!0,i.peerRef=e.peers[t].peer,i.channels=e.peers[t].channels;var n=this.getLocalConfig(o,t,i);e.peers[t]=new L(n)}else e.enableLogs&&console.error("Peer ("+t+") does not exist. Renegotiation skipped.")},this.replaceTrack=function(t,i,o){if(!e.peers[i])throw"This peer ("+i+") does not exist.";var n=e.peers[i].peer;n.getSenders&&"function"===typeof n.getSenders&&n.getSenders().length?n.getSenders().forEach((function(n){o&&"video"===n.track.kind&&(e.peers[i].peer.lastVideoTrack=n.track,n.replaceTrack(t)),o||"audio"!==n.track.kind||(e.peers[i].peer.lastAudioTrack=n.track,n.replaceTrack(t))})):(console.warn("RTPSender.replaceTrack is NOT supported."),this.renegotiatePeer(i))},this.onNegotiationNeeded=function(e,t){},this.addNegotiatedMessage=function(i,o){if(i.type&&i.sdp)return"answer"==i.type&&e.peers[o]&&e.peers[o].addRemoteSdp(i),"offer"==i.type&&(i.renegotiatingPeer?this.renegotiatePeer(o,null,i):this.createAnsweringPeer(i,o)),void(e.enableLogs&&console.log("Remote peer's sdp:",i.sdp));if(i.candidate)return e.peers[o]&&e.peers[o].addRemoteCandidate(i),void(e.enableLogs&&console.log("Remote peer's candidate pairs:",i.candidate));if(i.enableMedia){e.session=i.userPreferences.session||e.session,e.session.oneway&&e.attachStreams.length&&(e.attachStreams=[]),i.userPreferences.isDataOnly&&e.attachStreams.length&&(e.attachStreams.length=[]);var n={};e.attachStreams.forEach((function(e){n[e.streamid]={isAudio:!!e.isAudio,isVideo:!!e.isVideo,isScreen:!!e.isScreen}})),i.userPreferences.streamsToShare=n,t.onNegotiationNeeded({readyForOffer:!0,userPreferences:i.userPreferences},o)}i.readyForOffer&&e.onReadyForOffer(o,i.userPreferences)},this.onGettingRemoteMedia=function(e,t){},this.onRemovingRemoteMedia=function(e,t){},this.onGettingLocalMedia=function(e){},this.onLocalMediaError=function(t,i){e.onMediaError(t,i)},this.shareFile=function(t,i){o(),e.fbr.readAsArrayBuffer(t,(function(t){var o=e.getAllParticipants();i&&(o=[i]),o.forEach((function(i){e.fbr.getNextChunk(t,(function(t){e.peers[i].channels.forEach((function(e){e.send(t)}))}),i)}))}),{userid:e.userid,chunkSize:"Firefox"===DetectRTC.browser.name?15e3:e.chunkSize||0})};var n=new F(e);this.onDataChannelMessage=function(t,i){n.receive(JSON.parse(t),i,e.peers[i]?e.peers[i].extra:{})},this.onDataChannelClosed=function(t,i){t.userid=i,t.extra=e.peers[i]?e.peers[i].extra:{},e.onclose(t)},this.onDataChannelError=function(t,i){t.userid=i,event.extra=e.peers[i]?e.peers[i].extra:{},e.onerror(t)},this.onDataChannelOpened=function(t,i){e.peers[i].channels.length?e.peers[i].channels=[t]:(e.peers[i].channels.push(t),e.onopen({userid:i,extra:e.peers[i]?e.peers[i].extra:{},channel:t}))},this.onPeerStateChanged=function(t){e.onPeerStateChanged(t)},this.onNegotiationStarted=function(e,t){},this.onNegotiationCompleted=function(e,t){},this.getRemoteStreams=function(t){return t=t||e.peers.getAllParticipants()[0],e.peers[t]?e.peers[t].streams:[]}}function l(e,t,i){if("undefined"!==typeof CustomEvent){var o={arguments:i,__exposedProps__:i},n=new CustomEvent(t,o);e.dispatchEvent(n)}}function u(e,t){if(t.stream&&C(t.stream,"audio").length){if(!e||!t)throw"Both arguments are required.";if(e.onspeaking&&e.onsilence){if("undefined"===typeof hark)throw"hark.js not found.";hark(t.stream,{onspeaking:function(){e.onspeaking(t)},onsilence:function(){e.onsilence(t)},onvolumechange:function(i,o){e.onvolumechange&&e.onvolumechange(merge({volume:i,threshold:o},t))}})}}}function m(e,t){t.stream&&t.stream&&t.stream.addEventListener&&(t.stream.addEventListener("mute",(function(i){i=e.streamEvents[t.streamid],i.session={audio:"audio"===i.muteType,video:"video"===i.muteType},e.onmute(i)}),!1),t.stream.addEventListener("unmute",(function(i){i=e.streamEvents[t.streamid],i.session={audio:"audio"===i.unmuteType,video:"video"===i.unmuteType},e.onunmute(i)}),!1))}function p(){if(window.crypto&&window.crypto.getRandomValues&&-1===navigator.userAgent.indexOf("Safari")){for(var e=window.crypto.getRandomValues(new Uint32Array(3)),t="",i=0,o=e.length;i<o;i++)t+=e[i].toString(36);return t}return(Math.random()*(new Date).getTime()).toString(36).replace(/\./g,"")}function f(e,t,i){if(i.autoCreateMediaElement){var o=!1;C(e,"video").length||e.isVideo||e.isScreen||(o=!0),"Firefox"===DetectRTC.browser.name&&(i.session.video||i.session.screen)&&(o=!1);var n=document.createElement(o?"audio":"video");if(n.srcObject=e,n.setAttribute("autoplay",!0),n.setAttribute("playsinline",!0),n.setAttribute("controls",!0),n.setAttribute("muted",!1),n.setAttribute("volume",1),"Firefox"===DetectRTC.browser.name){var a="ended";"oninactive"in n&&(a="inactive"),n.addEventListener(a,(function(){if(currentUserMediaRequest.remove(e.idInstance),"local"===e.type){a="ended","oninactive"in e&&(a="inactive"),B.onSyncNeeded(e.streamid,a),i.attachStreams.forEach((function(t,o){e.streamid===t.streamid&&delete i.attachStreams[o]}));var t=[];i.attachStreams.forEach((function(e){e&&t.push(e)})),i.attachStreams=t;var o=i.streamEvents[e.streamid];if(o)return void i.onstreamended(o);this.parentNode&&this.parentNode.removeChild(this)}}),!1)}var r=n.play();if("undefined"!==typeof r){var s=!1;setTimeout((function(){s||(s=!0,t(n))}),1e3),r.then((function(){s||(s=!0,t(n))})).catch((function(e){s||(s=!0,t(n))}))}else t(n)}else t({})}function h(e,t){window.removeEventListener(e,t),window.addEventListener(e,t,!1)}function v(e){var t=[];return e.forEach((function(e){e&&t.push(e)})),t}function g(e){return!e.audio&&!e.video&&!e.screen&&e.data}function _(e){return"undefined"===typeof e}function b(e){return"string"===typeof e}(function(e){e&&"undefined"===typeof window&&"undefined"!==typeof i.g&&(i.g.navigator={userAgent:s,getUserMedia:function(){}},i.g.console||(i.g.console={}),"undefined"===typeof i.g.console.debug&&(i.g.console.debug=i.g.console.info=i.g.console.error=i.g.console.log=i.g.console.log||function(){console.log(arguments)}),"undefined"===typeof document&&(e.document={},document.createElement=document.captureStream=document.mozCaptureStream=function(){var e={getContext:function(){return e},play:function(){},pause:function(){},drawImage:function(){},toDataURL:function(){return""}};return e},document.addEventListener=document.removeEventListener=e.addEventListener=e.removeEventListener=function(){},e.HTMLVideoElement=e.HTMLMediaElement=function(){}),"undefined"===typeof io&&(e.io=function(){return{on:function(e,t){t=t||function(){},"connect"===e&&t()},emit:function(e,t,i){i=i||function(){},"open-room"!==e&&"join-room"!==e||i(!0,t.sessionid,null)}}}),"undefined"===typeof location&&(e.location={protocol:"file:",href:"",hash:"",origin:"self"}),"undefined"===typeof screen&&(e.screen={width:0,height:0}),"undefined"===typeof URL&&(e.URL={createObjectURL:function(){return""},revokeObjectURL:function(){return""}}),e.window=i.g)})("undefined"!==typeof i.g?i.g:null),function(){var a="Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45",r="object"===typeof process&&"object"===typeof process.versions&&process.versions.node&&!process.browser;if(r){var s=process.versions.node.toString().replace("v","");a="Nodejs/"+s+" (NodeOS) AppleWebKit/"+s+" (KHTML, like Gecko) Nodejs/"+s+" Nodejs/"+s}(function(e){"undefined"===typeof window&&("undefined"===typeof window&&"undefined"!==typeof i.g&&(i.g.navigator={userAgent:a,getUserMedia:function(){}},e.window=i.g),"undefined"===typeof location&&(e.location={protocol:"file:",href:"",hash:""}),"undefined"===typeof screen&&(e.screen={width:0,height:0}))})("undefined"!==typeof i.g?i.g:window);var d=window.navigator;"undefined"!==typeof d?("undefined"!==typeof d.webkitGetUserMedia&&(d.getUserMedia=d.webkitGetUserMedia),"undefined"!==typeof d.mozGetUserMedia&&(d.getUserMedia=d.mozGetUserMedia)):d={getUserMedia:function(){},userAgent:a};var c=!!/Android|webOS|iPhone|iPad|iPod|BB10|BlackBerry|IEMobile|Opera Mini|Mobile|mobile/i.test(d.userAgent||""),l=-1!==d.userAgent.indexOf("Edge")&&(!!d.msSaveOrOpenBlob||!!d.msSaveBlob),u=!!window.opera||d.userAgent.indexOf(" OPR/")>=0,m="undefined"!==typeof window.InstallTrigger,p=/^((?!chrome|android).)*safari/i.test(d.userAgent),f=!!window.chrome&&!u,h="undefined"!==typeof document&&!!document.documentMode&&!l;function v(){d.appVersion;var e,t,i,o=d.userAgent,n=d.appName,a=""+parseFloat(d.appVersion),r=parseInt(d.appVersion,10);if(p&&!f&&-1!==o.indexOf("CriOS")&&(p=!1,f=!0),u){n="Opera";try{a=d.userAgent.split("OPR/")[1].split(" ")[0],r=a.split(".")[0]}catch(s){a="0.0.0.0",r=0}}else h?(t=o.indexOf("rv:"),t>0?a=o.substring(t+3):(t=o.indexOf("MSIE"),a=o.substring(t+5)),n="IE"):f?(t=o.indexOf("Chrome"),n="Chrome",a=o.substring(t+7)):p?(t=o.indexOf("Safari"),n="Safari",a=o.substring(t+7),-1!==(t=o.indexOf("Version"))&&(a=o.substring(t+8)),-1!==d.userAgent.indexOf("Version/")&&(a=d.userAgent.split("Version/")[1].split(" ")[0])):m?(t=o.indexOf("Firefox"),n="Firefox",a=o.substring(t+8)):(e=o.lastIndexOf(" ")+1)<(t=o.lastIndexOf("/"))&&(n=o.substring(e,t),a=o.substring(t+1),n.toLowerCase()===n.toUpperCase()&&(n=d.appName));return l&&(n="Edge",a=d.userAgent.split("Edge/")[1]),-1!==(i=a.search(/[; \)]/))&&(a=a.substring(0,i)),r=parseInt(""+a,10),isNaN(r)&&(a=""+parseFloat(d.appVersion),r=parseInt(d.appVersion,10)),{fullVersion:a,version:r,name:n,isPrivateBrowsing:!1}}function g(e,t){var i=0,o=50,n=!1,a=window.setInterval((function(){e()&&(window.clearInterval(a),t(n)),i++>o&&(window.clearInterval(a),n=!0,t(n))}),10)}function _(e){var t=e.toLowerCase();if(0===t.indexOf("msie")&&0===t.indexOf("trident"))return!1;var i=/(?:msie|rv:)\s?([\d\.]+)/.exec(t);return!!(i&&parseInt(i[1],10)>=10)}function b(e){var t;try{if(window.webkitRequestFileSystem)window.webkitRequestFileSystem(window.TEMPORARY,1,(function(){t=!1}),(function(e){t=!0}));else if(window.indexedDB&&/Firefox/.test(window.navigator.userAgent)){var i;try{i=window.indexedDB.open("test"),i.onerror=function(){return!0}}catch(o){t=!0}"undefined"===typeof t&&g((function(){return"done"===i.readyState}),(function(e){e||(t=!i.result)}))}else if(_(window.navigator.userAgent)){t=!1;try{window.indexedDB||(t=!0)}catch(o){t=!0}}else if(window.localStorage&&/Safari/.test(window.navigator.userAgent)){try{window.localStorage.setItem("test",1)}catch(o){t=!0}"undefined"===typeof t&&(t=!1,window.localStorage.removeItem("test"))}}catch(o){t=!1}g((function(){return"undefined"!==typeof t}),(function(i){e(t)}))}var y={Android:function(){return d.userAgent.match(/Android/i)},BlackBerry:function(){return d.userAgent.match(/BlackBerry|BB10/i)},iOS:function(){return d.userAgent.match(/iPhone|iPad|iPod/i)},Opera:function(){return d.userAgent.match(/Opera Mini/i)},Windows:function(){return d.userAgent.match(/IEMobile/i)},any:function(){return y.Android()||y.BlackBerry()||y.iOS()||y.Opera()||y.Windows()},getOsName:function(){var e="Unknown OS";return y.Android()&&(e="Android"),y.BlackBerry()&&(e="BlackBerry"),y.iOS()&&(e="iOS"),y.Opera()&&(e="Opera Mini"),y.Windows()&&(e="Windows"),e}};function w(){for(var e,t="-",i=d.appVersion,o=d.userAgent,n=t,a=[{s:"Windows 10",r:/(Windows 10.0|Windows NT 10.0)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Windows Vista",r:/Windows NT 6.0/},{s:"Windows Server 2003",r:/Windows NT 5.2/},{s:"Windows XP",r:/(Windows NT 5.1|Windows XP)/},{s:"Windows 2000",r:/(Windows NT 5.0|Windows 2000)/},{s:"Windows ME",r:/(Win 9x 4.90|Windows ME)/},{s:"Windows 98",r:/(Windows 98|Win98)/},{s:"Windows 95",r:/(Windows 95|Win95|Windows_95)/},{s:"Windows NT 4.0",r:/(Windows NT 4.0|WinNT4.0|WinNT|Windows NT)/},{s:"Windows CE",r:/Windows CE/},{s:"Windows 3.11",r:/Win16/},{s:"Android",r:/Android/},{s:"Open BSD",r:/OpenBSD/},{s:"Sun OS",r:/SunOS/},{s:"Linux",r:/(Linux|X11)/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"Mac OS X",r:/Mac OS X/},{s:"Mac OS",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/},{s:"QNX",r:/QNX/},{s:"UNIX",r:/UNIX/},{s:"BeOS",r:/BeOS/},{s:"OS/2",r:/OS\/2/},{s:"Search Bot",r:/(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver)/}],r=0;e=a[r];r++)if(e.r.test(o)){n=e.s;break}var s=t;switch(/Windows/.test(n)&&(/Windows (.*)/.test(n)&&(s=/Windows (.*)/.exec(n)[1]),n="Windows"),n){case"Mac OS X":/Mac OS X (10[\.\_\d]+)/.test(o)&&(s=/Mac OS X (10[\.\_\d]+)/.exec(o)[1]);break;case"Android":/Android ([\.\_\d]+)/.test(o)&&(s=/Android ([\.\_\d]+)/.exec(o)[1]);break;case"iOS":/OS (\d+)_(\d+)_?(\d+)?/.test(o)&&(s=/OS (\d+)_(\d+)_?(\d+)?/.exec(i),s=s[1]+"."+s[2]+"."+(0|s[3]));break}return{osName:n,osVersion:s}}var C="Unknown OS",S="Unknown OS Version";function x(e){e=(e||d.userAgent).toLowerCase();var t=e.match(/android\s([0-9\.]*)/);return!!t&&t[1]}var k=w();k&&k.osName&&"-"!=k.osName?(C=k.osName,S=k.osVersion):y.any()&&(C=y.getOsName(),"Android"==C&&(S=x()));r="object"===typeof process&&"object"===typeof process.versions&&process.versions.node;"Unknown OS"===C&&r&&(C="Nodejs",S=process.versions.node.toString().replace("v",""));var T=!1,R=!1;["captureStream","mozCaptureStream","webkitCaptureStream"].forEach((function(e){"undefined"!==typeof document&&"function"===typeof document.createElement&&(!T&&e in document.createElement("canvas")&&(T=!0),!R&&e in document.createElement("video")&&(R=!0))}));var M=/^(192\.168\.|169\.254\.|10\.|172\.(1[6-9]|2\d|3[01]))/,E=/([0-9]{1,3}(\.[0-9]{1,3}){3})/,P=/[a-f0-9]{1,4}(:[a-f0-9]{1,4}){7}/;function L(e,t){if(q.isWebRTCSupported){var i=!0,o=!0;U((function(t){t?t.match(M)?(i=!1,e("Local: "+t,i,o)):t.match(P)?(o=!1,e("Public: "+t,i,o)):e("Public: "+t,i,o):e()}),t)}}function U(e,t){if("undefined"!==typeof document&&"function"===typeof document.getElementById){var i={},o=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection;if(!o){var n=document.getElementById("iframe");if(!n)return;var a=n.contentWindow;o=a.RTCPeerConnection||a.mozRTCPeerConnection||a.webkitRTCPeerConnection}if(o){var r=null;"Chrome"===q.browser&&q.browser.version<58&&(r={optional:[{RtpDataChannels:!0}]});var s={iceServers:[{urls:"stun:stun.l.google.com:19302"}]},d=new o(s,r);if(t&&(d.addStream?d.addStream(t):d.addTrack&&t.getTracks()[0]&&d.addTrack(t.getTracks()[0],t)),d.onicecandidate=function(e){e.candidate&&e.candidate.candidate?c(e.candidate.candidate):c()},!t)try{d.createDataChannel("sctp",{})}catch(u){}q.isPromisesSupported?d.createOffer().then((function(e){d.setLocalDescription(e).then(l)})):d.createOffer((function(e){d.setLocalDescription(e,l,(function(){}))}),(function(){}))}}function c(t){if(t){var o=E.exec(t);if(o){var n=o[1],a=t.match(M),r=!0;void 0===i[n]&&e(n,a,r),i[n]=!0}}else e()}function l(){var e=d.localDescription.sdp.split("\n");e.forEach((function(e){e&&0===e.indexOf("a=candidate:")&&c(e)}))}}var A=[],$=[],I=[],O=[];d.mediaDevices&&d.mediaDevices.enumerateDevices&&(d.enumerateDevices=function(e){var t=d.mediaDevices.enumerateDevices();t&&t.then?d.mediaDevices.enumerateDevices().then(e).catch((function(){e([])})):e([])});var B=!1;("undefined"!==typeof D&&"getSources"in D||d.mediaDevices&&d.mediaDevices.enumerateDevices)&&(B=!0);var F=!1,N=!1,V=!1,H=!1,j=!1;function z(e){if(B)if(!d.enumerateDevices&&window.MediaStreamTrack&&window.MediaStreamTrack.getSources&&(d.enumerateDevices=window.MediaStreamTrack.getSources.bind(window.MediaStreamTrack)),!d.enumerateDevices&&d.enumerateDevices&&(d.enumerateDevices=d.enumerateDevices.bind(d)),d.enumerateDevices){A=[],$=[],I=[],O=[],F=!1,N=!1,V=!1,H=!1,j=!1;var t={};d.enumerateDevices((function(i){i.forEach((function(e){var i={};for(var o in e)try{"function"!==typeof e[o]&&(i[o]=e[o])}catch(n){}t[i.deviceId+i.label+i.kind]||("audio"===i.kind&&(i.kind="audioinput"),"video"===i.kind&&(i.kind="videoinput"),i.deviceId||(i.deviceId=i.id),i.id||(i.id=i.deviceId),i.label?("videoinput"!==i.kind||j||(j=!0),"audioinput"!==i.kind||H||(H=!0)):(i.isCustomLabel=!0,"videoinput"===i.kind?i.label="Camera "+(O.length+1):"audioinput"===i.kind?i.label="Microphone "+($.length+1):"audiooutput"===i.kind?i.label="Speaker "+(I.length+1):i.label="Please invoke getUserMedia once.","undefined"!==typeof q&&q.browser.isChrome&&q.browser.version>=46&&!/^(https:|chrome-extension:)$/g.test(location.protocol||"")&&"undefined"!==typeof document&&"string"===typeof document.domain&&document.domain.search&&-1===document.domain.search(/localhost|127.0./g)&&(i.label="HTTPs is required to get label of this "+i.kind+" device.")),"audioinput"===i.kind&&(F=!0,-1===$.indexOf(i)&&$.push(i)),"audiooutput"===i.kind&&(N=!0,-1===I.indexOf(i)&&I.push(i)),"videoinput"===i.kind&&(V=!0,-1===O.indexOf(i)&&O.push(i)),A.push(i),t[i.deviceId+i.label+i.kind]=i)})),"undefined"!==typeof q&&(q.MediaDevices=A,q.hasMicrophone=F,q.hasSpeakers=N,q.hasWebcam=V,q.isWebsiteHasWebcamPermissions=j,q.isWebsiteHasMicrophonePermissions=H,q.audioInputDevices=$,q.audioOutputDevices=I,q.videoInputDevices=O),e&&e()}))}else e&&e();else e&&e()}var q=window.DetectRTC||{};q.browser=v(),b((function(e){q.browser.isPrivateBrowsing=!!e})),q.browser["is"+q.browser.name]=!0,q.osName=C,q.osVersion=S;"object"===typeof process&&"object"===typeof process.versions&&process.versions["node-webkit"];var W=!1;["RTCPeerConnection","webkitRTCPeerConnection","mozRTCPeerConnection","RTCIceGatherer"].forEach((function(e){W||e in window&&(W=!0)})),q.isWebRTCSupported=W,q.isORTCSupported="undefined"!==typeof RTCIceGatherer;var G=!1;if((q.browser.isChrome&&q.browser.version>=35||q.browser.isFirefox&&q.browser.version>=34||q.browser.isEdge&&q.browser.version>=17||"Android"===q.osName&&q.browser.isChrome)&&(G=!0),!/^(https:|chrome-extension:)$/g.test(location.protocol||"")){var K="undefined"!==typeof document&&"string"===typeof document.domain&&document.domain.search&&-1===document.domain.search(/localhost|127.0./g);(K&&(q.browser.isChrome||q.browser.isEdge||q.browser.isOpera)||q.browser.isFirefox)&&(G=!1)}q.isScreenCapturingSupported=G;var X={isSupported:!1,isCreateMediaStreamSourceSupported:!1};["AudioContext","webkitAudioContext","mozAudioContext","msAudioContext"].forEach((function(e){X.isSupported||e in window&&(X.isSupported=!0,window[e]&&"createMediaStreamSource"in window[e].prototype&&(X.isCreateMediaStreamSourceSupported=!0))})),q.isAudioContextSupported=X.isSupported,q.isCreateMediaStreamSourceSupported=X.isCreateMediaStreamSourceSupported;var J=!1;q.browser.isChrome&&q.browser.version>31&&(J=!0),q.isRtpDataChannelsSupported=J;var Y=!1;(q.browser.isFirefox&&q.browser.version>28||q.browser.isChrome&&q.browser.version>25||q.browser.isOpera&&q.browser.version>=11)&&(Y=!0),q.isSctpDataChannelsSupported=Y,q.isMobileDevice=c;var Q=!1;(d.getUserMedia||d.mediaDevices&&d.mediaDevices.getUserMedia)&&(Q=!0),q.browser.isChrome&&q.browser.version>=46&&!/^(https:|chrome-extension:)$/g.test(location.protocol||"")&&"undefined"!==typeof document&&"string"===typeof document.domain&&document.domain.search&&-1===document.domain.search(/localhost|127.0./g)&&(Q="Requires HTTPs"),"Nodejs"===q.osName&&(Q=!1),q.isGetUserMediaSupported=Q;var Z="";if(screen.width){var ee=screen.width?screen.width:"",te=screen.height?screen.height:"";Z+=ee+" x "+te}function ie(e,t){function i(e,t){return 0==t?e:i(t,e%t)}var o=i(e,t);return e/o/(t/o)}q.displayResolution=Z,q.displayAspectRatio=ie(screen.width,screen.height).toFixed(2),q.isCanvasSupportsStreamCapturing=T,q.isVideoSupportsStreamCapturing=R,"Chrome"==q.browser.name&&q.browser.version>=53&&(q.isCanvasSupportsStreamCapturing||(q.isCanvasSupportsStreamCapturing="Requires chrome flag: enable-experimental-web-platform-features"),q.isVideoSupportsStreamCapturing||(q.isVideoSupportsStreamCapturing="Requires chrome flag: enable-experimental-web-platform-features")),q.DetectLocalIPAddress=L,q.isWebSocketsSupported="WebSocket"in window&&2===window.WebSocket.CLOSING,q.isWebSocketsBlocked=!q.isWebSocketsSupported,"Nodejs"===q.osName&&(q.isWebSocketsSupported=!0,q.isWebSocketsBlocked=!1),q.checkWebSocketsSupport=function(e){e=e||function(){};try{var t,i=new WebSocket("wss://echo.websocket.org:443/");i.onopen=function(){q.isWebSocketsBlocked=!1,t=(new Date).getTime(),i.send("ping")},i.onmessage=function(){q.WebsocketLatency=(new Date).getTime()-t+"ms",e(),i.close(),i=null},i.onerror=function(){q.isWebSocketsBlocked=!0,e()}}catch(o){q.isWebSocketsBlocked=!0,e()}},q.load=function(e){e=e||function(){},z(e)},q.MediaDevices="undefined"!==typeof A?A:[],q.hasMicrophone=F,q.hasSpeakers=N,q.hasWebcam=V,q.isWebsiteHasWebcamPermissions=j,q.isWebsiteHasMicrophonePermissions=H,q.audioInputDevices=$,q.audioOutputDevices=I,q.videoInputDevices=O;var oe=!1;"undefined"!==typeof document&&"function"===typeof document.createElement&&"setSinkId"in document.createElement("video")&&(oe=!0),q.isSetSinkIdSupported=oe;var ne=!1;q.browser.isFirefox&&"undefined"!==typeof mozRTCPeerConnection?"getSenders"in mozRTCPeerConnection.prototype&&(ne=!0):q.browser.isChrome&&"undefined"!==typeof webkitRTCPeerConnection&&"getSenders"in webkitRTCPeerConnection.prototype&&(ne=!0),q.isRTPSenderReplaceTracksSupported=ne;var ae=!1;q.browser.isFirefox&&q.browser.version>38&&(ae=!0),q.isRemoteStreamProcessingSupported=ae;var re=!1;"undefined"!==typeof D&&"applyConstraints"in D.prototype&&(re=!0),q.isApplyConstraintsSupported=re;var se=!1;q.browser.isFirefox&&q.browser.version>=43&&(se=!0),q.isMultiMonitorScreenCapturingSupported=se,q.isPromisesSupported=!!("Promise"in window),q.version="1.3.9","undefined"===typeof q&&(window.DetectRTC={});var de=window.MediaStream;"undefined"===typeof de&&"undefined"!==typeof webkitMediaStream&&(de=webkitMediaStream),q.MediaStream="undefined"!==typeof de&&"function"===typeof de&&Object.keys(de.prototype),q.MediaStreamTrack="undefined"!==typeof D&&Object.keys(D.prototype);var ce=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection;q.RTCPeerConnection="undefined"!==typeof ce&&Object.keys(ce.prototype),window.DetectRTC=q,e.exports=q,o=[],n=function(){return q}.apply(t,o),void 0===n||(e.exports=n)}(),"undefined"!==typeof cordova&&(DetectRTC.isMobileDevice=!0,DetectRTC.browser.name="Chrome"),navigator&&navigator.userAgent&&-1!==navigator.userAgent.indexOf("Crosswalk")&&(DetectRTC.isMobileDevice=!0,DetectRTC.browser.name="Chrome"),window.addEventListener||(window.addEventListener=function(e,t,i){e.attachEvent&&e.attachEvent("on"+t,i)}),window.attachEventListener=function(e,t,i,o){e.addEventListener(t,i,o)};var y=window.MediaStream;function w(e,t){return(!e.session.audio||"two-way"!==e.session.audio)&&("Firefox"===DetectRTC.browser.name&&!1!==t||!("Chrome"!==DetectRTC.browser.name||DetectRTC.browser.version<50)&&(!0===typeof t||!("undefined"!==typeof t||!e.session.audio||!e.session.screen||e.session.video)&&(t=!0,!0)))}function C(e,t){return e&&e.getTracks?e.getTracks().filter((function(e){return e.kind===(t||"audio")})):[]}function S(){var e=!1;try{if("undefined"===typeof RTCRtpTransceiver)return!1;if(!("currentDirection"in RTCRtpTransceiver.prototype))return!1;var t=new T;try{t.addTransceiver("audio"),e=!0}catch(i){}t.close()}catch(i){e=!1}return e&&x()}function x(){var e=!1;try{var t=new T({sdpSemantics:"unified-plan"});try{var i=t.getConfiguration();e="unified-plan"==i.sdpSemantics||(i.sdpSemantics,!1)}catch(o){e=!1}}catch(o){e=!1}return e}function k(){if("undefined"!==typeof cordova&&"undefined"!==typeof cordova.plugins&&"undefined"!==typeof cordova.plugins.iosrtc){var e=cordova.plugins.iosrtc;window.webkitRTCPeerConnection=e.RTCPeerConnection,window.RTCSessionDescription=e.RTCSessionDescription,window.RTCIceCandidate=e.RTCIceCandidate,window.MediaStream=e.MediaStream,window.MediaStreamTrack=e.MediaStreamTrack,navigator.getUserMedia=navigator.webkitGetUserMedia=e.getUserMedia,e.debug.enable("iosrtc*"),"function"==typeof e.selectAudioOutput&&e.selectAudioOutput(window.iOSDefaultAudioOutputDevice||"speaker"),e.registerGlobals()}}"undefined"===typeof y&&"undefined"!==typeof webkitMediaStream&&(y=webkitMediaStream),"undefined"!==typeof y&&("stop"in y.prototype||(y.prototype.stop=function(){this.getTracks().forEach((function(e){e.stop()}))})),window.iOSDefaultAudioOutputDevice=window.iOSDefaultAudioOutputDevice||"speaker",document.addEventListener("deviceready",k,!1),k();var T,R={};function M(e){var t={OfferToReceiveAudio:!!e.OfferToReceiveAudio,OfferToReceiveVideo:!!e.OfferToReceiveVideo};return t}"undefined"!==typeof window.RTCPeerConnection?T=window.RTCPeerConnection:"undefined"!==typeof mozRTCPeerConnection?T=mozRTCPeerConnection:"undefined"!==typeof webkitRTCPeerConnection&&(T=webkitRTCPeerConnection);var E=window.RTCSessionDescription||window.mozRTCSessionDescription,P=window.RTCIceCandidate||window.mozRTCIceCandidate,D=window.MediaStreamTrack;function L(e){if("undefined"!==typeof window.RTCPeerConnection?T=window.RTCPeerConnection:"undefined"!==typeof mozRTCPeerConnection?T=mozRTCPeerConnection:"undefined"!==typeof webkitRTCPeerConnection&&(T=webkitRTCPeerConnection),E=window.RTCSessionDescription||window.mozRTCSessionDescription,P=window.RTCIceCandidate||window.mozRTCIceCandidate,D=window.MediaStreamTrack,!T)throw"WebRTC 1.0 (RTCPeerConnection) API are NOT available in this browser.";var t=e.rtcMultiConnection;this.extra=e.remoteSdp?e.remoteSdp.extra:t.extra,this.userid=e.userid,this.streams=[],this.channels=e.channels||[],this.connectionDescription=e.connectionDescription,this.addStream=function(e){t.addStream(e,i.userid)},this.removeStream=function(e){t.removeStream(e,i.userid)};var i=this;e.remoteSdp&&(this.connectionDescription=e.remoteSdp.connectionDescription);var o,n={};R.sdpConstraints=M({OfferToReceiveAudio:!0,OfferToReceiveVideo:!0});var a=!!e.renegotiatingPeer;e.remoteSdp&&(a=!!e.remoteSdp.renegotiatingPeer);var r=[];if(t.attachStreams.forEach((function(e){e&&r.push(e)})),a)o=e.peerRef;else{var s="all";(t.candidates.turn||t.candidates.relay)&&(t.candidates.stun||t.candidates.reflexive||t.candidates.host||(s="relay"));try{var d={iceServers:t.iceServers,iceTransportPolicy:t.iceTransportPolicy||s};"undefined"!==typeof t.iceCandidatePoolSize&&(d.iceCandidatePoolSize=t.iceCandidatePoolSize),"undefined"!==typeof t.bundlePolicy&&(d.bundlePolicy=t.bundlePolicy),"undefined"!==typeof t.rtcpMuxPolicy&&(d.rtcpMuxPolicy=t.rtcpMuxPolicy),t.sdpSemantics&&(d.sdpSemantics=t.sdpSemantics||"unified-plan"),t.iceServers&&t.iceServers.length||(d=null,t.optionalArgument=null),o=new T(d,t.optionalArgument)}catch(h){try{d={iceServers:t.iceServers};o=new T(d)}catch(h){o=new T}}}!o.getRemoteStreams&&o.getReceivers&&(o.getRemoteStreams=function(){var e=new y;return o.getReceivers().forEach((function(t){e.addTrack(t.track)})),[e]}),!o.getLocalStreams&&o.getSenders&&(o.getLocalStreams=function(){var e=new y;return o.getSenders().forEach((function(t){e.addTrack(t.track)})),[e]}),o.onicecandidate=function(n){if(n.candidate)t.trickleIce&&e.onLocalCandidate({candidate:n.candidate.candidate,sdpMid:n.candidate.sdpMid,sdpMLineIndex:n.candidate.sdpMLineIndex});else if(!t.trickleIce){var a=o.localDescription;e.onLocalSdp({type:a.type,sdp:a.sdp,remotePeerSdpConstraints:e.remotePeerSdpConstraints||!1,renegotiatingPeer:!!e.renegotiatingPeer||!1,connectionDescription:i.connectionDescription,dontGetRemoteStream:!!e.dontGetRemoteStream,extra:t?t.extra:{},streamsToShare:p})}},r.forEach((function(n){e.remoteSdp&&e.remoteSdp.remotePeerSdpConstraints&&e.remoteSdp.remotePeerSdpConstraints.dontGetRemoteStream||e.dontAttachLocalStream||(n=t.beforeAddingStream(n,i),n&&(o.getLocalStreams().forEach((function(e){n&&e.id==n.id&&(n=null)})),n&&n.getTracks&&n.getTracks().forEach((function(e){try{o.addTrack(e,n)}catch(h){}}))))})),o.oniceconnectionstatechange=o.onsignalingstatechange=function(){var n=i.extra;t.peers[i.userid]&&(n=t.peers[i.userid].extra||n),o&&(e.onPeerStateChanged({iceConnectionState:o.iceConnectionState,iceGatheringState:o.iceGatheringState,signalingState:o.signalingState,extra:n,userid:i.userid}),o&&o.iceConnectionState&&-1!==o.iceConnectionState.search(/closed|failed/gi)&&i.streams instanceof Array&&i.streams.forEach((function(e){var i=t.streamEvents[e.id]||{streamid:e.id,stream:e,type:"remote"};t.onstreamended(i)})))};var c={OfferToReceiveAudio:!!r.length,OfferToReceiveVideo:!!r.length};e.localPeerSdpConstraints&&(c=e.localPeerSdpConstraints),R.sdpConstraints=M(c);var l={};o.ontrack=function(t){if(t&&"track"===t.type)if(t.stream=t.streams[t.streams.length-1],t.stream.id||(t.stream.id=t.track.id),l[t.stream.id]&&"Safari"!==DetectRTC.browser.name)t.track&&(t.track.onended=function(){o&&o.onremovestream(t)});else{l[t.stream.id]=t.stream.id;var i={};e.remoteSdp&&e.remoteSdp.streamsToShare?i=e.remoteSdp.streamsToShare:e.streamsToShare&&(i=e.streamsToShare);var a=i[t.stream.id];a?(t.stream.isAudio=a.isAudio,t.stream.isVideo=a.isVideo,t.stream.isScreen=a.isScreen):(t.stream.isVideo=!!C(t.stream,"video").length,t.stream.isAudio=!t.stream.isVideo,t.stream.isScreen=!1),t.stream.streamid=t.stream.id,n[t.stream.id]=t.stream,e.onRemoteStream(t.stream),t.stream.getTracks().forEach((function(e){e.onended=function(){o&&o.onremovestream(t)}})),t.stream.onremovetrack=function(){o&&o.onremovestream(t)}}},o.onremovestream=function(t){t.stream.streamid=t.stream.id,n[t.stream.id]&&delete n[t.stream.id],e.onRemoteStreamRemoved(t.stream)},"function"!==typeof o.removeStream&&(o.removeStream=function(e){e.getTracks().forEach((function(t){o.removeTrack(t,e)}))}),this.addRemoteCandidate=function(e){o.addIceCandidate(new P(e))},this.addRemoteSdp=function(e,i){i=i||function(){},"Safari"!==DetectRTC.browser.name&&(e.sdp=t.processSdp(e.sdp)),o.setRemoteDescription(new E(e)).then(i,(function(o){t.enableLogs&&console.error("setRemoteDescription failed","\n",o,"\n",e.sdp),i()})).catch((function(o){t.enableLogs&&console.error("setRemoteDescription failed","\n",o,"\n",e.sdp),i()}))};var u=!0;function m(t){t.binaryType="arraybuffer",t.onmessage=function(t){e.onDataChannelMessage(t.data)},t.onopen=function(){e.onDataChannelOpened(t)},t.onerror=function(t){e.onDataChannelError(t)},t.onclose=function(t){e.onDataChannelClosed(t)},t.internalSend=t.send,t.send=function(e){"open"===t.readyState&&t.internalSend(e)},o.channel=t}e.remoteSdp&&(u=!1),this.createDataChannel=function(){var e=o.createDataChannel("sctp",{});m(e)},!0!==t.session.data||a||(u?this.createDataChannel():o.ondatachannel=function(e){var t=e.channel;m(t)}),this.enableDisableVideoEncoding=function(e){var t;if(o.getSenders().forEach((function(e){t||"video"!==e.track.kind||(t=e)})),t&&t.getParameters){var i=t.getParameters();i.encodings[1]&&(i.encodings[1].active=!!e),i.encodings[2]&&(i.encodings[2].active=!!e),t.setParameters(i)}},e.remoteSdp&&(e.remoteSdp.remotePeerSdpConstraints&&(c=e.remoteSdp.remotePeerSdpConstraints),R.sdpConstraints=M(c),this.addRemoteSdp(e.remoteSdp,(function(){f("createAnswer")}))),"two-way"!=t.session.audio&&"two-way"!=t.session.video&&"two-way"!=t.session.screen||(R.sdpConstraints=M({OfferToReceiveAudio:"two-way"==t.session.audio||e.remoteSdp&&e.remoteSdp.remotePeerSdpConstraints&&e.remoteSdp.remotePeerSdpConstraints.OfferToReceiveAudio,OfferToReceiveVideo:"two-way"==t.session.video||"two-way"==t.session.screen||e.remoteSdp&&e.remoteSdp.remotePeerSdpConstraints&&e.remoteSdp.remotePeerSdpConstraints.OfferToReceiveAudio}));var p={};function f(n){o[n](R.sdpConstraints).then((function(n){"Safari"!==DetectRTC.browser.name&&(n.sdp=t.processSdp(n.sdp)),o.setLocalDescription(n).then((function(){t.trickleIce&&(e.onLocalSdp({type:n.type,sdp:n.sdp,remotePeerSdpConstraints:e.remotePeerSdpConstraints||!1,renegotiatingPeer:!!e.renegotiatingPeer||!1,connectionDescription:i.connectionDescription,dontGetRemoteStream:!!e.dontGetRemoteStream,extra:t?t.extra:{},streamsToShare:p}),t.onSettingLocalDescription(i))}),(function(e){t.enableLogs&&console.error("setLocalDescription error",e)}))}),(function(e){t.enableLogs&&console.error("sdp-error",e)}))}o.getLocalStreams().forEach((function(e){p[e.streamid]={isAudio:!!e.isAudio,isVideo:!!e.isVideo,isScreen:!!e.isScreen}})),u&&f("createOffer"),o.nativeClose=o.close,o.close=function(){if(o){try{o.nativeClose!==o.close&&o.nativeClose()}catch(h){}o=null,i.peer=null}},this.peer=o}var U=function(){function e(e,o){var n=i(e);return n.videoCodecNumbers?("vp8"===o&&n.vp8LineNumber===n.videoCodecNumbers[0]||"vp9"===o&&n.vp9LineNumber===n.videoCodecNumbers[0]||"h264"===o&&n.h264LineNumber===n.videoCodecNumbers[0]||(e=t(e,o,n)),e):e}function t(e,t,i,o){var n="";if("vp8"===t){if(!i.vp8LineNumber)return e;n=i.vp8LineNumber}if("vp9"===t){if(!i.vp9LineNumber)return e;n=i.vp9LineNumber}if("h264"===t){if(!i.h264LineNumber)return e;n=i.h264LineNumber}var a=i.videoCodecNumbersOriginal.split("SAVPF")[0]+"SAVPF ",r=[n];return o&&(r=[]),i.videoCodecNumbers.forEach((function(e){e!==n&&r.push(e)})),a+=r.join(" "),e=e.replace(i.videoCodecNumbersOriginal,a),e}function i(e){var t={};return e.split("\n").forEach((function(e){0===e.indexOf("m=video")&&(t.videoCodecNumbers=[],e.split("SAVPF")[1].split(" ").forEach((function(i){i=i.trim(),i&&i.length&&(t.videoCodecNumbers.push(i),t.videoCodecNumbersOriginal=e)}))),-1===e.indexOf("VP8/90000")||t.vp8LineNumber||(t.vp8LineNumber=e.replace("a=rtpmap:","").split(" ")[0]),-1===e.indexOf("VP9/90000")||t.vp9LineNumber||(t.vp9LineNumber=e.replace("a=rtpmap:","").split(" ")[0]),-1===e.indexOf("H264/90000")||t.h264LineNumber||(t.h264LineNumber=e.replace("a=rtpmap:","").split(" ")[0])})),t}function o(e){var o=i(e);return e=t(e,"vp9",o,!0),e=t(e,"vp8",o,!0),e}function n(e){if(!e||"string"!==typeof e)throw"Invalid arguments.";return e=e.replace("a=rtcp-fb:126 nack\r\n",""),e=e.replace("a=rtcp-fb:126 nack pli\r\n","a=rtcp-fb:126 pli\r\n"),e=e.replace("a=rtcp-fb:97 nack\r\n",""),e=e.replace("a=rtcp-fb:97 nack pli\r\n","a=rtcp-fb:97 pli\r\n"),e}function a(e,t){if(t&&t.getSenders&&t.getSenders().length){if(!e||"string"!==typeof e)throw"Invalid arguments.";t.getSenders().forEach((function(t){for(var i=t.getParameters(),o=0;o<i.codecs.length;o++)if(i.codecs[o].mimeType==e){i.codecs.unshift(i.codecs.splice(o,1));break}t.setParameters(i)}))}}function r(e){return e.replace(/m=audio ([0-9]+) RTP\/SAVPF ([0-9 ]*)/g,"m=audio $1 RTP/SAVPF 9")}function s(e,t,i){return t?("undefined"!==typeof isFirefox&&isFirefox||(i&&(t.screen?t.screen<300&&console.warn("It seems that you are using wrong bandwidth value for screen. Screen sharing is expected to fail."):console.warn("It seems that you are not using bandwidth for screen. Screen sharing is expected to fail.")),t.screen&&i&&(e=e.replace(/b=AS([^\r\n]+\r\n)/g,""),e=e.replace(/a=mid:video\r\n/g,"a=mid:video\r\nb=AS:"+t.screen+"\r\n")),(t.audio||t.video)&&(e=e.replace(/b=AS([^\r\n]+\r\n)/g,"")),t.audio&&(e=e.replace(/a=mid:audio\r\n/g,"a=mid:audio\r\nb=AS:"+t.audio+"\r\n")),t.screen?e=e.replace(/a=mid:video\r\n/g,"a=mid:video\r\nb=AS:"+t.screen+"\r\n"):t.video&&(e=e.replace(/a=mid:video\r\n/g,"a=mid:video\r\nb=AS:"+t.video+"\r\n"))),e):e}function d(e,t,i){return c(e,0,-1,t,i)}function c(e,t,i,o,n){for(var a=-1!==i?i:e.length,r=t;r<a;++r)if(0===e[r].indexOf(o)&&(!n||-1!==e[r].toLowerCase().indexOf(n.toLowerCase())))return r;return null}function l(e){var t=new RegExp("a=rtpmap:(\\d+) \\w+\\/\\d+"),i=e.match(t);return i&&2===i.length?i[1]:null}function u(e,t){t=t||{};var i,o=t.min,n=t.max,a=e.split("\r\n"),r=d(a,"a=rtpmap","VP8/90000");if(r&&(i=l(a[r])),!i)return e;var s,c=d(a,"a=rtpmap","rtx/90000");if(c&&(s=l(a[c])),!c)return e;var u=d(a,"a=fmtp:"+s.toString());if(null!==u){var m="\r\n";m+="a=fmtp:"+i+" x-google-min-bitrate="+(o||"228")+"; x-google-max-bitrate="+(n||"228"),a[u]=a[u].concat(m),e=a.join("\r\n")}return e}function m(e,t){t=t||{};var i,o=e.split("\r\n"),n=d(o,"a=rtpmap","opus/48000");if(n&&(i=l(o[n])),!i)return e;var a=d(o,"a=fmtp:"+i.toString());if(null===a)return e;var r="";return r+="; stereo="+("undefined"!=typeof t.stereo?t.stereo:"1"),r+="; sprop-stereo="+("undefined"!=typeof t["sprop-stereo"]?t["sprop-stereo"]:"1"),"undefined"!=typeof t.maxaveragebitrate&&(r+="; maxaveragebitrate="+(t.maxaveragebitrate||1048576)),"undefined"!=typeof t.maxplaybackrate&&(r+="; maxplaybackrate="+(t.maxplaybackrate||1048576)),"undefined"!=typeof t.cbr&&(r+="; cbr="+("undefined"!=typeof t.cbr?t.cbr:"1")),"undefined"!=typeof t.useinbandfec&&(r+="; useinbandfec="+t.useinbandfec),"undefined"!=typeof t.usedtx&&(r+="; usedtx="+t.usedtx),"undefined"!=typeof t.maxptime&&(r+="\r\na=maxptime:"+t.maxptime),o[a]=o[a].concat(r),e=o.join("\r\n"),e}function p(e){for(var t=e.split("\r\n"),i=null,o=0;o<t.length;o++)if(-1!==t[o].search("opus/48000")){var n=extractSdp(t[o],/:(\d+) opus\/48000/i);break}for(o=0;o<t.length;o++)if(-1!==t[o].search("a=fmtp")){var a=extractSdp(t[o],/a=fmtp:(\d+)/);if(a===n){i=o;break}}return null===i||(t[i]=t[i].concat("; stereo=1; sprop-stereo=1"),e=t.join("\r\n")),e}return{removeVPX:o,disableNACK:n,prioritize:a,removeNonG722:r,setApplicationSpecificBandwidth:function(e,t,i){return s(e,t,i)},setVideoBitrates:function(e,t){return u(e,t)},setOpusAttributes:function(e,t){return m(e,t)},preferVP9:function(t){return e(t,"vp9")},preferCodec:e,forceStereoAudio:p}}();window.BandwidthHandler=U;var A=function(){function e(e,t){var i=t.candidate,o=e.candidates,n=o.stun,a=o.turn;if(_(o.reflexive)||(n=o.reflexive),_(o.relay)||(a=o.relay),(o.host||!i.match(/typ host/g))&&(a||!i.match(/typ relay/g))&&(n||!i.match(/typ srflx/g))){var r=e.iceProtocols;if((r.udp||!i.match(/ udp /g))&&(r.tcp||!i.match(/ tcp /g)))return e.enableLogs&&console.debug("Your candidate pairs:",i),{candidate:i,sdpMid:t.sdpMid,sdpMLineIndex:t.sdpMLineIndex}}}return{processCandidates:e}}(),$=function(){function e(e){var t=[{urls:["stun:stun.l.google.com:19302","stun:stun1.l.google.com:19302","stun:stun2.l.google.com:19302","stun:stun.l.google.com:19302?transport=udp"]}];return t}return{getIceServers:e}}();function I(e,t){e.mandatory&&e.mandatory.chromeMediaSource||e.mozMediaSource||e.mediaSource?t.isScreen=!0:e.video?t.isVideo=!0:e.audio&&(t.isAudio=!0)}function O(e){if(!0!==currentUserMediaRequest.mutex){currentUserMediaRequest.mutex=!0;var t=JSON.stringify(e.localMediaConstraints);if(currentUserMediaRequest.streams[t])r(currentUserMediaRequest.streams[t].stream,!0);else{var i=!!/BB10|BlackBerry/i.test(navigator.userAgent||"");if(i||"undefined"===typeof navigator.mediaDevices||"function"!==typeof navigator.mediaDevices.getUserMedia)return navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia,void navigator.getUserMedia(e.localMediaConstraints,(function(e){e.streamid=e.streamid||e.id||p(),e.idInstance=t,r(e)}),(function(t){e.onLocalMediaError(t,e.localMediaConstraints)}));if("undefined"===typeof navigator.mediaDevices){navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia;var o,n,a=function(){};navigator.mediaDevices={getUserMedia:function(e){return navigator.getUserMedia(e,(function(e){e(stream),o=stream}),(function(e){a(e),n=e})),{then:function(e){if(!o)return e,{then:function(e){n?e(n):a=e}};e(o)}}}}}if(!0===e.localMediaConstraints.isScreen){if(navigator.mediaDevices.getDisplayMedia)navigator.mediaDevices.getDisplayMedia(e.localMediaConstraints).then((function(e){e.streamid=e.streamid||e.id||p(),e.idInstance=t,r(e)})).catch((function(t){e.onLocalMediaError(t,e.localMediaConstraints)}));else{if(!navigator.getDisplayMedia)throw new Error("getDisplayMedia API is not availabe in this browser.");navigator.getDisplayMedia(e.localMediaConstraints).then((function(e){e.streamid=e.streamid||e.id||p(),e.idInstance=t,r(e)})).catch((function(t){e.onLocalMediaError(t,e.localMediaConstraints)}))}return}navigator.mediaDevices.getUserMedia(e.localMediaConstraints).then((function(e){e.streamid=e.streamid||e.id||p(),e.idInstance=t,r(e)})).catch((function(t){e.onLocalMediaError(t,e.localMediaConstraints)}))}}else currentUserMediaRequest.queueRequests.push(e);function r(i,o){I(e.localMediaConstraints,i);var n="ended";"oninactive"in i&&(n="inactive"),i.addEventListener(n,(function(){delete currentUserMediaRequest.streams[t],currentUserMediaRequest.mutex=!1,currentUserMediaRequest.queueRequests.indexOf(e)&&(delete currentUserMediaRequest.queueRequests[currentUserMediaRequest.queueRequests.indexOf(e)],currentUserMediaRequest.queueRequests=v(currentUserMediaRequest.queueRequests))}),!1),currentUserMediaRequest.streams[t]={stream:i},currentUserMediaRequest.mutex=!1,currentUserMediaRequest.queueRequests.length&&O(currentUserMediaRequest.queueRequests.shift()),e.onGettingLocalMedia(i,o)}}window.currentUserMediaRequest={streams:[],mutex:!1,queueRequests:[],remove:function(e){this.mutex=!1;var t=this.streams[e];if(t){t=t.stream;var i=t.currentUserMediaRequestOptions;this.queueRequests.indexOf(i)&&(delete this.queueRequests[this.queueRequests.indexOf(i)],this.queueRequests=v(this.queueRequests)),this.streams[e].stream=null,delete this.streams[e]}}};var B=function(){function e(e){if(e)return"string"===typeof e||"undefined"===typeof e?e:e.audio&&e.video?null:e.audio?"audio":e.video?"video":void 0}function t(t,o,n){if(t&&t.addEventListener){if("undefined"==typeof o||1==o){var a="ended";"oninactive"in t&&(a="inactive"),t.addEventListener(a,(function(){B.onSyncNeeded(this.streamid,a)}),!1)}t.mute=function(i,a){i=e(i),"undefined"!==typeof a&&(o=a),"undefined"!=typeof i&&"audio"!=i||C(t,"audio").forEach((function(e){e.enabled=!1,n.streamEvents[t.streamid].isAudioMuted=!0})),"undefined"!=typeof i&&"video"!=i||C(t,"video").forEach((function(e){e.enabled=!1})),"undefined"!=typeof o&&1!=o||B.onSyncNeeded(t.streamid,"mute",i),n.streamEvents[t.streamid].muteType=i||"both",l(t,"mute",i)},t.unmute=function(i,a){i=e(i),"undefined"!==typeof a&&(o=a),r(),"undefined"!=typeof i&&"audio"!=i||C(t,"audio").forEach((function(e){e.enabled=!0,n.streamEvents[t.streamid].isAudioMuted=!1})),"undefined"!=typeof i&&"video"!=i||(C(t,"video").forEach((function(e){e.enabled=!0})),"undefined"!==typeof i&&"video"==i&&n.streamEvents[t.streamid].isAudioMuted&&function e(i){i||(i=0),i++,i<100&&n.streamEvents[t.streamid].isAudioMuted&&(t.mute("audio"),setTimeout((function(){e(i)}),50))}()),"undefined"!=typeof o&&1!=o||B.onSyncNeeded(t.streamid,"unmute",i),n.streamEvents[t.streamid].unmuteType=i||"both",l(t,"unmute",i)}}function r(){if(n.streamEvents[t.streamid].mediaElement){var e=n.streamEvents[t.streamid].mediaElement;e.volume=0,i(200,5,(function(){try{e.volume+=.2}catch(t){e.volume=1}}))}}}function i(e,t,o,n){n=(n||0)+1,n>=t||setTimeout((function(){o(),i(e,t,o,n)}),e)}return{setHandlers:t,onSyncNeeded:function(e,t,i){}}}();function F(e){var t={};function i(i,o,n){var a=i.uuid;if(t[a]||(t[a]=[]),t[a].push(i.message),i.last){var r=t[a].join("");i.isobject&&(r=JSON.parse(r));var s=(new Date).getTime(),d=s-i.sendingTime,c={data:r,userid:o,extra:n,latency:d};e.autoTranslateText?(c.original=c.data,e.Translator.TranslateText(c.data,(function(t){c.data=t,e.onmessage(c)}))):e.onmessage(c),delete t[a]}}return{receive:i}}var N={send:function(e){var t=e.connection,i=e.channel,o=e.remoteUserId,n=e.text,a=t.chunkSize||1e3,r="",s=!1;b(n)||(s=!0,n=JSON.stringify(n));var d=p(),c=(new Date).getTime();function l(e,n){var u={type:"text",uuid:d,sendingTime:c};e&&(n=e,u.packets=parseInt(n.length/a)),n.length>a?u.message=n.slice(0,a):(u.message=n,u.last=!0,u.isobject=s),i.send(u,o),r=n.slice(u.message.length),r.length&&setTimeout((function(){l(null,r)}),t.chunkInterval||100)}l(n)}},V=function(){function e(e){var t={};function i(e,t){if(-1!==e.position){var i=+e.position.toFixed(2).split(".")[1]||100;t.innerHTML=i+"%"}}e.onFileStart=function(i){var o=document.createElement("div");if(o.title=i.name,o.innerHTML="<label>0%</label> <progress></progress>",i.remoteUserId&&(o.innerHTML+=" (Sharing with:"+i.remoteUserId+")"),e.filesContainer||(e.filesContainer=document.body||document.documentElement),e.filesContainer.insertBefore(o,e.filesContainer.firstChild),!i.remoteUserId)return t[i.uuid]={div:o,progress:o.querySelector("progress"),label:o.querySelector("label")},void(t[i.uuid].progress.max=i.maxChunks);t[i.uuid]||(t[i.uuid]={}),t[i.uuid][i.remoteUserId]={div:o,progress:o.querySelector("progress"),label:o.querySelector("label")},t[i.uuid][i.remoteUserId].progress.max=i.maxChunks},e.onFileProgress=function(e){var o=t[e.uuid];o&&(e.remoteUserId&&(o=t[e.uuid][e.remoteUserId],!o)||(o.progress.value=e.currentPosition||e.maxChunks||o.progress.max,i(o.progress,o.label)))},e.onFileEnd=function(e){var i=t[e.uuid];if(i){if(!e.remoteUserId||(i=t[e.uuid][e.remoteUserId],i)){var o=i.div;-1!=e.type.indexOf("image")?o.innerHTML='<a href="'+e.url+'" download="'+e.name+'">Download <strong style="color:red;">'+e.name+'</strong> </a><br /><img src="'+e.url+'" title="'+e.name+'" style="max-width: 80%;">':o.innerHTML='<a href="'+e.url+'" download="'+e.name+'">Download <strong style="color:red;">'+e.name+'</strong> </a><br /><iframe src="'+e.url+'" title="'+e.name+'" style="width: 80%;border: 0;height: inherit;margin-top:1em;"></iframe>'}}else console.error("No such progress-helper element exist.",e)}}return{handle:e}}(),H=function(){function e(e){e.autoTranslateText=!1,e.language="en",e.googKey="AIzaSyCgB5hmFY74WYB-EoWkhr9cAGr6TiTHrEE",e.Translator={TranslateText:function(t,i){var o=document.createElement("script");o.type="text/javascript";var n=encodeURIComponent(t),a="method"+e.token();window[a]=function(e){e.data&&e.data.translations[0]&&i?i(e.data.translations[0].translatedText):e.error&&"Daily Limit Exceeded"===e.error.message?console.error('Text translation failed. Error message: "Daily Limit Exceeded."'):e.error?console.error(e.error.message):console.error(e)};var r="https://www.googleapis.com/language/translate/v2?key="+e.googKey+"&target="+(e.language||"en-US")+"&callback=window."+a+"&q="+n;o.src=r,document.getElementsByTagName("head")[0].appendChild(o)},getListOfLanguages:function(t){var i=new XMLHttpRequest;i.onreadystatechange=function(){if(i.readyState==XMLHttpRequest.DONE){var e=JSON.parse(i.responseText);if(e&&e.data&&e.data.languages)return void t(e.data.languages);if(e.error&&"Daily Limit Exceeded"===e.error.message)return void console.error('Text translation failed. Error message: "Daily Limit Exceeded."');if(e.error)return void console.error(e.error.message);console.error(e)}};var o="https://www.googleapis.com/language/translate/v2/languages?key="+e.googKey+"&target=en";i.open("GET",o,!0),i.send(null)}}}return{handle:e}}();(function(e){r=r||{useDefaultDevices:!0},e.channel=e.sessionid=(a||location.href.replace(/\/|:|#|\?|\$|\^|%|\.|`|~|!|\+|@|\[|\||]|\|*. /g,"").split("\n").join("").split("\r").join(""))+"";var t=new c(e),i={};function o(t){e.deletePeer(t)}function n(t){if(e.socketAutoReConnect=!0,e.socket)t&&t(e.socket);else{if("undefined"===typeof d)if("undefined"!==typeof FirebaseConnection)window.SocketConnection=FirebaseConnection;else{if("undefined"===typeof PubNubConnection)throw"SocketConnection.js seems missed.";window.SocketConnection=PubNubConnection}new d(e,(function(i){t&&t(e.socket)}))}}function s(i,o){e.socket.emit("join-room",{sessionid:e.sessionid,session:e.session,mediaConstraints:e.mediaConstraints,sdpConstraints:e.sdpConstraints,streams:v(),extra:e.extra,password:"undefined"!==typeof e.password&&"object"!==typeof e.password?e.password:""},(function(n,a){if(!0===n){if(e.enableLogs&&console.log("isRoomJoined: ",n," roomid: ",e.sessionid),e.peers[e.sessionid])return;t.onNegotiationNeeded(i)}!1===n&&e.enableLogs&&console.warn("isRoomJoined: ",a," roomid: ",e.sessionid),o(n,e.sessionid,a)}))}function l(t){e.enableLogs&&console.log("Sending open-room signal to socket.io"),e.waitingForLocalMedia=!1,e.socket.emit("open-room",{sessionid:e.sessionid,session:e.session,mediaConstraints:e.mediaConstraints,sdpConstraints:e.sdpConstraints,streams:v(),extra:e.extra,identifier:e.publicRoomIdentifier,password:"undefined"!==typeof e.password&&"object"!==typeof e.password?e.password:""},(function(i,o){!0===i&&(e.enableLogs&&console.log("isRoomOpened: ",i," roomid: ",e.sessionid),t(i,e.sessionid)),!1===i&&(e.enableLogs&&console.warn("isRoomOpened: ",o," roomid: ",e.sessionid),t(i,e.sessionid,o))}))}function v(){try{return e.streamEvents.selectAll("local").map((function(e){return{streamid:e.streamid,tracks:e.stream.getTracks().length}}))}catch(t){return[]}}function _(i,o){if(e.dontCaptureUserMedia||i.isDataOnly)o();else{var n={};i.localPeerSdpConstraints.OfferToReceiveAudio&&(n.audio=e.mediaConstraints.audio),i.localPeerSdpConstraints.OfferToReceiveVideo&&(n.video=e.mediaConstraints.video);var a=i.session||e.session;a.oneway&&"two-way"!==a.audio&&"two-way"!==a.video&&"two-way"!==a.screen?o():(a.oneway&&a.audio&&"two-way"===a.audio&&(a={audio:!0}),(a.audio||a.video||a.screen)&&(a.screen?"Edge"===DetectRTC.browser.name?navigator.getDisplayMedia({video:!0,audio:w(e)}).then((function(i){i.isScreen=!0,t.onGettingLocalMedia(i),!a.audio&&!a.video||w(e)?o(i):e.invokeGetUserMedia(null,o)}),(function(e){console.error("Unable to capture screen on Edge. HTTPs and version 17+ is required.")})):e.invokeGetUserMedia({audio:w(e),video:!0,isScreen:!0},!a.audio&&!a.video||w(e)?o:e.invokeGetUserMedia(null,o)):(a.audio||a.video)&&e.invokeGetUserMedia(null,o,a)))}}function b(t,i){t?(i.audio&&C(t,"audio").forEach((function(e){e.applyConstraints(i.audio)})),i.video&&C(t,"video").forEach((function(e){e.applyConstraints(i.video)}))):e.enableLogs&&console.error("No stream to applyConstraints.")}function x(i,o,n){o?t.replaceTrack(i,o,n):e.peers.getAllParticipants().forEach((function(e){t.replaceTrack(i,e,n)}))}t.onGettingLocalMedia=function(t,o){if(o=o||function(){},i[t.streamid])o();else{i[t.streamid]=!0;try{t.type="local"}catch(n){}e.setStreamEndHandler(t),f(t,(function(i){i.id=t.streamid,i.muted=!0,i.volume=0,-1===e.attachStreams.indexOf(t)&&e.attachStreams.push(t),"undefined"!==typeof B&&B.setHandlers(t,!0,e);var a=0===t.getAudioTracks().filter((function(e){return e.enabled})).length;e.streamEvents[t.streamid]={stream:t,type:"local",mediaElement:i,userid:e.userid,extra:e.extra,streamid:t.streamid,isAudioMuted:a};try{u(e,e.streamEvents[t.streamid]),m(e,e.streamEvents[t.streamid]),e.onstream(e.streamEvents[t.streamid])}catch(n){}o()}),e)}},t.onGettingRemoteMedia=function(t,i){try{t.type="remote"}catch(o){}e.setStreamEndHandler(t,"remote-stream"),f(t,(function(o){o.id=t.streamid,"undefined"!==typeof B&&B.setHandlers(t,!1,e),e.streamEvents[t.streamid]={stream:t,type:"remote",userid:i,extra:e.peers[i]?e.peers[i].extra:{},mediaElement:o,streamid:t.streamid},m(e,e.streamEvents[t.streamid]),e.onstream(e.streamEvents[t.streamid])}),e)},t.onRemovingRemoteMedia=function(t,i){var o=e.streamEvents[t.streamid];o||(o={stream:t,type:"remote",userid:i,extra:e.peers[i]?e.peers[i].extra:{},streamid:t.streamid,mediaElement:e.streamEvents[t.streamid]?e.streamEvents[t.streamid].mediaElement:null}),e.peersBackup[o.userid]&&(o.extra=e.peersBackup[o.userid].extra),e.onstreamended(o),delete e.streamEvents[t.streamid]},t.onNegotiationNeeded=function(t,i,o){o=o||function(){},i=i||t.remoteUserId,t=t||"";var a={remoteUserId:i,message:t,sender:e.userid};t.remoteUserId&&t.message&&t.sender&&(a=t),n((function(){e.socket.emit(e.socketMessageEvent,a,o)}))},t.onUserLeft=o,t.disconnectWith=function(t,i){e.socket&&e.socket.emit("disconnect-with",t,i||function(){}),e.deletePeer(t)},e.socketOptions={transport:"polling"},e.openOrJoin=function(t,i){i=i||function(){},e.checkPresence(t,(function(t,o){if(t){e.sessionid=o;var n=!1,a=!1,r=!!e.session.oneway,d=g(e.session);a={OfferToReceiveAudio:e.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:e.sdpConstraints.mandatory.OfferToReceiveVideo},n={OfferToReceiveAudio:r?!!e.session.audio:e.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:r?!!e.session.video||!!e.session.screen:e.sdpConstraints.mandatory.OfferToReceiveVideo};var c={remoteUserId:e.sessionid,message:{newParticipationRequest:!0,isOneWay:r,isDataOnly:d,localPeerSdpConstraints:n,remotePeerSdpConstraints:a},sender:e.userid};_(c.message,(function(){s(c,i)}))}else e.waitingForLocalMedia=!0,e.isInitiator=!0,e.sessionid=o||e.sessionid,g(e.session)?l(i):e.captureUserMedia((function(){l(i)}))}))},e.waitingForLocalMedia=!1,e.open=function(t,i){i=i||function(){},e.waitingForLocalMedia=!0,e.isInitiator=!0,e.sessionid=t||e.sessionid,n((function(){g(e.session)?l(i):e.captureUserMedia((function(){l(i)}))}))},e.peersBackup={},e.deletePeer=function(t){if(t&&e.peers[t]){var i={userid:t,extra:e.peers[t]?e.peers[t].extra:{}};if(e.peersBackup[i.userid]&&(i.extra=e.peersBackup[i.userid].extra),e.onleave(i),e.peers[t]){e.peers[t].streams.forEach((function(e){e.stop()}));var o=e.peers[t].peer;if(o&&"closed"!==o.iceConnectionState)try{o.close()}catch(n){}e.peers[t]&&(e.peers[t].peer=null,delete e.peers[t])}}},e.rejoin=function(t){if(!e.isInitiator&&t&&Object.keys(t).length){var i={};e.peers[t.remoteUserId]&&(i=e.peers[t.remoteUserId].extra,e.deletePeer(t.remoteUserId)),t&&t.remoteUserId&&(e.join(t.remoteUserId),e.onReConnecting({userid:t.remoteUserId,extra:i}))}},e.join=function(t,i){e.sessionid=!!t&&(t.sessionid||t.remoteUserId||t)||e.sessionid,e.sessionid+="";var o=!1,a=!1,r=!1,d=!1;if(t&&t.session||!t||"string"===typeof t){var c=t&&t.session||e.session;r=!!c.oneway,d=g(c),a={OfferToReceiveAudio:e.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:e.sdpConstraints.mandatory.OfferToReceiveVideo},o={OfferToReceiveAudio:r?!!e.session.audio:e.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:r?!!e.session.video||!!e.session.screen:e.sdpConstraints.mandatory.OfferToReceiveVideo}}i=i||{};var l=function(){};"function"===typeof i&&(l=i,i={}),"undefined"!==typeof i.localPeerSdpConstraints&&(o=i.localPeerSdpConstraints),"undefined"!==typeof i.remotePeerSdpConstraints&&(a=i.remotePeerSdpConstraints),"undefined"!==typeof i.isOneWay&&(r=i.isOneWay),"undefined"!==typeof i.isDataOnly&&(d=i.isDataOnly);var u={remoteUserId:e.sessionid,message:{newParticipationRequest:!0,isOneWay:r,isDataOnly:d,localPeerSdpConstraints:o,remotePeerSdpConstraints:a},sender:e.userid};return _(u.message,(function(){n((function(){s(u,l)}))})),u},e.publicRoomIdentifier="",e.getUserMedia=e.captureUserMedia=function(i,o){i=i||function(){};var n=o||e.session;e.dontCaptureUserMedia||g(n)?i():(n.audio||n.video||n.screen)&&(n.screen?"Edge"===DetectRTC.browser.name?navigator.getDisplayMedia({video:!0,audio:w(e)}).then((function(a){if(a.isScreen=!0,t.onGettingLocalMedia(a),!n.audio&&!n.video||w(e))i(a);else{var r={};for(var s in n)"screen"!==s&&(r[s]=n[s]);e.invokeGetUserMedia(o,i,r)}}),(function(e){console.error("Unable to capture screen on Edge. HTTPs and version 17+ is required.")})):e.invokeGetUserMedia({audio:w(e),video:!0,isScreen:!0},(function(t){if(!n.audio&&!n.video||w(e))i(t);else{var a={};for(var r in n)"screen"!==r&&(a[r]=n[r]);e.invokeGetUserMedia(o,i,a)}})):(n.audio||n.video)&&e.invokeGetUserMedia(o,i,n))},e.onbeforeunload=function(i,o){e.closeBeforeUnload&&(e.peers.getAllParticipants().forEach((function(i){t.onNegotiationNeeded({userLeft:!0},i),e.peers[i]&&e.peers[i].peer&&e.peers[i].peer.close(),delete e.peers[i]})),o||e.closeSocket(),e.isInitiator=!1)},window.ignoreBeforeUnload?e.closeBeforeUnload=!1:(e.closeBeforeUnload=!0,window.addEventListener("beforeunload",e.onbeforeunload,!1)),e.userid=p(),e.changeUserId=function(t,i){i=i||function(){},e.userid=t||p(),e.socket.emit("changed-uuid",e.userid,i)},e.extra={},e.attachStreams=[],e.session={audio:!0,video:!0},e.enableFileSharing=!1,e.bandwidth={screen:!1,audio:!1,video:!1},e.codecs={audio:"opus",video:"VP9"},e.processSdp=function(t){return S()||"Safari"===DetectRTC.browser.name?t:("VP8"===e.codecs.video.toUpperCase()&&(t=U.preferCodec(t,"vp8")),"VP9"===e.codecs.video.toUpperCase()&&(t=U.preferCodec(t,"vp9")),"H264"===e.codecs.video.toUpperCase()&&(t=U.preferCodec(t,"h264")),"G722"===e.codecs.audio&&(t=U.removeNonG722(t)),"Firefox"===DetectRTC.browser.name||((e.bandwidth.video||e.bandwidth.screen)&&(t=U.setApplicationSpecificBandwidth(t,e.bandwidth,!!e.session.screen)),e.bandwidth.video&&(t=U.setVideoBitrates(t,{min:8*e.bandwidth.video*1024,max:8*e.bandwidth.video*1024})),e.bandwidth.audio&&(t=U.setOpusAttributes(t,{maxaveragebitrate:8*e.bandwidth.audio*1024,maxplaybackrate:8*e.bandwidth.audio*1024,stereo:1,maxptime:3}))),t)},"undefined"!==typeof U&&(e.BandwidthHandler=e.CodecsHandler=U),e.mediaConstraints={audio:{mandatory:{},optional:e.bandwidth.audio?[{bandwidth:8*e.bandwidth.audio*1024||1048576}]:[]},video:{mandatory:{},optional:e.bandwidth.video?[{bandwidth:8*e.bandwidth.video*1024||1048576},{facingMode:"user"}]:[{facingMode:"user"}]}},"Firefox"===DetectRTC.browser.name&&(e.mediaConstraints={audio:!0,video:!0}),r.useDefaultDevices||DetectRTC.isMobileDevice||DetectRTC.load((function(){var t,i;if(DetectRTC.MediaDevices.forEach((function(o){"audioinput"===o.kind&&!1!==e.mediaConstraints.audio&&(t=o),"videoinput"===o.kind&&!1!==e.mediaConstraints.video&&(i=o)})),t){if("Firefox"===DetectRTC.browser.name)return void(!0!==e.mediaConstraints.audio?e.mediaConstraints.audio.deviceId=t.id:e.mediaConstraints.audio={deviceId:t.id});1==e.mediaConstraints.audio&&(e.mediaConstraints.audio={mandatory:{},optional:[]}),e.mediaConstraints.audio.optional||(e.mediaConstraints.audio.optional=[]);var o=[{sourceId:t.id}];e.mediaConstraints.audio.optional=o.concat(e.mediaConstraints.audio.optional)}if(i){if("Firefox"===DetectRTC.browser.name)return void(!0!==e.mediaConstraints.video?e.mediaConstraints.video.deviceId=i.id:e.mediaConstraints.video={deviceId:i.id});1==e.mediaConstraints.video&&(e.mediaConstraints.video={mandatory:{},optional:[]}),e.mediaConstraints.video.optional||(e.mediaConstraints.video.optional=[]);o=[{sourceId:i.id}];e.mediaConstraints.video.optional=o.concat(e.mediaConstraints.video.optional)}})),e.sdpConstraints={mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0},optional:[{VoiceActivityDetection:!1}]},e.sdpSemantics=null,e.iceCandidatePoolSize=null,e.bundlePolicy=null,e.rtcpMuxPolicy=null,e.iceTransportPolicy=null,e.optionalArgument={optional:[{DtlsSrtpKeyAgreement:!0},{googImprovedWifiBwe:!0},{googScreencastMinBitrate:300},{googIPv6:!0},{googDscp:!0},{googCpuUnderuseThreshold:55},{googCpuOveruseThreshold:85},{googSuspendBelowMinBitrate:!0},{googCpuOveruseDetection:!0}],mandatory:{}},e.iceServers=$.getIceServers(e),e.candidates={host:!0,stun:!0,turn:!0},e.iceProtocols={tcp:!0,udp:!0},e.onopen=function(t){e.enableLogs&&console.info("Data connection has been opened between you & ",t.userid)},e.onclose=function(t){e.enableLogs&&console.warn("Data connection has been closed between you & ",t.userid)},e.onerror=function(t){e.enableLogs&&console.error(t.userid,"data-error",t)},e.onmessage=function(t){e.enableLogs&&console.debug("data-message",t.userid,t.data)},e.send=function(t,i){e.peers.send(t,i)},e.close=e.disconnect=e.leave=function(){e.onbeforeunload(!1,!0)},e.closeEntireSession=function(t){t=t||function(){},e.socket.emit("close-entire-session",(function i(){e.getAllParticipants().length?setTimeout(i,100):(e.onEntireSessionClosed({sessionid:e.sessionid,userid:e.userid,extra:e.extra}),e.changeUserId(null,(function(){e.close(),t()})))}))},e.onEntireSessionClosed=function(t){e.enableLogs&&console.info("Entire session is closed: ",t.sessionid,t.extra)},e.onstream=function(t){var i=e.videosContainer;i.insertBefore(t.mediaElement,i.firstChild);var o=t.mediaElement.play();"undefined"===typeof o?setTimeout((function(){t.mediaElement.play()}),2e3):o.catch((function(){})).then((function(){setTimeout((function(){t.mediaElement.play()}),2e3)}))},e.onstreamended=function(e){e.mediaElement||(e.mediaElement=document.getElementById(e.streamid)),e.mediaElement&&e.mediaElement.parentNode&&e.mediaElement.parentNode.removeChild(e.mediaElement)},e.direction="many-to-many",e.removeStream=function(t,i){var o;e.attachStreams.forEach((function(e){e.id===t&&(o=e)})),o?(e.peers.getAllParticipants().forEach((function(t){if(!i||t===i){var n=e.peers[t];try{n.peer.removeStream(o)}catch(a){}}})),e.renegotiate()):console.warn("No such stream exist.",t)},e.addStream=function(i,o){if(i.getTracks)return-1===e.attachStreams.indexOf(i)&&(i.streamid||(i.streamid=i.id),e.attachStreams.push(i)),void e.renegotiate(o);function n(t){i.streamCallback&&i.streamCallback(t),e.renegotiate(o)}g(i)?e.renegotiate(o):(i.audio||i.video||i.screen)&&(i.screen?"Edge"===DetectRTC.browser.name?navigator.getDisplayMedia({video:!0,audio:w(e)}).then((function(o){o.isScreen=!0,t.onGettingLocalMedia(o),!i.audio&&!i.video||w(e)?n(o):e.invokeGetUserMedia(null,(function(e){n(e)}))}),(function(e){console.error("Unable to capture screen on Edge. HTTPs and version 17+ is required.")})):e.invokeGetUserMedia({audio:w(e),video:!0,isScreen:!0},(function(t){!i.audio&&!i.video||w(e)?n(t):e.invokeGetUserMedia(null,(function(e){n(e)}))})):(i.audio||i.video)&&e.invokeGetUserMedia(null,n))},e.invokeGetUserMedia=function(i,o,n){n||(n=e.session),i||(i=e.mediaConstraints),O({onGettingLocalMedia:function(e){var n=i.video;n&&(n.mediaSource||n.mozMediaSource||n.mandatory&&n.mandatory.chromeMediaSource)&&(e.isScreen=!0),e.isScreen||(e.isVideo=!!C(e,"video").length,e.isAudio=!e.isVideo&&C(e,"audio").length),t.onGettingLocalMedia(e,(function(){"function"===typeof o&&o(e)}))},onLocalMediaError:function(e,i){t.onLocalMediaError(e,i)},localMediaConstraints:i||{audio:!!n.audio&&i.audio,video:!!n.video&&i.video}})},e.applyConstraints=function(t,i){if(D&&D.prototype.applyConstraints){var o;if(i)return e.streamEvents[i]&&(o=e.streamEvents[i].stream),void b(o,t);e.attachStreams.forEach((function(e){b(e,t)}))}else alert("track.applyConstraints is NOT supported in your browser.")},e.replaceTrack=function(i,o,n){if(i=i||{},T.prototype.getSenders)if(i instanceof D)x(i,o,n);else{if(i instanceof y)return C(i,"video").length&&x(C(i,"video")[0],o,!0),void(C(i,"audio").length&&x(C(i,"audio")[0],o,!1));if(g(i))throw"connection.replaceTrack requires audio and/or video and/or screen.";(i.audio||i.video||i.screen)&&(i.screen?"Edge"===DetectRTC.browser.name?navigator.getDisplayMedia({video:!0,audio:w(e)}).then((function(o){o.isScreen=!0,t.onGettingLocalMedia(o),!i.audio&&!i.video||w(e)?a(o):e.invokeGetUserMedia(null,a)}),(function(e){console.error("Unable to capture screen on Edge. HTTPs and version 17+ is required.")})):e.invokeGetUserMedia({audio:w(e),video:!0,isScreen:!0},!i.audio&&!i.video||w(e)?a:e.invokeGetUserMedia(null,a)):(i.audio||i.video)&&e.invokeGetUserMedia(null,a))}else e.addStream(i);function a(t){e.replaceTrack(t,o,n||i.video||i.screen)}},e.resetTrack=function(t,i){t||(t=e.getAllParticipants()),"string"==typeof t&&(t=[t]),t.forEach((function(t){var o=e.peers[t].peer;"undefined"!==typeof i&&!0!==i||!o.lastVideoTrack||e.replaceTrack(o.lastVideoTrack,t,!0),"undefined"!==typeof i&&!1!==i||!o.lastAudioTrack||e.replaceTrack(o.lastAudioTrack,t,!1)}))},e.renegotiate=function(i){i?t.renegotiatePeer(i):e.peers.getAllParticipants().forEach((function(e){t.renegotiatePeer(e)}))},e.setStreamEndHandler=function(t,i){if(t&&t.addEventListener&&(i=!!i,!t.alreadySetEndHandler)){t.alreadySetEndHandler=!0;var o="ended";"oninactive"in t&&(o="inactive"),t.addEventListener(o,(function(){if(t.idInstance&&currentUserMediaRequest.remove(t.idInstance),!i){var o=[];e.attachStreams.forEach((function(e){e.id!=t.id&&o.push(e)})),e.attachStreams=o}var n=e.streamEvents[t.streamid];if(n||(n={stream:t,streamid:t.streamid,type:i?"remote":"local",userid:e.userid,extra:e.extra,mediaElement:e.streamEvents[t.streamid]?e.streamEvents[t.streamid].mediaElement:null}),i&&e.peers[n.userid]){var a=e.peers[n.userid].peer;o=[];a.getRemoteStreams().forEach((function(e){e.id!=t.id&&o.push(e)})),e.peers[n.userid].streams=o}n.userid===e.userid&&"remote"===n.type||(e.peersBackup[n.userid]&&(n.extra=e.peersBackup[n.userid].extra),e.onstreamended(n),delete e.streamEvents[t.streamid])}),!1)}},e.onMediaError=function(t,i){e.enableLogs&&console.error(t,i)},e.autoCloseEntireSession=!1,e.filesContainer=e.videosContainer=document.body||document.documentElement,e.isInitiator=!1,e.shareFile=t.shareFile,"undefined"!==typeof V&&V.handle(e),"undefined"!==typeof H&&H.handle(e),e.token=p,e.onNewParticipant=function(t,i){e.acceptParticipationRequest(t,i)},e.acceptParticipationRequest=function(e,i){i.successCallback&&(i.successCallback(),delete i.successCallback),t.createNewPeer(e,i)},"undefined"!==typeof B&&(e.StreamsHandler=B),e.onleave=function(e){},e.invokeSelectFileDialog=function(e){var t=new FileSelector;t.accept="*.*",t.selectSingleFile(e)},e.onmute=function(e){if(e&&e.mediaElement)if("both"===e.muteType||"video"===e.muteType){e.mediaElement.src=null;var t=e.mediaElement.pause();"undefined"!==typeof t?t.then((function(){e.mediaElement.poster=e.snapshot||"https://cdn.webrtc-experiment.com/images/muted.png"})):e.mediaElement.poster=e.snapshot||"https://cdn.webrtc-experiment.com/images/muted.png"}else"audio"===e.muteType&&(e.mediaElement.muted=!0)},e.onunmute=function(e){e&&e.mediaElement&&e.stream&&("both"===e.unmuteType||"video"===e.unmuteType?(e.mediaElement.poster=null,e.mediaElement.srcObject=e.stream,e.mediaElement.play()):"audio"===e.unmuteType&&(e.mediaElement.muted=!1))},e.onExtraDataUpdated=function(t){t.status="online",e.onUserStatusChanged(t,!0)},e.getAllParticipants=function(t){return e.peers.getAllParticipants(t)},"undefined"!==typeof B&&(B.onSyncNeeded=function(i,o,n){e.peers.getAllParticipants().forEach((function(e){t.onNegotiationNeeded({streamid:i,action:o,streamSyncNeeded:!0,type:n||"both"},e)}))}),e.connectSocket=function(e){n(e)},e.closeSocket=function(){try{io.sockets={}}catch(t){}e.socket&&("function"===typeof e.socket.disconnect&&e.socket.disconnect(),"function"===typeof e.socket.resetProps&&e.socket.resetProps(),e.socket=null)},e.getSocket=function(t){return!t&&e.enableLogs&&console.warn("getSocket.callback paramter is required."),t=t||function(){},e.socket?t(e.socket):n((function(){t(e.socket)})),e.socket},e.getRemoteStreams=t.getRemoteStreams;var k=["selectFirst","selectAll","forEach"];if(e.streamEvents={selectFirst:function(t){return e.streamEvents.selectAll(t)[0]},selectAll:function(t){t||(t={local:!0,remote:!0,isScreen:!0,isAudio:!0,isVideo:!0}),"local"==t&&(t={local:!0}),"remote"==t&&(t={remote:!0}),"screen"==t&&(t={isScreen:!0}),"audio"==t&&(t={isAudio:!0}),"video"==t&&(t={isVideo:!0});var i=[];return Object.keys(e.streamEvents).forEach((function(o){var n=e.streamEvents[o];if(-1===k.indexOf(o)){var a=!0;t.local&&"local"===n.type&&(a=!1),t.remote&&"remote"===n.type&&(a=!1),t.isScreen&&n.stream.isScreen&&(a=!1),t.isVideo&&n.stream.isVideo&&(a=!1),t.isAudio&&n.stream.isAudio&&(a=!1),t.userid&&n.userid===t.userid&&(a=!1),!1===a&&i.push(n)}})),i}},e.socketURL="/",e.socketMessageEvent="RTCMultiConnection-Message",e.socketCustomEvent="RTCMultiConnection-Custom-Message",e.DetectRTC=DetectRTC,e.setCustomSocketEvent=function(t){t&&(e.socketCustomEvent=t),e.socket&&e.socket.emit("set-custom-socket-event-listener",e.socketCustomEvent)},e.getNumberOfBroadcastViewers=function(t,i){e.socket&&t&&i&&e.socket.emit("get-number-of-users-in-specific-broadcast",t,i)},e.onNumberOfBroadcastViewersUpdated=function(t){e.enableLogs&&e.isInitiator&&console.info("Number of broadcast (",t.broadcastId,") viewers",t.numberOfBroadcastViewers)},e.onUserStatusChanged=function(t,i){e.enableLogs&&!i&&console.info(t.userid,t.status)},e.getUserMediaHandler=O,e.multiPeersHandler=t,e.enableLogs=!0,e.setCustomSocketHandler=function(e){"undefined"!==typeof d&&(d=e)},e.chunkSize=4e4,e.maxParticipantsAllowed=1e3,e.disconnectWith=t.disconnectWith,e.checkPresence=function(t,i){t=t||e.sessionid,"SSEConnection"!==d.name?e.socket?e.socket.emit("check-presence",t+"",(function(t,o,n){e.enableLogs&&console.log("checkPresence.isRoomExist: ",t," roomid: ",o),i(t,o,n)})):e.connectSocket((function(){e.checkPresence(t,i)})):SSEConnection.checkPresence(t,(function(t,o,n){if(!e.socket)return t||(e.userid=o),void e.connectSocket((function(){i(t,o,n)}));i(t,o)}))},e.onReadyForOffer=function(t,i){e.multiPeersHandler.createNewPeer(t,i)},e.setUserPreferences=function(t){return e.dontAttachStream&&(t.dontAttachLocalStream=!0),e.dontGetRemoteStream&&(t.dontGetRemoteStream=!0),t},e.updateExtraData=function(){e.socket.emit("extra-data-updated",e.extra)},e.enableScalableBroadcast=!1,e.maxRelayLimitPerUser=3,e.dontCaptureUserMedia=!1,e.dontAttachStream=!1,e.dontGetRemoteStream=!1,e.onReConnecting=function(t){e.enableLogs&&console.info("ReConnecting with",t.userid,"...")},e.beforeAddingStream=function(e){return e},e.beforeRemovingStream=function(e){return e},"undefined"!==typeof isChromeExtensionAvailable&&(e.checkIfChromeExtensionAvailable=isChromeExtensionAvailable),"undefined"!==typeof isFirefoxExtensionAvailable&&(e.checkIfChromeExtensionAvailable=isFirefoxExtensionAvailable),"undefined"!==typeof getChromeExtensionStatus&&(e.getChromeExtensionStatus=getChromeExtensionStatus),e.modifyScreenConstraints=function(e){return e},e.onPeerStateChanged=function(t){e.enableLogs&&-1!==t.iceConnectionState.search(/closed|failed/gi)&&console.error("Peer connection is closed between you & ",t.userid,t.extra,"state:",t.iceConnectionState)},e.isOnline=!0,h("online",(function(){e.isOnline=!0})),h("offline",(function(){e.isOnline=!1})),e.isLowBandwidth=!1,navigator&&navigator.connection&&navigator.connection.type&&(e.isLowBandwidth=-1!==navigator.connection.type.toString().toLowerCase().search(/wifi|cell/g),e.isLowBandwidth)){if(e.bandwidth={audio:!1,video:!1,screen:!1},e.mediaConstraints.audio&&e.mediaConstraints.audio.optional&&e.mediaConstraints.audio.optional.length){var R=[];e.mediaConstraints.audio.optional.forEach((function(e){"undefined"===typeof e.bandwidth&&R.push(e)})),e.mediaConstraints.audio.optional=R}if(e.mediaConstraints.video&&e.mediaConstraints.video.optional&&e.mediaConstraints.video.optional.length){R=[];e.mediaConstraints.video.optional.forEach((function(e){"undefined"===typeof e.bandwidth&&R.push(e)})),e.mediaConstraints.video.optional=R}}e.getExtraData=function(t,i){if(!t)throw"remoteUserId is required.";if("function"!==typeof i)return e.peers[t]?e.peers[t].extra:e.peersBackup[t]?e.peersBackup[t].extra:{};e.socket.emit("get-remote-user-extra-data",t,(function(e,t,o){i(e,t,o)}))},r.autoOpenOrJoin&&e.openOrJoin(e.sessionid),e.onUserIdAlreadyTaken=function(t,i){e.close(),e.closeSocket(),e.isInitiator=!1,e.userid=e.token(),e.join(e.sessionid),e.enableLogs&&console.warn("Userid already taken.",t,"Your new userid:",e.userid)},e.trickleIce=!0,e.version="3.7.0",e.onSettingLocalDescription=function(t){e.enableLogs&&console.info("Set local description for remote user",t.userid)},e.resetScreen=function(){sourceId=null,DetectRTC&&DetectRTC.screen&&delete DetectRTC.screen.sourceId,currentUserMediaRequest={streams:[],mutex:!1,queueRequests:[]}},e.autoCreateMediaElement=!0,e.password=null,e.setPassword=function(t,i){i=i||function(){},e.socket?e.socket.emit("set-password",t,i):(e.password=t,i(!0,e.sessionid,null))},e.onSocketDisconnect=function(t){e.enableLogs&&console.warn("socket.io connection is closed")},e.onSocketError=function(t){e.enableLogs&&console.warn("socket.io connection is failed")},e.errors={ROOM_NOT_AVAILABLE:"Room not available",INVALID_PASSWORD:"Invalid password",USERID_NOT_AVAILABLE:"User ID does not exist",ROOM_PERMISSION_DENIED:"Room permission denied",ROOM_FULL:"Room full",DID_NOT_JOIN_ANY_ROOM:"Did not join any room yet",INVALID_SOCKET:"Invalid socket",PUBLIC_IDENTIFIER_MISSING:"publicRoomIdentifier is required",INVALID_ADMIN_CREDENTIAL:"Invalid username or password attempted"}})(this)};e.exports=t=a,o=[],n=function(){return a}.apply(t,o),void 0===n||(e.exports=n)},34007:function(e,t,i){i(21903),i(91134);var o=!!(window.AudioContext&&window.MediaStreamAudioSourceNode&&window.AnalyserNode&&window.ScriptProcessorNode);e.exports=function(e,t,i){i||(i=t,t=null),t=t||{};var o={},n=t.context||new AudioContext,a=n.createMediaStreamSource(e),r=n.createAnalyser(),s=null;return i&&(s=n.createScriptProcessor(2048,1,1),s.onaudioprocess=function(){i(o.get())}),r.smoothingTimeConstant=.3,r.fftSize=256,a.connect(r),o.get=function(){var e=0,t=new Uint8Array(r.frequencyBinCount);r.getByteFrequencyData(t);for(var i=0;i<t.length;i++)e+=t[i];return e/t.length/255},o.destroy=function(){s&&(s.disconnect(),r.disconnect()),a.disconnect(),t.context||n.close()},a.connect(r),s&&(r.connect(s),s.connect(n.destination)),o},e.exports.supported=o},99418:function(e,t,i){"use strict";i.r(t);var o=i(31601),n=i.n(o),a=i(76314),r=i.n(a),s=r()(n());s.push([e.id,".m_audioEqualizer[data-v-c9cf908c]{width:100%;height:100%;-o-object-fit:scale-down;object-fit:scale-down}.m_audioEqualizer canvas[data-v-c9cf908c]{display:block;max-width:100%;max-height:100%;background-color:#fff}",""]),t["default"]=s},36313:function(e,t,i){"use strict";i.r(t);var o=i(31601),n=i.n(o),a=i(76314),r=i.n(a),s=r()(n());s.push([e.id,".m_captureEffects ._content ._options[data-v-a1467d96]{background:rgba(0,0,0,.1);padding:calc(var(--spacing)/2);border-radius:6px}.m_captureEffects ._content ._options>*[data-v-a1467d96]{margin:calc(var(--spacing)/2) 0;padding:calc(var(--spacing)/2);background-color:#fff;border-radius:4px}.m_captureEffects ._content ._options[data-v-a1467d96]>:first-child{margin-top:0}.m_captureEffects ._content ._options[data-v-a1467d96]>:last-child{margin-bottom:0}.is--disabled[data-v-a1467d96]{filter:grayscale(100%);opacity:.7;cursor:not-allowed;-webkit-user-select:none;-moz-user-select:none;user-select:none}.is--disabled>*[data-v-a1467d96]{pointer-events:none}",""]),t["default"]=s},69736:function(e,t,i){"use strict";i.r(t);var o=i(31601),n=i.n(o),a=i(76314),r=i.n(a),s=r()(n());s.push([e.id,"._capturePane[data-v-5cdbfa5a]{position:relative;flex:1 0 200px;max-width:280px;overflow:auto;display:flex;flex-flow:column nowrap}._capturePane[data-type=settings][data-v-5cdbfa5a]{background-color:var(--c-rouge)}._capturePane[data-type=settings] ._topbar[data-v-5cdbfa5a]{border-color:var(--c-rouge_fonce)}._capturePane[data-type=effects][data-v-5cdbfa5a]{background-color:var(--c-bleumarine)}._capturePane[data-type=effects] ._topbar[data-v-5cdbfa5a]{border-color:var(--c-bleumarine_fonce)}._topbar[data-v-5cdbfa5a]{flex:0 0 auto;border-bottom:2px solid #fff;padding:calc(var(--spacing)/2);color:#fff;justify-content:center}._topbar[data-v-5cdbfa5a],._topbar--title[data-v-5cdbfa5a]{display:flex;align-items:center}._topbar--title[data-v-5cdbfa5a]{flex-flow:row wrap;width:100%;justify-content:space-between}",""]),t["default"]=s},94384:function(e,t,i){"use strict";i.r(t);var o=i(31601),n=i.n(o),a=i(76314),r=i.n(a),s=r()(n());s.push([e.id,".m_captureSettings[data-v-47274ab5]{color:#fff}.m_captureSettings .u-buttonLink[data-v-47274ab5],.m_captureSettings .u-label[data-v-47274ab5],.m_captureSettings label[data-v-47274ab5],.m_captureSettings small[data-v-47274ab5]{color:inherit}.m_captureSettings input[data-v-47274ab5],.m_captureSettings select[data-v-47274ab5]{color:var(--c-noir)}.m_captureSettings--settings[data-v-47274ab5]{overflow-y:auto;flex:1 1 auto}.m_captureSettings--settings>div[data-v-47274ab5]{padding:calc(var(--spacing)/2);padding-top:calc(var(--spacing)/4)}.m_captureSettings--settings>div>div[data-v-47274ab5]{background-color:rgba(0,0,0,.1);padding:0 calc(var(--spacing)/2) calc(var(--spacing)/2);border-radius:6px}.m_captureSettings--settings>div>div>div[data-v-47274ab5]{padding-top:calc(var(--spacing)/4);margin-bottom:calc(var(--spacing)/4)}.m_captureSettings--settings>div>div>div[data-v-47274ab5]:last-child{margin-bottom:0}.m_captureSettings--settings>div>label[data-v-47274ab5]{line-height:2}.m_captureSettings--settings--resolutions label[data-v-47274ab5]{padding:calc(var(--spacing)/4) 0;display:flex;align-items:center}.m_captureSettings--settings--resolutions label>input[data-v-47274ab5]{flex:0 0 auto;margin:0;margin-right:calc(var(--spacing)/3)}.m_captureSettings--updateButton[data-v-47274ab5]{flex:0 0 auto;border-top:2px solid var(--c-rouge_fonce);color:#000;display:flex;flex-flow:column wrap}.m_sideBySideSwitches[data-v-47274ab5]{flex-flow:row nowrap}.m_sideBySideSwitches>*[data-v-47274ab5]{display:block;border-color:var(--c-rouge_fonce);min-width:100px;padding:calc(var(--spacing)/8) 0;display:flex;flex-flow:row wrap;align-items:stretch}.m_sideBySideSwitches>* input[data-v-47274ab5]{margin:calc(var(--spacing)/2)}@media only screen and (max-width:780px){.m_sideBySideSwitches>* input[data-v-47274ab5]{margin:calc(var(--spacing)/4)}}.m_sideBySideSwitches>*>div[data-v-47274ab5]{flex:1 1 0;display:flex;flex-flow:row nowrap;align-items:center}.m_sideBySideSwitches>* small[data-v-47274ab5]{flex:0 0 100%;background-color:var(--c-rouge_fonce);display:block;text-align:center;font-style:normal;display:flex;align-items:center;justify-content:center}.m_captureSettings--updateButton--buttons[data-v-47274ab5]{padding:calc(var(--spacing)/2);display:flex;justify-content:center}.m_captureSettings--updateButton--shareStreamToggle[data-v-47274ab5]{position:relative;background-color:var(--c-rouge_fonce);color:#fff;text-align:center}._close_button[data-v-47274ab5]{position:absolute;top:0;right:0;min-height:0;padding:0;margin:calc(var(--spacing)/4)}._close_button img[data-v-47274ab5]{width:2rem;height:2rem}._loader[data-v-47274ab5]{position:absolute;z-index:1000}._customResolution[data-v-47274ab5]{justify-content:center}._customResolution input[data-v-47274ab5]{width:auto}._customResolutionX[data-v-47274ab5]{font-size:var(--sl-font-size-large)}._resolutionLabel[data-v-47274ab5]{flex:1}._resolutionLabel[data-v-47274ab5] ._labelLine{color:#fff;font-size:var(--sl-font-size-normal)}._resolutionLabel[data-v-47274ab5] .u-instructions{color:#fff;margin-bottom:0}._sourcesTitle[data-v-47274ab5]{display:flex;justify-content:space-between}",""]),t["default"]=s},56266:function(e,t,i){"use strict";i.r(t);var o=i(31601),n=i.n(o),a=i(76314),r=i.n(a),s=r()(n());s.push([e.id,".m_captureview[data-v-36c214a2]{display:flex;flex-flow:row nowrap;max-height:100vh;height:100%}.m_captureview .m_captureview--settingsPaneButton[data-v-36c214a2]{position:relative;z-index:1;display:flex;justify-content:center;align-items:center;width:0;background-color:var(--c-rouge)}.m_captureview .m_captureview--settingsPaneButton>button[data-v-36c214a2]{transform:rotate(-90deg);transform-origin:center top;border-top-left-radius:0;border-top-right-radius:0;margin-left:-1px}.m_captureview .m_captureview--videoPane[data-v-36c214a2]{position:relative;overflow-y:auto;flex:1 1 100px;display:flex;flex-flow:column nowrap}.m_captureview .m_captureview--videoPane--top[data-v-36c214a2]{position:relative;margin:0 auto;min-height:60px;flex:1 1 auto;overflow:hidden;width:100%;height:100%;background-color:var(--c-noir);background-color:#000;display:flex;flex-flow:column nowrap;justify-content:center;align-items:center}.m_captureview .m_captureview--videoPane--top.is--being_streamed[data-v-36c214a2]{border-bottom:5px solid var(--c-rouge)}.m_captureview .m_captureview--videoPane--bottom[data-v-36c214a2]{position:relative;flex:0 0 auto;box-shadow:0 -1px 4px rgba(0,0,0,.1)}.m_captureview .m_captureview--videoPane--bottom .m_captureview--videoPane--bottom--buttons[data-v-36c214a2]{display:flex;flex-flow:row wrap;justify-content:space-between;align-items:center}.m_captureview .m_captureview--videoPane--bottom .m_captureview--videoPane--bottom--buttons button img[data-v-36c214a2],.m_captureview .m_captureview--videoPane--bottom .m_captureview--videoPane--bottom--buttons button svg[data-v-36c214a2]{width:2rem;height:2rem;padding:0}.m_captureview .m_captureview--videoPane--bottom .m_captureview--videoPane--bottom--buttons>*[data-v-36c214a2]{flex:0 0 auto;display:flex}.m_captureview .m_captureview--videoPane--bottom .m_captureview--videoPane--bottom--buttons[data-v-36c214a2]>:not(:empty){padding:calc(var(--spacing)/2)}@media only screen and (min-width:781px){.m_captureview .m_captureview--videoPane--bottom .m_captureview--videoPane--bottom--buttons>*[data-v-36c214a2]{flex:1 0 200px}}.m_captureview .m_captureview--videoPane--bottom .m_captureview--videoPane--bottom--buttons>*>*[data-v-36c214a2]{margin-right:calc(var(--spacing)/2)}.m_captureview .m_captureview--videoPane--bottom .m_captureview--videoPane--bottom--buttons>* ._settingsBtn[data-v-36c214a2]{flex-shrink:0;padding:calc(var(--spacing)/2)}.m_captureview .m_captureview--videoPane--bottom .m_captureview--videoPane--bottom--buttons[data-v-36c214a2]>:nth-child(2){text-align:center;display:flex;flex-flow:row wrap;align-items:center;justify-content:center}.m_captureview .m_captureview--videoPane--bottom .m_captureview--videoPane--bottom--buttons[data-v-36c214a2]>:last-child{justify-content:flex-end}.m_captureview .m_captureview--videoPane--bottom .m_captureview--videoPane--bottom--buttons.is--recording[data-v-36c214a2]{background-color:var(--c-rouge)}.m_captureview ._settingsTag[data-v-36c214a2]{position:absolute;bottom:0;right:0;z-index:1;margin:calc(var(--spacing)/2);pointer-events:none;display:flex;flex-flow:row wrap;gap:calc(var(--spacing)/4)}.m_captureview ._settingsTag button[data-v-36c214a2],.m_captureview ._settingsTag select[data-v-36c214a2]{pointer-events:auto}.m_captureview ._settingsTag select[data-v-36c214a2]{width:11ch}.m_captureview .m_captureview--videoPane--top--videoContainer[data-v-36c214a2]{position:relative;width:100%;height:100%}.m_captureview .m_captureview--videoPane--top--videoContainer .m_audioEqualizer[data-v-36c214a2],.m_captureview .m_captureview--videoPane--top--videoContainer .mediaContainer img[data-v-36c214a2],.m_captureview .m_captureview--videoPane--top--videoContainer canvas[data-v-36c214a2],.m_captureview .m_captureview--videoPane--top--videoContainer video[data-v-36c214a2]{position:absolute;top:0;left:0;width:100%;height:100%;-o-object-fit:contain;object-fit:contain}._captureButton[data-v-36c214a2]{position:relative;width:auto;height:auto;flex:0 0 auto;margin:0 calc(var(--spacing)/4)}._captureButton.is--active[data-v-36c214a2]{background:var(--c-rouge)}._captureButton>img[data-v-36c214a2]{flex:0 0 auto}._mode_indicator[data-v-36c214a2]{top:0;left:0;right:0;bottom:0;background-color:var(--c-rouge);font-weight:700;font-family:Fira Code;font-size:var(--sl-font-size-large);text-transform:uppercase;letter-spacing:.06em;color:#fff}._delay_timer[data-v-36c214a2],._mode_indicator[data-v-36c214a2]{position:absolute;pointer-events:none;display:flex;align-items:center;justify-content:center}._delay_timer[data-v-36c214a2]{z-index:100;width:100%;height:100%;font-size:40vmin;color:transparent;--c-text-stroke:var(--c-rouge);--c-text-shadow:rgba(0,0,0,.2);color:var(--c-rouge_fonce);-webkit-text-stroke:1vmin var(--c-text-stroke)}._delay_timer.is--small[data-v-36c214a2]{font-size:10vmin;-webkit-text-stroke:.2vmin var(--c-text-stroke);bottom:0}._delay_timer.is--small.is--timelapse[data-v-36c214a2]{height:50%}._capture_options[data-v-36c214a2]{position:absolute;bottom:0;width:100%;z-index:100;text-align:center;pointer-events:none;display:flex;flex-flow:column nowrap;justify-content:center;gap:calc(var(--spacing)/4);padding:calc(var(--spacing)/2)}._capture_options ._duration_timer[data-v-36c214a2]{display:inline-block;margin:0 auto;background-color:var(--c-rouge);padding:0 calc(var(--spacing)/8);font-size:var(--sl-font-size-normal);margin-bottom:calc(var(--spacing)/8);color:#fff;border-radius:4px;pointer-events:auto}._capture_options .record_options[data-v-36c214a2]{max-width:450px;margin:0 auto;pointer-events:auto}._capture_options .record_options>*[data-v-36c214a2]{margin-bottom:0;background-color:var(--c-rouge);color:#fff;padding:0 calc(var(--spacing)/4);border-radius:4px;width:auto;display:flex;align-items:center}._capture_options .record_options input[data-v-36c214a2]{min-width:2em;max-width:4em;height:1.4em;margin:2px;padding:0 2px;width:auto;text-align:center;color:#fff;background-color:var(--c-rouge_clair);border-bottom:0}._capture_options .record_options input[data-v-36c214a2]:active,._capture_options .record_options input[data-v-36c214a2]:focus{border-bottom-color:var(--c-rouge_fonce)}._capture_options .record_options .record_options--timer[data-v-36c214a2]{font-size:2em}._tiny_equalizer[data-v-36c214a2]{margin:0 calc(var(--spacing)/2)}._tiny_equalizer .m_audioEqualizer[data-v-36c214a2]{position:relative;width:64px;height:36px;background-color:transparent!important;border-radius:4px;overflow:hidden}._onion_skin[data-v-36c214a2]{position:absolute;top:0;left:0;right:0;bottom:0}._onion_skin.is--onionskin[data-v-36c214a2]{opacity:.2;opacity:var(--onionskin-opacity)}._onion_skin[data-v-36c214a2] img{width:100%;height:100%;-o-object-fit:contain;object-fit:contain}._mode_accessory_range[data-v-36c214a2]{max-width:200px;margin:-5px 0 -5px auto}._mode_accessory_range input[data-v-36c214a2],._mode_accessory_range label[data-v-36c214a2]{margin:0}._video_grid_overlay[data-v-36c214a2]{position:absolute;display:block;width:100%;height:100%;display:flex;align-items:center;justify-content:center;pointer-events:none;-o-object-fit:contain;object-fit:contain;--stroke_width:2px}._video_grid_overlay svg[data-v-36c214a2]{position:absolute;width:100%;height:100%;stroke:var(--c-rouge);fill:none}._video_grid_overlay svg line[data-v-36c214a2],._video_grid_overlay svg rect[data-v-36c214a2]{stroke-width:var(--stroke_width)}._enable_timelapse_button[data-v-36c214a2]{color:#fff;background:var(--c-orange);width:28px;height:28px;display:block;min-height:0;line-height:0;border-radius:50%;text-align:center;font-weight:700;padding:calc(var(--spacing)/8);margin:calc(var(--spacing)/4)}._enable_timelapse_button svg[data-v-36c214a2]{width:100%!important;height:100%!important}._enable_timelapse_button.is--active[data-v-36c214a2]{background:var(--c-rouge);color:#fff}._capture_flash[data-v-36c214a2]{background-color:var(--c-rouge);position:absolute;width:100%;height:100%;z-index:100}._download_media_without_validation[data-v-36c214a2]{background-color:var(--c-noir);padding:0 calc(var(--spacing)/2) calc(var(--spacing)/4);margin-bottom:-.2em;line-height:1;text-align:right;text-overflow:ellipsis;white-space:nowrap;overflow:hidden}._download_media_without_validation a[data-v-36c214a2]{color:var(--c-gris)}._videoEq[data-v-36c214a2]{display:flex;flex-flow:row wrap;align-items:center}._loader[data-v-36c214a2]{background:transparent;color:#fff;color:var(--c-rouge);margin-bottom:calc(var(--spacing)*2)}._stopmotionValidation[data-v-36c214a2]{flex:0 0 auto;margin:0;border-radius:calc(var(--spacing)/4);display:flex;flex-flow:row nowrap;justify-content:center;align-items:center;gap:calc(var(--spacing)/2);--input-height:2em}._stopmotionValidation>*[data-v-36c214a2]{flex:0 0 auto}._stopmotionValidation ._stopmotionValidation--fpscounter[data-v-36c214a2]{display:flex;flex-flow:column nowrap;align-items:center}",""]),t["default"]=s},23013:function(e,t,i){"use strict";i.r(t);var o=i(31601),n=i.n(o),a=i(76314),r=i.n(a),s=r()(n());s.push([e.id,"input[type=number][data-v-d2daf70e]{max-width:18ch}",""]),t["default"]=s},6742:function(e,t,i){"use strict";i.r(t);var o=i(31601),n=i.n(o),a=i(76314),r=i.n(a),s=r()(n());s.push([e.id,".m_lines{padding:var(--spacing)}.m_lines,.m_lines svg{width:100%;height:100%}.m_lines svg{pointer-events:none}",""]),t["default"]=s},91366:function(e,t,i){"use strict";i.r(t);var o=i(31601),n=i.n(o),a=i(76314),r=i.n(a),s=r()(n());s.push([e.id,".m_previewValidation[data-v-40d4ba5e]{position:absolute;top:0;left:0;background-color:#000;padding:calc(var(--spacing)*1);display:flex;justify-content:center;align-items:center}.m_previewValidation[data-v-40d4ba5e],.m_previewValidation>*[data-v-40d4ba5e]{width:100%;height:100%;-o-object-fit:contain;object-fit:contain}.m_previewValidation>*[data-v-40d4ba5e]{margin:0}.m_previewValidation--svg[data-v-40d4ba5e] svg{width:100%;height:100%;max-width:100%;margin:auto}",""]),t["default"]=s},18930:function(e,t,i){"use strict";i.r(t);var o=i(31601),n=i.n(o),a=i(76314),r=i.n(a),s=r()(n());s.push([e.id,".m_mediaValidationButtons[data-v-7e4a586a]{position:relative;z-index:105;display:flex;flex-flow:row wrap;gap:calc(var(--spacing)/2);justify-content:space-around;align-items:center;padding:calc(var(--spacing)/2);flex:0 0 auto;text-transform:uppercase;font-weight:500;letter-spacing:.06em;font-size:var(--font-verysmall);height:auto;background-color:var(--c-noir)}.m_mediaValidationButtons>*[data-v-7e4a586a]{flex:0 1 200px;display:flex;align-items:center}.m_mediaValidationButtons .m_mediaValidationButtons--overlay[data-v-7e4a586a]{position:absolute;top:0;left:0;right:0;bottom:0;display:flex;justify-content:center;align-items:center;background-color:#353535;--loader-bg-color:transparent;--loader-border-color:var(--c-rouge)}.m_mediaValidationButtons .m_mediaValidationButtons--overlay[data-v-7e4a586a] .u-loader{background-color:transparent}.m_mediaValidationButtons .m_mediaValidationButtons--overlay .m_mediaValidationButtons--overlay--percent[data-v-7e4a586a]{position:absolute;margin-left:8em;z-index:55000;color:#fff;padding:2px;border-radius:4px}.m_mediaValidationButtons button svg[data-v-7e4a586a]{width:2rem;height:2rem}._arrows[data-v-7e4a586a]{display:none}._valStarBtns[data-v-7e4a586a]{display:flex;align-items:stretch}._favBtn[data-v-7e4a586a]{margin-left:-5px;border-top-left-radius:0;border-bottom-left-radius:0}._checkBtn rect[data-v-7e4a586a]{fill:transparent;stroke:#fff;stroke-width:6px;fill:var(--c-rouge)}._checkBtn.is--active rect[data-v-7e4a586a]{fill:#fff}._locationBtn[data-v-7e4a586a]{position:absolute;bottom:100%;right:0;margin:calc(var(--spacing)/1)}",""]),t["default"]=s},60497:function(e,t,i){"use strict";i.r(t);var o=i(31601),n=i.n(o),a=i(76314),r=i.n(a),s=r()(n());s.push([e.id,"._modeSelector[data-v-5fc4cc80]{position:absolute;z-index:1;display:flex;left:0;right:0;flex-flow:row wrap;justify-content:center;align-items:center;padding:calc(var(--spacing)/1);gap:calc(var(--spacing)/2);-webkit-user-select:none;-moz-user-select:none;user-select:none;pointer-events:none;font-family:Fira Code;color:var(--c-orange)}._modeSelector>*[data-v-5fc4cc80]{flex:0 0 auto;display:flex;flex-flow:row wrap;font-family:inherit;pointer-events:auto}._modeSelector>._arrows[data-v-5fc4cc80]{padding:0}._modeSelector>._arrows button[data-v-5fc4cc80]{padding:0;min-height:0}._modeSelector>._arrows svg[data-v-5fc4cc80]{width:36px;height:36px;padding:4px}._modeSelector input[data-v-5fc4cc80]{width:0;height:0;display:none}._modeSelector input:checked+label[data-v-5fc4cc80]{background-color:var(--c-orange)}._modeSelector input[disabled]+label[data-v-5fc4cc80]{filter:grayscale(100%);opacity:.3;cursor:not-allowed}._modeSelector label[data-v-5fc4cc80]{font-size:inherit;font-family:inherit;display:inline-block;text-decoration:none;text-transform:uppercase;font-weight:500;letter-spacing:.06em;flex-shrink:0;cursor:pointer;border-radius:6px;transition:color .25s ease-out,opacity .5s;display:flex;flex-flow:row nowrap;align-items:center;justify-content:center;background-color:#fff;letter-spacing:0;margin:0;text-align:center;transition:all .4s cubic-bezier(.19,1,.22,1)}._modeSelector ._picto[data-v-5fc4cc80]{border-radius:50%;overflow:hidden;display:block;width:36px;height:36px;padding:4px;color:#fff;margin-right:0}._modeSelector span[data-v-5fc4cc80]{display:block;font-weight:400;text-transform:lowercase;margin:.405rem;font-size:.8rem;font-family:Fira Mono;text-transform:uppercase;font-weight:500;letter-spacing:.05em;color:var(--c-noir);font-weight:600}",""]),t["default"]=s},25612:function(e,t,i){"use strict";i.r(t);var o=i(31601),n=i.n(o),a=i(76314),r=i.n(a),s=r()(n());s.push([e.id,"._player[data-v-66c7c3e6]{position:absolute;width:100%;height:100%;display:flex;flex-flow:column nowrap;justify-content:center;align-items:center;background:#000}._player[data-v-66c7c3e6] ._mediaContent,._player[data-v-66c7c3e6] img{max-width:100%;max-height:100%}._playPauseBtn[data-v-66c7c3e6]{position:absolute;top:0;bottom:0;left:0;right:0;width:100%;background:transparent;display:flex;justify-content:center;align-items:center;padding:calc(var(--spacing)/1)}._playPauseBtn button[data-v-66c7c3e6]{border-radius:50%;padding:calc(var(--spacing)/2)}._fps[data-v-66c7c3e6]{position:absolute;display:flex;justify-content:center;bottom:0;width:100%;padding:calc(var(--spacing)/1)}._fps>*[data-v-66c7c3e6]{background:var(--c-noir);padding:calc(var(--spacing)/4)}._fps>* label[data-v-66c7c3e6]{color:#fff}._miniListPreview[data-v-66c7c3e6]{display:flex;flex-flow:row wrap;position:absolute;gap:1px;z-index:-1;opacity:.5;justify-content:center;align-items:center;align-content:center;padding:calc(var(--spacing)*2)}._miniListPreview>*[data-v-66c7c3e6]{width:50px;height:50px}._imgCount[data-v-66c7c3e6]{position:absolute;bottom:0;right:0;padding:calc(var(--spacing)/2);color:#fff;font-size:var(--sl-font-size-small)}",""]),t["default"]=s},39842:function(e,t,i){"use strict";i.r(t);var o=i(31601),n=i.n(o),a=i(76314),r=i.n(a),s=r()(n());s.push([e.id,".m_stopmotionList[data-v-2cfb19ff]{position:relative}",""]),t["default"]=s},57889:function(e,t,i){"use strict";i.r(t);var o=i(31601),n=i.n(o),a=i(76314),r=i.n(a),s=r()(n());s.push([e.id,'.m_stopmotionpanel[data-v-422abd54]{--img-width:120px;position:relative;display:flex;flex-flow:column nowrap;flex:0 0 auto}.m_stopmotionpanel.is--showing_video_validation[data-v-422abd54]{flex-grow:1}.m_stopmotionpanel--toprowbuttons[data-v-422abd54]{position:relative;width:100%;background-color:var(--c-noir);pointer-events:none;display:flex;justify-content:center;align-items:center;gap:calc(var(--spacing)/4)}.m_stopmotionpanel--toprowbuttons>*[data-v-422abd54]{pointer-events:auto;margin:calc(var(--spacing)/4)}.m_stopmotionpanel--toprowbuttons>.m_stopmotionpanel--toprowbuttons--counter[data-v-422abd54]{display:flex;align-items:center;gap:calc(var(--spacing)/2);background-color:var(--c-noir);margin:0;padding:0}.m_stopmotionpanel--toprowbuttons>.m_stopmotionpanel--toprowbuttons--counter label[data-v-422abd54]{margin-bottom:0}.m_stopmotionpanel--medias[data-v-422abd54]{flex:1 1 auto;display:flex;flex-flow:row wrap;justify-content:center;background-color:#000;padding:1px;color:#fff;counter-reset:compteListe}.m_stopmotionpanel--medias .m_stopmotionpanel--medias--list[data-v-422abd54]{display:block;flex:1 1 200px;position:relative;display:flex;flex-flow:row nowrap;align-items:center;overflow-x:auto;overflow-y:hidden;-webkit-overflow-scrolling:touch;overscroll-behavior-y:contain;padding:0;gap:1px;scroll-behavior:smooth;--c-thumbcolor:var(--c-noir);--scrollbar-height:4px;--scrollbar-padding:4px;--scrollbar-border:4px;--c-barbgcolor:hsla(0,0%,100%,0);--c-thumbcolor:#fff}.m_stopmotionpanel--medias .m_stopmotionpanel--medias--list[data-v-422abd54]::-webkit-scrollbar{height:calc(var(--scrollbar-padding)*2 + var(--scrollbar-height));width:calc(var(--scrollbar-padding)*2 + var(--scrollbar-height));background-color:var(--c-barbgcolor)}.m_stopmotionpanel--medias .m_stopmotionpanel--medias--list[data-v-422abd54]::-webkit-scrollbar-thumb,.m_stopmotionpanel--medias .m_stopmotionpanel--medias--list[data-v-422abd54]::-webkit-scrollbar-track{border:var(--scrollbar-border) solid hsla(0,0%,100%,0);border-radius:calc(var(--scrollbar-border)*4);background-clip:padding-box;-webkit-transition:all .4s;transition:all .4s}.m_stopmotionpanel--medias .m_stopmotionpanel--medias--list[data-v-422abd54]::-webkit-scrollbar-track{background-color:transparent}.m_stopmotionpanel--medias .m_stopmotionpanel--medias--list[data-v-422abd54]::-webkit-scrollbar-thumb{background-color:var(--c-thumbcolor)}.m_stopmotionpanel--medias .m_stopmotionpanel--medias--list[data-v-422abd54]::-webkit-scrollbar-thumb:hover{background-color:var(--c-gris);border:var(--scrollbar-border) solid hsla(0,0%,100%,0)}.m_stopmotionpanel--medias .m_stopmotionpanel--medias--list--items[data-v-422abd54]{position:relative;width:auto;flex:0 0 auto;width:var(--img-width);height:auto;cursor:pointer;transition:all .4s cubic-bezier(.19,1,.22,1)}.m_stopmotionpanel--medias .m_stopmotionpanel--medias--list--items[data-v-422abd54]:before{counter-increment:compteListe 1;content:counter(compteListe) " ";position:absolute;left:0;bottom:0;padding:calc(var(--spacing)/8) calc(var(--spacing)/4) calc(var(--spacing)/16);margin:calc(var(--spacing)/16);text-transform:uppercase;font-weight:500;letter-spacing:.06em;font-size:var(--font-verysmall);background-color:#fff;color:var(--c-noir);border-radius:2px;line-height:1;z-index:1}.m_stopmotionpanel--medias .m_stopmotionpanel--medias--list--items[data-v-422abd54] img,.m_stopmotionpanel--medias .m_stopmotionpanel--medias--list--items[data-v-422abd54] video{position:relative;width:100%;height:100%;margin:0;-o-object-fit:contain;object-fit:contain}.m_stopmotionpanel--medias .m_stopmotionpanel--medias--list--items[data-v-422abd54]:last-child{flex-basis:auto;width:auto;overflow:hidden}.m_stopmotionpanel--medias .m_stopmotionpanel--medias--list--items:last-child video[data-v-422abd54]{width:var(--img-width);height:auto}.m_stopmotionpanel--medias .m_stopmotionpanel--medias--list--items[data-v-422abd54]:last-child:before{content:attr(data-content)}.m_stopmotionpanel--medias .m_stopmotionpanel--medias--list--items.is--current_single[data-v-422abd54]:before{color:#fff;background-color:var(--c-rouge)}.m_stopmotionpanel--medias .m_stopmotionpanel--medias--list--items .mediaContainer[data-v-422abd54]{width:100%;height:100%;width:auto}.m_stopmotionpanel--videopreview[data-v-422abd54]{position:relative;flex:1 1 auto;overflow:hidden}.m_stopmotionpanel--videopreview .mediaContainer[data-v-422abd54]{position:absolute;height:100%;width:100%}.m_stopmotionpanel--videopreview .mediaContainer[data-v-422abd54]>*{width:100%;height:100%}.m_stopmotionpanel--videopreview .mediaContainer[data-v-422abd54] video{height:100%;width:100%;background-color:var(--c-noir)}.m_stopmotionpanel--buttons[data-v-422abd54]{flex:0 0 auto;width:100%;color:var(--c-noir)}.m_stopmotionpanel--buttons>*[data-v-422abd54]{display:flex;flex-flow:row wrap;justify-content:space-between;align-items:center;padding:calc(var(--spacing)/2)}.m_stopmotionpanel--buttons[data-v-422abd54]>:nth-child(2){border-top:2px solid #fff;justify-content:center;background-color:var(--c-noir)}.m_stopmotionpanel--buttons input[type=number][data-v-422abd54]{width:50px}._optionBtns[data-v-422abd54]{width:100%;padding:calc(var(--spacing)/4);gap:calc(var(--spacing)/4);justify-content:space-between;align-items:flex-start;color:var(--c-noir)}._optionBtns[data-v-422abd54],.m_stopmotionpanel--loader[data-v-422abd54]{position:absolute;top:0;left:0;display:flex}.m_stopmotionpanel--loader[data-v-422abd54]{z-index:2;bottom:0;right:0;background-color:fade(#fff,90%);justify-content:center;align-items:center}._loader[data-v-422abd54]{background:rgba(0,0,0,.95);color:var(--color-capture)}._separator[data-v-422abd54]{position:relative;flex:0 0 1px;height:100%;z-index:-1}._onion_skin[data-v-422abd54]{position:absolute;inset:0;display:flex;justify-content:center;align-items:center;-webkit-backdrop-filter:blur(2px);backdrop-filter:blur(2px);background:rgba(0,0,0,.25);padding:calc(var(--spacing)/4);text-align:center;font-variant:small-caps}._onion_skin input[data-v-422abd54]{width:100%;margin:0}._onion_skin_range[data-v-422abd54]{direction:rtl}._saveNotice[data-v-422abd54]{position:absolute;inset:-2px;background:hsla(0,0%,100%,.95);display:flex;justify-content:center;align-items:center}',""]),t["default"]=s},28760:function(e,t,i){"use strict";i.r(t);var o=i(31601),n=i.n(o),a=i(76314),r=i.n(a),s=r()(n());s.push([e.id,"._preview[data-v-2ed71ab5]{padding:calc(var(--spacing)/1);background:var(--c-gris);margin:0 0 calc(var(--spacing)/1) 0}._topRow[data-v-2ed71ab5]{justify-content:space-between;gap:calc(var(--spacing)/2)}._imagesCont[data-v-2ed71ab5],._topRow[data-v-2ed71ab5]{display:flex;flex-flow:row nowrap;align-items:center}._imagesCont[data-v-2ed71ab5]{background:var(--c-noir);padding:1px;gap:1px;overflow-x:auto;overflow-y:hidden;-webkit-overflow-scrolling:touch;overscroll-behavior-y:contain}._imagesCont>*[data-v-2ed71ab5]{flex:0 0 100px}._btns[data-v-2ed71ab5]{display:flex;flex-flow:row nowrap;align-items:center;gap:calc(var(--spacing)/2)}",""]),t["default"]=s},48594:function(e,t,i){"use strict";i.r(t);var o=i(31601),n=i.n(o),a=i(76314),r=i.n(a),s=r()(n());s.push([e.id,".m_vecto{-o-object-fit:scale-down;object-fit:scale-down}.m_vecto,.m_vecto svg{width:100%;height:100%}",""]),t["default"]=s},87976:function(e,t,i){var o=i(99418);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var n=i(43197).A;n("cbbdb526",o,!0,{sourceMap:!1,shadowMode:!1})},36524:function(e,t,i){var o=i(36313);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var n=i(43197).A;n("c4143868",o,!0,{sourceMap:!1,shadowMode:!1})},18774:function(e,t,i){var o=i(69736);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var n=i(43197).A;n("0dc476e2",o,!0,{sourceMap:!1,shadowMode:!1})},17270:function(e,t,i){var o=i(94384);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var n=i(43197).A;n("7c95cba4",o,!0,{sourceMap:!1,shadowMode:!1})},23212:function(e,t,i){var o=i(56266);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var n=i(43197).A;n("4d895afc",o,!0,{sourceMap:!1,shadowMode:!1})},79939:function(e,t,i){var o=i(23013);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var n=i(43197).A;n("5c7c00ad",o,!0,{sourceMap:!1,shadowMode:!1})},60092:function(e,t,i){var o=i(6742);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var n=i(43197).A;n("3b616b83",o,!0,{sourceMap:!1,shadowMode:!1})},82460:function(e,t,i){var o=i(91366);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var n=i(43197).A;n("52f7b16d",o,!0,{sourceMap:!1,shadowMode:!1})},10136:function(e,t,i){var o=i(18930);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var n=i(43197).A;n("c8c325e2",o,!0,{sourceMap:!1,shadowMode:!1})},59775:function(e,t,i){var o=i(60497);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var n=i(43197).A;n("223360da",o,!0,{sourceMap:!1,shadowMode:!1})},22646:function(e,t,i){var o=i(25612);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var n=i(43197).A;n("f46a95de",o,!0,{sourceMap:!1,shadowMode:!1})},5076:function(e,t,i){var o=i(39842);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var n=i(43197).A;n("09d5c227",o,!0,{sourceMap:!1,shadowMode:!1})},85499:function(e,t,i){var o=i(57889);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var n=i(43197).A;n("2eae3a6c",o,!0,{sourceMap:!1,shadowMode:!1})},28610:function(e,t,i){var o=i(28760);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var n=i(43197).A;n("1800c4e5",o,!0,{sourceMap:!1,shadowMode:!1})},75224:function(e,t,i){var o=i(48594);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var n=i(43197).A;n("298ca7be",o,!0,{sourceMap:!1,shadowMode:!1})}}]);